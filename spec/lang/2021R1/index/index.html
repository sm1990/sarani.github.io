<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta name="description"/><meta name="keywords"/><title></title><meta property="og:type" content="article"/><meta property="og:title" content="Ballerina - undefined"/><meta property="og:description"/><meta property="og:description"/><meta property="twitter:description"/><meta property="twitter:text:description"/><link rel="stylesheet" href="/spec/ballerina-language-specification.css"/><script type="text/javascript" src="https://www.google-analytics.com/analytics.js"></script><script src="https://www.googletagmanager.com/gtm.js?id=GTM-PSL2TX4"></script><script src="https://www.googletagmanager.com/gtag/js?id=UA-92163714-2"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@docsearch/js@alpha"></script><meta name="next-head-count" content="16"/><meta name="robots" content="noindex"/><meta name="googlebot" content="noindex"/><meta name="author" content="WSO2, Inc."/><meta property="og:image" content="/images/ballerina-swan-lake-sm-banner-general.png"/><meta property="og:title" content="Ballerina"/><meta property="og:image" content="/images/ballerina-swan-lake-sm-banner-general.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@ballerinalang"/><meta name="twitter:creator" content="@ballerinalang"/><meta name="twitter:title" content="Ballerina"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:image" content="/images/ballerina-swan-lake-sm-banner-general.png"/><meta property="twitter:image" content="/images/ballerina-swan-lake-sm-banner-general.png"/><link rel="shortcut icon" href="/images/favicon.ico"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/><link rel="stylesheet" href="/css/ballerina-search-button.css"/><link rel="stylesheet" href="/css/ballerina-search-modal.css"/><link rel="stylesheet" href="/css/ballerina-search-variables.css"/><link rel="stylesheet" href="/css/ballerina-search-style.css"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/dbd1af12e2ca4996.css" as="style"/><link rel="stylesheet" href="/_next/static/css/dbd1af12e2ca4996.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-d68cd569c1214ba2.js" defer=""></script><script src="/_next/static/chunks/framework-79bce4a3a540b080.js" defer=""></script><script src="/_next/static/chunks/main-4f85a1e5c9f3a8d0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-2bc609c5d81b076c.js" defer=""></script><script src="/_next/static/chunks/pages/spec/lang/%5B...slug%5D-d78dc1d9801e1147.js" defer=""></script><script src="/_next/static/lz8gcLmWqhPPISHqmYQtS/_buildManifest.js" defer=""></script><script src="/_next/static/lz8gcLmWqhPPISHqmYQtS/_ssgManifest.js" defer=""></script><script src="/_next/static/lz8gcLmWqhPPISHqmYQtS/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap">@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOiCnqEu92Fr1Mu51QrIzQ.woff) format('woff')}@font-face{font-family:'Roboto';font-style:italic;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TjARc-.woff) format('woff')}@font-face{font-family:'Roboto';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1Mu52xM.woff) format('woff')}@font-face{font-family:'Roboto';font-style:italic;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51S7ABc-.woff) format('woff')}@font-face{font-family:'Roboto';font-style:italic;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TzBhc-.woff) format('woff')}@font-face{font-family:'Roboto';font-style:italic;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TLBBc-.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1MmgWxM.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmSU5vAA.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOmCnqEu92Fr1Me5g.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmEU9vAA.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmWUlvAA.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmYUtvAA.woff) format('woff')}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOiCnqEu92Fr1Mu51QrEz0dL-vwnYh2eg.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOiCnqEu92Fr1Mu51QrEzQdL-vwnYh2eg.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOiCnqEu92Fr1Mu51QrEzwdL-vwnYh2eg.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOiCnqEu92Fr1Mu51QrEzMdL-vwnYh2eg.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOiCnqEu92Fr1Mu51QrEz8dL-vwnYh2eg.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOiCnqEu92Fr1Mu51QrEz4dL-vwnYh2eg.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOiCnqEu92Fr1Mu51QrEzAdL-vwnYg.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:italic;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TjASc3CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:italic;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TjASc-CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:italic;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TjASc2CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:italic;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TjASc5CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:italic;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TjASc1CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:italic;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TjASc0CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:italic;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TjASc6CsTYl4BO.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1Mu51xFIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1Mu51xMIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1Mu51xEIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1Mu51xLIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1Mu51xHIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1Mu51xGIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1Mu51xIIzIXKMny.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:italic;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51S7ACc3CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:italic;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51S7ACc-CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:italic;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51S7ACc2CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:italic;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51S7ACc5CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:italic;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51S7ACc1CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:italic;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51S7ACc0CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:italic;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51S7ACc6CsTYl4BO.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:italic;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TzBic3CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:italic;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TzBic-CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:italic;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TzBic2CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:italic;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TzBic5CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:italic;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TzBic1CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:italic;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TzBic0CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:italic;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TzBic6CsTYl4BO.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:italic;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TLBCc3CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:italic;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TLBCc-CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:italic;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TLBCc2CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:italic;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TLBCc5CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:italic;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TLBCc1CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:italic;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TLBCc0CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:italic;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TLBCc6CsTYl4BO.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1MmgVxFIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1MmgVxMIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1MmgVxEIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1MmgVxLIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1MmgVxHIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1MmgVxGIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOkCnqEu92Fr1MmgVxIIzIXKMny.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOmCnqEu92Fr1Mu72xKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOmCnqEu92Fr1Mu5mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOmCnqEu92Fr1Mu7mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOmCnqEu92Fr1Mu4WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOmCnqEu92Fr1Mu7WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOmCnqEu92Fr1Mu7GxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxKKTU1Kg.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmWUlfCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmWUlfABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmWUlfCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmWUlfBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmWUlfCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmWUlfChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmWUlfBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmYUtfCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmYUtfABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmYUtfCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmYUtfBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmYUtfCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmYUtfChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v30/KFOlCnqEu92Fr1MmYUtfBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next" data-reactroot=""><div class="main-wrapper spec vstack gap-0"><div class="wrap-page-content container"><div class="row"><div class="mdContentSpec col-12"><div><!DOCTYPE html>
<html lang="en">
<head>
  <title>Ballerina Language Specification</title>
  <meta charset="utf-8">
  <style type="text/css">
    body { font-family: sans-serif; line-height: 1.38;  }
    pre.grammar code, code.grammar { background-color: #D0D0D0; }
    pre, code { font-family: Consolas, monospace; }
    table { border: solid thin; border-collapse: collapse; }
    td, th { border: solid thin; padding: 0.5em; }
    p.status { font-size: large; font-weight: bold; }
  </style>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i&amp;display=swap">
<link rel="stylesheet" href="style/ballerina-language-specification.css">
<script src="https://code.jquery.com/jquery-2.2.4.min.js"></script><script src="style/ballerina-language-specification.js"></script>
</head>
<body>
<h1>Ballerina Language Specification, 2021R1</h1>
<p>
Primary contributors:
</p>
<ul>
<li>James Clark, <a href="mailto:jjc@jclark.com">jjc@jclark.com</a>
</li>
<li>Sanjiva Weerawarana, <a href="mailto:sanjiva@weerawarana.org">sanjiva@weerawarana.org</a>
</li>
<li>Sameera Jayasoma, <a href="mailto:sameera@wso2.com">sameera@wso2.com</a>
</li>
<li>Hasitha Aravinda, <a href="mailto:hasitha@wso2.com">hasitha@wso2.com</a>
</li>
</ul>
<p>
(Other contributors are listed in <a href="#contributors">Appendix D</a>.)
</p>
<p>
Copyright Â© 2018-2021 <a href="https://wso2.com/">WSO2</a>
</p>
<p>
Licensed under the <a href="https://creativecommons.org/licenses/by-nd/4.0/">Creative Commons
Attribution-NoDerivatives 4.0 International</a> license
</p>
<p class="status">
Language and document status
</p>
<p>
The language described in this specification is now stable. We do not plan to
make changes that introduce significant incompatibilities.
</p>
<p>
Comments on this document are welcome and should be made by creating an issue in
<code><a href="https://github.com/ballerina-platform/ballerina-spec">https://github.com/ballerina-platform/ballerina-spec</a></code>, which is the
GitHub repository where this specification is maintained.
</p>
<section class="toc"><h2>Table of contents</h2>
<ul>
<li>1. <a href="#introduction">Introduction</a>
</li>
<li>2. <a href="#notation">Notation</a>
</li>
<li>3. <a href="#program_structure">Program structure</a>
</li>
<li>4. <a href="#lexical_structure">Lexical structure</a>
</li>
<li>5. <a href="#values_types">Values, types and variables</a><ul>
<li>5.1 <a href="#section_5.1">Overview</a><ul>
<li>5.1.1 <a href="#section_5.1.1">Type system fundamentals</a>
</li>
<li>5.1.2 <a href="#section_5.1.2">Mutation</a>
</li>
<li>5.1.3 <a href="#section_5.1.3">Isolation</a>
</li>
<li>5.1.4 <a href="#section_5.1.4">Type descriptors</a>
</li>
<li>5.1.5 <a href="#section_5.1.5">Type-ids</a>
</li>
<li>5.1.6 <a href="#section_5.1.6">Iterability</a>
</li>
</ul>
</li>
<li>5.2 <a href="#section_5.2">Simple values</a><ul>
<li>5.2.1 <a href="#section_5.2.1">Nil</a>
</li>
<li>5.2.2 <a href="#section_5.2.2">Boolean</a>
</li>
<li>5.2.3 <a href="#section_5.2.3">Int</a>
</li>
<li>5.2.4 <a href="#section_5.2.4">Floating point types</a><ul>
<li>5.2.4.1 <a href="#section_5.2.4.1">Float</a>
</li>
<li>5.2.4.2 <a href="#section_5.2.4.2">Decimal</a>
</li>
</ul>
</li>
</ul>
</li>
<li>5.3 <a href="#section_5.3">Sequence values</a><ul>
<li>5.3.1 <a href="#section_5.3.1">Strings</a>
</li>
<li>5.3.2 <a href="#XML">XML</a><ul><li>5.3.2.1 <a href="#section_5.3.2.1">XML namespaces</a>
</li></ul>
</li>
</ul>
</li>
<li>5.4 <a href="#section_5.4">Structured values</a><ul>
<li>5.4.1 <a href="#section_5.4.1">Lists</a><ul>
<li>5.4.1.1 <a href="#section_5.4.1.1">Array types</a>
</li>
<li>5.4.1.2 <a href="#section_5.4.1.2">Tuple types</a>
</li>
</ul>
</li>
<li>5.4.2 <a href="#section_5.4.2">Mappings</a><ul>
<li>5.4.2.1 <a href="#section_5.4.2.1">Map types</a>
</li>
<li>5.4.2.2 <a href="#section_5.4.2.2">Record types</a>
</li>
</ul>
</li>
<li>5.4.3 <a href="#tables">Tables</a>
</li>
</ul>
</li>
<li>5.5 <a href="#section_5.5">Behavioral values</a><ul>
<li>5.5.1 <a href="#section_5.5.1">Errors</a>
</li>
<li>5.5.2 <a href="#functions">Functions</a>
</li>
<li>5.5.3 <a href="#section_5.5.3">Objects</a><ul>
<li>5.5.3.1 <a href="#section_5.5.3.1">Network interaction</a>
</li>
<li>5.5.3.2 <a href="#section_5.5.3.2">Fields</a>
</li>
<li>5.5.3.3 <a href="#section_5.5.3.3">Methods</a>
</li>
<li>5.5.3.4 <a href="#section_5.5.3.4">Visibility</a>
</li>
<li>5.5.3.5 <a href="#section_5.5.3.5">Typing</a>
</li>
<li>5.5.3.6 <a href="#section_5.5.3.6">Inclusion and type-ids</a>
</li>
</ul>
</li>
<li>5.5.4 <a href="#section_5.5.4">Futures</a>
</li>
<li>5.5.5 <a href="#section_5.5.5">Type descriptors</a>
</li>
<li>5.5.6 <a href="#section_5.5.6">Handles</a>
</li>
<li>5.5.7 <a href="#section_5.5.7">Streams</a>
</li>
</ul>
</li>
<li>5.6 <a href="#section_5.6">Other type descriptors</a><ul>
<li>5.6.1 <a href="#section_5.6.1">Type reference</a>
</li>
<li>5.6.2 <a href="#section_5.6.2">Singleton types</a>
</li>
<li>5.6.3 <a href="#section_5.6.3">Any type</a>
</li>
<li>5.6.4 <a href="#section_5.6.4">Never type</a>
</li>
<li>5.6.5 <a href="#section_5.6.5">Readonly type</a>
</li>
<li>5.6.6 <a href="#distinct_types">Distinct types</a>
</li>
<li>5.6.7 <a href="#section_5.6.7">Union types</a>
</li>
<li>5.6.8 <a href="#section_5.6.8">Intersection types</a>
</li>
<li>5.6.9 <a href="#section_5.6.9">Optional types</a>
</li>
<li>5.6.10 <a href="#anydata">Anydata type</a>
</li>
<li>5.6.11 <a href="#section_5.6.11">JSON types</a>
</li>
<li>5.6.12 <a href="#byte_type">Byte type</a>
</li>
</ul>
</li>
<li>5.7 <a href="#built-in_object_types">Built-in object types</a><ul>
<li>5.7.1 <a href="#section_5.7.1">Iterator</a>
</li>
<li>5.7.2 <a href="#section_5.7.2">Iterable</a>
</li>
<li>5.7.3 <a href="#StreamImplementor">StreamImplementor</a>
</li>
<li>5.7.4 <a href="#section_5.7.4">Listener</a>
</li>
<li>5.7.5 <a href="#section_5.7.5">RawTemplate</a>
</li>
<li>5.7.6 <a href="#section_5.7.6">RetryManager</a>
</li>
</ul>
</li>
<li>5.8 <a href="#section_5.8">Abstract operations</a><ul>
<li>5.8.1 <a href="#FillMember">FillMember</a>
</li>
<li>5.8.2 <a href="#Cloning">Cloning</a><ul>
<li>5.8.2.1 <a href="#Clone">Clone</a>
</li>
<li>5.8.2.2 <a href="#ImmutableClone">ImmutableClone</a>
</li>
</ul>
</li>
<li>5.8.3 <a href="#DeepEquals">DeepEquals</a>
</li>
<li>5.8.4 <a href="#section_5.8.4">NumericConvert</a>
</li>
<li>5.8.5 <a href="#ToString">ToString</a>
</li>
<li>5.8.6 <a href="#ordering">Ordering</a>
</li>
</ul>
</li>
<li>5.9 <a href="#section_5.9">Binding patterns and variables</a><ul>
<li>5.9.1 <a href="#section_5.9.1">Binding patterns</a>
</li>
<li>5.9.2 <a href="#section_5.9.2">Typed binding patterns</a>
</li>
<li>5.9.3 <a href="#section_5.9.3">Variable and identifier scoping</a>
</li>
</ul>
</li>
</ul>
</li>
<li>6. <a href="#expressions">Expressions</a><ul>
<li>6.1 <a href="#section_6.1">Expression evaluation</a>
</li>
<li>6.2 <a href="#section_6.2">Static typing of expressions</a><ul>
<li>6.2.1 <a href="#lax_static_typing">Lax static typing</a>
</li>
<li>6.2.2 <a href="#section_6.2.2">Contextually expected type</a>
</li>
<li>6.2.3 <a href="#section_6.2.3">Precise and broad types</a>
</li>
<li>6.2.4 <a href="#section_6.2.4">Isolated expressions</a>
</li>
</ul>
</li>
<li>6.3 <a href="#section_6.3">Casting and conversion</a>
</li>
<li>6.4 <a href="#section_6.4">Constant expressions</a>
</li>
<li>6.5 <a href="#section_6.5">Literals</a>
</li>
<li>6.6 <a href="#section_6.6">Template expressions</a><ul>
<li>6.6.1 <a href="#section_6.6.1">String template expression</a>
</li>
<li>6.6.2 <a href="#section_6.6.2">XML template expression</a>
</li>
<li>6.6.3 <a href="#section_6.6.3">Raw template expression</a>
</li>
</ul>
</li>
<li>6.7 <a href="#section_6.7">Structural constructors</a><ul>
<li>6.7.1 <a href="#section_6.7.1">List constructor</a>
</li>
<li>6.7.2 <a href="#section_6.7.2">Mapping constructor</a>
</li>
<li>6.7.3 <a href="#section_6.7.3">Table constructor</a>
</li>
</ul>
</li>
<li>6.8 <a href="#section_6.8">Object construction</a><ul>
<li>6.8.1 <a href="#section_6.8.1">Object constructor</a><ul>
<li>6.8.1.1 <a href="#section_6.8.1.1">Fields</a>
</li>
<li>6.8.1.2 <a href="#section_6.8.1.2">Methods</a>
</li>
<li>6.8.1.3 <a href="#resources">Resources</a>
</li>
<li>6.8.1.4 <a href="#section_6.8.1.4">Initialization</a>
</li>
</ul>
</li>
<li>6.8.2 <a href="#section_6.8.2">New expression</a>
</li>
</ul>
</li>
<li>6.9 <a href="#section_6.9">Variable reference expression</a>
</li>
<li>6.10 <a href="#section_6.10">Field access expression</a>
</li>
<li>6.11 <a href="#section_6.11">Optional field access expression</a>
</li>
<li>6.12 <a href="#section_6.12">XML attribute access expression</a>
</li>
<li>6.13 <a href="#section_6.13">Annotation access expression</a>
</li>
<li>6.14 <a href="#section_6.14">Member access expression</a>
</li>
<li>6.15 <a href="#function_call">Function call expression</a>
</li>
<li>6.16 <a href="#section_6.16">Method call expression</a>
</li>
<li>6.17 <a href="#section_6.17">Error constructor</a>
</li>
<li>6.18 <a href="#section_6.18">Anonymous function expression</a>
</li>
<li>6.19 <a href="#section_6.19">Let expression</a>
</li>
<li>6.20 <a href="#section_6.20">Type cast expression</a>
</li>
<li>6.21 <a href="#section_6.21">Typeof expression</a>
</li>
<li>6.22 <a href="#section_6.22">Unary expression</a>
</li>
<li>6.23 <a href="#section_6.23">Multiplicative expression</a>
</li>
<li>6.24 <a href="#section_6.24">Additive expression</a>
</li>
<li>6.25 <a href="#section_6.25">Shift expression</a>
</li>
<li>6.26 <a href="#section_6.26">Range expression</a>
</li>
<li>6.27 <a href="#section_6.27">Relational expression</a>
</li>
<li>6.28 <a href="#section_6.28">Type test expression</a>
</li>
<li>6.29 <a href="#section_6.29">Equality expression</a>
</li>
<li>6.30 <a href="#section_6.30">Binary bitwise expression</a>
</li>
<li>6.31 <a href="#section_6.31">Logical expression</a>
</li>
<li>6.32 <a href="#section_6.32">Conditional expression</a>
</li>
<li>6.33 <a href="#section_6.33">Checking expression</a>
</li>
<li>6.34 <a href="#section_6.34">Trap expression</a>
</li>
<li>6.35 <a href="#section_6.35">Query expression</a><ul>
<li>6.35.1 <a href="#section_6.35.1">From clause</a>
</li>
<li>6.35.2 <a href="#section_6.35.2">Where clause</a>
</li>
<li>6.35.3 <a href="#section_6.35.3">Let clause</a>
</li>
<li>6.35.4 <a href="#section_6.35.4">Join clause</a>
</li>
<li>6.35.5 <a href="#section_6.35.5">Order by clause</a>
</li>
<li>6.35.6 <a href="#section_6.35.6">Limit clause</a>
</li>
<li>6.35.7 <a href="#section_6.35.7">Select clause</a>
</li>
<li>6.35.8 <a href="#section_6.35.8">On conflict clause</a>
</li>
</ul>
</li>
<li>6.36 <a href="#section_6.36">XML navigation expression</a><ul>
<li>6.36.1 <a href="#section_6.36.1">XML name pattern</a>
</li>
<li>6.36.2 <a href="#section_6.36.2">XML filter expression</a>
</li>
<li>6.36.3 <a href="#section_6.36.3">XML step expression</a>
</li>
</ul>
</li>
<li>6.37 <a href="#section_6.37">Transactional expression</a>
</li>
</ul>
</li>
<li>7. <a href="#actions_statements">Actions and statements</a><ul>
<li>7.1 <a href="#section_7.1">Actions</a>
</li>
<li>7.2 <a href="#section_7.2">Threads and strands</a>
</li>
<li>7.3 <a href="#section_7.3">Function bodies</a><ul>
<li>7.3.1 <a href="#section_7.3.1">Function parameters</a>
</li>
<li>7.3.2 <a href="#section_7.3.2">Workers</a>
</li>
<li>7.3.3 <a href="#section_7.3.3">Expression-bodied functions</a>
</li>
<li>7.3.4 <a href="#section_7.3.4">External functions</a>
</li>
<li>7.3.5 <a href="#isolated_functions">Isolated functions</a>
</li>
</ul>
</li>
<li>7.4 <a href="#section_7.4">Statement execution</a>
</li>
<li>7.5 <a href="#section_7.5">Fork statement</a>
</li>
<li>7.6 <a href="#section_7.6">Start action</a>
</li>
<li>7.7 <a href="#section_7.7">Wait action</a><ul>
<li>7.7.1 <a href="#section_7.7.1">Single wait action</a>
</li>
<li>7.7.2 <a href="#section_7.7.2">Multiple wait action</a>
</li>
<li>7.7.3 <a href="#section_7.7.3">Alternate wait action </a>
</li>
</ul>
</li>
<li>7.8 <a href="#section_7.8">Worker message passing</a><ul>
<li>7.8.1 <a href="#section_7.8.1">Send action</a>
</li>
<li>7.8.2 <a href="#section_7.8.2">Receive action</a><ul>
<li>7.8.2.1 <a href="#section_7.8.2.1">Single receive action</a>
</li>
<li>7.8.2.2 <a href="#section_7.8.2.2">Multiple receive action</a>
</li>
</ul>
</li>
<li>7.8.3 <a href="#section_7.8.3">Flush action</a>
</li>
<li>7.8.4 <a href="#section_7.8.4">Send-receive correspondence</a>
</li>
</ul>
</li>
<li>7.9 <a href="#section_7.9">Outbound network interaction</a>
</li>
<li>7.10 <a href="#section_7.10">Query action</a>
</li>
<li>7.11 <a href="#section_7.11">Local variable declaration statements</a>
</li>
<li>7.12 <a href="#conditional_variable_type_narrowing">Conditional variable type narrowing</a>
</li>
<li>7.13 <a href="#XML_namespace_declaration_statement">XML namespace declaration statement</a>
</li>
<li>7.14 <a href="#section_7.14">Assignment</a><ul>
<li>7.14.1 <a href="#section_7.14.1">Lvalues</a>
</li>
<li>7.14.2 <a href="#section_7.14.2">Assignment statement</a>
</li>
<li>7.14.3 <a href="#section_7.14.3">Compound assignment statement</a>
</li>
<li>7.14.4 <a href="#section_7.14.4">Destructuring assignment statement</a>
</li>
</ul>
</li>
<li>7.15 <a href="#section_7.15">Action statement</a>
</li>
<li>7.16 <a href="#section_7.16">Call statement</a>
</li>
<li>7.17 <a href="#section_7.17">Conditional statement</a>
</li>
<li>7.18 <a href="#section_7.18">Do statement</a>
</li>
<li>7.19 <a href="#match_statement">Match statement</a>
</li>
<li>7.20 <a href="#section_7.20">Loops</a><ul>
<li>7.20.1 <a href="#section_7.20.1">Foreach statement</a>
</li>
<li>7.20.2 <a href="#section_7.20.2">While statement</a>
</li>
<li>7.20.3 <a href="#section_7.20.3">Continue statement</a>
</li>
<li>7.20.4 <a href="#section_7.20.4">Break statement</a>
</li>
</ul>
</li>
<li>7.21 <a href="#lock_statement">Lock statement</a>
</li>
<li>7.22 <a href="#section_7.22">Fail and retry</a><ul>
<li>7.22.1 <a href="#section_7.22.1">Fail statement</a>
</li>
<li>7.22.2 <a href="#section_7.22.2">On fail clause</a>
</li>
<li>7.22.3 <a href="#section_7.22.3">Retry statement</a>
</li>
</ul>
</li>
<li>7.23 <a href="#transactions">Transactions</a><ul>
<li>7.23.1 <a href="#section_7.23.1">Transaction manager</a><ul>
<li>7.23.1.1 <a href="#section_7.23.1.1">Begin operation</a>
</li>
<li>7.23.1.2 <a href="#section_7.23.1.2">Commit operation</a>
</li>
<li>7.23.1.3 <a href="#section_7.23.1.3">Rollback operation</a>
</li>
</ul>
</li>
<li>7.23.2 <a href="#section_7.23.2">Transaction statement</a>
</li>
<li>7.23.3 <a href="#section_7.23.3">Retry transaction statement</a>
</li>
<li>7.23.4 <a href="#section_7.23.4">Commit action</a>
</li>
<li>7.23.5 <a href="#section_7.23.5">Rollback statement</a>
</li>
</ul>
</li>
<li>7.24 <a href="#section_7.24">Panic statement</a>
</li>
<li>7.25 <a href="#section_7.25">Return statement</a>
</li>
</ul>
</li>
<li>8. <a href="#module_level">Module-level declarations</a><ul>
<li>8.1 <a href="#section_8.1">Import declaration</a>
</li>
<li>8.2 <a href="#section_8.2">Module and program execution</a>
</li>
<li>8.3 <a href="#listeners_and_services">Listeners and services</a><ul>
<li>8.3.1 <a href="#section_8.3.1">Listener declaration</a>
</li>
<li>8.3.2 <a href="#section_8.3.2">Service declaration</a>
</li>
<li>8.3.3 <a href="#section_8.3.3">Isolated inference</a>
</li>
</ul>
</li>
<li>8.4 <a href="#section_8.4">Function definition</a>
</li>
<li>8.5 <a href="#section_8.5">Module type definition</a>
</li>
<li>8.6 <a href="#section_8.6">Module class definition</a>
</li>
<li>8.7 <a href="#section_8.7">Module variable declaration</a>
</li>
<li>8.8 <a href="#section_8.8">Module constant declaration</a>
</li>
<li>8.9 <a href="#section_8.9">Module enumeration declaration</a>
</li>
<li>8.10 <a href="#section_8.10">Module XML namespace declaration</a>
</li>
</ul>
</li>
<li>9. <a href="#metadata">Metadata</a><ul>
<li>9.1 <a href="#section_9.1">Annotations</a>
</li>
<li>9.2 <a href="#section_9.2">Documentation</a>
</li>
<li>9.3 <a href="#section_9.3">Ballerina Flavored Markdown</a>
</li>
</ul>
</li>
<li>10. <a href="#lang_library">Lang library</a><ul>
<li>10.1 <a href="#section_10.1">Generic types</a>
</li>
<li>10.2 <a href="#built-in_subtypes">Built-in subtypes</a>
</li>
<li>10.3 <a href="#section_10.3">Lang library modules</a><ul>
<li>10.3.1 <a href="#lang.array"><code>lang.array</code> module</a>
</li>
<li>10.3.2 <a href="#lang.boolean"><code>lang.boolean</code> module</a>
</li>
<li>10.3.3 <a href="#lang.decimal"><code>lang.decimal</code> module</a>
</li>
<li>10.3.4 <a href="#lang.error"><code>lang.error</code> module</a>
</li>
<li>10.3.5 <a href="#lang.float"><code>lang.float</code> module</a>
</li>
<li>10.3.6 <a href="#lang.future"><code>lang.future</code> module</a>
</li>
<li>10.3.7 <a href="#lang.int"><code>lang.int</code> module</a>
</li>
<li>10.3.8 <a href="#lang.map"><code>lang.map</code> module</a>
</li>
<li>10.3.9 <a href="#lang.object"><code>lang.object</code> module</a>
</li>
<li>10.3.10 <a href="#lang.stream"><code>lang.stream</code> module</a>
</li>
<li>10.3.11 <a href="#lang.string"><code>lang.string</code> module</a>
</li>
<li>10.3.12 <a href="#lang.table"><code>lang.table</code> module</a>
</li>
<li>10.3.13 <a href="#lang.typedesc"><code>lang.typedesc</code> module</a>
</li>
<li>10.3.14 <a href="#lang.xml"><code>lang.xml</code> module</a>
</li>
<li>10.3.15 <a href="#lang.transaction"><code>lang.transaction</code> module</a>
</li>
<li>10.3.16 <a href="#lang.runtime"><code>lang.runtime</code> module</a>
</li>
<li>10.3.17 <a href="#lang.value"><code>lang.value</code> module</a>
</li>
</ul>
</li>
</ul>
</li>
<li>A. <a href="#references">References</a>
</li>
<li>B. <a href="#changes">Changes since previous releases</a><ul>
<li>B.1 <a href="#section_B.1">Summary of changes from 2020R1 to 2021R1</a>
</li>
<li>B.2 <a href="#section_B.2">Summary of changes from 2019R3 to 2020R1</a>
</li>
<li>B.3 <a href="#section_B.3">Summary of changes from 2019R2 to 2019R3</a>
</li>
<li>B.4 <a href="#section_B.4">Summary of changes from 2019R1 to 2019R2</a>
</li>
<li>B.5 <a href="#section_B.5">Summary of changes from 0.990 to 2019R1</a>
</li>
<li>B.6 <a href="#section_B.6">Summary of changes from 0.980 to 0.990</a>
</li>
<li>B.7 <a href="#section_B.7">Summary of changes from 0.970 to 0.980</a>
</li>
</ul>
</li>
<li>C. <a href="#planned_future_functionality">Planned future functionality</a>
</li>
<li>D. <a href="#contributors">Other contributors</a>
</li>
</ul></section>
<section>
<h2 id="introduction">1. Introduction</h2>
<p>
Ballerina is a statically typed, concurrent programming language, focusing on
network interaction and structured data. It is intended to be the core of a
language-centric middleware platform. It has all the general-purpose
functionality expected of a modern programming language, but it also has several
unusual aspects that make it particularly suitable for its intended purpose.
</p>
<p>
First, it provides language constructs specifically for consuming and providing
network services. Future versions of Ballerina will add language constructs for
other middleware functionality such as event stream processing and reliable
messaging; this is described in more detail in <a href="#planned_future_functionality">Appendix C</a>.
</p>
<p>
Second, its abstractions and syntax for concurrency and network interaction have
been designed so that there is a close correspondence with sequence diagrams.
This enables a bidirectional mapping for any Ballerina function between its
textual representation in the syntax described in this specification and its
graphical representation as a sequence diagram, such that the sequence diagram
fully shows the aspects of the behavior of that function that relate to
concurrency and network interaction.
</p>
<p>
Third, it has a type system that is more flexible and allows for looser coupling
than traditional statically typed languages. The type system is structural:
instead of requiring the program to explicitly say which types are compatible
with each other, compatibility of types and values is determined automatically
based on their structure; this is particularly useful when combining data from
multiple, independently-designed systems. In addition, the type system provides
union types and open records. This flexibility allows the type system to be used
as a schema for the data that is exchanged in distributed applications.
Ballerina's data types are designed to work particularly well with JSON; any
JSON value has a direct, natural representation as a Ballerina value. Ballerina
also provides support for XML and tabular data.
</p>
<p>
Ballerina is not a research language. It is intended to be a pragmatic language
suitable for mass-market commercial adoption. It tries to feel familiar to
programmers who are used to popular, modern C-family languages, notably Java, C#
and JavaScript. It also gets ideas and inspiration from many other existing
programming languages including TypeScript, Go, Rust, D, Kotlin, Swift, Python
and Perl.
</p>
<p>
The Ballerina language has been designed in conjunction with the Ballerina
platform, which provides comprehensive support for a module-based software
development model, including versioning, dependency management, testing,
documentation, building and sharing. Modules are organized into repositories;
there is a globally-shared, central repository, but repositories can also be
local.
</p>
<p>
The Ballerina language includes a small library, the lang library, which
provides fundamental operations on the data types defined by the language; the
lang library is defined by this specification. The Ballerina platform includes
an extensive standard library, which includes not only the usual low-level,
general-purpose functionality, but also support for a wide variety of network
protocols, interface standards, data formats and authentication/authorization
standards, which make writing secure, resilient distributed applications
significantly easier than with other languages. The standard library is not
specified in this document.
</p>
</section>
<section>
<h2 id="notation">2. Notation</h2>
<p>
Productions are written in the form:
</p>

<pre>symbol := rhs
</pre>
<p>
where symbol is the name of a nonterminal, and <code>rhs</code> is as follows:
</p>
<ul>
<li>
<code>0xX</code> means the single character whose Unicode code point is
denoted by the hexadecimal numeral X</li>
<li>
<code>^x</code> means any single Unicode code point that does not match x
and is not a disallowed character;</li>
<li>
<code>x..y</code> means any single Unicode character whose code point is
greater than or equal to that of x and less than or equal to that of y</li>
<li>
<code class="grammar">str</code> means the characters <code>str</code> literally</li>
<li>
<code>symbol </code>means a reference to production for the nonterminal
<code>symbol</code>
</li>
<li>
<code>x|y</code> means x or y</li>
<li>
<code>x&amp;y</code> means x and y, interleaved in any order</li>
<li>
<code>[x]</code> means zero or one times</li>
<li>
<code>x?</code> means x zero or one times</li>
<li>
<code>x*</code> means x zero or more times</li>
<li>
<code>x+</code> means x one or more times</li>
<li>
<code>(x)</code> means x (grouping)</li>
</ul>
<p>
The <code>rhs</code> of a symbol that starts with a lower-case letter implicitly allows white
space and comments, as defined by the production <code>TokenWhiteSpace</code>,
between the terminals and nonterminals that it references.
</p>
</section>
<section>
<h2 id="program_structure">3. Program structure</h2>
<p>
A Ballerina program is divided into modules. A module has a source form and a
binary form. The source form of a module consists of an ordered collection of
one or more source parts; each source part is a sequence of bytes that is the
UTF-8 encoding of part of the source code for the module. The format of a source
part is defined by this specification. The format of a binary module is
specified by the Ballerina platform.
</p>
<p>
A source module can reference other modules. Each source module can be
separately compiled into a binary module: compilation of a source module needs
access only to the binary form of other modules referenced from the source
module. A source module identifies each module that it references using an
organization name and a module name, which is divided into one or more parts.
Both the organization name and each part of the module name are Unicode strings.
Any organization name starting with the string <code>ballerina</code> is
reserved for use by the Ballerina platform.
</p>
<p>
The Ballerina platform defines a packaging system for Ballerina modules, which
allows one or more modules to be combined into a package. The packaging system
treats the first part of each module's name as being a package name. All the
modules combined into a package share the same package name. Packages have both
a source and a binary format. The source format stores the source form of a
package's modules in a hierarchical filesystem. The binary format stores the
binary form of a package's module as a sequence of bytes.
</p>
<p>
Binary packages can be stored in a package repository. Packages are versioned;
versions are semantic, as described in the SemVer specification. A package
repository can store multiple versions of the same package. Thus, within a
repository, binary packages are organized into a three-level hierarchy:
</p>
<ol>
<li>organization;</li>
<li>package name;</li>
<li>version.</li>
</ol>
<p>
The source format of a package includes a <code>Ballerina.toml</code> file that
allows control over the package versions used for referenced modules.
</p>
<p>
The packaging system also allows control over which modules are exported from a
package; modules that are not exported from a package are visible only to
modules within the package.
</p>
</section>
<section>
<h2 id="lexical_structure">4. Lexical structure</h2>
<p>
The grammar in this document specifies how a sequence of Unicode code points is
interpreted as part of the source of a Ballerina module. A Ballerina module part
is a sequence of octets (8-bit bytes); this sequence of octets is interpreted as
the UTF-8 encoding of a sequence of code points and must comply with the
requirements of RFC 3629.
</p>
<p>
After the sequence of octets is decoded from UTF-8, the following two
transformations must be performed before it is parsed using the grammar in this
document:
</p>
<ul>
<li>if the sequence starts with a byte order mark (code point 0xFEFF), it must
be removed</li>
<li>newlines are normalized as follows:
<ul>
<li>the two character sequence 0xD 0xA is replaced by 0xA</li>
<li>a single 0xD character that is not followed by 0xD is replaced by 0xA</li>
</ul>
</li>
</ul>
<p>
The sequence of code points must not contain any of the following disallowed
code points:
</p>
<ul>
<li>surrogates (0xD800 to 0xDFFF)</li>
<li>non-characters (the 66 code points that Unicode designates as
non-characters)</li>
<li>C0 control characters (0x0 to 0x1F and 0x1F) other than whitespace (0x9,
0xA, 0xC, 0xD)</li>
<li>C1 control characters (0x80 to 0x9F)</li>
</ul>
<p>
Note that the grammar notation ^X does not allow the above disallowed code
points.
</p>

<pre class="grammar"><span class="ntdfn" id="identifier">identifier</span> := <a href="#UnquotedIdentifier"><span class="ntref">UnquotedIdentifier</span></a> | <a href="#QuotedIdentifier"><span class="ntref">QuotedIdentifier</span></a>
<span class="ntdfn" id="UnquotedIdentifier">UnquotedIdentifier</span> := (<a href="#IdentifierInitialChar"><span class="ntref">IdentifierInitialChar</span></a> | <a href="#IdentifierEscape"><span class="ntref">IdentifierEscape</span></a>) (<a href="#IdentifierFollowingChar"><span class="ntref">IdentifierFollowingChar</span></a> | <a href="#IdentifierEscape"><span class="ntref">IdentifierEscape</span></a>)*
<span class="ntdfn" id="QuotedIdentifier">QuotedIdentifier</span> := <code>'</code> (<a href="#IdentifierFollowingChar"><span class="ntref">IdentifierFollowingChar</span></a> | <a href="#IdentifierEscape"><span class="ntref">IdentifierEscape</span></a>)+
<span class="ntdfn" id="IdentifierInitialChar">IdentifierInitialChar</span> :=  <a href="#AsciiLetter"><span class="ntref">AsciiLetter</span></a> | <code>_</code> | <a href="#UnicodeIdentifierChar"><span class="ntref">UnicodeIdentifierChar</span></a>
<span class="ntdfn" id="IdentifierFollowingChar">IdentifierFollowingChar</span> := <a href="#IdentifierInitialChar"><span class="ntref">IdentifierInitialChar</span></a> | <a href="#Digit"><span class="ntref">Digit</span></a>
<span class="ntdfn" id="IdentifierEscape">IdentifierEscape</span> := <a href="#IdentifierSingleEscape"><span class="ntref">IdentifierSingleEscape</span></a> | <a href="#NumericEscape"><span class="ntref">NumericEscape</span></a>
<span class="ntdfn" id="IdentifierSingleEscape">IdentifierSingleEscape</span> := <code>\</code> ^ ( <a href="#AsciiLetter"><span class="ntref">AsciiLetter</span></a> | 0x9 | 0xA | 0xD | <a href="#UnicodePatternWhiteSpaceChar"><span class="ntref">UnicodePatternWhiteSpaceChar</span></a> )
<span class="ntdfn" id="NumericEscape">NumericEscape</span> := <code>\u{</code> <a href="#CodePoint"><span class="ntref">CodePoint</span></a> <code>}</code>
<span class="ntdfn" id="CodePoint">CodePoint</span> := <a href="#HexDigit"><span class="ntref">HexDigit</span></a>+
<span class="ntdfn" id="AsciiLetter">AsciiLetter</span> := <code>A</code> .. <code>Z</code> | <code>a</code> .. <code>z</code>
<span class="ntdfn" id="UnicodeIdentifierChar">UnicodeIdentifierChar</span> := ^ ( <a href="#AsciiChar"><span class="ntref">AsciiChar</span></a> | <a href="#UnicodeNonIdentifierChar"><span class="ntref">UnicodeNonIdentifierChar</span></a> )
<span class="ntdfn" id="AsciiChar">AsciiChar</span> := 0x0 .. 0x7F
<span class="ntdfn" id="UnicodeNonIdentifierChar">UnicodeNonIdentifierChar</span> :=
   <a href="#UnicodePrivateUseChar"><span class="ntref">UnicodePrivateUseChar</span></a>
   | <a href="#UnicodePatternWhiteSpaceChar"><span class="ntref">UnicodePatternWhiteSpaceChar</span></a>
   | <a href="#UnicodePatternSyntaxChar"><span class="ntref">UnicodePatternSyntaxChar</span></a>
<span class="ntdfn" id="UnicodePrivateUseChar">UnicodePrivateUseChar</span> :=
   0xE000 .. 0xF8FF
   | 0xF0000 .. 0xFFFFD
   | 0x100000 .. 0x10FFFD
<span class="ntdfn" id="UnicodePatternWhiteSpaceChar">UnicodePatternWhiteSpaceChar</span> := 0x200E | 0x200F | 0x2028 | 0x2029
<span class="ntdfn" id="UnicodePatternSyntaxChar">UnicodePatternSyntaxChar</span> := <em>character with Unicode property Pattern_Syntax=True</em>
<span class="ntdfn" id="Digit">Digit</span> := <code>0</code> .. <code>9</code>
</pre>
<p>
Note that the set of characters allowed in identifiers follows the requirements
of Unicode TR31 for immutable identifiers; the set of characters is immutable in
the sense that it does not change between Unicode versions.
</p>
<p>
The <code>QuotedIdentifier</code> syntax allows a reserved keyword
<code><var>K</var></code> can be used as an identifier by preceding it with a
single quote i.e. <code>'<var>K</var></code>. The <code>IdentifierEscape</code>
syntax allows an arbitrary non-empty string to be treated as an identifier. In a
<code>NumericEscape</code>, <code>CodePoint</code> must valid Unicode code
point; more precisely, it must be a hexadecimal numeral denoting an integer
<em>n</em> where 0 â¤ <em>n</em> &lt; 0xD800 or 0xDFFF &lt; n â¤
0x10FFFF.
</p>

<pre class="grammar"><span class="ntdfn" id="TokenWhiteSpace">TokenWhiteSpace</span> := (<a href="#Comment"><span class="ntref">Comment</span></a> | <a href="#WhiteSpaceChar"><span class="ntref">WhiteSpaceChar</span></a>)*
<span class="ntdfn" id="Comment">Comment</span> := <code>//</code> <a href="#AnyCharButNewline"><span class="ntref">AnyCharButNewline</span></a>*
<span class="ntdfn" id="AnyCharButNewline">AnyCharButNewline</span> := ^ 0xA
<span class="ntdfn" id="WhiteSpaceChar">WhiteSpaceChar</span> := 0x9 | 0xA | 0xD | 0x20
</pre>
<p>
<code>TokenWhiteSpace</code> is implicitly allowed on the right hand side of
productions for non-terminals whose names start with a lower-case letter.
</p>
</section>
<section>
<h2 id="values_types">5. Values, types and variables</h2>

<section>
<h3 id="section_5.1">5.1 Overview</h3>

<section>
<h4 id="section_5.1.1">5.1.1 Type system fundamentals</h4>
<p>
Ballerina programs operate on a rich universe of values. This universe of values
is partitioned into a number of <em>basic types</em>; every value belongs to
exactly one basic type.
</p>
<p>
Values are of four kinds, each corresponding to a kind of basic type:
</p>
<ul>
<li>simple values, like booleans and floating point numbers, which are not
constructed from other values;</li>
<li>structured values, like mappings and lists, which contain other values;</li>
<li>sequence values, which combine aspects of simple values and structured
values;</li>
<li>behavioral values, like functions and objects, which are not just data</li>
</ul>
<p>
There is a fundamental distinction between values that have a <em>storage
identity</em> and values that do not. A value that has storage identity has an
identity that comes from the location where the value is stored. All structural
and behavioural values have a storage identity, whereas all simple values do
not. Storage identity for sequence values is more complicated and will be
explained in the section on sequence values.
</p>
<p>
Values can be stored in variables or as members of structures or in constituents
of sequences. When a value has no storage identity, it can be stored directly in
the variable, structure or sequence. However, when a value has storage identity,
what is stored in the variable, structure or sequence is a reference to the
location where the value is stored rather than the value itself. Storage
identity allows values in Ballerina to represent not just trees but graphs.
</p>
<p>
Ballerina provides the ability to test whether two values have the same storage
identity, but does not expose the specific storage location of a value. For
values with storage identity, there is the concept of creating a <em>new</em>
value: this means creating a value that has a storage identity that is different
from any existing value. For values with storage identity, there is also the
concept of <em>copying</em>: it means to create a value that is the same, except
for having a new storage identity. The concept of having storage identity is
similar to the concept of a reference type in some other programming languages,
but also accomodates the concept of a sequence value.
</p>
<p>
Ballerina programs use types to categorize values both at compile-time and
runtime. Types deal with an abstraction of values that does not consider storage
identity. This abstraction is called a <em>shape</em>. A type denotes a set of
shapes. Subtyping in Ballerina is <em>semantic</em>: a type S is a subtype of
type T if the set of shapes denoted by S is a subset of the set of shapes
denoted by T. Every value has a corresponding shape. A shape is specific to a
basic type: if two values have different basic types, then they have different
shapes. The shape of the values contained in a structured value are part of the
shape of the structured value. Since shapes do not deal with storage identity,
they represent trees rather graphs. For simple values, there is no difference
between a shape and a value, with the exception of floating point values where
the shape does not consider representation details that do not affect the
mathematical value being represented.
</p>
<p>
A value is <em>plain data</em> if it is a simple value, a sequence value or a
structured value that does not contain a behavioral value at any depth.
More precisely, a value is defined to be <em>plain data</em> if it is
</p>
<ul>
<li>a simple value,</li>
<li>a sequence value, or</li>
<li>a structured value, all of whose members are also plain data.</li>
</ul>
<p>
Plain data values can in general contain cycles of references, but in some
contexts are restricted to be acyclic. Plain data values, including values with
cycles, can be compared for equality.
</p>
<p>
The two most important kinds of behavioural values are functions and objects. A
function value can be executed by calling it; when a function is called, it is
passed values and arguments and returns a value. An object encapsulates data
with functions that operate on the data: an object's members are divided into
fields, which hold the data, and methods, which are the functions that operate
on the data.
</p>
</section>

<section>
<h4 id="section_5.1.2">5.1.2 Mutation</h4>
<p>
There are two kinds of things that can be mutated in Ballerina: variables and
values. Mutation of values is tied to storage identity: mutation is only
possible for values with storage identity. When a value stored in some storage
location is mutated, the change will be visible through all variables referring
to the value in that location. But not all values with storage identity can be
mutated: a value may not support mutation even though it has a storage identity.
</p>
<p>
The possibility of mutation gives rise to two relations between a value and a
type:
</p>
<ul>
<li>a value <em>looks like</em> a type at a particular point in the execution of
a program if its shape at that point is a member of the type;</li>
<li>a value <em>belongs to</em> a type if it looks like the type, and it will
necessarily continue to look like the type no matter how the value is mutated.</li>
</ul>
<p>
If a value cannot be mutated, looking like a type and belonging to a type are
the same thing.
</p>
<p>
When a Ballerina program declares a variable to have a compile-time type, this
means that the Ballerina compiler together with the runtime system will ensure
that the variable will only ever hold a value that belongs to the type.
Ballerina also provides mechanisms that take a value that looks like a type and
use it to create a value that belongs to a type.
</p>
<p>
Every value has a read-only bit. If the read-only bit is on, it means that the
value is immutable. A value's read-only bit is fixed when the value is
constructed, and cannot be changed thereafter. Ballerina maintains the invariant
that immutability is deep: any value reachable from a value with its read-only
bit set is guaranteed to have its read-only bit set. Here <em>reachable</em>
means reachable through read operations: every member of a structure value is
reachable from the structure value; every constituent of a sequence value is
reachable from the sequence value; every member of an object value is reachable
from the object value. Reachability is transitive: if <var>t</var> is reachable
from <var>s</var>, and <var>s</var> is reachable from <var>r</var>, then
<var>t</var> is reachable from <var>r</var>. Reachability is also considered
reflexive: a value is reachable from itself.
</p>
<p>
Some basic types are inherently immutable: the read-only bit is always on for a
value that belongs to an inherently immutable basic type. All simple types are
inherently immutable as are functions. Some basic types are selectively
immutable: a type is selectively immutable if it is possible to construct both
values of the type that have the read-only bit on and values that do not have
the read-only bit on. All structured types are selectively immutable as are
objects. Finally, some basic types are inherently mutable: the read-only bit is
never on for a value belonging to an inherently mutable basic type.
</p>
<p>
Each selectively immutable basic type can be partitioned into two
<em>uniform</em> types, one containing values with the read-only bit on, and one
containing values where the read-only bit is off. For every other basic type,
there is a single uniform type. Every uniform type is thus either completely
readonly or completely mutable; every value thus belongs to exactly one unform
type, and mutation cannot change the uniform type to which a value belongs.
</p>
<p>
It is also possible to limit the mutability of variables, by making them final.
This means that the value that a variable holds cannot be changed after the
variable has been initialized. Unlike immutability of variables, this is not
deep. A final variable can hold a mutable value.
</p>
</section>

<section>
<h4 id="section_5.1.3">5.1.3 Isolation</h4>
<p>
There are three possible operations on storage: read, write and execute. The
concept of immutability relates to reading and writing storage, and provides
limited information about execution: execution cannot lead to mutation of an
immutable value. For functions and objects, it is useful to have more
information about how execution may lead to mutation. Ballerina has a concept of
<em>isolation</em> that provides this.
</p>
<p>
In addition to defining when a value is reachable from a value, we can define
when a value is reachable from a variable: a value is reachable from a variable
if the value is reachable from the value that the variable holds. We
can also define when mutable state is reachable from a value or variable: the
mutable state of a value v is reachable from a value or variable, if v is
reachable from the value or variable; the mutable state of a variable v is
reachable only from the variable v.
</p>
<p>
Objects have an isolated bit in addition to a read-only bit; an object value is
isolated if its isolated bit is set. Mutable state is defined to be <em>freely
reachable</em> from a value or variable if it is reachable without following a
reference to an isolated object. A variable or value is an <em>isolated
root</em> if its mutable state is isolated from the rest of the program's
mutable state: any mutable state that is freely reachable from the isolated root
is reachable from outside only through the isolated root. More precisely, if
some mutable state <var>s</var> is freely reachable from an isolated root value
<var>r</var>, then <var>s</var> is not freely reachable from a variable or value
that is not reachable from <var>r</var> except by following a reference through
<var>r</var>; similarly, if some mutable state <var>s</var> is freely reachable
from an isolated root variable <var>r</var>, then <var>s</var> is not freely
reachable from a value that is not reachable from <var>r</var> and is not freely
reachable from any variable other than <var>r</var>. A variable can also be
declared to be isolated. Ballerina maintains the invariant that isolated objects
and isolated variables are isolated roots. Ballerina also guarantees that any
mutable state freely reachable from an isolated object or isolated variable is
accessed only within the scope of a <a href="#lock_statement">lock
statement</a>, which ensures that there is no data race in accessing that
mutable state. This implies that there will be no data race accessing any
mutable state that is reachable (not just freely reachable) from an isolated
object or isolated variable.
</p>
<p>
Functions and methods have an isolated bit in addition to a read-only bit; a
function or method is isolated if its isolated bit is set. Ballerina guarantees
that a call an isolated method or function will only result in access to mutable
state if at least one of the following conditions applies:
</p>
<ul>
<li>the mutable state is freely reachable from an argument passed to the
function or method and the access happens on the strand on which the function is
called; the object on which a method is invoked is considered as an argument for
this purpose;</li>
<li>the mutable state is freely reachable from an isolated variable or an
isolated object;</li>
<li>the mutable state is part of a new value created by the call.</li>
</ul>
<p>
The caller of a function can thus ensure that a function call will not lead to a
data race by ensuring that no data race is possible for the mutable state freely
reachable from the arguments that it passes to the function, for example by
passing only immutable values or isolated objects.
</p>

</section>
<section>
<h4 id="section_5.1.4">5.1.4 Type descriptors</h4>
<p>
Ballerina provides a rich variety of type descriptors, which programs use to
describe types. For example, there is a type descriptor for each simple basic
type; there is a type descriptor that describes a type as a union of two types;
there is a type descriptor that uses a single value to describe a type that
contains a single shape. This means that values can look like and belong to
arbitrarily many types, even though they look like or belong to exactly one
<em>basic</em> type.
</p>
<p>
The following table summarizes the type descriptors provided by Ballerina.
</p>
<table>
  <tr>
   <td><strong>Kind</strong></td>
   <td><strong>Name</strong></td>
   <td><strong>Set of values denoted by type descriptor</strong></td>
  </tr>
  <tr>
   <td rowspan="5">basic, simple</td>
   <td>nil</td>
   <td>()</td>
  </tr>
  <tr>
   <td>boolean</td>
   <td>true, false</td>
  </tr>
  <tr>
   <td>int</td>
   <td>64-bit signed integers</td>
  </tr>
  <tr>
   <td>float</td>
   <td>64-bit IEEE 754-2008 binary floating point numbers</td>
  </tr>
  <tr>
   <td>decimal</td>
   <td>decimal floating point numbers</td>
  </tr>
  <tr>
   <td rowspan="2">basic, sequence</td>
   <td>string</td>
   <td>a sequence of Unicode scalar values</td>
  </tr>
  <tr>
   <td>XML</td>
   <td>a sequence of zero or more elements, processing instructions, comments or
text items</td>
  </tr>
  <tr>
   <td rowspan="5">basic, structured</td>
   <td>array</td>
   <td>an ordered list of values, optionally with a specific length, where a
single type is specified for all members of the list</td>
  </tr>
  <tr>
   <td>tuple</td>
   <td>an ordered list of values, where a type is specified separately for each
member of the list</td>
  </tr>
  <tr>
   <td>map</td>
   <td>a mapping from keys, which are strings, to values; specifies mappings in
terms of a single type to which all keys are mapped</td>
  </tr>
  <tr>
   <td>record</td>
   <td>a mapping from keys, which are strings, to values; specifies maps in
terms of names of fields (required keys) and value for each field</td>
  </tr>
  <tr>
   <td>table</td>
   <td>a ordered collection of mappings, where a mapping is uniquely identified
within the table by a key derived from the mapping</td>
  </tr>
  <tr>
   <td rowspan="7">basic, behavioral</td>
   <td>error</td>
   <td>an indication that there has been an error, with a string identifying the
reason for the error, and a mapping giving additional details about the error</td>
  </tr>
  <tr>
   <td>function</td>
   <td>a function with 0 or more specified parameter types and a single return
type</td>
  </tr>
  <tr>
   <td>future</td>
   <td>a value to be returned by a function execution</td>
  </tr>
  <tr>
   <td>object</td>
   <td>a combination of named fields and named methods</td>
  </tr>
  <tr>
   <td>typedesc</td>
   <td>a type descriptor</td>
  </tr>
  <tr>
   <td>handle</td>
   <td>reference to externally managed storage</td>
  </tr>
  <tr>
   <td>stream</td>
   <td>a sequence of values that can be generated lazily</td>
  </tr>
  <tr>
   <td rowspan="11">other</td>
   <td>singleton</td>
   <td>a single value described by a literal</td>
  </tr>
  <tr>
   <td>readonly</td>
   <td>any value whose read-only bit is on</td>
  </tr>
  <tr>
   <td>any</td>
   <td>any value other than an error</td>
  </tr>
  <tr>
   <td>never</td>
   <td>no value</td>
  </tr>
  <tr>
   <td>optional</td>
   <td>a value that is either () or belongs to a type</td>
  </tr>
  <tr>
   <td>union</td>
   <td>a value that belongs to at least one of a number of types</td>
  </tr>
  <tr>
   <td>intersection</td>
   <td>a value that belongs to all of a number of types</td>
  </tr>
  <tr>
   <td>distinct</td>
   <td></td>
  </tr>
  <tr>
   <td>anydata</td>
   <td>plain data (a simple value, sequence value or structured value that
   does not contain behavioral members at any depth)</td>
  </tr>
  <tr>
   <td>json</td>
   <td>the union of (), int, float, decimal, string, and maps and arrays whose
values are, recursively, json</td>
  </tr>
  <tr>
   <td>byte</td>
   <td>int in the range 0 to 255 inclusive</td>
  </tr>
</table>
<p>
A shape is divided into two <em>aspects</em>: the <em>primary aspect</em> and
the <em>read-only aspect</em>. A value's read-only bit is a part of the
<em>read-only aspect</em> of the value's shape. The read-only bit of values
contained in a structured value is part of the read-only aspect of those values
and of the read-only aspect of the structured value. Everything about a shape
except the read-only bits constitutes the primary aspect of the shape. If two
plain data values compare equal, then the primary aspect of their shapes is the
same, but there may be differences in the read-only aspect.
</p>
<p>
Type descriptors other than <code>readonly</code> describes types using only the
primary aspect of shape: whether a value belongs to the type is not affected by
the read-only aspect of the value's shape. The <code>readonly</code> type uses
only the read-only aspect: whether a value belongs to the <code>readonly</code>
type depends only on the read-only aspect of the value's shape.
</p>
<p>
In addition to describing a type, a type descriptor may also include information
used to construct a value of the type, as well as metadata. Whereas the type
described by a type descriptor is known at compile time, this additional
information may need to be resolved at runtime. The typedesc basic type
represents a type descriptor that has been resolved.
</p>

<pre class="grammar"><span class="ntdfn" id="type-descriptor">type-descriptor</span> :=
   <a href="#simple-type-descriptor"><span class="ntref">simple-type-descriptor</span></a>
   | <a href="#sequence-type-descriptor"><span class="ntref">sequence-type-descriptor</span></a>
   | <a href="#structured-type-descriptor"><span class="ntref">structured-type-descriptor</span></a>
   | <a href="#behavioral-type-descriptor"><span class="ntref">behavioral-type-descriptor</span></a>
   | <a href="#other-type-descriptor"><span class="ntref">other-type-descriptor</span></a>
</pre>
<p>
For simplicity, the type-descriptor grammar is ambiguous. The following table
shows the various types of type descriptor in decreasing order of precedence,
together with associativity.
</p>
<table>
  <tr>
   <td><strong>Operator</strong></td>
   <td><strong>Associativity</strong></td>
  </tr>
  <tr>
   <td><code>distinct T</code></td>
   <td></td>
  </tr>
  <tr>
   <td>
<code>T[]</code><br><code>T?</code>
</td>
   <td></td>
  </tr>
  <tr>
   <td><code>T1 &amp; T2</code></td>
   <td>left</td>
  </tr>
  <tr>
   <td><code>T1 | T2</code></td>
   <td>left</td>
  </tr>
  <tr>
   <td><code>function(args) returns T</code></td>
   <td>right</td>
  </tr>
</table>


</section>
<section>
<h4 id="section_5.1.5">5.1.5 Type-ids</h4>
<p>
Ballerina has a feature, called <em>distinct types</em>, which provides
functionality similar to that provided by nominal types, but which works within
Ballerina's structural type system. Distinct types are similar to the branded
types found in some other structurally typed languages, such as Modula-3.
</p>
<p>
The semantics of distinct types are based on type-ids. These are similar to the
brands used by branded types. A distinct type is created by the use of the
<code>distinct</code> keyword in either a <a href="#distinct-types">distinct-type-descriptor</a> or the
<code>class-type-quals</code> of a <code>module-class-defn</code>. Each such
occurrence of the <code>distinct</code> keyword has a distinct type-id, which
uniquely identifies it within a Ballerina program. A type-id has three parts:
</p>
<ol>
<li>a module id, which identifies the module within which the
distinct-type-descriptor occurs; this consists of an organization, a module
name, and an array of platform-specified strings, which could include
information about, for example, the repository or version of the package the
module comes from;</li>
<li>a local id, which identifies the occurrence of the
<code>distinct</code> within the module; this takes one of two forms:
<ul>
<li>named - 
<ul>
<li>if the <code>distinct</code> keyword is part of a distinct-type-descriptor
that is the only distinct-type-descriptor occurring within a module-type-defn,
then the local id is the name of the type defined by the module-type-defn;</li>
<li>if the <code>distinct</code> keyword is part of the class-type-quals
of a module-class-defn, then the local id is the name of the class defined
by the module-class-defn;</li>
</ul>
</li>
<li>anonymous - otherwise, the local id is a compiler-generated integer;</li>
</ul>
</li>
<li>a boolean flag saying whether the type-id is public; this flag is on if and
only if the local id part is named and is the name of a module-type-defn that is
public.</li>
</ol>
<p>
Distinct types can be used with only the object or error basic types. An object
value or error value has a set of type-ids. These type-ids are fixed at the
time of construction and are immutable thereafter. A value's set of type-ids may
be empty. The type-ids of a value are part of the value's shape and so can
affect when an object belongs to a type. The set of type-ids of an object or
error value are divided into primary type-ids and secondary type-ids: the
secondary type-ids could be inferred from the primary type-ids using the
program's source.
</p>
<p>
An object or error value is always constructed using a specific type descriptor.
A type descriptor for objects and errors thus performs a dual role: it denotes a
type and it defines a mechanism to construct a value of the type. A type
descriptor is <em>definite</em> if it induces a specific set of type-ids. The
set of type-ids of an object or error value are those induced by the
type-descriptor used to construct it; such a type descriptor must therefore be
definite. A type descriptor that denotes a type that does not allow object or
error values induces an empty set of type-ids and so is vacuously definite. For
other type descriptors, the section that specifies that type descriptor will say
when it is definite, the set of type-ids that it induces when it is, and which
of those are primary.
</p>

</section>
<section>
<h4 id="section_5.1.6">5.1.6 Iterability</h4>
<p>
Values of some basic types are <em>iterable</em>. An iterable value supports an
iteration operation, which treats the iterable value as consisting of a sequence
of zero or more simpler values, which are in some sense a part of the iterable
value; the iteration operation provides the values in the sequence, one after
another. The sequence of values that an iteration operation on a value provides
is the <em>iteration sequence</em> of the value. Each iterable basic type
defines the iteration sequence for a value of that basic type. There is also a
value associated with the completion of the iteration operation, which is nil if
the iteration completed successfully and an error otherwise. The iteration
operation thus determines two associated types for an iterable type: the value
type, which is the type of the values in the iteration sequence, and the
completion type, which is the type of the iteration completion value.
</p>
<p>
The following tables summarizes the iterable basic types.
</p>
<table>
<tr>
<th>Basic type</th>
<th>Iteration sequence</th>
<th>Type descriptor</th>
<th>Value type</th>
<th>Completion type</th>
</tr>
<tr>
<td>string</td>
<td>length 1 substrings</td>
<td><code>string</code></td>
<td><code>string:Char</code></td>
<td><code>()</code></td>
</tr>
<tr>
<td>xml</td>
<td>singleton xml values</td>
<td><code>xml&lt;T&gt;</code></td>
<td><code>T</code></td>
<td><code>()</code></td>
</tr>
<tr>
<td>list</td>
<td>members in order</td>
<td><code>T[]</code></td>
<td><code>T</code></td>
<td><code>()</code></td>
</tr>
<tr>
<td>mapping</td>
<td>members</td>
<td><code>map&lt;T&gt;</code></td>
<td><code>T</code></td>
<td><code>()</code></td>
</tr>
<tr>
<td>table</td>
<td>members in order</td>
<td><code>table&lt;T&gt;</code></td>
<td><code>T</code></td>
<td><code>()</code></td>
</tr>
<tr>
<td>stream</td>
<td>items</td>
<td><code>stream&lt;T,C&gt;</code></td>
<td><code>T</code></td>
<td><code>C</code></td>
</tr>
</table>
</section>
</section>

<section>
<h3 id="section_5.2">5.2 Simple values</h3>
<p>
A simple value belongs to exactly one of the following basic types:
</p>
<ul>
<li>nil</li>
<li>boolean</li>
<li>int</li>
<li>float</li>
<li>decimal</li>
</ul>
<p>
The type descriptor for each simple basic type contains all the values of the
basic type.
</p>
<p>
All simple basic types are inherently immutable.
</p>

<pre class="grammar"><span class="ntdfn" id="simple-type-descriptor">simple-type-descriptor</span> :=
   <a href="#nil-type-descriptor"><span class="ntref">nil-type-descriptor</span></a>
   | <a href="#boolean-type-descriptor"><span class="ntref">boolean-type-descriptor</span></a>
   | <a href="#int-type-descriptor"><span class="ntref">int-type-descriptor</span></a>
   | <a href="#floating-point-type-descriptor"><span class="ntref">floating-point-type-descriptor</span></a>
</pre>
<section>
<h4 id="section_5.2.1">5.2.1 Nil</h4>

<pre class="grammar"><span class="ntdfn" id="nil-type-descriptor">nil-type-descriptor</span> :=  <code>(</code> <code>)</code>
<span class="ntdfn" id="nil-literal">nil-literal</span> :=  <code>(</code> <code>)</code> | <code>null</code>
</pre>
<p>
The nil type contains a single value, called nil, which is used to represent the
absence of any other value. The nil value is written <code>()</code>. The nil
value can also be written <code>null</code>, for compatibility with JSON; the
use of null should be restricted to JSON-related contexts.
</p>
<p>
The nil type is special, in that it is the only basic type that consists of a
single value. The type descriptor for the nil type is not written using a
keyword, but is instead written <code>()</code> like the value.
</p>
</section>
<section>
<h4 id="section_5.2.2">5.2.2 Boolean</h4>

<pre class="grammar"><span class="ntdfn" id="boolean-type-descriptor">boolean-type-descriptor</span> := <code>boolean</code>
<span class="ntdfn" id="boolean-literal">boolean-literal</span> := <code>true</code> | <code>false</code>
</pre>
<p>
The boolean type consists of the values true and false.
</p>
</section>
<section>
<h4 id="section_5.2.3">5.2.3 Int</h4>

<pre class="grammar"><span class="ntdfn" id="int-type-descriptor">int-type-descriptor</span> := <code>int</code>
<span class="ntdfn" id="int-literal">int-literal</span> := <a href="#DecimalNumber"><span class="ntref">DecimalNumber</span></a> | <a href="#HexIntLiteral"><span class="ntref">HexIntLiteral</span></a>
<span class="ntdfn" id="DecimalNumber">DecimalNumber</span> := <code>0</code> | <a href="#NonZeroDigit"><span class="ntref">NonZeroDigit</span></a> <a href="#Digit"><span class="ntref">Digit</span></a>*
<span class="ntdfn" id="HexIntLiteral">HexIntLiteral</span> := <a href="#HexIndicator"><span class="ntref">HexIndicator</span></a> <a href="#HexNumber"><span class="ntref">HexNumber</span></a>
<span class="ntdfn" id="HexNumber">HexNumber</span> := <a href="#HexDigit"><span class="ntref">HexDigit</span></a>+
<span class="ntdfn" id="HexIndicator">HexIndicator</span> := <code>0x</code> | <code>0X</code>
<span class="ntdfn" id="HexDigit">HexDigit</span> := <a href="#Digit"><span class="ntref">Digit</span></a> | <code>a</code> .. <code>f</code> | <code>A</code> .. <code>F</code>
<span class="ntdfn" id="NonZeroDigit">NonZeroDigit</span> := <code>1</code> .. <code>9</code>
</pre>
<p>
The int type consists of integers between -9,223,372,036,854,775,808 and
9,223,372,036,854,775,807 (i.e. signed integers than can fit into 64 bits using
a two's complement representation).
</p>
<p>
The <a href="#byte_type"><code>byte</code> type</a> is a subtype of
<code>int</code>. The <code>lang.int</code> lang library module also
provides <a href="#built-in_subtypes">built-in subtypes</a> for signed and
unsigned integers representable in 8, 16 and 32 bits.
</p>

</section>
<section>
<h4 id="section_5.2.4">5.2.4 Floating point types</h4>

<pre class="grammar"><span class="ntdfn" id="floating-point-type-descriptor">floating-point-type-descriptor</span> := <code>float</code> | <code>decimal</code>
<span class="ntdfn" id="floating-point-literal">floating-point-literal</span> :=
   <a href="#DecimalFloatingPointNumber"><span class="ntref">DecimalFloatingPointNumber</span></a> | <a href="#HexFloatingPointLiteral"><span class="ntref">HexFloatingPointLiteral</span></a>
<span class="ntdfn" id="DecimalFloatingPointNumber">DecimalFloatingPointNumber</span> :=
   <a href="#DecimalNumber"><span class="ntref">DecimalNumber</span></a> <a href="#Exponent"><span class="ntref">Exponent</span></a> [<a href="#FloatingPointTypeSuffix"><span class="ntref">FloatingPointTypeSuffix</span></a>]
   | <a href="#DottedDecimalNumber"><span class="ntref">DottedDecimalNumber</span></a> [<a href="#Exponent"><span class="ntref">Exponent</span></a>] [<a href="#FloatingPointTypeSuffix"><span class="ntref">FloatingPointTypeSuffix</span></a>]
   | <a href="#DecimalNumber"><span class="ntref">DecimalNumber</span></a> <a href="#FloatingPointTypeSuffix"><span class="ntref">FloatingPointTypeSuffix</span></a>
<span class="ntdfn" id="DottedDecimalNumber">DottedDecimalNumber</span> :=
   <a href="#DecimalNumber"><span class="ntref">DecimalNumber</span></a> <code>.</code> <a href="#Digit"><span class="ntref">Digit</span></a>*
   | <code>.</code> <a href="#Digit"><span class="ntref">Digit</span></a>+
<span class="ntdfn" id="Exponent">Exponent</span> := <a href="#ExponentIndicator"><span class="ntref">ExponentIndicator</span></a> [<a href="#Sign"><span class="ntref">Sign</span></a>] <a href="#Digit"><span class="ntref">Digit</span></a>+
<span class="ntdfn" id="ExponentIndicator">ExponentIndicator</span> := <code>e</code> | <code>E</code>
<span class="ntdfn" id="HexFloatingPointLiteral">HexFloatingPointLiteral</span> := <a href="#HexIndicator"><span class="ntref">HexIndicator</span></a> <a href="#HexFloatingPointNumber"><span class="ntref">HexFloatingPointNumber</span></a>
<span class="ntdfn" id="HexFloatingPointNumber">HexFloatingPointNumber</span> :=
   <a href="#HexNumber"><span class="ntref">HexNumber</span></a> <a href="#HexExponent"><span class="ntref">HexExponent</span></a>
   | <a href="#DottedHexNumber"><span class="ntref">DottedHexNumber</span></a> [<a href="#HexExponent"><span class="ntref">HexExponent</span></a>]
<span class="ntdfn" id="DottedHexNumber">DottedHexNumber</span> :=
   <a href="#HexDigit"><span class="ntref">HexDigit</span></a>+ <code>.</code> <a href="#HexDigit"><span class="ntref">HexDigit</span></a>*
   | <code>.</code> <a href="#HexDigit"><span class="ntref">HexDigit</span></a>+
<span class="ntdfn" id="HexExponent">HexExponent</span> := <a href="#HexExponentIndicator"><span class="ntref">HexExponentIndicator</span></a> [<a href="#Sign"><span class="ntref">Sign</span></a>] <a href="#Digit"><span class="ntref">Digit</span></a>+
<span class="ntdfn" id="HexExponentIndicator">HexExponentIndicator</span> := <code>p</code> | <code>P</code>
<span class="ntdfn" id="Sign">Sign</span> := <code>+</code> | <code>-</code>
<span class="ntdfn" id="FloatingPointTypeSuffix">FloatingPointTypeSuffix</span> := <a href="#DecimalTypeSuffix"><span class="ntref">DecimalTypeSuffix</span></a> | <a href="#FloatTypeSuffix"><span class="ntref">FloatTypeSuffix</span></a>
<span class="ntdfn" id="DecimalTypeSuffix">DecimalTypeSuffix</span> := <code>d</code> | <code>D</code>
<span class="ntdfn" id="FloatTypeSuffix">FloatTypeSuffix</span> :=  <code>f</code> | <code>F</code>
</pre>

<section>
<h5 id="section_5.2.4.1">5.2.4.1 Float</h5>

<p>
The float type corresponds to IEEE 754-2008 64-bit binary (radix 2) floating
point numbers. A float value can be represented by either a
DecimalFloatingPointNumber with an optional FloatTypeSuffix, or by a
HexFloatingPointLiteral.
</p>
<p>
The multiple bit patterns that IEEE 754 treats as NaN are considered to be the
same value in Ballerina. Positive and negative zero of a floating point basic
type are distinct values, following IEEE 754, but are defined to have the same
shape, so that they will usually be treated as being equal.
</p>
<p>
IEEE-defined operations on float values must be performed using a
rounding-direction attribute of roundTiesToEven (which is the default IEEE
rounding direction, sometimes called <em>round to nearest</em>). All float
values, including the intermediate results of expressions, must use the value
space defined for the float type; implementations must not use extended
precision for intermediate results. This ensures that all implementations will
produce identical results. (This is the same as what is required by strictfp in
Java.)
</p>
</section>
<section>
<h5 id="section_5.2.4.2">5.2.4.2 Decimal</h5>

<p>
The decimal type corresponds to a subset of IEEE 754-2008 128-bit decimal (radix
10) floating point numbers. Any decimal value can be represented by a
DecimalFloatingPointNumber with an optional DecimalTypeSuffix.
</p>
<p>
A decimal value is a triple (<var>s</var>, <var>c</var>, <var>e</var>) where
</p>
<ul>
<li>
<var>s</var> is sign, either 0 or -1</li>
<li>
<var>c</var> is the coefficient, an unsigned integer that can be exactly
represented in 34 decimal digits</li>
<li>
<var>e</var> is the exponent, a signed integer</li>
</ul>
<p>
representing the mathematical value -1<sup><var>s</var></sup> Ã
<var>c</var> Ã 10<sup><var>e</var></sup>. The range for the exponent
<var>e</var> is implementation dependent, but must be at least the range
supported by the IEEE 754-2008 decimal128 format (which is -6176 to 6111
inclusive).
</p>
<p>
The decimal type corresponds to the ANSI X3.274 subset of IEEE 754-2008, which
has the following simplifications:
</p>
<ul>
<li>+0 and -0 are not distinguished; if the coefficent is zero, then the sign is
also constrained to be zero;</li>
<li>NaN, infinities and subnormals are not supported; operations that would
result in one of these values according to the normal rules of IEEE 754-2008
instead result in a panic.</li>
</ul>
<p>
Operations on the decimal type use the roundTiesToEven rounding mode, like the
float type.
</p>
<p>
The shape of a decimal value is its mathematical value. Thus two decimal values
have the same shape if they represent the same mathematical value, even if they
do so using different exponents.
</p>
</section>
</section>
</section>
<section>
<h3 id="section_5.3">5.3 Sequence values</h3>

<pre class="grammar"><span class="ntdfn" id="sequence-type-descriptor">sequence-type-descriptor</span> :=
   <a href="#string-type-descriptor"><span class="ntref">string-type-descriptor</span></a>
   | <a href="#xml-type-descriptor"><span class="ntref">xml-type-descriptor</span></a>
</pre>
<p>
A sequence value belongs to one of the following two basic types:
</p>
<ul>
<li>string</li>
<li>xml</li>
</ul>
<p>
A sequence value consists of an ordered sequence of zero or more constituent
items, where the constituent items belong to the same basic type as the sequence
value itself. The <em>length</em> of a sequence value is the number of its
constituent items. Each constituent of a sequence value has an integer index
â¥ 0 and &lt; length. A sequence value is a <em>singleton</em> if its
length is 1. For each sequence basic type, there is an <em>empty</em> value,
which has length 0. As with other basic types, the sequence basic types are
disjoint with themselves and with other basic types. Thus the empty value for
string is distinct from the empty value for xml, and these are both distinct
from nil.
</p>
<p>
The values belonging to a sequence basic type B can be defined in terms of its
singleton values and a concatenation operation, by the following rules:
</p>
<ul>
<li>
the singleton values of B belong to B;
</li>
<li>
the empty value of B belongs to B;
</li>
<li>
if v<sub>1</sub> and v<sub>2</sub> belong to B, then the concatenation of
v<sub>1</sub> and v<sub>2</sub> belongs to B.
</li>
</ul>
<p>
The concatenation of any value v belonging to B with the empty sequence of B in
either order is v.
</p>
<p>
Note that for a sequence consisting of a single item v is the same thing as v. A
single item <em>is a</em> sequence. The type of the constituent items of a
sequence of basic type B is thus a subtype of B. This is a fundamental
difference between sequences and lists.
</p>
<p>
Only singleton values of a sequence type can have storage identity. When a
constituent of a sequence value has storage identity, what is stored in the
sequence value is a reference to the location where the constituent value is
stored rather than the constituent value itself.
</p>
<p>
A sequence value is iterable: the iteration sequence consists of the singleton
items of the sequence value in order and the iteration completion value is
always nil.
</p>

<section>
<h4 id="section_5.3.1">5.3.1 Strings</h4>

<pre class="grammar"><span class="ntdfn" id="string-type-descriptor">string-type-descriptor</span> := <code>string</code>
<span class="ntdfn" id="string-literal">string-literal</span> := <a href="#DoubleQuotedStringLiteral"><span class="ntref">DoubleQuotedStringLiteral</span></a>
<span class="ntdfn" id="DoubleQuotedStringLiteral">DoubleQuotedStringLiteral</span> := <code>"</code> (<a href="#StringChar"><span class="ntref">StringChar</span></a> | <a href="#StringEscape"><span class="ntref">StringEscape</span></a>)* <code>"</code>
<span class="ntdfn" id="StringChar">StringChar</span> := ^ ( 0xA | 0xD | <code>\</code> | <code>"</code> )
<span class="ntdfn" id="StringEscape">StringEscape</span> := <a href="#StringSingleEscape"><span class="ntref">StringSingleEscape</span></a> | <a href="#NumericEscape"><span class="ntref">NumericEscape</span></a>
<span class="ntdfn" id="StringSingleEscape">StringSingleEscape</span> := <code>\t</code> | <code>\n</code> | <code>\r</code> | <code>\\</code> | <code>\"</code>
</pre>
<p>
A string is an sequence of zero or more Unicode characters. More precisely, it
is a sequence whose singleton values represent Unicode scalar values, where a
Unicode scalar value is any code point in the Unicode range of 0x0 to 0x10FFFF
inclusive, other than surrogate code points, which are 0xD800 to 0xDFFF
inclusive. Note that a string may include Unicode noncharacters, such as 0xFFFE
and 0xFFFF.
</p>
<p>
String values do not have storage identity and so the string basic type is
inherently immutable.
</p>
<p>
There is a <a href="#built-in_subtypes">built-in subtype</a>
<code>string:Char</code> for single character strings.
</p>
</section>
<section>
<h4 id="XML">5.3.2 XML</h4>

<p>
An xml value is a sequence representing parsed XML, such as occurs in the
content of an XML element. The singleton values are of the following types:
</p>
<ul>
<li>element</li>
<li>processing instruction</li>
<li>comment</li>
<li>text</li>
</ul>
<p>
The element, processing instruction and comment singletons correspond directly
to information items in the XML Information Set. A text singleton corresponds to
one or more character information items. When an xml value is constructed,
consecutive text singletons are merged, so that an xml value never contains
consecutive text singletons. There are <a href="#built-in_subtypes">built-in
subtypes</a> <code>xml:Element</code>, <code>xml:ProcessingInstruction</code>,
<code>xml:Comment</code> and <code>xml:Text</code> corresponding to the above
singletons; <code>xml:Text</code> also allows the empty xml value.
</p>
<pre class="grammar"><span class="ntdfn" id="xml-type-descriptor">xml-type-descriptor</span> := <code>xml</code> [<a href="#type-parameter"><span class="ntref">type-parameter</span></a>]
<span class="ntdfn" id="type-parameter">type-parameter</span> := <code>&lt;</code> <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> <code>&gt;</code>
</pre>
<p>
A shape belongs to type <code>xml</code> if its basic type is <code>xml</code>.
A type parameter of an xml-type-descriptor must be a subtype of
<code>xml</code>. A shape belongs to type <code>xml&lt;T&gt;</code> if all of
its constituent items belong to <code>T</code>. So, for example,
<code>xml&lt;xml:Element&gt;</code> is the type for xml values containing
only elements. Note that <code>xml&lt;xml&lt;<var>T</var>&gt;&gt;</code> is the
same as <code>xml&lt;<var>T</var>&gt;</code> and that
<code>xml&lt;xml:Text&gt;</code> is the same as <code>xml:Text</code>.
</p>
<p>
The name of an element is represented by a string. The attributes of an element
are represented by a value of type <code>map&lt;string&gt;</code>. The children
of an element is represented by a value of type <code>xml</code>.
</p>
<p>
Singleton element, processing instruction and comment values have storage
identity. Other xml values do not.
</p>
<p>
The <code>xml:Text</code> type is inherently immutable. This implies that both
text singletons and empty xml values always have their read-only bits on. The
<code>xml:Element</code>, <code>xml:ProcessingInstruction</code> and
<code>xml:Comment</code> types are selectively immutable. The read-only bit of a
xml value with length greater than one is on if and only if the read-only bit of
all its constituent items is on. The attributes and children of an element are
reachable from the element. Thus, if the read-only bit of an
<code>xml:Element</code> is on, then the read-only bits of the mapping
representing its attributes and of the xml value representing its children are
also on.
</p>
<p>
Note that although the mutable constituents of mutable xml value can be mutated,
the number and the storage identity of the constituents of a xml value are fixed
when the value is constructed. The storage identity of the attributes map of an
element are also fixed when the element is constructed.
</p>
<section>
<h5 id="section_5.3.2.1">5.3.2.1 XML namespaces</h5>
<p>
The name of an element or attribute, which in the XML Information Set is
represented by a combination of the [namespace name] and [local name] properties
of an element information item (EII) or attribute information item (AII), is
represented by a single <em>expanded name</em> string. If the [namespace name]
property has no value, then the expanded name consists of just the value of the
[local name] property; otherwise, the expanded name is of the form:
</p>
<pre>
   {<var>namespace-uri</var>}<var>local-name</var>
</pre>
<p>
where <code><var>namespace-uri</var></code> and
<code><var>local-name</var></code> are the values of the [namespace name] and
[local name] properties respectively.
</p>
<p>
The attributes map for an element includes not only an entry for each AII in the
[attributes] property of the EII, but also an entry for each attribute in the
[namespace attributes] property. The key of the entry is the string representing
the name of the attribute, constructed from the AII item as described in the
previous paragraph. The name of every namespace attribute will thus start with
the string <code>{http://www.w3.org/2000/xmlns/}</code>.
</p>
<p>
The attributes map can also contain entries representing namespace attributes
synthesized from the [in-scope namespaces] property. There will be a synthesized
namespace attribute for every prefix other than <code>xml</code> that occurs as
a prefix of the EII or of an AII in the element's [attributes] property and for
which there is no declaration in the [namespace attributes] property. No
namespace attribute will be synthesized for the default namespace. (The
synthesized namespace attributes ensure that namespace prefixes will not be lost
if the element is extracted into a new context.)
</p>
<p>
An xml value can be converted to an XML information set for serialization. This
is done in the context of a set of namespace declarations that are in-scope from
the xml value's parent element, if any. The process of converting an xml element
singleton into an EII has the following stages.
</p>
<ol>
<li>The [namespace name] and [local name] properties of the EII are determined
from the element's expanded name.</li>
<li>An AII is constructed for each entry in the element's attribute map, with
the [namespace name] and [local name] properties of the AII determined from the
entry's key, which is the attribute's expanded name. Each AII is added to either
the [attributes] or [namespace attributes] property of the EII depending on the
AII's [namespace name] property. The [prefix] property of each AII in the
[namespace attributes] property can also be set at this point.</li>
<li>The [namespace attributes] property of the EII is pruned by removing an
AII with [normalized value] N if the AII is not a default namespace declaration,
and the in-scope namespace declarations include a declaration with namespace
name N, and either the EII or one of the AIIs has a [namespace name] property
equal to N. (In this case, the entry for the namespace attribute would get
synthesized when the information set is converted to an xml value.)</li>
<li>For each AII in the EII's [attributes] property that has a [namespace name]
property, a [prefix] property is assigned. If the namespace name is
<code>http://www.w3.org/XML/1998/namespace</code>, then use a prefix of
<code>xml</code>. If there is already a namespace declaration in the [namespace
attributes] that declares a prefix with that namespace name, then that prefix is
used. Otherwise if there is a namespace declaration in the in-scope namespaces
that declares a prefix with that namespace and it is not redeclared or
undeclared by the [namespace attributes], then that prefix is used. Otherwise
generate a prefix and add an AII to the [namespace attributes] to declare
it.</li>
<li>If the EII has no [namespace name] property, but a default namespace
declaration is in scope, then an <code>xmlns=""</code> AII is added to the
[namespace attributes] property to undeclare the default namespace.</li>
<li>If the EII has a [namespace name] property N, then we need
to ensure that there is an applicable namespace declaration:
<ol>
<li>if one of the [namespace attributes] declares N as the default namespace,
then nothing needs to be done;</li>
<li>similarly, if an in-scope namespace declaration declares N as the default
namespace, and the [namespace attributes] do not undeclare it, then nothing
needs to be done;</li>
<li>otherwise, try to find, in the same way as for an AII, a prefix P which is
already declared as N; if there is one, set the [prefix] property of the EII to
P;</li>
<li>otherwise, if the [namespace attributes] property does not contain a default
namespace declaration or undeclaration, generate a default namespace declaration
for N and add it to the [namespace attributes] property;</li>
<li>otherwise, generate a new prefix P, set the [prefix] property of the EII to
P, and add an AII to the [namespace attributes] to declare it.</li>
</ol>
</li>
<li>Generate the [in-scope namespaces] property for this EII, using the parent's
in-scope namespaces and the [namespace attributes].</li>
<li>Convert the children of the xml element, including the element children, to
a list of information items, in the context of this EII's in-scope
namespaces.</li>
</ol>

</section>

</section>

</section>
<section>
<h3 id="section_5.4">5.4 Structured values</h3>
<p>
Structured values are containers for other values, which are called their
members. There are three basic types of structured value: list, mapping and
table.
</p>
<p>
Structured values are usually mutable. Mutating a structured value changes which
values it contains. Structured values can also be constructed as immutable.
Immutability is deep: immutable structured values cannot contain mutable
structured values; if the read-only bit of a structured value is on, then the
read-only bit of each of its members is on.
</p>
<p>
The shape of the members of a structured value contributes to the shape of the
structured value. A structured type descriptor describe the shape of the
structured value in terms of the shapes of its members. Mutating a member of a
structured value can cause the shape of the structured value to change. A
structured value has an inherent type, which is a type descriptor which is part
of the structured value's runtime value. At runtime, the structured value
prevents any mutation that might lead to the structured value having a shape
that is not a member of its inherent type. Thus a structured value belongs to a
type if and only if its inherent type is a subtype of that type.
</p>
<p>
The inherent type of an immutable structured value is a singleton type with the
structured value's shape as its single member. Thus, an immutable structured
value belongs to a type if and only if the type contains the shape of the value.
</p>
<p>
Every structured value has a length, which is the number of its members.
All structured values are iterable: the iteration sequence consists of the
members of the structure and the completion type is always nil.
</p>
<p>
A structured value provides random access to its members using a key that
uniquely identifies each member within the structure. A key can be out-of-line,
meaning it is independent of the member, or in-line, meaning it is part of the
member. The <em>member type</em> for a key type K in a structured type T
consists of all shapes v such that there is a shape in T with key in K and shape
v. A type K is an <em>optional key type</em> for T if there is a shape v in T
and a key k in K such that v does not have a member k; a type that is not an
optional key type is a required key type.
</p>

<pre class="grammar"><span class="ntdfn" id="structured-type-descriptor">structured-type-descriptor</span> :=
   <a href="#list-type-descriptor"><span class="ntref">list-type-descriptor</span></a>
   | <a href="#mapping-type-descriptor"><span class="ntref">mapping-type-descriptor</span></a>
   | <a href="#table-type-descriptor"><span class="ntref">table-type-descriptor</span></a>
</pre>
<p>
The following table summarizes the type descriptors for structured types.
</p>
<table>
  <tr>
   <td>Structured type</td>
   <td>list</td>
   <td>mapping</td>
   <td>table</td>
  </tr>
  <tr>
   <td>Key source</td>
   <td>out-of-line</td>
   <td>out-of-line</td>
   <td>in-line</td>
  </tr>
  <tr>
   <td>Key type</td>
   <td>integer</td>
   <td>string</td>
   <td>anydata</td>
  </tr>
  <tr>
   <td>Type descriptor with uniform member type</td>
   <td>array</td>
   <td>map</td>
   <td>table</td>
  </tr>
  <tr>
   <td>Type descriptor with separate member types</td>
   <td>tuple</td>
   <td>record</td>
   <td>-</td>
  </tr>
</table>

<section>
<h4 id="section_5.4.1">5.4.1 Lists</h4>
<p>
A list value is a container that keeps its members in an ordered list. The
number of members of the list is called the <em>length</em> of the list. The key
for a member of a list is the integer index representing its position in the
list, with the index of the first member being 0. For a list of length
<em>n</em>, the indices of the members of the list, from first to last, are
0,1,...,<em>n</em> - 1. The shape of a list value is an ordered list of the
shapes of its members.
</p>
<p>
A list is iterable: the iteration sequence consists of the members of the
list in order and the iteration completion value is always nil.
</p>
<p>
The type of list values can be described by two kinds of type descriptors.
</p>

<pre class="grammar"><span class="ntdfn" id="list-type-descriptor">list-type-descriptor</span> :=
   <a href="#array-type-descriptor"><span class="ntref">array-type-descriptor</span></a> | <a href="#tuple-type-descriptor"><span class="ntref">tuple-type-descriptor</span></a>
</pre>
<p>
The inherent type of a list value must be a <code>list-type-descriptor</code>.
The inherent type of a list value determines a type T<sub><em>i</em></sub> for a
member with index <em>i</em>. The runtime system will enforce a constraint that
a value written to index <em>i</em> will belong to type T<sub><em>i</em></sub>.
Note that the constraint is not merely that the value looks like
T<sub><em>i</em></sub>.
</p>
<p>
Both kinds of type descriptor are covariant in the types of their members.
</p>
<section>
<h5 id="section_5.4.1.1">5.4.1.1 Array types</h5>
<p>
An array type-descriptor describes a type of list value by specifying the type
that the value for all members must belong to, and optionally, a length.
</p>

<pre class="grammar"><span class="ntdfn" id="array-type-descriptor">array-type-descriptor</span> := <a href="#member-type-descriptor"><span class="ntref">member-type-descriptor</span></a> <code>[</code> [ <a href="#array-length"><span class="ntref">array-length</span></a> ] <code>]</code>
<span class="ntdfn" id="member-type-descriptor">member-type-descriptor</span> := <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a>
<span class="ntdfn" id="array-length">array-length</span> :=
   <a href="#int-literal"><span class="ntref">int-literal</span></a>
   | <a href="#constant-reference-expr"><span class="ntref">constant-reference-expr</span></a>
   | <a href="#inferred-array-length"><span class="ntref">inferred-array-length</span></a>
<span class="ntdfn" id="inferred-array-length">inferred-array-length</span> := <code>*</code>
</pre>
<p>
A type <code>T[]</code> contains a list shape if all members of the list shape
are in <code>T</code>. A type <code>T[n]</code> contains a list shape if in
addition the length of the list shape is n.
</p>
<p>
A <code>constant-reference-expr</code> in an <code>array-length</code> must
evaluate to a non-negative integer. An array length of <code>*</code> means that
the length of the array is to be inferred from the context; this is allowed only
within a type descriptor occurring in a context that is specified to be
inferable; its meaning is the same as if the length was specified explicitly.
</p>
<p>
Note also that <code>T[n]</code> is a subtype of <code>T[]</code>, and that if
<code>S</code> is a subtype of <code>T</code>, then <code>S[]</code> is a
subtype of <code>T[]</code>; this is a consequence of the definition of
subtyping in terms of subset inclusion of the corresponding sets of shapes.
</p>
<p>
The type of the values in the iteration sequence of a value belonging
<code>T[]</code> is <code>T</code>.
</p>
</section>
<section>
<h5 id="section_5.4.1.2">5.4.1.2 Tuple types</h5>
<p>
A tuple type descriptor describes a type of list value by specifying a separate
type for each member of the list.
</p>

<pre class="grammar"><span class="ntdfn" id="tuple-type-descriptor">tuple-type-descriptor</span> :=
   <code>[</code> <a href="#tuple-member-type-descriptors"><span class="ntref">tuple-member-type-descriptors</span></a> <code>]</code>
<span class="ntdfn" id="tuple-member-type-descriptors">tuple-member-type-descriptors</span> :=
   <a href="#member-type-descriptor"><span class="ntref">member-type-descriptor</span></a> (<code>,</code> <a href="#member-type-descriptor"><span class="ntref">member-type-descriptor</span></a>)* [<code>,</code> <a href="#tuple-rest-descriptor"><span class="ntref">tuple-rest-descriptor</span></a>]
   | [ <a href="#tuple-rest-descriptor"><span class="ntref">tuple-rest-descriptor</span></a> ]
<span class="ntdfn" id="tuple-rest-descriptor">tuple-rest-descriptor</span> := <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> <code>...</code>

</pre>
<p>
A tuple type descriptor T with m member type descriptors contains a list shape L
of length n if and only if:
</p>
<ul>
<li>m is less than or equal to n</li>
<li>the i-th member type descriptor of T contains the i-th member of L for each
i from 1 to m;</li>
<li>if n is greater than m, then T has a tuple-rest-descriptor
R<code>...</code>, and R contains the j-th member of L for each j from m + 1 to
n.</li>
</ul>
<p>
Note that a tuple type where all the <code>member-type-descriptor</code>s are
the same and there is no tuple-rest-descriptor is equivalent to an
array-type-descriptor with a length.
</p>
</section>
</section>
<section>
<h4 id="section_5.4.2">5.4.2 Mappings</h4>
<p>
A mapping value is a container where each member has a key, which is a string,
that uniquely identifies within the mapping. We use the term <em>field</em> to
mean the member together its key; the name of the field is the key, and the
value of the field is that value of the member; no two fields in a mapping value
can have the same name.
</p>
<p>
The shape of a mapping value is an unordered collection of field shapes one for
each field. The field shape for a field f has a name, which is the same as the
name of f, and a shape, which is the shape of the value of f.
</p>
<p>
Each field also has a read-only bit. This is in addition to the read-only bit of
the mapping value. If a mapping value's field has its read-only bit on, then
that field cannot be assigned to nor removed. If the mapping value's read-only
bit is on, then the read-only bit of every field is also on. A field's read-only
bit is fixed when the mapping value is constructed, and cannot be changed
thereafter. If a field's read-only bit is on, the read-only bit of the value of
the field is also on. The read-only bit of a field is part of the read-only
aspect of the mapping value's shape.
</p>
<p>
A mapping is iterable: the iteration sequence consists of the members of the
mapping and the iteration completion value is always nil. The order of the iteration
sequence is implementation-dependent, but implementations are encouraged to
preserve and use the order in which the fields were added.
</p>
<p>
The type of mapping values can be described by two kinds of type descriptors.
</p>

<pre class="grammar"><span class="ntdfn" id="mapping-type-descriptor">mapping-type-descriptor</span> :=
   <a href="#map-type-descriptor"><span class="ntref">map-type-descriptor</span></a> | <a href="#record-type-descriptor"><span class="ntref">record-type-descriptor</span></a>
</pre>
<p>
The inherent type of a mapping value must be a
<code>mapping-type-descriptor</code>. The inherent type of a mapping value
determines a type T<sub><em>f</em></sub> for the value of the field with name
<em>f</em>. The runtime system will enforce a constraint that a value written to
field <em>f</em> will belong to type T<sub><em>f</em></sub>. Note that the
constraint is not merely that the value looks like T<sub><em>f</em></sub>.
</p>
<p>
Both kinds of type descriptor are covariant in the types of their members.
</p>
<section>
<h5 id="section_5.4.2.1">5.4.2.1 Map types</h5>
<p>
A map type-descriptor describes a type of mapping value by specifying the type
that the value for all fields must belong to.
</p>

<pre class="grammar"><span class="ntdfn" id="map-type-descriptor">map-type-descriptor</span> := <code>map</code> <a href="#type-parameter"><span class="ntref">type-parameter</span></a>
</pre>
<p>
A type <code>map&lt;T&gt;</code> contains a mapping shape <em>m</em> if every field
shape in <em>m</em> has a value shape that is in <code>T</code>.
</p>
<p>
The type of the values in the iteration sequence of a value belonging
<code>map&lt;T&gt;</code> is <code>T</code>.
</p>
<p>
If a type descriptor T has <a href="#lax_static_typing">lax static typing</a>,
then the type <code>map&lt;T&gt;</code> also has lax static typing.
</p>
</section>
<section>
<h5 id="section_5.4.2.2">5.4.2.2 Record types</h5>
<p>
A record type descriptor describes a type of mapping value by specifying a type
separately for the value of each field.
</p>

<pre class="grammar"><span class="ntdfn" id="record-type-descriptor">record-type-descriptor</span> :=
   <a href="#inclusive-record-type-descriptor"><span class="ntref">inclusive-record-type-descriptor</span></a> | <a href="#exclusive-record-type-descriptor"><span class="ntref">exclusive-record-type-descriptor</span></a>
<span class="ntdfn" id="inclusive-record-type-descriptor">inclusive-record-type-descriptor</span> :=
   <code>record</code> <code>{</code> <a href="#field-descriptor"><span class="ntref">field-descriptor</span></a>* <code>}</code>
<span class="ntdfn" id="exclusive-record-type-descriptor">exclusive-record-type-descriptor</span> :=
   <code>record</code> <code>{|</code> <a href="#field-descriptor"><span class="ntref">field-descriptor</span></a>* [<a href="#record-rest-descriptor"><span class="ntref">record-rest-descriptor</span></a>] <code>|}</code>
<span class="ntdfn" id="field-descriptor">field-descriptor</span> :=
   <a href="#individual-field-descriptor"><span class="ntref">individual-field-descriptor</span></a> | <a href="#record-type-inclusion"><span class="ntref">record-type-inclusion</span></a>
<span class="ntdfn" id="individual-field-descriptor">individual-field-descriptor</span> :=
   <a href="#metadata"><span class="ntref">metadata</span></a> [<code>readonly</code>] <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> <a href="#field-name"><span class="ntref">field-name</span></a> [<code>?</code> | (<code>=</code> <a href="#default-expression"><span class="ntref">default-expression</span></a>)] <code>;</code>
<span class="ntdfn" id="field-name">field-name</span> := <a href="#identifier"><span class="ntref">identifier</span></a>
<span class="ntdfn" id="default-expression">default-expression</span> := <a href="#expression"><span class="ntref">expression</span></a>
<span class="ntdfn" id="record-type-inclusion">record-type-inclusion</span> := <code>*</code> <a href="#type-reference"><span class="ntref">type-reference</span></a> <code>;</code>
<span class="ntdfn" id="record-rest-descriptor">record-rest-descriptor</span> := <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> <code>...</code> <code>;</code>
</pre>
<p>
Each <code>individual-field-descriptor</code> specifies an additional constraint
that a mapping value shape must satisfy for it to be a member of the described
type. The constraint depends on whether <code>?</code> is present:
</p>
<ul>
<li>if <code>?</code> is not present, then the constraint is that the mapping
value shape must have a field shape with the specified field-name and with a
value shape that is a member of the specified type-descriptor; this is called a
required field;</li>
<li>if <code>?</code> is present, then the constraint is that if the mapping
value shape has a field shape with the specified field-name, then its value
shape must be a member of the specified type-descriptor; this is called an
optional field.</li>
</ul>
<p>
If an <code>individual-field-descriptor</code> specifies <code>readonly</code>,
then there is also a constraint that the field has its read-only bit set.
Furthermore, the type of the field is the intersection of <code>readonly</code>
and the type specified by the type-descriptor.
</p>
<p>
The order of the <code>individual-field-descriptor</code>s within a
<code>record-type-descriptor</code> is not significant. Note that the delimited
identifier syntax allows the field name to be any non-empty string.
</p>
<p>
An exclusive-record-type-descriptor, which uses the <code>{|</code> and
<code>|}</code> delimiters, allows exclusively the fields described. More
precisely, for a mapping value shape and a record-type-descriptor, let the extra
field shapes be the field shapes of the mapping value shapes whose names are not
the same as field-name of any individual-field-descriptor; a mapping value shape
is a member of the type described by an exclusive-record-type-descriptor only if
either:
</p>
<ul>
<li>there are no extra fields shapes, or</li>
<li>there is a record-rest-descriptor <code>T...</code>, and the value shape of
every extra field shape is a member of <code>T</code>.</li>
</ul>
<p>
An inclusive-record-type-descriptor, which uses the <code>{</code> and
<code>}</code> delimiters, allows any mapping value that includes the fields
described, provided that the values of all other fields are plain data. A type
descriptor <code>record { F };</code> is thus equivalent to <code>record {| F;
anydata...; |}</code>, where <code>anydata</code> is defined <a href="#anydata">below</a> as the type descriptor for plain data.
</p>
<p>
A record type descriptor that either is an inclusive-record-type-descriptor or
is an exclusive-record-type-descriptor with a record-rest-descriptor is called
<em>open</em>; a record type descriptor that is not open is called
<em>closed</em>.
</p>
<p>
If a record type descriptor is closed and every individual-field-descriptor
specifies <code>readonly</code>, then it describes a type that is a subtype of
<code>readonly</code>: a shape belongs to the type only if its read-only bit is
set.
</p>
<p>
A <code>default-expression</code> is an expression that specifies a default
value for the field, which is used when the record type descriptor is used to
construct a mapping value but no value is specified explicitly for the field.
The type descriptor contains a 0-argument function closure for each default
value. The closure is created from the expression when the type descriptor is
resolved. The expression must meet the requirements for an <a href="#isolated_functions">isolated function</a>. The closure is evaluated to
create a field value each time the default is used in the construction of a
mapping value. The default value does not affect the type described by the type
descriptor.
</p>
<p>
A <code>record-type-inclusion</code> includes fields from a named record type.
The <code>type-reference</code> must reference a type described by a
<code>record-type-descriptor</code>. The <code>field-descriptor</code>s and any
<code>record-rest-descriptor</code> are included the type being defined; the
meaning is the same as if they had been specified explicitly. For default
values, the closure rather than the expression is copied in.
It is an error for an <code>record-type-descriptor</code> to directly or
indirectly include itself. An <code>individual-field-descriptor</code> in a
<code>record-type-descriptor</code> can override an
<code>individual-field-descriptor</code> of the same name in an included
<code>record-type-descriptor</code>, provided the type declared for the field in
the overriding field descriptor is a subtype of the type declared in the
overridden field descriptor. It is an error if a
<code>record-type-descriptor</code> has two or more
<code>record-type-inclusion</code>s that include an
<code>individual-field-descriptor</code> with the same name, unless those
<code>individual-field-descriptor</code>s are overridden by an
<code>individual-field-descriptor</code> in the including
<code>record-type-descriptor</code>. A <code>record-rest-descriptor</code> in
the including type overrides any <code>record-rest-descriptor</code> in the
included type. It is an error if a <code>record-type-descriptor</code> has two
or more <code>record-type-inclusion</code>s that include different
<code>record-rest-descriptor</code>s, unless those
<code>record-rest-descriptor</code>s are overridden by an
<code>record-rest-descriptor</code> in the including
<code>record-type-descriptor</code>. For the purposes of
resolving a <code>record-type-inclusion</code>, an including or included type
that is an <code>inclusive-record-type-descriptor</code> is treated as if it
were the equivalent <code>exclusive-record-type-descriptor</code> with an
explicit <code>record-rest-descriptor</code>.
</p>
</section>
</section>
<section>
<h4 id="tables">5.4.3 Tables</h4>
<p>
A table is a structural value, whose members are mapping values. A table
provides access to its members using a key that comes from the read-only fields
of the member. It keeps its members in order, but does not provide random access
to a member using its position in this order.
</p>
<p>
Every table value has, in addition to its members, a key sequence, which is used
to provide keyed access to its members. The key sequence is an ordered sequence
of field names. The key sequence of a table is fixed when a table is
constructed and cannot be changed thereafter. For each field name in the key
sequence, every member of the table must have a read-only field with that name
and the value of the field must be acyclic plain data. A table's key sequence
determines a key value for each member of the table: if the key sequence
consists of a single field name f, then the key value of a member is that value
of field f of that member. If the key sequence consists of multiple field names
f<sub>1</sub>,f<sub>2</sub>,...,f<sub>n</sub> where n is â¥ 2, then the
key value for a member r is a tuple with members
v<sub>1</sub>,v<sub>2</sub>,...,v<sub>n</sub> where v<sub>i</sub> is the value
of field f<sub>i</sub> of r. A table constrains its membership so that a key
value uniquely identifies a member within the table. More precisely, for every
two rows r<sub>i</sub> and r<sub>j</sub> in a table with i not equal to j, the
key value for r<sub>i</sub> must not be equal to the key value for
r<sub>j</sub>. Key values are compared for equality using the <a href="#DeepEquals">DeepEquals</a> abstract operation. This constraint is
enforced by the table both when the table is constructed and when the table is
mutated. As a special case, a table's key sequence may be empty; this represents
a keyless table, whose members are not uniquely identified by a key.
</p>
<p>
The shape of a table value is a triple consisting of
</p>
<ul>
<li>an ordered list containing for each table member, the shape of that member</li>
<li>the table's key sequence, and</li>
<li>a set containing for each table member, the shape of the key value of that
member (derived from the table members and the key sequence)</li>
</ul>

<pre class="grammar"><span class="ntdfn" id="table-type-descriptor">table-type-descriptor</span> := <code>table</code> <a href="#row-type-parameter"><span class="ntref">row-type-parameter</span></a> [<a href="#key-constraint"><span class="ntref">key-constraint</span></a>]
<span class="ntdfn" id="row-type-parameter">row-type-parameter</span> := <a href="#type-parameter"><span class="ntref">type-parameter</span></a>
<span class="ntdfn" id="key-constraint">key-constraint</span> := <a href="#key-specifier"><span class="ntref">key-specifier</span></a> | <a href="#key-type-constraint"><span class="ntref">key-type-constraint</span></a>
<span class="ntdfn" id="key-specifier">key-specifier</span> := <code>key</code> <code>(</code> [ <a href="#field-name"><span class="ntref">field-name</span></a> (<code>,</code> <a href="#field-name"><span class="ntref">field-name</span></a>)* ] <code>)</code>
<span class="ntdfn" id="key-type-constraint">key-type-constraint</span> := <code>key</code> <a href="#type-parameter"><span class="ntref">type-parameter</span></a>
</pre>
<p>
The row-type-parameter specifies the shape of the table's members. A table type
<code>table&lt;<var>R</var>&gt; <var>KC</var> </code> contains a table shape if
and only if every table member shape belongs to <code><var>R</var></code> and
the table shape satisfies the key constraint <code><var>KC</var></code>. The
type specified by a row-type-parameter must be a subtype of
<code>map&lt;any|error&gt;</code>
</p>
<p>
In a table-type-descriptor <code>table&lt;<var>R</var>&gt;
key(<var>ks</var>)</code>, <code><var>R</var></code> and
<code><var>ks</var></code> must be consistent in the following sense: for each
field name f<sub>i</sub> in <code><var>ks</var></code>, f<sub>i</sub> must be a
required, read-only field of <code><var>R</var></code> with a type that is a
subtype of <code>anydata</code>. A table shape satisfies a key-constraint
<code>key(<var>ks</var>)</code> if and only if its key sequence is
<code><var>ks</var></code>. A table shape satisfies a key-constraint
<code>key&lt;K&gt;</code> if and and only if its set of key value shapes are a
subset of <code><var>K</var></code>. The shape of a keyless table satisfies the
key-constraint <code>key&lt;never&gt;</code>.
</p>
<p>
As with other structured values, a table value has an inherent type. The
inherent type of a table value must be a table-type-descriptor with a
key-constraint that is a key-specifier.
</p>
<p>
A table is iterable: the iteration sequence consists of the members of the
table in order and the iteration completion value is always nil.
</p>

</section>
</section>
<section>
<h3 id="section_5.5">5.5 Behavioral values</h3>

<pre class="grammar"><span class="ntdfn" id="behavioral-type-descriptor">behavioral-type-descriptor</span> :=
   <a href="#error-type-descriptor"><span class="ntref">error-type-descriptor</span></a>
   | <a href="#function-type-descriptor"><span class="ntref">function-type-descriptor</span></a>
   | <a href="#object-type-descriptor"><span class="ntref">object-type-descriptor</span></a>
   | <a href="#future-type-descriptor"><span class="ntref">future-type-descriptor</span></a>
   | <a href="#typedesc-type-descriptor"><span class="ntref">typedesc-type-descriptor</span></a>
   | <a href="#handle-type-descriptor"><span class="ntref">handle-type-descriptor</span></a>
   | <a href="#stream-type-descriptor"><span class="ntref">stream-type-descriptor</span></a>
</pre>

<section>
<h4 id="section_5.5.1">5.5.1 Errors</h4>

<pre class="grammar"><span class="ntdfn" id="error-type-descriptor">error-type-descriptor</span> := <code>error</code> [<a href="#type-parameter"><span class="ntref">type-parameter</span></a>]
</pre>
<p>
An error value provides information about an error that has occurred. Error
values belong to a separate basic type; this makes it possible for language
constructs to handle errors differently from other values.
</p>
<p>
The error type is inherently immutable. An error value contains the following
information:
</p>
<ul>
<li>a message, which is a string containing a human-readable message describing
the error</li>
<li>a cause, which is either nil or another error value that was the cause of
this error</li>
<li>a detail, which is an immutable mapping providing additional information about
the error</li>
<li>a stack trace, which is an immutable snapshot of the state of the execution
stack</li>
</ul>
<p>
The detail mapping must be a subtype of <code>map&lt;Cloneable&gt;</code>.
</p>
<p>
The shapes of the message, cause and detail record are part of the shape of the
error; the stack trace is not part of the shape. A type descriptor
<code>error&lt;<var>T</var>&gt;</code> contains an error shape if
<code><var>T</var></code> contains the shape of its detail. The type
<code>error</code> contains a shape if its basic type is error.
</p>
<p>
An error-type-descriptor is always definite and induces an empty set of
type-ids. An intersection type can be used to describe an error type that induces
a non-empty set of type-ids.
</p>
</section>

<section>
<h4 id="functions">5.5.2 Functions</h4>

<pre class="grammar"><span class="ntdfn" id="function-type-descriptor">function-type-descriptor</span> :=
   <a href="#function-quals"><span class="ntref">function-quals</span></a> <code>function</code> <a href="#function-signature"><span class="ntref">function-signature</span></a>
   | [<a href="#isolated-qual"><span class="ntref">isolated-qual</span></a>] <code>function</code>
<span class="ntdfn" id="function-quals">function-quals</span> :=
   <a href="#transactional-qual"><span class="ntref">transactional-qual</span></a> [<a href="#isolated-qual"><span class="ntref">isolated-qual</span></a>]
   | [<a href="#isolated-qual"><span class="ntref">isolated-qual</span></a>] [<a href="#transactional-qual"><span class="ntref">transactional-qual</span></a>]
<span class="ntdfn" id="isolated-qual">isolated-qual</span> := <code>isolated</code>
<span class="ntdfn" id="transactional-qual">transactional-qual</span> := <code>transactional</code>
<span class="ntdfn" id="function-signature">function-signature</span> := <code>(</code> <a href="#param-list"><span class="ntref">param-list</span></a> <code>)</code> <a href="#return-type-descriptor"><span class="ntref">return-type-descriptor</span></a>
</pre>
<p>
A function is a part of a program that can be explicitly executed. In Ballerina,
a function is also a value, implying that it can be stored in variables, and
passed to or returned from functions. When a function is executed, it is passed
an argument list as input and returns a value as output.
</p>

<pre class="grammar"><span class="ntdfn" id="param-list">param-list</span> :=
   <a href="#required-params"><span class="ntref">required-params</span></a> [<code>,</code> <a href="#defaultable-params"><span class="ntref">defaultable-params</span></a>] [<code>,</code> <a href="#included-record-params"><span class="ntref">included-record-params</span></a>] [<code>,</code> <a href="#rest-param"><span class="ntref">rest-param</span></a>]
   | <a href="#defaultable-params"><span class="ntref">defaultable-params</span></a> [<code>,</code> <a href="#included-record-params"><span class="ntref">included-record-params</span></a>] [<code>,</code> <a href="#rest-param"><span class="ntref">rest-param</span></a>]
   | <a href="#included-record-params"><span class="ntref">included-record-params</span></a> [<code>,</code> <a href="#rest-param"><span class="ntref">rest-param</span></a>]
   | [<a href="#rest-param"><span class="ntref">rest-param</span></a>]
<span class="ntdfn" id="required-params">required-params</span> := <a href="#required-param"><span class="ntref">required-param</span></a> (<code>,</code> <a href="#required-param"><span class="ntref">required-param</span></a>)*
<span class="ntdfn" id="required-param">required-param</span> := [<a href="#annots"><span class="ntref">annots</span></a>] <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> [<a href="#param-name"><span class="ntref">param-name</span></a>]
<span class="ntdfn" id="defaultable-params">defaultable-params</span> := <a href="#defaultable-param"><span class="ntref">defaultable-param</span></a> (<code>,</code> <a href="#defaultable-param"><span class="ntref">defaultable-param</span></a>)*
<span class="ntdfn" id="defaultable-param">defaultable-param</span> := [<a href="#annots"><span class="ntref">annots</span></a>] <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> [<a href="#param-name"><span class="ntref">param-name</span></a>] <code>=</code> (<a href="#default-expression"><span class="ntref">default-expression</span></a> | <a href="#inferred-typedesc-default"><span class="ntref">inferred-typedesc-default</span></a>) 
<span class="ntdfn" id="included-record-params">included-record-params</span> := <a href="#included-record-param"><span class="ntref">included-record-param</span></a> (<code>,</code> <a href="#included-record-param"><span class="ntref">included-record-param</span></a>)*
<span class="ntdfn" id="included-record-param">included-record-param</span> := [<a href="#annots"><span class="ntref">annots</span></a>] <code>*</code> <a href="#type-reference"><span class="ntref">type-reference</span></a> [<a href="#param-name"><span class="ntref">param-name</span></a>]
<span class="ntdfn" id="rest-param">rest-param</span> := [<a href="#annots"><span class="ntref">annots</span></a>] <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> <code>...</code> [<a href="#param-name"><span class="ntref">param-name</span></a>]
<span class="ntdfn" id="param-name">param-name</span> := <a href="#identifier"><span class="ntref">identifier</span></a>
<span class="ntdfn" id="inferred-typedesc-default">inferred-typedesc-default</span> := <code>&lt;</code> <code>&gt;</code>
</pre>
<p>
A param-name can be omitted from a required-param, defaultable-param,
included-record-param or rest-param only when occuring in the function-signature
of a function-type-descriptor. The type-descriptor in a required-param or
defaultable-param must not be <code>never</code>.
</p>
<p>
The argument list passed to a function consists of zero or more arguments in order;
each argument is a value, but the argument list itself is not passed as a value.
The argument list must conform to the param-list as described in this section.
Usually, the compiler's type checking will ensure that this is the case; if not,
the function will panic.
</p>
<p>
It is convenient to consider the complete param-list as having a type. This type
is described by a tuple-type-descriptor that has a member-type-descriptor for
each required-param, defaultable-param and included-record-param, and has a
tuple-rest-descriptor if and only if there is a rest-param. The i-th
member-type-descriptor of the tuple type descriptor is the same as the
type-descriptor of the i-th member of the param-list; for an
included-record-param, the type-descriptor is the type-reference; the
type-descriptor of the tuple-rest-descriptor, if present, is the same as the
type-descriptor of the rest-param.
</p>
<p>
An argument list consisting of values v<sub>1</sub>,..., v<sub>n</sub> conforms
to a param-list that has type P, if and only if for each i with 1 â¤ i â¤
n, v<sub>i</sub> belongs to T<sub>i</sub>, where T<sub>i</sub> is defined to be the type
that contains a shape s if and only if P contains a list shape whose i-th member
is s.
</p>
<p>
A defaultable-param is a parameter for which a default value is specified. An
expression can be used to specify the default value; this expression may refer
to previous parameters. Each such expression is turned into a closure that
computes the default value for the parameter using the values of previous
parameters, and this closure is part of the type descriptor for the function. It
is also possible for the default to be specified as <code>&lt;&gt;</code>; this
means that the default value is a <code>typedesc</code> value that is to be
inferred by the caller from the contextually expected type of the function call.
It is allowed only when the parameter name to which the default value applies is
referenced in the return-type-descriptor, as described below, and is allowed for
at most one parameter in a function. The caller of the function uses the
function's type descriptor to compute default values for any defaultable
arguments that were not specified explicitly. These default values are included
in the argument list passed to the function. Whether a parameter is defaultable,
and what its default is, do not affect the shape of the function and thus do not
affect typing. The closures computing the defaultable parameters are created
when the type descriptor is resolved; the default value is computed by calling
the closure each time the function is called and the corresponding parameter is
not specified. Whether a parameter is defaultable is used at compile time, but
the closure that computes the default value is only used at runtime. If the
function-type-descriptor includes an isolated-qual, then an expression used as a
default-expression must meet the requirements for an <a href="#isolated_functions">isolated function</a>.
</p>
<p>
The name of each parameter is included in the function's type descriptor. A
caller of the function may specify the name of the parameter that an argument is
supplying. In this case, the caller uses the parameter name at compile time in
conjunction with the type descriptor to create the argument list. The
parameter names do not affect the shape of the function and thus do not affect
typing.
</p>
<p>
The type-reference in an included-record-param must refer to a type defined by a
record-type-descriptor. Specifying an included-record-param <code>*<var>T</var>
<var>p</var></code> is similar to specifying a required-param <code><var>T</var>
<var>p</var></code>. The difference is that the caller of the function may
specify the value for a field of an included-record-param using the field's name
as if it had been declared as a parameter. Any field of the
included-record-param not so specified is defaulted using the
record-type-descriptor. A field-descriptor is a <code>parameter field
descriptor</code> of a function if it is a field descriptor of a
record-type-descriptor referenced by an included-record-param of the function.
The field names of all the parameter field descriptors whose type is not
<code>never</code> must be distinct from each other and from the names of the
parameters. Whether a parameter is an included-record-param is part of the
function's type-descriptor, but does not affect the shape of the function and
thus does not affect whether a function value belongs to a function type.
</p>
<p>
The process by which the function caller creates an argument list, which may
make use of arguments specified both by position and by name, is described in
more detail in the <a href="#function_call">section on function calls</a>.
</p>
<pre class="grammar"><span class="ntdfn" id="return-type-descriptor">return-type-descriptor</span> := [ <code>returns</code> [<a href="#annots"><span class="ntref">annots</span></a>] <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> ]
</pre>
<p>
When the execution of a function returns to its caller, it returns exactly one
value. A function that would in other programming languages not return a value
is represented in Ballerina by a function returning <code>()</code>. Note that
the function definition does not have to explicitly return <code>()</code>; a
return statement or falling off the end of the function body will implicitly
return <code>()</code>.
</p>
<p>
The value returned by a function will belong to the type specified in the
return-type-descriptor. An empty return-type-descriptor is equivalent to
<code>returns ()</code>. The type-descriptor in a return-type-descriptor may be
<code>never</code>.
</p>
<p>
A return-type-descriptor may be depend on the param-list in the following way. A
type-reference occurring in a return-type-descriptor can refer to a parameter
name if the type of the parameter is a subtype of <code>typedesc</code>. If p is
such a parameter, then a reference to p in the return-type-descriptor denotes
the type that is the value of p. If the default value for p is
<code>&lt;&gt;</code> and p occurs in the return-type-descriptor in a union p|T,
then for every basic type B, either the intersection of B and T must be empty,
or the intersection of typedesc&lt;B&gt; and the declared type of p must be
empty, or both. The return-type-descriptor thus denotes a
distinct set of shapes for each invocation of the function. A function-signature
with a return-type-descriptor that uses a type-reference to refer to a parameter
name in this way is said to be <em>dependently-typed</em>. Functions with
dependently-types signatures can be declared and used within Ballerina, but
Ballerina does not yet provide a mechanism to define such functions.
</p>
<p>
Function types are covariant in their return types and contravariant in the type
of their parameter lists. More precisely, a function type with return type R and
parameter list type P is a subtype of a function type with return type R' and
parameter list type P' if and only if R is a subtype of R' and P' is a subtype
of P. A function value f belongs to a function type T if the declared type of f
is a subtype of T.
</p>
<p>
If a function-type-descriptor includes an <code>isolated-qual</code>, then a
function value belongs to the type only if the value's isolated bit is set; if
the function type does not include an <code>isolated-qual</code>, then whether a
function value belongs to the type is not affected by the value's isolated bit.
</p>
<p>
All function values belongs to a function-type-descriptor <code>function</code>;
a function value belongs to the function-type-descriptor <code>isolated
function</code> if and only if it is an isolated function.
</p>
<p>
In addition to a readonly bit and an isolated bit, a function value also has a
transactional bit. A function value with its transactional bit set can only be
called in a <a href="#transactions">transactional scope</a>; this is enforced by
the type system. A function value with its transactional bit not set belongs to
the type described by a function-type-descriptor with a function-signature only
if the function-type-descriptor does not include a <code>transactional</code>
qualifier. This means that a function-type-descriptor with a function-signature
but without a <code>transactional</code> qualifier is a subtype of the
corresponding function-type-descriptor with a <code>transactional</code>
qualifier. Note that the subtyping relationship for <code>transactional</code>
is in the opposite direction from <code>isolated</code>. A function value's
transactional bit does not affect whether it belongs to the type described by a
function-type-descriptor without a function-signature.
</p>
</section>
<section>
<h4 id="section_5.5.3">5.5.3 Objects</h4>
<p>
An object value encapsulates data with functions that operate on the data. An
object consists of named members, where each member is either a field or a
method. A field of an object stores a value. A method of an object is a function
that can be invoked on the object using a <code>method-call-expr</code>; when a
method is invoked on an object, the function can access the object using the
<code>self</code> variable. An object's methods are associated with the object
when the object is constructed and cannot be changed thereafter. Fields and
methods have names that uniquely identify them within their object; fields and
methods share a single symbol space; it is not possible for an object to have a
field and a method with the same name.
</p>
<p>
The type of object values can be described using an
<code>object-type-descriptor</code>, as specified in this section. It can also
be described using a <em>class</em>. A class both describes an object type and
provides a way to construct an object belonging to the type; in particular, it
provides the method definitions that are associated with the object when it is
constructed. A class is defined using a module-level class definition.
</p>
<p>
The object basic type is selectively immutable. An object value has a read-only
bit, which is fixed when the object is constructed. An
<code>object-type-descriptor</code> does not describe whether the object's
read-only bit is set: whether a value belongs to the type described by an
<code>object-type-descriptor</code> is not affected by the object's read-only
bit. Whether an object is read-only can be described separately using a
<code>readonly</code> type descriptor, which can be combined with an
<code>object-type-descriptor</code> using the type intersection operator.
</p>

<pre class="grammar"><span class="ntdfn" id="object-type-descriptor">object-type-descriptor</span> :=
   <a href="#object-type-quals"><span class="ntref">object-type-quals</span></a> <code>object</code> <code>{</code>
      <a href="#object-member-descriptor"><span class="ntref">object-member-descriptor</span></a>*
   <code>}</code>
<span class="ntdfn" id="object-type-quals">object-type-quals</span> :=
   <a href="#isolated-qual"><span class="ntref">isolated-qual</span></a> [<a href="#object-network-qual"><span class="ntref">object-network-qual</span></a>]
   | [<a href="#object-network-qual"><span class="ntref">object-network-qual</span></a> [<a href="#isolated-qual"><span class="ntref">isolated-qual</span></a>]]
<span class="ntdfn" id="object-member-descriptor">object-member-descriptor</span> :=
   <a href="#object-field-descriptor"><span class="ntref">object-field-descriptor</span></a>
   | <a href="#method-decl"><span class="ntref">method-decl</span></a>
   | <a href="#remote-method-decl"><span class="ntref">remote-method-decl</span></a>
   | <a href="#object-type-inclusion"><span class="ntref">object-type-inclusion</span></a>
</pre>

<p>
If an isolated-qual is specified, then an object belongs to the described type
only if the object's isolated bit is set. If an isolated-qual is not specified,
then an object's isolated bit does not affect whether it belongs to the
described type.
</p>

<section>
<h5 id="section_5.5.3.1">5.5.3.1 Network interaction</h5>
<p>
Objects are the basis for Ballerina's network interaction primitives. There are
two special kinds of object for network interaction: client objects and service
objects. A client object supports network interaction with a remote system that
is originated by the Ballerina program. A service object supports network
interaction with a remote system that is originated by the remote system. An
object may be a client object or a service object or neither; it cannot be both
a client object and a service object. An object that is a client object or a
service object is a network interaction object.
</p>

<pre class="grammar"><span class="ntdfn" id="object-network-qual">object-network-qual</span> := <code>client</code> | <code>service</code>
</pre>

<p>
If the <code>object-network-qual</code> is <code>client</code>, then an object
belongs to the type only if it is a client object. If the
<code>object-network-qual</code> is <code>service</code>, then an object belongs
to the type only if it is a service object. If <code>object-network-qual</code>
is not present, then an object belongs to the type regardless of whether it is a
client object or service object or neither. A <code>object-network-qual</code>
is not allowed in conjunction with <code>public</code>.
</p>

<p>
Network interaction objects provide two additional features: remote methods and
resources. Remote methods are supported by both client and service objects. The
remote methods of an object are in a separate symbol space from the other
methods of the object. Resources are supported only by service objects. Object
type descriptors do not provide a way to describe the resources of a service
object: whether a service object belongs to an object type is not affected by
the service object's resources. Resources are described in detail in the <a href="#resources">section</a> on object constructors.
</p>

</section>

<section>
<h5 id="section_5.5.3.2">5.5.3.2 Fields</h5>

<pre class="grammar"><span class="ntdfn" id="object-field-descriptor">object-field-descriptor</span> :=
   <a href="#metadata"><span class="ntref">metadata</span></a> [<code>public</code>] <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> <a href="#field-name"><span class="ntref">field-name</span></a> <code>;</code>
</pre>
<p>
An <code>object-field-descriptor</code> describes a field of the object. The
<code>field-name</code> of an <code>object-field-descriptor</code> must be
distinct from the <code>field-name</code> of every other
<code>object-field-descriptor</code> in the <code>object-type-descriptor</code>
and from the <code>method-name</code> of every <code>method-decl</code> in the
<code>object-type-descriptor</code>.
</p>
<p>
If an object's read-only bit is set, then the read-only bit of the value of
every field must also be set and the value of a field cannot be changed after
the object has been constructed.
</p>
</section>

<section>
<h5 id="section_5.5.3.3">5.5.3.3 Methods</h5>

<pre class="grammar"><span class="ntdfn" id="method-decl">method-decl</span> :=
   <a href="#metadata"><span class="ntref">metadata</span></a> [<code>public</code>] <a href="#method-quals"><span class="ntref">method-quals</span></a>
   <code>function</code> <a href="#method-name"><span class="ntref">method-name</span></a> <a href="#function-signature"><span class="ntref">function-signature</span></a> <code>;</code>
<span class="ntdfn" id="method-quals">method-quals</span> := <a href="#function-quals"><span class="ntref">function-quals</span></a>
<span class="ntdfn" id="method-name">method-name</span> := <a href="#identifier"><span class="ntref">identifier</span></a>
</pre>
<p>
A <code>method-decl</code> describes a method of the object. The
<code>method-name</code> of a <code>method-decl</code> must be distinct from the
<code>method-name</code> of every other <code>method-decl</code> in the
<code>object-type-descriptor</code> and from the <code>field-name</code> of
every <code>object-field-descriptor</code> in the
<code>object-type-descriptor</code>. Note that here is no method overloading.
The <code>method-name</code> in a <code>method-decl</code> must not be
<code>init</code>.
</p>

<p>
The <code>isolated-qual</code> together with the <code>function-signature</code>
give the function type of the method. An isolated method has the same access to
the object on which the method is invoked that it has to parameters.
</p>

<pre class="grammar"><span class="ntdfn" id="remote-method-decl">remote-method-decl</span> :=
   <a href="#metadata"><span class="ntref">metadata</span></a> <a href="#remote-method-quals"><span class="ntref">remote-method-quals</span></a> 
   <code>function</code> <a href="#method-name"><span class="ntref">method-name</span></a> <a href="#function-signature"><span class="ntref">function-signature</span></a> <code>;</code>
<span class="ntdfn" id="remote-method-quals">remote-method-quals</span> :=
   <a href="#remote-qual"><span class="ntref">remote-qual</span></a> <a href="#function-quals"><span class="ntref">function-quals</span></a>
   | <a href="#isolated-qual"><span class="ntref">isolated-qual</span></a> [<a href="#transactional-qual"><span class="ntref">transactional-qual</span></a>] <a href="#remote-qual"><span class="ntref">remote-qual</span></a>
   | <a href="#transactional-qual"><span class="ntref">transactional-qual</span></a> [<a href="#isolated-qual"><span class="ntref">isolated-qual</span></a>] <a href="#remote-qual"><span class="ntref">remote-qual</span></a>
   | <a href="#isolated-qual"><span class="ntref">isolated-qual</span></a> <a href="#remote-qual"><span class="ntref">remote-qual</span></a> <a href="#transactional-qual"><span class="ntref">transactional-qual</span></a>
   | <a href="#transactional-qual"><span class="ntref">transactional-qual</span></a> <a href="#remote-qual"><span class="ntref">remote-qual</span></a> <a href="#isolated-qual"><span class="ntref">isolated-qual</span></a>
<span class="ntdfn" id="remote-qual">remote-qual</span> := <code>remote</code>
</pre>
<p>
A <code>remote-method-decl</code> declares a remote method. An object can
include a <code>remote-method-decl</code> only if it is a network interaction
object. A remote method is a method for network interaction: a remote method of
a client object is for outbound network interaction; a remote method of a
service object is for inbound network interaction. The <code>method-name</code>
of a <code>remote-method-decl</code> must be distinct from the
<code>method-name</code> of every other <code>remote-method-decl</code> in the
<code>object-type-descriptor</code>. However, a <code>method-decl</code> and a
<code>remote-method-decl</code> can have the same name. A remote method cannot
be called using the normal method call syntax. A remote method of a client
object can only be invoked by a <code>client-remote-method-call-action</code>.
The return type of the remote method of a client object must not be
<code>never</code>. A remote method of a service object is invoked by a listener
object provided by a library module; Ballerina does not yet define a mechanism
to allow such a library module to be implemented completely in Ballerina.
</p>

</section>

<section>
<h5 id="section_5.5.3.4">5.5.3.4 Visibility</h5>
<p>
Each field and method of an object has a <em>visibility region</em>, which is
the region of code within which the field or method is visible and can be
accessed. The visibility region of a <code>remote-method-decl</code> or of
<code>object-field-descriptor</code> or <code>method-decl</code> that includes
<code>public</code> consists of all the modules of the program. Otherwise the
visibility region is the module containing this object type descriptor; this is
called module-level visibility.
</p>
</section>
<section>
<h5 id="section_5.5.3.5">5.5.3.5 Typing</h5>

<p>
The shape of an object consists of a read-only bit, an isolated bit, a network
interaction kind and an unordered collection of object field shapes and object
method shapes. A network interaction kind has one of three values: service,
client or empty. An object field shape or object method shape is a 4-tuple
consisting of the name of the field or method, the visibility region, a remote
flag and a shape for the value of the field or for the method's function.
</p>
<p>
An object type is inclusive, in a similar way to an
inclusive-record-type-descriptor: an object shape belongs to an object type if
it has at least the fields and methods described in the object-type-descriptor.
Thus all object values belong to the type <code>object { }</code>.
</p>
<p>
An object-type-descriptor that has a field with name f, visibility region R and
type T contains an object shape only if the object shape contains an object
field shape that has name f, visibility region R and a value shape that is
contained in T. An object-type-descriptor that has a method with name m,
visibility region R, remote qualifier r and function type T contains an object
shape only if the object shape contains an object method shape that has name m,
visibility region R, a remote flag that matches r and a function value that
belongs to type T.
</p>
<p>
Thus an object type T' is a subtype of an object type T only if for each field
or method f of T there is a corresponding field or method f' of T such that the
type of f' in T' is a subtype of the type of f in T and the visibility region of
f' in T' is the same as the visibility region of f in T. This implies that if an
object type descriptor T has fields or methods with module-level visibility,
then it is possible to define another object type descriptor that is a subtype
of T only within the same module as T.
</p>
 
</section>
<section>
<h5 id="section_5.5.3.6">5.5.3.6 Inclusion and type-ids</h5>

<pre class="grammar"><span class="ntdfn" id="object-type-inclusion">object-type-inclusion</span> := <code>*</code> <a href="#type-reference"><span class="ntref">type-reference</span></a> <code>;</code>
</pre>
<p>
Every type descriptor referenced directly or indirectly by a
<code>type-reference</code> in an <code>object-type-inclusion</code> must be an
<code>object-type-descriptor</code>, <code>distinct-type-descriptor</code>,
<code>intersection-type-descriptor</code> or
a class without a <code>readonly</code> qualifier; the
referenced type descriptor will thus necessarily be definite and a subtype of
object. If a referenced object-type-descriptor or class has an
<code>isolated</code>, <code>service</code> or <code>client</code> qualifier
<var>Q</var>, then the referencing object-type-descriptor must also have the
qualifier <var>Q</var>. The <code>object-field-descriptor</code>s and
<code>method-decl</code>s from the referenced type are included in the type
being defined. A type-reference to a class is treated as a reference to the
class's type; only the types of the methods and fields are copied from the
referenced type. An <code>object-field-descriptor</code> or
<code>method-decl</code> in a <code>object-type-descriptor</code> can override
respectively an <code>object-field-descriptor</code> or <code>method-decl</code>
of the same name in an included <code>object-type-descriptor</code>, provided
the type declared for the field or method in the overriding descriptor is a
subtype of the type declared in the overridden descriptor. An
<code>object-field-descriptor</code> cannot override a <code>method-decl</code>,
nor can a <code>method-decl</code> override an
<code>object-field-descriptor</code>. It is an error if an
<code>object-type-descriptor</code> has two or more
<code>object-type-inclusion</code>s that include an
<code>object-field-descriptor</code> with the same name, unless those
<code>object-field-descriptor</code>s are overridden by an
<code>object-field-descriptor</code> in the including
<code>object-type-descriptor</code>. It is an error if an
<code>object-type-descriptor</code> has two or more
<code>object-type-inclusion</code>s that include <code>method-decl</code>s with
the same name but different <code>function-signature</code>s, unless those
<code>method-decl</code>s are overridden by a <code>method-decl</code> in the
including <code>object-type-descriptor</code>.
</p>
<p>
An object-type-descriptor is always definite. The set of type-ids induced by an
object-type-descriptor is the union of the set of type-ids induced by the type
descriptors that it includes. An induced type-id is primary in an
object-type-descriptor if and only if it is primary in any of the included type
descriptors. It is an error if the induced set of type-ids includes a non-public
type-id from another module.
</p>
<p>
It is an error for an <code>object-type-descriptor</code> to directly or
indirectly include itself.
</p>
</section>
</section>
<section>
<h4 id="section_5.5.4">5.5.4 Futures</h4>

<pre class="grammar"><span class="ntdfn" id="future-type-descriptor">future-type-descriptor</span> := <code>future</code> [<a href="#type-parameter"><span class="ntref">type-parameter</span></a>]
</pre>
<p>
A future value refers to a named worker, which will return a value. A future
value belongs to a type <code>future&lt;T&gt;</code> if the return type of the
named worker is a subtype of T.
</p>
<p>
A value belongs to a type <code>future</code> (without the type-parameter)
if it has basic type future.
</p>
</section>
<section>
<h4 id="section_5.5.5">5.5.5 Type descriptors</h4>
<pre class="grammar"><span class="ntdfn" id="typedesc-type-descriptor">typedesc-type-descriptor</span> := <code>typedesc</code> [<a href="#type-parameter"><span class="ntref">type-parameter</span></a>]
</pre>
<p>
A type descriptor value is an immutable value representing a resolved type
descriptor. The type typedesc contains all values with basic type typedesc. A
typedesc value <var>t</var> belongs to a type typedesc&lt;<var>T</var>&gt; if
and only if the type described by <code>t</code> is a subtype of <var>T</var>.
The typedesc type is thus covariant with its type parameter.
</p>
<p>
Referencing an identifier defined by a type definition in an expression context
will result in a type descriptor value.
</p>

</section>
<section>
<h4 id="section_5.5.6">5.5.6 Handles</h4>
<pre class="grammar"><span class="ntdfn" id="handle-type-descriptor">handle-type-descriptor</span> := <code>handle</code>
</pre>
<p>
A handle value is a reference to storage managed externally to a Ballerina
program. Handle values are useful only in conjunction with functions that have
external function bodies; in particular, a new handle value can be created only
by a function with an external function body. Handle values are inherently
immutable.
</p>
<p>
A value belongs to a type <code>handle</code> if it has a basic type of handle.
</p>

</section>

<section>
<h4 id="section_5.5.7">5.5.7 Streams</h4>

<pre class="grammar"><span class="ntdfn" id="stream-type-descriptor">stream-type-descriptor</span> := <code>stream</code> [<a href="#stream-type-parameters"><span class="ntref">stream-type-parameters</span></a>]
<span class="ntdfn" id="stream-type-parameters">stream-type-parameters</span> := <code>&lt;</code> <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> [<code>,</code> <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a>]<code>&gt;</code>
</pre>
<p>
A stream is an object-like value that can generate a sequence of values. There
is also a value associated with the completion of the generation of the
sequence, which is either nil, indicating the generation of the sequence completed
successfully, or an error. A stream belongs to type
<code>stream&lt;T,C&gt;</code> if the values in the generated sequence all
belong to T and if the completion value belongs to C. The type
<code>stream&lt;T&gt;</code> is equivalent to <code>stream&lt;T,()&gt;</code>. A
value belongs to a type <code>stream</code> (without the type-parameter) if it
has basic type stream. A type <code>stream&lt;T,C&gt;</code> where C does not
include nil describes an unbounded stream.
</p>
<p>
A stream supports two primitive operations: a next operation and a close
operation. The next operation has the same semantics as the next method on the
Iterator object type. The close operation informs the stream that there will be
no more next operations and thus allows the stream to release resources used by
the stream; the close operation on a <code>stream&lt;T,C&gt;</code> has a result
of type <code>C?</code>, where nil means that the close operation was
successful. The close operation is idempotent: performing the close operation on
a stream on which the close operation has already been performed has no effect.
When the generation of the sequence is complete, the stream automatically
performs the close operation to release resources used by the stream.
</p>
<p>
The type descriptor <code>stream&lt;T,C&gt;</code> works like a class, in that
it can be used with <code>new</code> to construct stream values that belong to
the type. The normal implementation of a <code>stream&lt;T,C&gt;</code> is a
wrapper around an object belonging to <a href="#StreamImplementor">object type
<code>StreamImplementor&lt;T,C&gt;</code></a>. The next and close operations on
the stream delegate to the next and close methods on the StreamImplementor.
</p>
<p>
The stream module of the <a href="#lang_library">lang library</a> provides
additional operations on stream that can be implemented in terms of the
primitive next and close operations.
</p>
<p>
A stream is iterable. A stream of type <code>stream&lt;T,C&gt;</code> has value
type <code>T</code> and completion type <code>C</code>. Calling the next method
on the iterator created for an iteration has the same effect as performing the
next operation on the stream. The stream does not keep a copy of the sequence of
values returned by the next operation. Any subsequent iteration operation on the
same stream will not generate further values, so the iteration sequence for
iterations other than the first will be the empty sequence.
</p>
<p>
Note that in this version of Ballerina the stream type is not a class because
Ballerina does not yet support parameterized classes.
</p>
</section>

</section>
<section>
<h3 id="section_5.6">5.6 Other type descriptors</h3>

<pre class="grammar"><span class="ntdfn" id="other-type-descriptor">other-type-descriptor</span> :=
   | <a href="#type-reference"><span class="ntref">type-reference</span></a>
   | <a href="#singleton-type-descriptor"><span class="ntref">singleton-type-descriptor</span></a>
   | <a href="#any-type-descriptor"><span class="ntref">any-type-descriptor</span></a>
   | <a href="#never-type-descriptor"><span class="ntref">never-type-descriptor</span></a>
   | <a href="#readonly-type-descriptor"><span class="ntref">readonly-type-descriptor</span></a>
   | <a href="#distinct-type-descriptor"><span class="ntref">distinct-type-descriptor</span></a>
   | <a href="#union-type-descriptor"><span class="ntref">union-type-descriptor</span></a>
   | <a href="#intersection-type-descriptor"><span class="ntref">intersection-type-descriptor</span></a>
   | <a href="#optional-type-descriptor"><span class="ntref">optional-type-descriptor</span></a>
   | <a href="#anydata-type-descriptor"><span class="ntref">anydata-type-descriptor</span></a>
   | <a href="#json-type-descriptor"><span class="ntref">json-type-descriptor</span></a>
   | <a href="#byte-type-descriptor"><span class="ntref">byte-type-descriptor</span></a>
   | <code>(</code> <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> <code>)</code>
</pre>
<p>
It is important to understand that the type descriptors specified in this
section do not add to the universe of values. They are just adding new ways to
describe subsets of this universe.
</p>
<section>
<h4 id="section_5.6.1">5.6.1 Type reference</h4>
<pre class="grammar"><span class="ntdfn" id="type-reference">type-reference</span> := <a href="#identifier"><span class="ntref">identifier</span></a> | <a href="#qualified-identifier"><span class="ntref">qualified-identifier</span></a>
</pre>

<p>
A type descriptor can use a type-reference to refer to a type definition in the
same module or another module.
</p>
<p>
A type-reference referring to a type descriptor <var>T</var> is definite if and
only if <var>T</var>. If it is, the type-ids induced by are the same as those
induced by <var>T</var> and a type-id is primary in <var>t</var> if and only if
it is primary in <var>T</var>. It is an error if the induced set of type-ids
includes a non-public type-id from another module.
</p>

</section>
<section>
<h4 id="section_5.6.2">5.6.2 Singleton types</h4>

<pre class="grammar"><span class="ntdfn" id="singleton-type-descriptor">singleton-type-descriptor</span> := <a href="#simple-const-expr"><span class="ntref">simple-const-expr</span></a>

</pre>
<p>
A singleton type is a type containing a single shape. A singleton type is
described using an compile-time constant expression for a single value: the type
contains the shape of that value. Note that it is possible for the
variable-reference within the simple-const-expr to reference a structured value;
in this case, the value will have its read-only bit set; a value without its
read-only bit set will thus not belong to any singleton type.
</p>
</section>
<section>
<h4 id="section_5.6.3">5.6.3 Any type</h4>

<pre class="grammar"><span class="ntdfn" id="any-type-descriptor">any-type-descriptor</span> := <code>any</code>
</pre>
<p>
The type descriptor <code>any</code> describes the type consisting of all values
other than errors. A value belongs to the any type if and only if its basic type
is not error. Thus all values belong to the type <code>any|error</code>. Note
that a structure with members that are errors belongs to the <code>any</code>
type.
</p>
<p>
The any-type-descriptor is not definite.
</p>
</section>
<section>
<h4 id="section_5.6.4">5.6.4 Never type</h4>

<pre class="grammar"><span class="ntdfn" id="never-type-descriptor">never-type-descriptor</span> := <code>never</code>
</pre>
<p>
The type descriptor <code>never</code> describes the type that does not contain
any shapes. No value ever belongs to the <code>never</code>.
</p>
<p>
This can be useful to describe for the return type of a function, if the
function never returns. It can also be useful as a type parameter. For example,
<code>xml&lt;never&gt;</code> describes the an xml type that has no
constituents, i.e. the empty xml value.
</p>
<p>
Note that for any type <code>T</code>, the type <code>T|never</code> is the same
as <code>T</code>.
</p>
</section>
<section>
<h4 id="section_5.6.5">5.6.5 Readonly type</h4>
<pre class="grammar"><span class="ntdfn" id="readonly-type-descriptor">readonly-type-descriptor</span> := <code>readonly</code>
</pre>
<p>
A shape belongs to the type <code>readonly</code> if its read-only bit is on.
</p>
<p>
A value belonging to an inherently immutable basic type will always have its
read-only bit on. These basic types are:
</p>
<ul>
<li>all simple types
<ul>
<li>nil</li>
<li>boolean</li>
<li>int</li>
<li>float</li>
<li>decimal</li>
</ul>
</li>
<li>string</li>
<li>error</li>
<li>function</li>
<li>typedesc</li>
<li>handle</li>
</ul>
<p>
A value belonging to a selectively immutable basic type may have its read-only
bit on. These basic types are:
</p>
<ul>
<li>xml</li>
<li>list</li>
<li>mapping</li>
<li>table</li>
<li>object</li>
</ul>

</section>
<section>
<h4 id="distinct_types">5.6.6 Distinct types</h4>
<pre class="grammar"><span class="ntdfn" id="distinct-type-descriptor">distinct-type-descriptor</span> := <code>distinct</code> <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a>
</pre>
<p>
Each occurrence of a distinct-type-descriptor describes a type that is distinct
from any other occurrence of a distinct-type-descriptor. Only object and error
values can belong to a type described by a distinct-type-descriptor.
</p>
<p>
The type denoted by a distinct-type-descriptor <code><var>D</var></code>, where
<code><var>D</var></code> is <code>distinct <var>T</var></code>, and
<var>d</var> is the type-id of this occurrence of <code><var>D</var></code>,
contains a shape <var>s</var> of an object or error value if and only if both
<code><var>T</var></code> contains <var>s</var> and the set of type-ids of
<var>s</var> contains <var>d</var>. The set of type-ids induced by
<code><var>D</var></code> consists of <var>d</var> as the primary type-id and
the type-ids induced by <code><var>T</var></code> as the secondary type-ids. The
type <code><var>T</var></code> must be definite and must be a subtype of object
or a subtype of error. The type <code><var>D</var></code> is always definite.
Note that <code><var>D</var></code> is always a proper subtype of
<code><var>T</var></code>.
</p>

</section>
<section>
<h4 id="section_5.6.7">5.6.7 Union types</h4>

<pre class="grammar"><span class="ntdfn" id="union-type-descriptor">union-type-descriptor</span> := <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> <code>|</code> <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a>
</pre>
<p>
The set of shapes denoted by an union type <code>T1|T2</code> is the union of
the set of shapes denoted by <code>T1</code> and the set of shapes denoted by
<code>T2</code>. Thus, the type <code>T1|T2</code> contains a shape if and only
if either the type denoted by <code>T1</code> contains the shape or the type
denoted by <code>T2</code> contains the shape. A type descriptor
<code>T1|T2</code> is not a class and cannot be used with <code>new</code>,
even if one or both of T1 and T2 are classes.
</p>
<p>
A union type <code>T1|T2</code> is definite if and only if both <code>T1</code>
and <code>T2</code> are definite and the set of type-ids induced by
<code>T1</code> and <code>T2</code> are the same. If it is definite, then it
induces the same set of type-ids as <code>T1</code> and <code>T2</code>, and a
type-id is primary if it is primary in either <code>T1</code> or
<code>T2</code>.
</p>
</section>
<section>
<h4 id="section_5.6.8">5.6.8 Intersection types</h4>

<pre class="grammar"><span class="ntdfn" id="intersection-type-descriptor">intersection-type-descriptor</span> := <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> <code>&amp;</code> <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a>
</pre>
<p>
The set of shapes denoted by an intersection type  is the
intersection of the set of shapes denoted by <code>T1</code> and the set of
shapes denoted by <code>T2</code>. Thus, the type <code>T1&amp;T2</code>
contains a shape if and only if the types denoted by <code>T1</code> and
<code>T2</code> both contain the shape. It is a error to have an intersection
type that denotes an empty set of shapes. In an intersection type
<code>T1&amp;T2</code>, it is an error if <code>T1</code> and <code>T2</code>
are both function types unless there is a single function-type-descriptor that
denotes a type that is a subtype of both <code>T1</code> and <code>T2</code>.
A type descriptor <code>T1&amp;T2</code> is not a class and cannot be used
with <code>new</code>, even if one or both of T1 and T2 are classes.
</p>
<p>
An intersection type <code>T1&amp;T2</code> is definite if and only if both
<code>T1</code> and <code>T2</code> are definite. If it is definite, then it
induces the union of the set of type-ids induced by <code>T1</code> and
<code>T2</code>, and a type-id is primary if it is primary in either
<code>T1</code> or <code>T2</code>.
</p>
<p>
Intersection types are particularly useful in conjunction with
<code>readonly</code>. A set of readonly shapes can be described by
<code>readonly&amp;T</code>, where <code>T</code> describes the primary aspect
of the shape.
</p>
</section>

<section>
<h4 id="section_5.6.9">5.6.9 Optional types</h4>

<pre class="grammar"><span class="ntdfn" id="optional-type-descriptor">optional-type-descriptor</span> := <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> <code>?</code>
</pre>
<p>
A type <code><var>T</var>?</code> means the union of <code><var>T</var></code>
and <code>()</code>. It is completely equivalent to
<code><var>T</var>|()</code>.
</p>
</section>

<section>
<h4 id="anydata">5.6.10 Anydata type</h4>

<pre class="grammar"><span class="ntdfn" id="anydata-type-descriptor">anydata-type-descriptor</span> := <code>anydata</code>
</pre>
<p>
The type descriptor <code>anydata</code> describes the type of plain data. The
type <code>anydata</code> contains a shape if and only if it is the shape of a
value that is plain data. The <code>anydata</code> type can thus be defined as:
</p>

<pre>  () | boolean | int | float | decimal
    | string | xml
    | anydata[] | map&lt;anydata&gt; | table&lt;map&lt;anydata&gt;&gt;
</pre>
</section>
<section>
<h4 id="section_5.6.11">5.6.11 JSON types</h4>

<pre class="grammar"><span class="ntdfn" id="json-type-descriptor">json-type-descriptor</span> := <code>json</code>
</pre>
<p>
The <code>json</code> type is designed for processing data expression in JSON
format. It is a built-in name for a union defined as follows:
</p>
<pre>type json = () | boolean | int | float | decimal | string | json[] | map&lt;json&gt;;
</pre>
<p>
In addition, the <code>json</code> type is defined to have <a href="#lax_static_typing">lax static typing</a>.
</p>

</section>

<section>
<h4 id="byte_type">5.6.12 Byte type</h4>

<pre class="grammar"><span class="ntdfn" id="byte-type-descriptor">byte-type-descriptor</span> := <code>byte</code>
</pre>
<p>
The byte type is a predefined name for a union of the int values in the range 0
to 255 inclusive. It is equivalent to the <a href="#built-in_subtypes">built-in
subtype</a> <code>int:Unsigned8</code>.
</p>
</section>

</section>
<section>
<h3 id="built-in_object_types">5.7 Built-in object types</h3>
<p>
There are several object types that are built-in in the sense that the
language treats objects with these types specially. There are two kinds of
object type:
</p>
<ul>
<li>purely structural types; the name of the type is internal to this
specification and not exposed to the language;</li>
<li>distinct types; the name of the type is defined in a lang library
module.</li>
</ul>

<section>
<h4 id="section_5.7.1">5.7.1 Iterator</h4>
<p>
A value of iterable type with iteration value type T and iteration completion
type C provides a way of creating an iterator object that belongs to the object
type
</p>

<pre>    object {
       public function next() returns record {| T value; |}|C;
    }
</pre>
<p>
In this specification, we refer to this type as Iterator&lt;T,C&gt;.
</p>
<p>
Conceptually an iterator is at a position between members of the iteration sequence. 
Possible positions are at the beginning (immediately before the first member if
any), between members and at the end (immediately after the last member if any).
A newly created iterator is at the beginning position. For an empty sequence,
there is only one possible position which is both at the beginning and at the
end.
</p>
<p>
The <code>next()</code> method behaves as follows:
</p>
<ul>
<li>if the iteration has encountered an error, return an error value</li>
<li>otherwise, if the iterator has completed successfully by reaching the end
position without an error, return nil</li>
<li>otherwise
<ul>
<li>move the iterator to next position, and</li>
<li>return a record <code>{ value: v }</code> where v is the member of the
sequence between the previous position and the new position</li>
</ul>
</li>
</ul>
<p>
Mutation of a structured value during iteration is handled as follows. A call to
<code>next()</code> must panic if there has been any mutation to the structured
value since the iterator was created other than the following:</p>
<ul>
<li>removing a member of the structured value that a preceding call to the
iterator has already returned;</li>
<li>changing the member associated with an existing key.</li>
</ul>
<p>
In the latter case, <code>next()</code> must return the value associated with
the key at the point when <code>next()</code> is called.
</p>
<p>
Note that it is not possible for the <code>next()</code> method simply to return
the values in the iteration sequence, since there would be no way to distinguish
a nil or error value that is part of the iteration sequence from a nil or error
value that represents the result of the iteration.
</p>
</section>
<section>
<h4 id="section_5.7.2">5.7.2 Iterable</h4>
<p>
An object belongs to the object type Iterable&lt;T,C&gt; if it has a
method named <code>iterator</code> with no arguments and a return type that is
subtype of Iterator&lt;T,C&gt; and it belongs to the distinct type
<code>Iterable</code> defined in <code>lang.object</code>. An object that
belongs to Iterable&lt;T,C&gt; is iterable: the object returned by the
<code>iterator</code> method determines the iteration sequence and iteration
completion value.
</p>
</section>
<section>
<h4 id="StreamImplementor">5.7.3 StreamImplementor</h4>
<p>
An object belongs to the object type StreamImplementor&lt;T,C&gt; if it
belongs to Iterator&lt;T,C&gt; and also optionally has a method
<code>close()</code> with return value <code>C?</code>. This is equivalent to
belonging to the following type.
</p>

<pre>    object {
       public isolated function next() returns record {| T value; |}|C;
    }
    | object {
       public isolated function next() returns record {| T value; |}|C;
       public isolated function close() returns C?;
    }
</pre>

<p>
The close method says that there will be no more calls to the next method. Any
call to a next method after the close method has been called must result in a
panic. A missing close method behaves like a close method that puts the object
into a closed state, in which calls to next will result in a panic, and then
immediately returns <code>()</code>.
</p>

</section>
<section>
<h4 id="section_5.7.4">5.7.4 Listener</h4>
<p>
The object type Listener&lt;T,A&gt;, where T is a a subtype of <code>service
object {}</code> and A is a subtype of <code>string[]|string|()</code>, is
described by the following object type descriptor:
</p>

<pre>object {
   public function attach(T svc, A attachPoint) returns error?;
   public function detach(T svc) returns error?;
   public function 'start() returns error?;
   public function gracefulStop() returns error?;
   public function immediateStop() returns error?;
}
</pre>
<p>
The role of a Listener is to handle incoming network messages by making
calls on service objects as described in <a href="#listeners_and_services">Listeners and services</a>. Each method is used
as follows:
</p>
<ul>
<li>the <code>attach</code> method is used to provide the Listener with a
service object that it can use to handle incoming network messages; the
<code>attachPoint</code> argument is used to identify which network messages the
service object should be used for;</li>
<li>the <code>detach</code> method tells the Listener to stop using a service
object that was previously provided using the <code>attach</code> method;</li>
<li>the <code>start</code> method tells the Listener to start handling incoming
network messages;</li>
<li>the <code>gracefulStop</code> and <code>immediateStop</code> messages tell
the Listener to stop handling incoming network messages;
<ul>
<li>in the case of <code>gracefulStop</code>, the listener should complete the
handling of any incoming messages that it has started to handle; in particular,
it should wait for the completion of any strands that it created to execute
service object methods;</li>
<li>in the case of <code>immediateStop</code>, the listener should not try to
complete the hanlding of any incoming messages that is has started to handle; in
particular, it should cancel any strands that it created to execute service
object methods.</li>
</ul>
</li>
</ul>
<p> 
Each method returns an error value if an error occurred, and return nil
otherwise. The listener object is responsible for creating and keeping track of
any strands that it needs.
</p>
<p>
A type is a <em>listener object type</em> if it is a subtype of the object type
Listener&lt;T,A&gt;, for some type T that is a subtype of <code>service object
{}</code> and some type A that is a subtype of <code>string[]|string|()</code>.
</p>
</section>
<section>
<h4 id="section_5.7.5">5.7.5 RawTemplate</h4>
<p>
The RawTemplate type describes the type of object constructed by a raw template
expression. The type is defined in <code>lang.object</code> as follows.
</p>
<pre>distinct object {
    public (readonly &amp; string[]) strings;
    public (any|error)[] insertions;
}
</pre>

</section>
<section>
<h4 id="section_5.7.6">5.7.6 RetryManager</h4>

<p>
Classes of type RetryManager are defined by the application to allow control
over retries performed by the retry statement and retry transaction statement
The object type RetryManager&lt;E&gt;, where E is a a subtype of
<code>error</code>, is described by the following object type descriptor:
</p>

<pre>object {
   public function shouldRetry(E e) returns boolean;
}
</pre>
<p>
Note that RetryManager&lt;E&gt; is contravariant in E i.e. RetryManager&lt;E&gt;
is a subtype of RetryManager&lt;E'&gt; if and only if E' is a subtype of E.
</p>

</section>

</section>
<section>
<h3 id="section_5.8">5.8 Abstract operations</h3>
<p>
These section specifies a number of operations that can be performed on values.
These operations are for internal use by the specification. These operations are
named in CamelCase with an initial upper-case letter to distinguish them from
functions in the lang library.
</p>
<section>
<h4 id="FillMember">5.8.1 FillMember</h4>
<p>
The FillMember(s, k) operation is defined for a structured value s and an
out-of-line key value k. It can be performed when s does not have a member with
key k; if it succeeds, it will result in a member with key k being added to s.
It will succeed if the inherent type of s allows the addition of a member with
key k and there is a way to construct a filler value for the type descriptor
that the inherent type of s requires for member k. The following table specifies
when and how a filler value can be constructed for a type descriptor.
</p>
<table>
<tr>
<th>Type descriptor</th>
<th>Filler value</th>
<th>When available</th>
</tr>
<tr>
<td><code>()</code></td>
<td><code>()</code></td>
<td></td>
</tr>
<tr>
<td><code>boolean</code></td>
<td><code>false</code></td>
<td></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>0</code></td>
<td></td>
</tr>
<tr>
<td><code>float</code></td>
<td><code>+0.0f</code></td>
<td></td>
</tr>
<tr>
<td><code>decimal</code></td>
<td><code>+0d</code></td>
<td></td>
</tr>
<tr>
<td><code>string</code></td>
<td><code>""</code></td>
<td></td>
</tr>
<tr>
<td>array or tuple type descriptor</td>
<td><code>[]</code></td>
<td>if that is a valid constructor for the type</td>
</tr>
<tr>
<td>map or record type descriptor</td>
<td><code>{ }</code></td>
<td>if that is a valid constructor for the type</td>
</tr>
<tr>
<td><code>readonly &amp; T</code></td>
<td>the filler value for T constructed as read-only</td>
<td>if that belongs to the type</td>
</tr>
<tr>
<td>table</td>
<td>empty table (with no rows)</td>
<td></td>
</tr>
<tr>
<td>object</td>
<td><code>new T()</code></td>
<td>if T is a class, where T is the type descriptor for the object, and the
static type of T's init method allows no arguments and does not include error</td>
</tr>
<tr>
<td>stream</td>
<td>empty stream</td>
<td></td>
</tr>
<tr>
<td><code>xml</code></td>
<td><code>xml``</code></td>
<td></td>
</tr>
<tr>
<td>built-in subtype of <code>xml</code>
</td>
<td><code>xml``</code></td>
<td>if this belongs to the subtype, i.e. if the subtype is
<code>xml:Text</code>
</td>
</tr>
<tr>
<td>singleton</td>
<td>the single value used to specify the type</td>
<td></td>
</tr>
<tr>
<td rowspan="2">union</td>
<td><code>()</code></td>
<td>if <code>()</code> is a member of the union</td>
</tr>
<tr>
<td>the filler value for basic type B</td>
<td>if all members of the union belong to a single basic type B,
and the filler value for B also belongs to the union</td>
</tr>
<tr>
<td><code>T?</code></td>
<td><code>()</code></td>
<td></td>
</tr>
<tr>
<td><code>any</code></td>
<td><code>()</code></td>
<td></td>
</tr>
<tr>
<td><code>anydata</code></td>
<td><code>()</code></td>
<td></td>
</tr>
<tr>
<td><code>byte</code></td>
<td><code>0</code></td>
<td></td>
</tr>
<tr>
<td>built-in subtype of <code>int</code>
</td>
<td><code>0</code></td>
<td></td>
</tr>
<tr>
<td><code>json</code></td>
<td><code>()</code></td>
<td></td>
</tr>
</table>

</section>
<section>
<h4 id="Cloning">5.8.2 Cloning</h4>
<p>
There are two cloning operations. Both of these operate on values belonging to the
Cloneable type defined as follows:
</p>
<pre>
public type Cloneable readonly|xml|Cloneable[]|map&lt;Cloneable&gt;|table&lt;map&lt;Cloneable&gt;&gt;;
</pre>
<p>
This type is defined in the lang.value module of the lang library. In this document,
the type will be referred to as <code>value:Cloneable</code>.
</p>

<section>
<h5 id="Clone">5.8.2.1 Clone</h5>
<p>
Clone(v) is defined for any value v that belongs to the type
<code>value:Cloneable</code>. It performs a deep copy, recursively copying all
structural values and their members and recursively copying all sequence values
and their constituents. Clone(v) for an immutable value v returns v. If v is of
a basic type that has an inherent type, Clone(v) has the same inherent type as
v. The graph of references of Clone(v) must have the same structure as that of
v. This implies that the number of distinct references reachable from Clone(v)
must be the same as the number of distinct references reachable from v. Clone(v)
must terminate even if v has cycles.
</p>
<p>
Clone(v) cannot be implemented simply by recursively calling Clone on all
members of v. Rather Clone must maintain a map that records the result of
cloning each reference value. When a Clone operation starts, this map as empty.
When cloning a reference value, it must use the result recorded in the map if
there is one.
</p>
<p>
The Clone operation is exposed by the <code>clone</code> function in the
lang.value module of the lang library.
</p>
</section>
<section>
<h5 id="ImmutableClone">5.8.2.2 ImmutableClone</h5>
<p>
ImmutableClone(v) is defined for any value v that belongs to the type
<code>value:Cloneable</code>. It performs a deep copy of v similar to Clone(v),
except that newly constructed values will be constructed as immutable and so
have their read-only bit on. Any immutable value is not copied. So the result
of Immutable always has its read-only bit on.
</p>
<p>
Like Clone, ImmutableClone must preserve graph structure, including cycles.
Conceptually the whole graph is constructed before being made immutable.
</p>
<p>
The ImmutableClone operation is exposed by the <code>cloneReadOnly</code>
function in the lang.value module of the lang library.
</p>
</section>
</section>
<section>
<h4 id="DeepEquals">5.8.3 DeepEquals</h4>
<p>
DeepEquals(v1, v2) is defined for any values v1, v2 that belong to type anydata.
It returns true or false depending of whether the primary aspect of the shape v1
and of v2 are the same. In other words, DeepEquals returns true if and only if
the values are the same ignoring whether read-only bits are on or off.
DeepEquals(v1, v2) must terminate for any values v1 and v2 of type anydata, even
if v1 or v2 have cycles. DeepEquals(v1, v2) returns true if v1 and v2 have the
same shape, even if the graphs of references of v1 and v2 have different
structures. If two values v1 and v2 have different basic types, then
DeepEquals(v1, v2) will be false.
</p>
<p>
The possibility of cycles means that DeepEquals cannot be implemented simply by
calling DeepEquals recursively on members. Rather DeepEquals must maintain a
mapping that records for each pair of references whether it is already in
process of comparing those references. When a DeepEquals operation starts, this
map is empty. Whenever it starts to compare two references, it should see
whether it has already recorded that pair (in either order), and, if it has,
proceed on the assumption that they compare equal.
</p>
<p>
DeepEquals(Clone(x), x) is guaranteed to be true for any value of type anydata.
</p>
</section>
<section>
<h4 id="section_5.8.4">5.8.4 NumericConvert</h4>
<p>
NumericConvert(t, v) is defined if t is the typedesc for float, decimal or int,
and v is a numeric value. It converts v to a value in t, or returns an error,
according to the following table.
</p>
<table>
  <tr>
   <td>from \ to</td>
   <td>float</td>
   <td>decimal</td>
   <td>int</td>
  </tr>
  <tr>
   <td>float</td>
   <td>unchanged</td>
   <td>closest math value</td>
   <td rowspan="2">round, error for NaN or out of int range</td>
  </tr>
  <tr>
   <td>decimal</td>
   <td>closest math value</td>
   <td>unchanged</td>
  </tr>
  <tr>
   <td>int</td>
   <td>same math value</td>
   <td>same math value</td>
   <td>unchanged</td>
  </tr>
</table>
</section>
<section>
<h4 id="ToString">5.8.5 ToString</h4>
<p>
ToString(v,style) converts a value to a string in one of three styles. The
conversion can be performed in one of three styles, specified by the style
parameter, which are as follows.
</p>
<ul>
<li>expression style: produces a string that looks like a Ballerina expression; there are
two cases
<ul>
<li>when v belongs to anydata and does not have cycles, it will produce a string that
is a valid Ballerina expression, such that evaluating that string will result in a value v'
for which DeepEquals(v, v') is true</li>
<li>otherwise, it will produce a string that is either not a valid Ballerina expression
or is a valid Ballerina expression that evaluates to a value that does not belong type type anydata</li>
</ul>
</li>
<li>informal style: similar to expression style, but does not preserve all the distinctions that
expression style does, and avoids syntax that requires a knowledge of Ballerina</li>
<li>direct style: this does a direct conversion of the value to a string rather than producing
a string that describes the value
<ul>
<li>if v is a string, then the result of ToString(v,direct) is v</li>
<li>if v is XML, then the result of ToString(v,direct) is v in XML syntax</li>
<li>direct style falls back to informal style for basic types where there is no
other natural more direct conversion</li>
</ul>
</li>
</ul>
<p>
The following table summarizes the result of ToString(v,style) for each basic type.
</p>
<table>
  <tr>
   <td rowspan="2">Basic type of v
   </td>
   <td colspan="3">style
   </td>
  </tr>
  <tr>
   <td>expression
   </td>
   <td>informal
   </td>
   <td>direct
   </td>
  </tr>
  <tr>
   <td>nil
   </td>
   <td>
<code>()</code>
   </td>
   <td>
<code>null</code>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>true
   </td>
   <td colspan="3">
<code>true</code>
   </td>
  </tr>
  <tr>
   <td>int
   </td>
   <td colspan="3">
<code>2</code>
   </td>
  </tr>
  <tr>
   <td rowspan="3">float
   </td>
   <td colspan="3">
<code>1.0</code>
   </td>
  </tr>
  <tr>
   <td>
<code>float:NaN</code>
   </td>
   <td colspan="2">
<code>NaN</code>
   </td>
  </tr>
  <tr>
   <td>
<code>float:Infinity</code>
   </td>
   <td colspan="2">
<code>Infinity</code>
   </td>
  </tr>
  <tr>
   <td rowspan="2">decimal
   </td>
   <td>
<code>1d</code>
   </td>
   <td colspan="2">
<code>1</code>
   </td>
  </tr>
  <tr>
   <td>
<code>1.20d</code>
   </td>
   <td colspan="2">
<code>1.20</code>
   </td>
  </tr>
  <tr>
   <td>string
   </td>
   <td colspan="2">
<code>"xyz"</code>
   </td>
   <td>
<code>xyz</code>
   </td>
  </tr>
  <tr>
   <td>xml
   </td>
   <td>
<code>xml`&lt;d&gt;t&lt;/d&gt;`</code>
   </td>
   <td>
<code>`&lt;d&gt;t&lt;/d&gt;`</code>
   </td>
   <td>
<code>&lt;d&gt;t&lt;/d&gt;</code>
   </td>
  </tr>
  <tr>
   <td rowspan="2">array
   </td>
   <td colspan="3">
<code>[<var>X</var>,<var>Y</var>]</code>
   </td>
  </tr>
  <tr>
   <td>
<var>X</var>, <var>Y</var> expression style
   </td>
   <td colspan="2">
<var>X</var>,<var>Y</var> informal style
   </td>
  </tr>
  <tr>
   <td rowspan="2">map
   </td>
   <td colspan="3">
<code>{"x":<var>X</var>,"y":<var>Y</var>}</code>
   </td>
  </tr>
  <tr>
   <td>
<var>X</var>, <var>Y</var> expression style
   </td>
   <td colspan="2">
<var>X</var>,<var>Y</var> informal style
   </td>
  </tr>
  <tr>
   <td rowspan="2">table
   </td>
   <td>
<code>table key(k) [<var>R<sub>1</sub></var>,<var>R<sub>2</sub></var>]</code>
   </td>
   <td colspan="2">
<code>[<var>R<sub>1</sub></var>,<var>R<sub>2</sub></var>]</code>
   </td>
  </tr>
  <tr>
   <td>
<var>R<sub>1</sub></var>,<var>R<sub>2</sub></var> expression style
   </td>
   <td colspan="2">
<var>R<sub>1</sub></var>,<var>R<sub>2</sub></var> informal style
   </td>
  </tr>
  <tr>
   <td rowspan="3">error
   </td>
   <td colspan="3">
<code>error D<sub>1</sub>&amp;D<sub>2</sub> (M,C,F<sub>1</sub>=V<sub>1</sub>,F<sub>2</sub>=V<sub>2</sub>)</code>
   </td>
  </tr>
  <tr>
   <td>V<sub>1</sub>, V<sub>2</sub> expression style, D<sub>1</sub>,D<sub>2</sub>  in the form <code>{<var>module-id</var>}<var>local-id</var></code>, M expression style, C expression style
   </td>
   <td colspan="2">V<sub>1</sub>, V<sub>2</sub> informal style, just local id of D<sub>1</sub>,D<sub>2</sub>, M informal style, C informal style
   </td>
  </tr>
  <tr>
   <td colspan="3">D<sub>1</sub>,D<sub>2</sub> are type-ids, M is the error message, C is the error cause, F<sub>1</sub>=V<sub>1</sub>,F<sub>2</sub>=V<sub>2</sub> are field names and values of the error detail
   </td>
  </tr>
  <tr>
   <td>object w/o toString method
   </td>
   <td colspan="3">
<code>object D1&amp;D2 U</code> where U is an identifier that uniquely identifies the object (objects will have the same identifier only if they are <code>===</code>)
   </td>
  </tr>
  <tr>
   <td rowspan="2">object with toString method
   </td>
   <td>
<code>object S</code>
   </td>
   <td colspan="2">
<code>S</code>
   </td>
  </tr>
  <tr>
    <td colspan="3">
<code>S</code> in direct style where S is the result of calling the toString method</td>
  </tr>
  <tr>
   <td rowspan="2">
<em>cycle detected</em>
   </td>
   <td>
<code>...[N]</code>
   </td>
   <td colspan="2">
<code>...</code>
   </td>
  </tr>
  <tr>
   <td>N is 0-based index down path from root object to object where cycle is detected
   </td>
   <td colspan="2">
   </td>
  </tr>
</table>
</section>
<section>
<h4 id="ordering">5.8.6 Ordering</h4>
<p>
There are three abstract operations related to ordering: Compare(x, y),
CompareA(x, y), CompareD(x, y). CompareA(x, y) and CompareD(x, y), which are
used to define sorting, return one of the values LT, EQ, GT representing the
cases where x is less than, equal to or greater than y. Compare(x, y), which is
used to define the relational operators, can also return the value UN to
represent the case where x is unordered with respect to y; this is used to deal
with NaN.
</p>
<p>
The three operations are related as follows: Compare(x, y) is the same as
CompareA(x, y) and CompareD(x, y) unless Compare(x, y) is UN.
</p>
<p>
A type is ordered if all the values that belong to the type can be compared to
each other using the above three abstract operations. Thus each of the abstract
operations are defined when there is an ordered type to which both arguments
belong.
</p>
<p>
If C is any of the three abstract operations, and there is an ordered type to
which both x and y belong, then:
</p>
<ul>
<li>C(x, y) is LT if and only if C(y, x) is GT</li>
<li>C(x, y) is EQ if and only if C(y, x) is EQ</li>
<li>C(x, y) is UN if and only if C(y, x) is UN</li>
</ul>
<p>
The most straightforward ordered types are basic types where all the values of
the type can be put into an order. These types are boolean, int, string. For
each of these three types, for any pair of values x, y belonging to the type
</p>
<ul>
<li>Compare(x, y) is EQ if x and y are the same value</li>

<li>Compare(x, y) is LT in the following cases: 
<ul>
<li>for int, if x is mathematically less than y</li>
<li>for boolean, if x is false and y is true</li>
<li>for string, if x is lexicographically less than y in Unicode code point
order, more precisely, if
<ul>
<li>x is an proper initial substring of y, or</li>
<li>for the first index at which x and y differ, the code point at that index in
x is less than the code point at that index in y</li>  
</ul>
</li>  
</ul>
</li>
<li>CompareA(x,y), and CompareD(x,y) have the same value as Compare(x, y)</li>
</ul>
<p>
The basic type decimal is ordered. The abstract operations are defined the same
as for int, except that Compare(x, y) is EQ if x and y have the same shape. In
other words, the compare operations ignore precision.
</p>
<p>
The basic type float is also ordered. Compare(x,y) is as defined by IEEE
754-2008 clause 5.11. In particular:
</p>
<ul>
<li>the Compare operation does not distinguish +0 from -0 i.e.
Compare(-0.0,+0.0) is EQ</li>
<li>Compare(x, y) is UN if x or y or both is NaN</li>
</ul>
<p>
When x and y belong to type float, CompareA(x, y) and CompareD(x, y) differ from
Compare(x, y) as follows:
</p>
<ul>
<li>CompareA(NaN,NaN) and CompareD(NaN, NaN) are EQ</li>
<li>CompareA(x, NaN) is LT if x is not NaN</li>
<li>CompareD(NaN, x) is LT if x is not NaN</li>
</ul>
<p>
If type T is ordered, then type T? Is also ordered. Comparison operations
involving nil are defined as follows:
</p>
<ul>
<li>Compare((),()), CompareA((),()) and CompareD((),()) are all EQ</li>
<li>Compare(x,()) is UN if x is not ()</li>
<li>CompareA(x,()) is LT if x is not ()</li>
<li>CompareA((), x) is LT if x is not ()</li>
</ul>
<p>
The CompareA operation is used for sorting in ascending order; the CompareD
operation is used in reverse for sorting in descending order. The net effect of
the above rules is thus that both () and NaN will appear at the end of a sorted
list, with NaN before (), in both ascending and descending order.
</p>
<p>
The following rules determine when a subtype of list is ordered:
</p>
<ul>
<li>[T...]  is ordered, if T is ordered;</li>
<li>[] is ordered;</li>
<li>[T, rest] is ordered if T is ordered and [rest] is ordered.</li>
</ul>
<p>
Each of the three abstract operations C are extended to apply to lists as
follows:
</p>
<ul>
<li>C([], []) is EQ;</li>
<li>C([], [y1,...]) is LT;</li>
<li>C([x1,x2,...],[y1, y2...]) is r unless r is EQ and otherwise C([x2,...],[y2,...]), where r is C(x1, y1).</li>
</ul>
</section>
</section>
<section>
<h3 id="section_5.9">5.9 Binding patterns and variables</h3>
<section>
<h4 id="section_5.9.1">5.9.1 Binding patterns</h4>
<p>
Binding patterns are used to support destructuring, which allows different parts
of a single structured value each to be assigned to separate variables at the
same time.
</p>

<pre class="grammar"><span class="ntdfn" id="binding-pattern">binding-pattern</span> :=
   <a href="#capture-binding-pattern"><span class="ntref">capture-binding-pattern</span></a>
   | <a href="#wildcard-binding-pattern"><span class="ntref">wildcard-binding-pattern</span></a>
   | <a href="#list-binding-pattern"><span class="ntref">list-binding-pattern</span></a>
   | <a href="#mapping-binding-pattern"><span class="ntref">mapping-binding-pattern</span></a>
   | <a href="#error-binding-pattern"><span class="ntref">error-binding-pattern</span></a>
<span class="ntdfn" id="capture-binding-pattern">capture-binding-pattern</span> := <a href="#variable-name"><span class="ntref">variable-name</span></a>
<span class="ntdfn" id="variable-name">variable-name</span> := <a href="#identifier"><span class="ntref">identifier</span></a>
<span class="ntdfn" id="wildcard-binding-pattern">wildcard-binding-pattern</span> := <code>_</code>
<span class="ntdfn" id="list-binding-pattern">list-binding-pattern</span> := <code>[</code> <a href="#list-member-binding-patterns"><span class="ntref">list-member-binding-patterns</span></a> <code>]</code>
<span class="ntdfn" id="list-member-binding-patterns">list-member-binding-patterns</span> :=
   <a href="#binding-pattern"><span class="ntref">binding-pattern</span></a> (<code>,</code> <a href="#binding-pattern"><span class="ntref">binding-pattern</span></a>)* [<code>,</code> <a href="#rest-binding-pattern"><span class="ntref">rest-binding-pattern</span></a>]
   | [ <a href="#rest-binding-pattern"><span class="ntref">rest-binding-pattern</span></a> ]
<span class="ntdfn" id="mapping-binding-pattern">mapping-binding-pattern</span> := <code>{</code> <a href="#field-binding-patterns"><span class="ntref">field-binding-patterns</span></a> <code>}</code>
<span class="ntdfn" id="field-binding-patterns">field-binding-patterns</span> :=
   <a href="#field-binding-pattern"><span class="ntref">field-binding-pattern</span></a> (<code>,</code> <a href="#field-binding-pattern"><span class="ntref">field-binding-pattern</span></a>)* [<code>,</code> <a href="#rest-binding-pattern"><span class="ntref">rest-binding-pattern</span></a>]
   | [ <a href="#rest-binding-pattern"><span class="ntref">rest-binding-pattern</span></a> ] 
<span class="ntdfn" id="field-binding-pattern">field-binding-pattern</span> :=
   <a href="#field-name"><span class="ntref">field-name</span></a> <code>:</code> <a href="#binding-pattern"><span class="ntref">binding-pattern</span></a>
   | <a href="#variable-name"><span class="ntref">variable-name</span></a>
<span class="ntdfn" id="rest-binding-pattern">rest-binding-pattern</span> := <code>...</code> <a href="#variable-name"><span class="ntref">variable-name</span></a>
<span class="ntdfn" id="error-binding-pattern">error-binding-pattern</span> := <code>error</code> [<a href="#error-type-reference"><span class="ntref">error-type-reference</span></a>] <code>(</code> <a href="#error-arg-list-binding-pattern"><span class="ntref">error-arg-list-binding-pattern</span></a> <code>)</code>
<span class="ntdfn" id="error-type-reference">error-type-reference</span> := <a href="#type-reference"><span class="ntref">type-reference</span></a>
<span class="ntdfn" id="error-arg-list-binding-pattern">error-arg-list-binding-pattern</span> :=
   <a href="#error-message-binding-pattern"><span class="ntref">error-message-binding-pattern</span></a> [<code>,</code> <a href="#error-cause-binding-pattern"><span class="ntref">error-cause-binding-pattern</span></a>] [<code>,</code> <a href="#error-field-binding-patterns"><span class="ntref">error-field-binding-patterns</span></a>]
   | [<a href="#error-field-binding-patterns"><span class="ntref">error-field-binding-patterns</span></a>]
<span class="ntdfn" id="error-message-binding-pattern">error-message-binding-pattern</span> := <a href="#simple-binding-pattern"><span class="ntref">simple-binding-pattern</span></a> 
<span class="ntdfn" id="error-cause-binding-pattern">error-cause-binding-pattern</span> := <a href="#simple-binding-pattern"><span class="ntref">simple-binding-pattern</span></a> | <a href="#error-binding-pattern"><span class="ntref">error-binding-pattern</span></a>
<span class="ntdfn" id="simple-binding-pattern">simple-binding-pattern</span> := <a href="#capture-binding-pattern"><span class="ntref">capture-binding-pattern</span></a> | <a href="#wildcard-binding-pattern"><span class="ntref">wildcard-binding-pattern</span></a>
<span class="ntdfn" id="error-field-binding-patterns">error-field-binding-patterns</span> :=
   <a href="#named-arg-binding-pattern"><span class="ntref">named-arg-binding-pattern</span></a> (<code>,</code> <a href="#named-arg-binding-pattern"><span class="ntref">named-arg-binding-pattern</span></a>)* [<code>,</code> <a href="#rest-binding-pattern"><span class="ntref">rest-binding-pattern</span></a>]
   | <a href="#rest-binding-pattern"><span class="ntref">rest-binding-pattern</span></a>
<span class="ntdfn" id="named-arg-binding-pattern">named-arg-binding-pattern</span> := <a href="#arg-name"><span class="ntref">arg-name</span></a> <code>=</code> <a href="#binding-pattern"><span class="ntref">binding-pattern</span></a>
</pre>
<p>
A binding pattern may succeed or fail in matching a value. A successful match
causes values to be assigned to all the variables occurring the binding-pattern.
</p>
<p>
A binding pattern matches a value in any of the following cases.
</p>
<ul>
<li>a capture-binding-pattern always matches a value and causes the matched
value to be assigned to named variable;</li>
<li>a wildcard-binding-pattern matches a value if the value belongs to type any,
in other words if the basic type of the value is not error; it does not cause
any assignments to be made;</li>
<li>a list-binding-pattern with m binding patterns matches a list with n
members if m is less than or equal to n, and the i-th binding pattern matches
the i-th member of the list for each i in 1 to m, and either m is equal to n or
the list-binding-pattern includes a rest-binding-pattern; if there is a
rest-binding-pattern <code>...v</code>, then a successful match causes a new
list value consisting of all members of the matched list except for the the
first m values to be assigned to <code>v</code>;</li>
<li>a mapping-binding-pattern { f<sub>1</sub>: p<sub>1</sub>, f<sub>2</sub>:
p<sub>2</sub>, ..., f<sub>n</sub>: p<sub>n</sub>, r } matches a mapping value m
that includes fields f<sub>1</sub>, f<sub>2</sub>, ... , f<sub>n</sub> if
p<sub>i</sub> matches the value of field f<sub>i</sub> for each i in 1 to n; if
r is <code>...v</code> then a successful match causes a new mapping value
consisting of all the other fields to be assigned to <code>v</code>; a
field-binding-pattern consisting of just a variable-name <code>x</code> is
equivalent to a field-binding-pattern <code>x: x</code>;
</li>
<li>an error-binding-pattern error ET(p<sub>m</sub>, p<sub>c</sub>,
f<sub>1</sub> = p<sub>1</sub>, f<sub>2</sub> = p<sub>2</sub>, ..., f<sub>n</sub>
= p<sub>n</sub>, r) matches an error value e if
<ul>
<li>e has a message that matches p<sub>m</sub>,</li>
<li>if p<sub>c</sub> is present, e has a cause that matches p<sub>c</sub>,</li>
<li>e has a detail record that has fields f<sub>1</sub>, f<sub>2</sub>, ... ,
f<sub>n</sub> such that p<sub>i</sub> matches the value of field f<sub>i</sub>
for each i in 1 to n,</li>
<li>if ET is present, the shape of e is in ET,</li>
<li>if r is <code>...v</code>, then a successful match causes a new mapping
value consisting of all fields of the detail record other than f<sub>1</sub>,
f<sub>2</sub>, ... , f<sub>n</sub> to be assigned to <code>v</code>;</li>
</ul>
</li>
</ul>
<p>
All the variables in a binding-pattern must be distinct e.g. [x, x] is not
allowed.
</p>
<p>
Given a type descriptor for every variable in a binding-pattern, there is a type
descriptor for the binding-pattern that will contain a value just in case that
the binding pattern successfully matches the value causing each variable to be
assigned a value belonging to the type descriptor for that variable.
</p>
<ul>
<li>for a capture-binding-pattern, the type descriptor is the type descriptor
for that variable;</li>
<li>for a wildcard-binding-pattern, the type descriptor is any</li>
<li>for a list-binding-pattern, the type descriptor is a tuple type descriptor;</li>
<li>for a mapping-binding-pattern, the type descriptor is a record type
descriptor;</li>
<li>for an error-binding-pattern, the type descriptor is an error type
descriptor.</li>
</ul>

</section>
<section>
<h4 id="section_5.9.2">5.9.2 Typed binding patterns</h4>

<pre class="grammar"><span class="ntdfn" id="typed-binding-pattern">typed-binding-pattern</span> := <a href="#inferable-type-descriptor"><span class="ntref">inferable-type-descriptor</span></a> <a href="#binding-pattern"><span class="ntref">binding-pattern</span></a>
<span class="ntdfn" id="inferable-type-descriptor">inferable-type-descriptor</span> := <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> | <code>var</code>
</pre>
<p>
A typed-binding-pattern combines a type-descriptor and a binding-pattern, and is
used to create the variables occurring in the binding-pattern. If
<code>var</code> is used instead of a type-descriptor, it means the type is
inferred.
</p>
<p>
There are two ways in which a typed-binding-pattern can be used.
</p>
<ul>
<li>
<em>Single use</em>. In the language syntax, this kind of use of a
typed-binding-pattern is usually followed by <code>=</code> (the only case where
it is not followed by <code>=</code> is when it follows <code>on fail</code>).
The typed-binding-pattern is matched once against the result of evaluating an
expression. When <code>var</code> is used, the type is inferred from the static
type of the expression (in the <code>on fail</code> case there can be multiple
expressions from which it is inferred); in this case, it is an error if the
intersection of <code>error</code> and the inferred type is non-empty, the
binding-pattern of the typed-binding-pattern is a capture-binding-pattern, and
the variable referenced in the capture-binding-pattern is not used. It is an
error if the type-descriptor in the typed-binding-pattern is
<code>never</code>.</li>
<li>
<em>Iterative use</em>. In the language syntax, this kind of use of a
typed-binding-pattern is followed by the <code>in</code> keyword. An iterator is
created from the result of evaluating an expression, and the
typed-binding-pattern is matched against each value returned by the iterator.
When <code>var</code> is used, the type is inferred to be T, where the static
type of the expression is an iterable type with value type T.</li>
</ul>
<p>
The simplest and most common form of a typed-binding-pattern is for the binding
pattern to consist of just a variable name. In this case, the variable is
constrained to contain only values matching the type descriptor.
</p>
<p>
When the binding pattern is more complicated, the binding pattern must be
consistent with the type-descriptor, so that the type-descriptor unambiguously
determines a type for each variable occurring in the binding pattern. A binding
pattern occurring in a typed-binding-pattern must also be irrefutable with
respect to the type of value against which it is to be matched. In other words,
the compiler will ensure that matching such a binding pattern against a value
will never fail at runtime.
</p>
</section>
<section>
<h4 id="section_5.9.3">5.9.3 Variable and identifier scoping</h4>
<p>
For every variable, there is place in the program that declares it. Variables
are lexically scoped: every variable declaration has a scope which determines
the region of the program within which the variable can be referenced.
</p>
<p>
There are two kinds of scope: module-scope and block-scope. A variable with
module-scope can be referenced anywhere within a module; if declared
<code>public</code>, it can also be referenced from outside the module.
</p>
<p>
Identifiers with module-scope are used to identify not only variables but other
module-level entities such as functions. Within module-scope, identifiers are
separated into three symbol spaces:
</p>
<ul>
<li>the <em>main</em> symbol space includes identifiers for variables,
constants, types, functions and other identifiers that do not belong to any of
the other two symbol spaces;</li>
<li>the <em>prefix</em> symbol space contains prefixes declared by import
declarations and XML namespace declaration statements;</li>
<li>the <em>annotation tag</em> symbol space contains annotation tags declared
by annotation declarations.</li>
</ul>
<p>
The prefix symbol space is special in that it is associated with a source part
rather than a module.
</p>
<p>
Block-scope is divided into symbol spaces in the same way as module-scope,
except that block-scope does not have a symbol space for annotation tags, since
annotation tags cannot be declared with block-scope.
</p>
<p>
An identifier declared with block-scope can be referenced only within a
particular block (always delimited with curly braces). Block-scope variables are
created by a variety of different constructs, many of which use a
typed-binding-pattern. Parameters are treated as read-only variables with
block-scope.
</p>
<p>
It is not an error if an identifier is declared with block-scope and there is
already a declaration of the same identifier in the same symbol space with
module-scope. In this case, the block-scope declaration will hide the
module-scope declaration for the region where the block-scope declaration is in
scope. However, it is a compile error if an identifier is declared with
block-scope and its scope overlaps with the scope of another declaration of the
same identifier in the same symbol space also with block-scope.
</p>
</section>
</section>
</section>
<section>
<h2 id="expressions">6. Expressions</h2>

<pre class="grammar"><span class="ntdfn" id="expression">expression</span> := 
   <a href="#literal"><span class="ntref">literal</span></a>
   | <a href="#string-template-expr"><span class="ntref">string-template-expr</span></a>
   | <a href="#xml-template-expr"><span class="ntref">xml-template-expr</span></a>
   | <a href="#raw-template-expr"><span class="ntref">raw-template-expr</span></a>
   | <a href="#structural-constructor-expr"><span class="ntref">structural-constructor-expr</span></a>
   | <a href="#object-constructor-expr"><span class="ntref">object-constructor-expr</span></a>
   | <a href="#new-expr"><span class="ntref">new-expr</span></a>
   | <a href="#variable-reference-expr"><span class="ntref">variable-reference-expr</span></a>
   | <a href="#field-access-expr"><span class="ntref">field-access-expr</span></a>
   | <a href="#optional-field-access-expr"><span class="ntref">optional-field-access-expr</span></a>
   | <a href="#xml-attribute-access-expr"><span class="ntref">xml-attribute-access-expr</span></a>
   | <a href="#annot-access-expr"><span class="ntref">annot-access-expr</span></a>
   | <a href="#member-access-expr"><span class="ntref">member-access-expr</span></a>
   | <a href="#function-call-expr"><span class="ntref">function-call-expr</span></a>
   | <a href="#method-call-expr"><span class="ntref">method-call-expr</span></a>
   | <a href="#error-constructor-expr"><span class="ntref">error-constructor-expr</span></a>
   | <a href="#anonymous-function-expr"><span class="ntref">anonymous-function-expr</span></a>
   | <a href="#let-expr"><span class="ntref">let-expr</span></a>
   | <a href="#type-cast-expr"><span class="ntref">type-cast-expr</span></a>
   | <a href="#typeof-expr"><span class="ntref">typeof-expr</span></a>
   | <a href="#unary-expr"><span class="ntref">unary-expr</span></a>
   | <a href="#multiplicative-expr"><span class="ntref">multiplicative-expr</span></a>
   | <a href="#additive-expr"><span class="ntref">additive-expr</span></a>
   | <a href="#shift-expr"><span class="ntref">shift-expr</span></a>
   | <a href="#range-expr"><span class="ntref">range-expr</span></a>
   | <a href="#relational-expr"><span class="ntref">relational-expr</span></a>
   | <a href="#is-expr"><span class="ntref">is-expr</span></a>
   | <a href="#equality-expr"><span class="ntref">equality-expr</span></a>
   | <a href="#binary-bitwise-expr"><span class="ntref">binary-bitwise-expr</span></a>
   | <a href="#logical-expr"><span class="ntref">logical-expr</span></a>
   | <a href="#conditional-expr"><span class="ntref">conditional-expr</span></a>
   | <a href="#checking-expr"><span class="ntref">checking-expr</span></a>
   | <a href="#trap-expr"><span class="ntref">trap-expr</span></a>
   | <a href="#query-expr"><span class="ntref">query-expr</span></a>
   | <a href="#xml-navigate-expr"><span class="ntref">xml-navigate-expr</span></a>
   | <a href="#transactional-expr"><span class="ntref">transactional-expr</span></a>
   | <code>(</code> <a href="#expression"><span class="ntref">expression</span></a> <code>)</code>
</pre>
<p>
For simplicity, the expression grammar is ambiguous. The following table shows
the various types of expression in decreasing order of precedence, together with
associativity.
</p>
<table>
  <tr>
   <td><strong>Operator</strong></td>
   <td><strong>Associativity</strong></td>
  </tr>
  <tr>
   <td>
<code>m:x</code>
<br>
<code>x.k</code>
<br>
<code>x.@a</code>
<br>
<code>f(x)</code>
<br>
<code>x.f(y)</code>
<br>
<code>x[y]</code>
<br>
<code>new T(x)</code>
   </td>
   <td></td>
  </tr>
  <tr>
   <td>
<code>+x</code>
<br>
<code>-x</code>
<br>
<code>~x</code>
<br>
<code>!x</code>
<br>
<code>&lt;T&gt; x</code>
<br>
<code>typeof x</code>
<br>
<code>check x</code>
<br>
<code>checkpanic x</code>
   </td>
   <td></td>
  </tr>
  <tr>
   <td>
<code>x * y</code>
<br>
<code>x / y</code>
<br>
<code>x % y</code>
   </td>
   <td>left</td>
  </tr>
  <tr>
   <td>
<code>x + y</code>
<br>
<code>x - y</code>
   </td>
   <td>left</td>
  </tr>
  <tr>
   <td>
<code>x &lt;&lt; y</code>
<br>
<code>x &gt;&gt; y</code>
<br>
<code>x &gt;&gt;&gt; y</code>
   </td>
   <td>left</td>
  </tr>
  <tr>
   <td>
<code>x ... y</code>
<br>
<code>x ..&lt; y</code>
   </td>
   <td>non</td>
  </tr>
  <tr>
   <td>
<code>x &lt; y</code>
<br>
<code>x &gt; y</code>
<br>
<code>x &lt;= y</code>
<br>
<code>x &gt;= y</code>
<br>
<code>x is y</code>
   </td>
   <td>non</td>
  </tr>
  <tr>
   <td>
<code>x == y</code>
<br>
<code>x != y</code>
<br>
<code>x === y</code>
<br>
<code>x !== y</code>
   </td>
   <td>left</td>
  </tr>
  <tr>
   <td><code>x &amp; y</code></td>
   <td>left</td>
  </tr>
  <tr>
   <td><code>x ^ y</code></td>
   <td>left</td>
  </tr>
  <tr>
   <td>
<code>x | y</code>
   </td>
   <td>left</td>
  </tr>
  <tr>
   <td><code>x &amp;&amp; y</code></td>
   <td>left</td>
  </tr>
  <tr>
   <td><code>x || y</code></td>
   <td>left</td>
  </tr>
  <tr>
   <td><code>x ?: y</code></td>
   <td>right</td>
  </tr>
  <tr>
   <td><code>x ? y : z</code></td>
   <td>right</td>
  </tr>
  <tr>
   <td>
<code>(x) =&gt; y</code>
<br>
<code>let x = y in z</code>
<br>
<code>from x in y select z</code>
<br>
<code>trap x</code>
   </td>
   <td>right</td>
  </tr>

</table>
<section>
<h3 id="section_6.1">6.1 Expression evaluation</h3>
<p>
When the evaluation of an expression completes normally, it produces a result,
which is a value. The evaluation of an expression may also complete abruptly.
There are two kinds of abrupt completion: check-fail and panic. With both kinds
of abrupt completion there is an associated value, which always has basic type
error.
</p>
<p>
The following sections describes how each kind expression is evaluated, assuming
that evaluation of subexpressions complete normally. Except where explicitly
stated to the contrary, expressions handle abrupt completion of subexpressions
as follows. If in the course of evaluating an expression E, the evaluation of
some subexpression E1 completes abruptly, then then evaluation of E also
completes abruptly in the same way as E1.
</p>
</section>
<section>
<h3 id="section_6.2">6.2 Static typing of expressions</h3>
<p>
A type is computed for every expression at compile time; this is called the
static type of the expression. The compiler and runtime together guarantee that
if the evaluation of an expression at runtime completes normally, then the
resulting value will belong to the static type. A type is also computed for
check-fail abrupt completion, which will be a (possibly empty) subtype of error;
however, for panic abrupt completion, no type is computed.
</p>
<p>
It is an error if the static type of an expression is <code>never</code>, except
in cases where the expression is one that this specification explicitly permits
to have static type <code>never</code> and the expression occurs in a context
where this specification explicitly permits an expression with static type
<code>never</code> to occur.
</p>
<p>
The detailed rules for the static typing of expressions are quite elaborate and
are not yet specified completely in this document.
</p>

<section>
<h4 id="lax_static_typing">6.2.1 Lax static typing</h4>
<p>
In some situations it is convenient for static typing to be less strict than
normal. One such situation is when processing data in Ballerina using a static
type that is less precise than the type that the data is in fact expected to
belong to. For example, when the Ballerina <code>json</code> type is used for
the processing of data in JSON format, the Ballerina static type will not
capture the constraints of the particular JSON format that is been processed.
</p>
<p>
Ballerina supports this situation through the concept of lax static typing,
which has two parts: the first part is that a type descriptor can be classified
as lax; the second part is that particular kinds of expression can have less
strict static typing rules when the static type of a subexpression is described
by a lax type descriptor. With these less strict rules, a potential type error
that would have been a compile-time error according to the normal strict static
typing rules would instead be allowed at compile-time and result in an error
value at runtime; the effect is thus that some static type-checking is instead
done dynamically.
</p>
<p>
In this version of Ballerina, only the first step has been taken towards
supporting this concept. There is a fixed set of type descriptors that are
classified as lax: specifically <code>json</code> is lax, and
<code>map&lt;T&gt;</code> is lax if T is lax. The only kinds of expression for
which lax typing rules are specified are field-access-expr,
optional-field-access-expr and checking-expr.
</p>

</section>
<section>
<h4 id="section_6.2.2">6.2.2 Contextually expected type</h4>
<p>
For a context in which an expression occurs, there may be a type descriptor that
describes the static type that the expression is expected to have. This is
called the <em>contextually expected type</em>. For example, if a variable is
declared by a type descriptor TD, then TD will be the contextually expected type
for the expression initializing the variable. A type descriptor must be
resolved before it can be used to provide a contextually expected type.</p>
<p>
Many kinds of expression that construct values use the contextually expected
type to determine the type of value constructed, rather than requiring the type
to be specified explicitly. For each such kind of expression, there is a set of
basic types (most often consisting of a single basic type) that the value
constructed by that kind of expression will always belong to. In this case, the
contextually expected type is narrowed by intersecting it with this set of basic
types; this narrowed type is called the <em>applicable</em> contextually
expected type. The narrowing is performed on the type descriptor by first
normalizing the type descriptor into a union, where each member of the union is
not a union and describes shapes from a single basic type, and then eliminating
any members of the union with the wrong basic type; if this leaves no members,
then it is a compile-time error; if it leaves a single member of the union, then
the the applicable contextually expected type is this single member, otherwise
it is a union of the remaining members.
</p>
<p>
Note the language provides a way to say that the type of a variable is to be
inferred from the static type of the expression used to initialize the variable.
In this case, there is no contextually expected type for the evaluation of the
expression. Not having a contextually expected type is different from having a
contextually expected type that allows all values.
</p>
</section>
<section>
<h4 id="section_6.2.3">6.2.3 Precise and broad types</h4>
<p>
There is an additional complexity relating to inferring types. Expressions in
fact have two static types, a precise type and a broad type. Usually, the
precise type is used. However, in a few situations, using the precise type would
be inconvenient, and so Ballerina uses the broad type. In particular, the broad
type is used for inferring the type of an implicitly typed non-final variable.
Similarly, the broad type is used when it is necessary to infer the member type
of the inherent type of a structured value.
</p>
<p>
In most cases, the precise type and the broad type of an expression are the
same. For a compound expression, the broad type of an expression is computed
from the broad type of the sub-expressions in the same way as the precise type
of the expression is computed from the precise type of sub-expressions.
Therefore in most cases, there is no need to mention the distinction between
precise and broad types.
</p>
<p>
The most important case where the precise type and the broad type are different
is literals. The precise type is a singleton type containing just the shape of
the value that the literal represents, whereas the broad type is the precise
type widened to contain the entire basic type of which it is a subtype. For
example, the precise type of the string literal <code>"X"</code> is the
singleton type <code>"X"</code>, but the broad type is <code>string</code>.
</p>
</section>
<section>
<h4 id="section_6.2.4">6.2.4 Isolated expressions</h4>
<p>
Ballerina defines requirements for when an expression is <em>isolated</em>. If
an expression meets the requirements, then it is compile-time guaranteed that
the value of the expression will be an isolated root and will not be aliased.
</p>
<p>
If the static type of an expression is immutable, i.e. a subtype of
<code>readonly</code>, or an isolated object, i.e. a subtype of <code>isolated
object {}</code>, then the expression is isolated.
</p>
<p>
Also, an expression of one of the following syntactic kinds is isolated if all
its subexpressions are isolated (regardless of its static type):
</p>
<ul>
<li><code>list-constructor-expr</code></li>
<li><code>table-constructor-expr</code></li>
<li><code>mapping-constructor-expr</code></li>
<li><code>xml-template-expr</code></li>
<li><code>raw-template-expr</code></li>
<li><code>type-cast-expr</code></li>
<li><code>checking-expr</code></li>
<li><code>trap-expr</code></li>
<li><code>conditional-expr</code></li>
</ul>
<p>
The section for each kind of expression will describe any alternative conditions
under which that kind of expression is also isolated.
</p>
</section>
</section>
<section>
<h3 id="section_6.3">6.3 Casting and conversion</h3>
<p>
Ballerina makes a sharp distinction between type conversion and type casting.
</p>
<p>
Casting a value does not change the value. Any value always belongs to multiple
types. Casting means taking a value that is statically known to be of one type,
and using it in a context that requires another type; casting checks that the
value is of that other type, but does not change the value.
</p>
<p>
Conversion is a process that takes as input a value of one type and produces as
output a possibly distinct value of another type. Note that conversion does not
mutate the input value.
</p>
<p>
Ballerina always requires programmers to make conversions explicit, even between
different types of number; there are no implicit conversions.
</p>
</section>
<section>
<h3 id="section_6.4">6.4 Constant expressions</h3>

<pre class="grammar"><span class="ntdfn" id="const-expr">const-expr</span> := 
   <a href="#literal"><span class="ntref">literal</span></a>
   | <a href="#string-template-expr"><span class="ntref">string-template-expr</span></a>
   | <a href="#xml-template-expr"><span class="ntref">xml-template-expr</span></a>
   | <a href="#raw-template-expr"><span class="ntref">raw-template-expr</span></a>
   | <a href="#structural-constructor-expr"><span class="ntref">structural-constructor-expr</span></a>
   | <a href="#constant-reference-expr"><span class="ntref">constant-reference-expr</span></a>
   | <a href="#type-cast-expr"><span class="ntref">type-cast-expr</span></a>
   | <a href="#unary-expr"><span class="ntref">unary-expr</span></a>
   | <a href="#multiplicative-expr"><span class="ntref">multiplicative-expr</span></a>
   | <a href="#additive-expr"><span class="ntref">additive-expr</span></a>
   | <a href="#shift-expr"><span class="ntref">shift-expr</span></a>
   | <a href="#range-expr"><span class="ntref">range-expr</span></a>
   | <a href="#relational-expr"><span class="ntref">relational-expr</span></a>
   | <a href="#is-expr"><span class="ntref">is-expr</span></a>
   | <a href="#equality-expr"><span class="ntref">equality-expr</span></a>
   | <a href="#binary-bitwise-expr"><span class="ntref">binary-bitwise-expr</span></a>
   | <a href="#logical-expr"><span class="ntref">logical-expr</span></a>
   | <a href="#conditional-expr"><span class="ntref">conditional-expr</span></a>
   | <code>(</code> <a href="#const-expr"><span class="ntref">const-expr</span></a> <code>)</code>
</pre>
<p>
A value resulting from the evaluation of a <code>const-expr</code> always has
its read-only bit on.
</p>
<p>
Within a <code>const-expr</code>, any nested expression must also be a
const-expr.
</p>

<pre class="grammar"><span class="ntdfn" id="constant-reference-expr">constant-reference-expr</span> := <a href="#variable-reference-expr"><span class="ntref">variable-reference-expr</span></a>
</pre>
<p>
A <code>constant-reference-expr</code> must reference a constant defined with
<code>module-const-decl</code>.
</p>
<p>
A <code>const-expr</code> is evaluated at compile-time. Constructors called
within a <code>const-expr</code> construct their values as immutable. Note that
the syntax of const-expr does not allow for the construction of error values.
The result of a <code>const-expr</code> is always immutable.
</p>

<pre class="grammar"><span class="ntdfn" id="simple-const-expr">simple-const-expr</span> :=
  <a href="#nil-literal"><span class="ntref">nil-literal</span></a>
  | <a href="#boolean-literal"><span class="ntref">boolean-literal</span></a>
  | [<a href="#Sign"><span class="ntref">Sign</span></a>] <a href="#int-literal"><span class="ntref">int-literal</span></a>
  | [<a href="#Sign"><span class="ntref">Sign</span></a>] <a href="#floating-point-literal"><span class="ntref">floating-point-literal</span></a>
  | <a href="#string-literal"><span class="ntref">string-literal</span></a>
  | <a href="#constant-reference-expr"><span class="ntref">constant-reference-expr</span></a>
</pre>
<p>
A simple-const-expr is a restricted form of const-expr used in contexts where
various forms of constructor expression would not make sense. Its semantics are
the same as a const-expr.
</p>
</section>
<section>
<h3 id="section_6.5">6.5 Literals</h3>

<pre class="grammar"><span class="ntdfn" id="literal">literal</span> :=
   <a href="#nil-literal"><span class="ntref">nil-literal</span></a>
   | <a href="#boolean-literal"><span class="ntref">boolean-literal</span></a>
   | <a href="#numeric-literal"><span class="ntref">numeric-literal</span></a>
   | <a href="#string-literal"><span class="ntref">string-literal</span></a>
   | <a href="#byte-array-literal"><span class="ntref">byte-array-literal</span></a>
<span class="ntdfn" id="numeric-literal">numeric-literal</span> := <a href="#int-literal"><span class="ntref">int-literal</span></a> | <a href="#floating-point-literal"><span class="ntref">floating-point-literal</span></a>
</pre>
<p>
A numeric-literal represents a value belonging to one of the basic types
int, float or decimal. The basic type to which the value belongs is determined
as follows:
</p>
<ul>
<li>if the numeric-literal includes a <code>FloatTypeSuffix</code>, then the
basic type is float;</li>
<li>if the numeric-literal includes a <code>DecimalTypeSuffix</code>, then the
basic type is decimal;</li>
<li>if the numeric-literal is a <code>HexFloatingPointLiteral</code>, then the
basic type is float;</li>
<li>otherwise, the basic type depends on the applicable expected numeric type
(where the possible basic types are int, float and decimal):
<ul>
<li>if the applicable contextually expected type is a subtype of decimal, then
the basic type is decimal;</li>
<li>if the applicable contextually expected type is a subtype of float, then the
basic type is float;</li>
<li>otherwise, if the numeric literal is an int-literal, then the basic type is
int;</li>
<li>otherwise, the basic type is float.</li>
</ul>
</li>
</ul>
<p>
The precise type of a numeric-literal is the singleton type containing just the
shape of the value that the numeric-literal represents. The broad type is
the basic type of which the precise type is a subset.
</p>

<pre class="grammar"><span class="ntdfn" id="byte-array-literal">byte-array-literal</span> := <a href="#Base16Literal"><span class="ntref">Base16Literal</span></a> | <a href="#Base64Literal"><span class="ntref">Base64Literal</span></a>
<span class="ntdfn" id="Base16Literal">Base16Literal</span> := <code>base16</code> <a href="#WS"><span class="ntref">WS</span></a> <code>`</code> <a href="#HexGroup"><span class="ntref">HexGroup</span></a>* <a href="#WS"><span class="ntref">WS</span></a> <code>`</code>
<span class="ntdfn" id="HexGroup">HexGroup</span> := <a href="#WS"><span class="ntref">WS</span></a> <a href="#HexDigit"><span class="ntref">HexDigit</span></a> <a href="#WS"><span class="ntref">WS</span></a> <a href="#HexDigit"><span class="ntref">HexDigit</span></a>
<span class="ntdfn" id="Base64Literal">Base64Literal</span> := <code>base64</code> <a href="#WS"><span class="ntref">WS</span></a> <code>`</code> <a href="#Base64Group"><span class="ntref">Base64Group</span></a>* [<a href="#PaddedBase64Group"><span class="ntref">PaddedBase64Group</span></a>] <a href="#WS"><span class="ntref">WS</span></a> <code>`</code>
<span class="ntdfn" id="Base64Group">Base64Group</span> :=
   <a href="#WS"><span class="ntref">WS</span></a> <a href="#Base64Char"><span class="ntref">Base64Char</span></a> <a href="#WS"><span class="ntref">WS</span></a> <a href="#Base64Char"><span class="ntref">Base64Char</span></a> <a href="#WS"><span class="ntref">WS</span></a> <a href="#Base64Char"><span class="ntref">Base64Char</span></a> <a href="#WS"><span class="ntref">WS</span></a> <a href="#Base64Char"><span class="ntref">Base64Char</span></a>
<span class="ntdfn" id="PaddedBase64Group">PaddedBase64Group</span> :=
   <a href="#WS"><span class="ntref">WS</span></a> <a href="#Base64Char"><span class="ntref">Base64Char</span></a> <a href="#WS"><span class="ntref">WS</span></a> <a href="#Base64Char"><span class="ntref">Base64Char</span></a> <a href="#WS"><span class="ntref">WS</span></a> <a href="#Base64Char"><span class="ntref">Base64Char</span></a> <a href="#WS"><span class="ntref">WS</span></a> <a href="#PaddingChar"><span class="ntref">PaddingChar</span></a>
   | <a href="#WS"><span class="ntref">WS</span></a> <a href="#Base64Char"><span class="ntref">Base64Char</span></a> <a href="#WS"><span class="ntref">WS</span></a> <a href="#Base64Char"><span class="ntref">Base64Char</span></a> <a href="#WS"><span class="ntref">WS</span></a> <a href="#PaddingChar"><span class="ntref">PaddingChar</span></a> <a href="#WS"><span class="ntref">WS</span></a> <a href="#PaddingChar"><span class="ntref">PaddingChar</span></a>
<span class="ntdfn" id="Base64Char">Base64Char</span> := <code>A</code> .. <code>Z</code> | <code>a</code> .. <code>z</code> | <code>0</code> .. <code>9</code> | <code>+</code> | <code>/</code>
<span class="ntdfn" id="PaddingChar">PaddingChar</span> := <code>=</code>
<span class="ntdfn" id="WS">WS</span> := <a href="#WhiteSpaceChar"><span class="ntref">WhiteSpaceChar</span></a>*
</pre>
<p>
The static type of byte-array-literal is <code>byte[N]</code>, where N is the
number of bytes encoded by the Base16Literal or Base64Literal. The inherent type
of the array value created is also <code>byte[N]</code>.
</p>
</section>
<section>
<h3 id="section_6.6">6.6 Template expressions</h3>
<p>
Template expressions make use of strings enclosed in backticks with interpolated
expressions.
</p>
<pre class="grammar"><span class="ntdfn" id="BacktickString">BacktickString</span> :=
  <code>`</code> <a href="#BacktickItem"><span class="ntref">BacktickItem</span></a>* <a href="#Dollar"><span class="ntref">Dollar</span></a>* <code>`</code>
<span class="ntdfn" id="BacktickItem">BacktickItem</span> :=
   <a href="#BacktickSafeChar"><span class="ntref">BacktickSafeChar</span></a>
   | <a href="#BacktickDollarsSafeChar"><span class="ntref">BacktickDollarsSafeChar</span></a>
   | <a href="#Dollar"><span class="ntref">Dollar</span></a>* <a href="#interpolation"><span class="ntref">interpolation</span></a>
<span class="ntdfn" id="interpolation">interpolation</span> := <code>${</code> <a href="#expression"><span class="ntref">expression</span></a> <code>}</code>
<span class="ntdfn" id="BacktickSafeChar">BacktickSafeChar</span> := ^ ( <code>`</code> | <code>$</code> )
<span class="ntdfn" id="BacktickDollarsSafeChar">BacktickDollarsSafeChar</span> :=  <code>$</code>+ ^ ( <code>{</code> | <code>`</code> | <code>$</code>)
<span class="ntdfn" id="Dollar">Dollar</span> := <code>$</code>
</pre>

<section>
<h4 id="section_6.6.1">6.6.1 String template expression</h4>

<pre class="grammar"><span class="ntdfn" id="string-template-expr">string-template-expr</span> := <code>string</code> <a href="#BacktickString"><span class="ntref">BacktickString</span></a>
</pre>
<p>
A <code>string-template-expr</code> interpolates the results of evaluating
expressions into a literal string. The static type of the expression in each
interpolation must be a subtype of
<code>boolean|int|float|decimal|string</code>. Within a
<code>BacktickString</code>, every character that is not part of an
<code>interpolation</code> is interpreted as a literal character. A
string-template-expr is evaluated by evaluating the expression in each
interpolation in the order in which they occur, and converting the result of the
each evaluation to a string using the <a href="#ToString">ToString</a> abstract
operation with the direct style. The result of evaluating the
<code>string-template-expr</code> is a string comprising the literal characters
and the results of evaluating and converting the interpolations, in the order in
which they occur in the <code>BacktickString</code>.
</p>
<p>
A literal <code>`</code> can be included in string template by using an
interpolation <code>${"`"}</code>.
</p>
</section>
<section>
<h4 id="section_6.6.2">6.6.2 XML template expression</h4>

<pre class="grammar"><span class="ntdfn" id="xml-template-expr">xml-template-expr</span> := <code>xml</code> <a href="#BacktickString"><span class="ntref">BacktickString</span></a>
</pre>
<p>
An XML template expression constructs an xml value as follows:
</p>
<ol>
<li>The backtick string is parsed to produce a string of literal characters with
interpolated expressions</li>
<li>The result of the previous step is parsed as XML content. More precisely, it
is parsed using the production <code>content</code> in the W3C XML
Recommendation. For the purposes of parsing as XML, each interpolated expression
is interpreted as if it were an additional character allowed by the CharData and
AttValue productions but no other. The result of this step is an XML Infoset
consisting of an ordered list of information items such as could occur as the
[children] property of an element information item, except that interpolated
expressions may occur as Character Information Item or in the [normalized value]
of an Attribute Information Item. Interpolated expressions are not allowed in
the value of a namespace attribute.</li>
<li>This infoset is then converted to an xml value, as described in the <a href="#XML">XML type</a> section, together with an ordered list of interpolated
expressions, and for each interpolated expression a position within the XML
value at which the value of the expression is to be inserted.</li>
<li>The static type of an expression occurring in an attribute value must be a
simple type and must not be nil. The static type type of an expression occurring
in content can either be xml or a non-nil simple type.</li>
<li>When the xml-template-expr is evaluated, the interpolated expressions are evaluated
in the order in which they occur in the <code>BacktickString</code>, and
converted to strings if necessary. A new copy is made of the xml value and the
result of the expression evaluations are inserted into the corresponding
position in the newly created xml value. This xml value is the result of the
evaluation.</li>
</ol>
<p>
An xml-template-expr occurring within a const-expr will construct an xml value
that has its read-only bit on.
</p>
</section>

<section>
<h4 id="section_6.6.3">6.6.3 Raw template expression</h4>

<pre class="grammar"><span class="ntdfn" id="raw-template-expr">raw-template-expr</span> := <a href="#BacktickString"><span class="ntref">BacktickString</span></a>
</pre>
<p>
A raw-template-expr constructs an object belonging to the abstract RawTemplate
object type.
</p>
<p>
A raw-template-expr is evaluated by
</p>
<ul>
<li>constructing an array <var>v</var> whose members are the result of
evaluating each interpolation's expression in the order in which they occur in
the BacktickString;</li>
<li>constructing an object with two fields
<ul>
<li>an <code>insertions</code> field with value <var>v</var>
</li>
<li>a <code>strings</code> field consisting of a read-only array of strings
containing the characters in BacktickString outside of interpolations, split at
the interpolation points; the length of the this array is one more than the
length of <var>v</var>.</li>
</ul>
</li>
</ul>
<p>
The result of the raw-template-expr is the newly constructed object.
</p>
<p>
For each raw-template-expr there is a separate class, which
is a subtype of the RawTemplate type. The objects constructed by a
raw-template-expr belong to this class. The type of the
<code>insertions</code> field is determined from the contextually expected type
or the static type of the expressions in the BacktickString in the same way as
with a list-constructor-expr. The <code>strings</code> and
<code>insertions</code> fields will be read-only if required by the contextually
expected type. The value of the <code>strings</code> field is constructed once
by the class. The value of the <code>insertions</code> is
constructed once for each evaluation of the raw-template-expr.
</p>

</section>
</section>

<section>
<h3 id="section_6.7">6.7 Structural constructors</h3>
<p>
Each basic type of structure has its own expression syntax for constructing a
value of the type.
</p>
<pre class="grammar"><span class="ntdfn" id="structural-constructor-expr">structural-constructor-expr</span> := <a href="#list-constructor-expr"><span class="ntref">list-constructor-expr</span></a> | <a href="#table-constructor-expr"><span class="ntref">table-constructor-expr</span></a> | <a href="#mapping-constructor-expr"><span class="ntref">mapping-constructor-expr</span></a>
</pre>

<p>
An structural-constructor-expr occurring within a const-expr will construct a
structural value that has its read-only bit on.
</p>

<section>
<h4 id="section_6.7.1">6.7.1 List constructor</h4>

<pre class="grammar"><span class="ntdfn" id="list-constructor-expr">list-constructor-expr</span> := <code>[</code> [ <a href="#expr-list"><span class="ntref">expr-list</span></a> ] <code>]</code>
<span class="ntdfn" id="expr-list">expr-list</span> := <a href="#expression"><span class="ntref">expression</span></a> (<code>,</code> <a href="#expression"><span class="ntref">expression</span></a>)*
</pre>
<p>
A list-constructor-expr creates a new list value. The members of the list come from evaluating each
expression in the expr-list in order.
</p>
<p>
If there is a contextually expected type, then the inherent type of the newly
created list is derived from the applicable contextually expected type. If the
applicable contextually expected type is a list type descriptor, then that used
as the inherent type. If the applicable contextually expected type is a union
type descriptor, then any members of the union that do not contain list shapes
of length N will be ignored, where N is the number of expressions in the
<code>expr-list</code>; it is a compile-time error if this does not leave a
single list type descriptor, which is then used as the inherent type. The static
type of the list-constructor-expr will be the same as the inherent type.
</p>
<p>
If there is no contextually expected type, then the inherent type will be a
tuple-type-descriptor with a member-type-descriptor for each expression in the
expr-list; the type of each member-type-descriptor will be the broad type of the
corresponding expression in the expr-list.
</p>
<p>
If there is a contextually expected type, then the type that the inherent type
requires for each list member provides the contextually expected type for the
expression for the member; otherwise there is no contextually expected type for
the expressions for members.
</p>
<p>
A member of a list can be filled in automatically if the <a href="#FillMember">FillMember</a> abstract operation would succeed on it. The
inherent type of a list establishes either a fixed length for the list or just a
minimum length for the list, which may be zero. In either case, a list
constructor may specify only the first <var>k</var> members, provided that for
each <var>i</var> from <var>k</var> + 1 up to the fixed length of the list, the
<var>i</var>-th member can be filled in automatically.
</p>

</section>
<section>
<h4 id="section_6.7.2">6.7.2 Mapping constructor</h4>

<pre class="grammar"><span class="ntdfn" id="mapping-constructor-expr">mapping-constructor-expr</span> := <code>{</code> [<a href="#field"><span class="ntref">field</span></a> (<code>,</code> <a href="#field"><span class="ntref">field</span></a>)*] <code>}</code>
<span class="ntdfn" id="field">field</span> := 
  <a href="#specific-field"><span class="ntref">specific-field</span></a>
  | <a href="#computed-name-field"><span class="ntref">computed-name-field</span></a>
  | <a href="#spread-field"><span class="ntref">spread-field</span></a>
<span class="ntdfn" id="specific-field">specific-field</span> :=
   [<code>readonly</code>] (<a href="#field-name"><span class="ntref">field-name</span></a> | <a href="#string-literal"><span class="ntref">string-literal</span></a>) <code>:</code> <a href="#value-expr"><span class="ntref">value-expr</span></a>
   | [<code>readonly</code>] [<a href="#variable-name"><span class="ntref">variable-name</span></a>]
<span class="ntdfn" id="value-expr">value-expr</span> := <a href="#expression"><span class="ntref">expression</span></a>
<span class="ntdfn" id="computed-name-field">computed-name-field</span> := <code>[</code> <a href="#field-name-expr"><span class="ntref">field-name-expr</span></a> <code>]</code> <code>:</code> <a href="#value-expr"><span class="ntref">value-expr</span></a>
<span class="ntdfn" id="field-name-expr">field-name-expr</span> := <a href="#expression"><span class="ntref">expression</span></a>
<span class="ntdfn" id="spread-field">spread-field</span> := <code>...</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
A mapping-constructor-expr creates a new mapping value. 
</p>
<p>
A specific-field specifies a single field, where the field name is known at
compile-time. A specific-field that consists of just a variable name
<code><var>x</var></code> is equivalent to a field <code><var>x</var>:
<var>x</var></code>.
</p>
<p>
The static type of the expression in a spread-field must allow only mapping
values, i.e. must be a subtype of <code>map&lt;any|error&gt;</code>. All the
fields of the mapping value that results from evaluating that expression are
included in the mapping value being constructed. It is a compile-time error if
the static type of the expression in a spread-field allows a field that
duplicates a specific-field or that could also occur in another spread-field.
Note that a spread-field with an inclusive record type of <code>record { never
x?; }</code> cannot duplicate a specific field for <code>x</code>.
</p>
<p>
If there is a contextually expected type, then the inherent type of the newly
created mapping is derived from the applicable contextually expected type. If
the applicable contextually expected type is a mapping type descriptor, then
that used as the inherent type. If the applicable contextually expected type is
a union type descriptor, then any members of the union that are inconsistent
with the field names specified in a specific-field in the
mapping-constructor-expr will be ignored; it is a compile-time error if this
does not leave a single mapping type descriptor, which is then used as the
inherent type. The static type of the mapping-constructor-expr will be the same
as the inherent type.
</p>
<p>
If there is no contextually expected type, then the inherent type will be an
exclusive-record-type-descriptor with an individual-field-descriptor for each
specific-field; the type of each field-descriptor will be the broad type of the
value-expr in the field, unless the field is read-only in which case the type of
the field-descriptor will be the precise type. The static type of the expression
in every spread-field will also be added to the inherent type. If there are
fields specified as a computed-name-field, then there will also be a
record-rest-descriptor <code>T...</code>, where <code>T</code> is the union of
the broad types of the value-expr in all such fields.
</p>
<p>
If a specific-field does not use a string-literal for the name of the field and
the inherent type descriptor is a record type descriptor, then the record type
descriptor must include an individual-field-descriptor for that field.
</p>
<p>
If the inherent type descriptor is a record type descriptor, a field will be
added to the constructed value using the default value from the type descriptor
for any field that is not specified explicitly in the mapping constructor and
that has a default value.
</p>
<p>
If there is a contextually expected type, then the type that the inherent type
requires for each field provides the contextually expected type for the
value-expr in a field; otherwise there is no contextually expected type for the
value-expr for fields. If there is a contextually expected type, the
contextually expected type for the expression in a spread-field is map&lt;T&gt;,
where the T is the smallest type such that the inherent type is a subtype of
map&lt;T&gt;. The contextually expected type for a field-name-expr is string.
</p>
<p>
A computed-name-field specifies a single field, where the name of the field is
specified by an expression enclosed in square brackets. A
mapping-constructor-expr first constructs a mapping value without considering
any computed-name-field. The effect of a computed-name-field is to modify the
member of the mapping with the specified name after the mapping has been
constructed. If the modification is incompatible with the inherent type, then
the mapping-constructor-expr will panic. The modifications are performed in the
order in which the computed-name-fields occur in the mapping-constructor-expr.
</p>
<p>
If the applicable contextually expected type is a subtype of readonly, then the
mapping will be constructed with its read-only bit on. If the inherent type
makes a specific field readonly, then that field will be constructed with its
read-only bit on. A specific-field that starts with <code>readonly</code> will
also be constructed with its read-only bit on.
</p>

</section>
<section>
<h4 id="section_6.7.3">6.7.3 Table constructor</h4>

<pre class="grammar"><span class="ntdfn" id="table-constructor-expr">table-constructor-expr</span> := <code>table</code> [<a href="#key-specifier"><span class="ntref">key-specifier</span></a>] <code>[</code> [<a href="#row-list"><span class="ntref">row-list</span></a>] <code>]</code>
<span class="ntdfn" id="row-list">row-list</span> := <a href="#mapping-constructor-expr"><span class="ntref">mapping-constructor-expr</span></a> (<code>,</code> <a href="#mapping-constructor-expr"><span class="ntref">mapping-constructor-expr</span></a>)*
</pre>
<p>
A table-constructor-expr creates a new table value. The members of the table
come from evaluating each mapping-constructor-expr in the row-list in order.
</p>
<p>
For example,
</p>

<pre>table key(email) [
   { email: "sanjiva@weerawarana.org", firstName: "Sanjiva", lastName: "Weerawarana" },
   { email: "jjc@jclark.com", firstName: "James", lastName: "Clark" }
]
</pre>
<p>
The inherent type of the constructed table is a table type descriptor including
a key-specifier <code>table&lt;<var>T</var>&gt; key(<var>ks</var>)</code>, where
<code><var>T</var></code> is the member type and <code><var>ks</var></code> is
the key sequence. The inherent type is determined from the contextually expected
type togther with the table-constructor-expr. The static type of the
table-constructor-expr will be the same as this inherent type.
</p>
<p>
If there is a contextually expected type, then the member type of inherent type
of the newly created table is derived from the applicable contextually expected
type, which must be a table-type-descriptor. If there is no contextually
expected type, then the member type of the inherent type is derived from the the
static type of the expressions for the members: the member type will be the
smallest record type that is a supertype of the static types of all the
expressions in the row-list. It is an error if there is no contextually expected
type and the row-list is empty.
</p>
<p>
The key sequence of the inherent type comes from the key-specifier of applicable
contextually expected type or the key-specifier in the table-constructor-expr.
If both of these are present, then they must be the same. If neither of them are
present, then the key sequence is empty. The key sequence of the table value is
the same as that of its inherent type. The key sequence and member type must
meet the same consistency requirements as if they were specified together in a
<a href="#tables">table type descriptor</a>. For every field-name in the key
sequence of the inherent type every mapping-constructor-expr in the row-list
must include a specific-field that has a value-expr that is a const-expr. It is
a compile-time error if two or more rows of the table have the same key value.
</p>
<p>
If there is a contextually expected type, then the type that the inherent type
requires for each table member provides the contextually expected type for the
expressions in the expr-list; otherwise there is no contextually expected type
for these expressions.
</p>

</section>
</section>

<section>
<h3 id="section_6.8">6.8 Object construction</h3>
<p>
There are two kinds of expression that can be used to construct an object: with
an object constructor expression, the methods and fields of the constructed
object are defined within the expression; with a new expression, the methods and
fields come from a separate, named class definition.
</p>

<section>
<h4 id="section_6.8.1">6.8.1 Object constructor</h4>

<pre class="grammar"><span class="ntdfn" id="object-constructor-expr">object-constructor-expr</span> :=
   [<a href="#annots"><span class="ntref">annots</span></a>] <a href="#object-type-quals"><span class="ntref">object-type-quals</span></a> <code>object</code> [<a href="#type-reference"><span class="ntref">type-reference</span></a>] <a href="#object-constructor-block"><span class="ntref">object-constructor-block</span></a>
<span class="ntdfn" id="object-constructor-block">object-constructor-block</span> := <code>{</code> <a href="#object-member"><span class="ntref">object-member</span></a>* <code>}</code>
<span class="ntdfn" id="object-member">object-member</span> := <a href="#object-field"><span class="ntref">object-field</span></a> | <a href="#method-defn"><span class="ntref">method-defn</span></a> | <a href="#remote-method-defn"><span class="ntref">remote-method-defn</span></a> | <a href="#resource-method-defn"><span class="ntref">resource-method-defn</span></a>
</pre>
<p>
The resulting of evaluating an <code>object-constructor-expr</code> is an
object. The <code>object-constructor-expr</code> must specify
<code>client</code> if any <code>method-defn</code> includes a
<code>remote-qual</code>.
</p>
<p>
The annotations applying to the <code>object-constructor-expr</code> and its
members are evaluated when the <code>object-constructor-expr</code> is
evaluated. This means that every object resulting from the evaluation of an
<code>object-constructor-expr</code> has its own type descriptor.
</p>
<p>
If there is a <code>type-reference</code>, then the referenced type is included
in the object's type in the same was as an <code>object-type-inclusion</code>,
and the type-ids of the constructed object are type-ids of the referenced type.
If there is no <code>type-reference</code>, then the applicable contextually
expected type T, if any, must be definite, and the type-ids of the constructed
object are the type-ids, if any, induced by T.
</p>
<p>
The <code>object-constructor-expr</code> is <em>implicitly read-only</em> if the
applicable contextually expected type is a subtype of readonly or if the
<code>type-reference</code> is present and references a type that is a subtype
of readonly. If the <code>object-constructor-expr</code> is <em>implicitly
read-only</em>, then the object will be constructed with its read-only bit on;
furthermore, in this case an <code>object-type-inclusion</code> is allowed to
directly or indirectly reference a readonly class.
</p>
<p>
The <code>object-constructor-expr</code> is <em>explicitly isolated</em> if
<code>object-type-quals</code> includes <code>isolated</code> or if the
type-reference is present and references an isolated object type. An
<code>object-constructor-expr</code> that is explicitly isolated will construct
an object with its isolated bit set.
</p>

<pre class="grammar"><span class="ntdfn" id="object-visibility-qual">object-visibility-qual</span> := <code>public</code>|<code>private</code>
</pre>

<p>
A visibility qualifier of <code>private</code> can be used within an
<code>object-constructor-expr</code> expression; this means that the visibility
region consists of every method-defn-body in the object-constructor-expr.
</p>

<section>
<h5 id="section_6.8.1.1">6.8.1.1 Fields</h5>
<pre class="grammar"><span class="ntdfn" id="object-field">object-field</span> :=
   <a href="#metadata"><span class="ntref">metadata</span></a> [<a href="#object-visibility-qual"><span class="ntref">object-visibility-qual</span></a>] [<code>final</code>]
   <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> <a href="#field-name"><span class="ntref">field-name</span></a> [<code>=</code> <a href="#field-initializer"><span class="ntref">field-initializer</span></a>] <code>;</code>
<span class="ntdfn" id="field-initializer">field-initializer</span> := <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
An <code>object-field</code> declares and initializes a field of the object.
</p>
<p>
If a field does not specify a field-initializer, then there must be an
<code>init</code> method and the <code>init</code> method must initialize the
field. The field-initializer must meet the requirements for an isolated function
unless the <code>init</code> method is present and not declared as
<code>isolated</code>. If the <code>object-constructor-expr</code> is implicitly
read-only, then the contextually expected type for a field-initializer will be
the intersection of readonly and the type specified in the type-descriptor of
the object-field.
</p>
<p>
If <code>final</code> is present, then the field must be assigned to exactly
once, either by its initializer or in the <code>init</code> method.
</p>
<p>
An <code>object-constructor-expr</code> will construct an object with its
read-only bit set if every object-field is declared as <code>final</code> and
has a type-descriptor that is a subtype of <code>readonly</code>. In this case,
the static type of the <code>object-constructor-expr</code> will be intersected
with <code>readonly</code>.
</p>
<p>
An object field is <em>isolated</em> if it is declared as <code>final</code> and
has a type-descriptor that is a subtype of <code>readonly</code> or
<code>isolated object {}</code>, or if the <code>object-constructor-expr</code>
is implicitly read-only. An <code>object-constructor-expr</code> is
<em>implicitly isolated</em> if it is implicitly readonly or if every object
field is isolated. An <code>object-constructor-expr</code> that is implicitly
isolated will construct an object with its isolated bit set. In this case, the
static type of the <code>object-constructor-expr</code> will be intersected with
<code>isolated object {}</code>. If the <code>object-constructor-expr</code> is
explicitly isolated, then every <code>field-initializer</code> must be an
isolated expression and any field that is not isolated must be declared as
private.
</p>
</section>

<section>
<h5 id="section_6.8.1.2">6.8.1.2 Methods</h5>

<pre class="grammar"><span class="ntdfn" id="method-defn">method-defn</span> :=
   <a href="#metadata"><span class="ntref">metadata</span></a> <a href="#object-visibility-qual"><span class="ntref">object-visibility-qual</span></a> <a href="#method-quals"><span class="ntref">method-quals</span></a>
   <code>function</code> <a href="#method-name"><span class="ntref">method-name</span></a> <a href="#function-signature"><span class="ntref">function-signature</span></a> <a href="#method-defn-body"><span class="ntref">method-defn-body</span></a>
</pre>

<p>
A <code>method-defn</code> defines a method of an object. 
</p>

<pre class="grammar"><span class="ntdfn" id="remote-method-defn">remote-method-defn</span> :=
   <a href="#metadata"><span class="ntref">metadata</span></a> <a href="#remote-method-quals"><span class="ntref">remote-method-quals</span></a>
   <code>function</code> <a href="#method-name"><span class="ntref">method-name</span></a> <a href="#function-signature"><span class="ntref">function-signature</span></a> <a href="#method-defn-body"><span class="ntref">method-defn-body</span></a>
</pre>
<p>
A <code>remote-method-defn</code> defines a remote method. This is allowed only
when an <code>object-network-qual</code> is present in the
<code>object-constructor-expr</code>.
</p>

<pre class="grammar"><span class="ntdfn" id="method-defn-body">method-defn-body</span> := <a href="#function-defn-body"><span class="ntref">function-defn-body</span></a>
</pre>
<p>
Within a <code>method-defn-body</code>, the fields and methods of the object are
not implicitly in-scope; instead the variable <code>self</code> is bound to the
object and can be used to access fields and methods of the object. If the
<code>object-constructor-expr</code> is explicitly isolated, then the
<code>self</code> variable must be accessed only within the scope of a lock
statement, except when <code>self</code> is part of a
<code>field-access-expr</code> of the form <code>self.<var>f</var></code>, where
<code><var>f</var></code> is the name of an isolated field.
</p>
<p>
If <code>isolated-qual</code> is present, then the method has its isolated bit
set and its <code>method-defn-body</code> must satisfy the requirements for an
<a href="#isolated_functions">isolated function</a>.
</p>

</section>

<section>
<h5 id="resources">6.8.1.3 Resources</h5>

<p>
In addition to remote methods, a service object can use <em>resources</em> to
support network interaction. Resources support a more data-oriented style of
network interaction, which complements the RPC style supported by remote
methods. A service object's resources are arranged in a tree. Each resource
exposes one or more named methods; by convention the method name
<code>get</code> is used for retrieving the resource. A listener thus identifies
a resource method to be called using the combination of a hierarchical path,
which identifies the resource, and the resource method name. A resource method
can also specify that a segment of the path provided by the listener should be
treated as a parameter. A resource method can only be invoked by a listener
object.
</p>

<pre class="grammar"><span class="ntdfn" id="resource-method-defn">resource-method-defn</span> :=
   <a href="#metadata"><span class="ntref">metadata</span></a> <a href="#resource-method-quals"><span class="ntref">resource-method-quals</span></a>
   <code>function</code> <a href="#resource-method-name"><span class="ntref">resource-method-name</span></a> <a href="#resource-path"><span class="ntref">resource-path</span></a> <a href="#function-signature"><span class="ntref">function-signature</span></a> <a href="#method-defn-body"><span class="ntref">method-defn-body</span></a>
<span class="ntdfn" id="resource-method-quals">resource-method-quals</span> :=
   <a href="#resource-qual"><span class="ntref">resource-qual</span></a> <a href="#function-quals"><span class="ntref">function-quals</span></a>
   | <a href="#isolated-qual"><span class="ntref">isolated-qual</span></a> [<a href="#transactional-qual"><span class="ntref">transactional-qual</span></a>] <a href="#resource-qual"><span class="ntref">resource-qual</span></a>
   | <a href="#transactional-qual"><span class="ntref">transactional-qual</span></a> [<a href="#isolated-qual"><span class="ntref">isolated-qual</span></a>] <a href="#resource-qual"><span class="ntref">resource-qual</span></a>
   | <a href="#isolated-qual"><span class="ntref">isolated-qual</span></a> <a href="#resource-qual"><span class="ntref">resource-qual</span></a> <a href="#transactional-qual"><span class="ntref">transactional-qual</span></a>
   | <a href="#transactional-qual"><span class="ntref">transactional-qual</span></a> <a href="#resource-qual"><span class="ntref">resource-qual</span></a> <a href="#isolated-qual"><span class="ntref">isolated-qual</span></a>
<span class="ntdfn" id="resource-qual">resource-qual</span> := <code>resource</code>
<span class="ntdfn" id="resource-method-name">resource-method-name</span> := <a href="#identifier"><span class="ntref">identifier</span></a>
<span class="ntdfn" id="resource-path">resource-path</span> :=
   <a href="#dot-resource-path"><span class="ntref">dot-resource-path</span></a>
   | <a href="#resource-path-segment"><span class="ntref">resource-path-segment</span></a> (<code>/</code> <a href="#resource-path-segment"><span class="ntref">resource-path-segment</span></a>)* [<code>/</code> <a href="#resource-path-rest-param"><span class="ntref">resource-path-rest-param</span></a>]
   | <a href="#resource-path-rest-param"><span class="ntref">resource-path-rest-param</span></a>
<span class="ntdfn" id="dot-resource-path">dot-resource-path</span> := <code>.</code>
<span class="ntdfn" id="resource-path-segment">resource-path-segment</span> := <a href="#resource-path-segment-name"><span class="ntref">resource-path-segment-name</span></a> | <a href="#resource-path-segment-param"><span class="ntref">resource-path-segment-param</span></a>
<span class="ntdfn" id="resource-path-segment-name">resource-path-segment-name</span> := <a href="#identifier"><span class="ntref">identifier</span></a>
<span class="ntdfn" id="resource-path-segment-param">resource-path-segment-param</span> := <code>[</code>[<a href="#annots"><span class="ntref">annots</span></a>] <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> <a href="#param-name"><span class="ntref">param-name</span></a><code>]</code>
<span class="ntdfn" id="resource-path-rest-param">resource-path-rest-param</span> := <code>[</code>[<a href="#annots"><span class="ntref">annots</span></a>] <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> <code>...</code> <a href="#param-name"><span class="ntref">param-name</span></a><code>]</code>
</pre>

<p>
A <code>resource-method-defn</code> defines a resource method. This is allowed
only when an <code>object-network-qual</code> of <code>service</code> is present
in the <code>object-constructor-expr</code>. The <code>resource-path</code>
specifies the node in the service object's resource tree to which the method is
attached and the <code>resource-method-name</code> specifies the method name. It
is an error to have two <code>resource-method-defn</code>s that both have the
same name and have a path that refers to the same node. A
<code>dot-resource-path</code> specifies the root of the service object's
resource tree. In a service object's resource tree, each edge from a parent node
to a child node has a label, which uniquely identifies the child relative to its
siblings. A label is either a string or one of two special values that indicate
that the corresponding path segment should be treated as a parameter. It is an
error for a parent node to have more than one edge to a child node labelled with
one of the two special values. A <code>resource-path-segment-name</code>
specifies a label that is a string. The two special label values come from a
<code>resource-path-segment-param</code> and a
<code>resource-path-rest-param</code> respectively. A parameter in a
<code>resource-path-segment-param</code> will be bound to a value representing a
single path segment; a parameter in a <code>resource-path-rest-param</code> will
be bound to a list representing zero or more path segments, with each member
representing a single path segment. The type of a path segment depends on the
listener, but the listener must be able to convert it into a string. For
example, in HTTP a path segment is natively a sequence of bytes, and an HTTP
listener could convert it into a string by decoding with UTF-8. It also depends
on the listener which types other than string it is able to convert a path
segment to.
</p>
<p>
The return type of a resource method must not allow values belonging to the
function basic type. A resource method with a name of <code>get</code> that can
return a service object represents a subservice. It is subject to the following
restrictions:
</p>
<ul>
<li>the return type must not allow anything other that service
objects and errors;</li>
<li>the resource path must not end with a <code>resource-path-rest-param</code>;</li>
<li>the method's node must not have any child nodes.</li>
</ul>
<p>
The semantics of hierarchical resources are defined by a lookup function, which
takes four parameters:
</p>
<ul>
<li>
<var>m</var> is the name of the method;</li>
<li>
<var>p</var> is the resource path;</li>
<li>
<var>r</var> refers to a node in the resource tree of a service object;</li>
<li>
<var>v</var> is the list path segments bound so far.</li>
</ul>
<p>
It returns an error or a tuple [<var>r</var>, <var>v</var>], where
</p>
<ul>
<li>
<var>r</var> is a node in the resource tree with an m method, which is the
method to be called;</li>
<li>
<var>v</var> is a list of path segments to be bound to the methodâs variable
resource path parameters.</li>
</ul>
<p>
The function lookup(<var>m</var>, <var>p</var>, <var>r</var>, <var>v</var>) is
defined as follows:
</p>
<ol>
<li>If <var>r</var> has a <code>get</code> method that can return a service
object, then call the <code>get</code> method of <var>r</var> using <var>v</var>
to bind the path parameters; if the result is an error, then return that error;
otherwise, the result must be a service object. Let <var>r</var>' be the root of
its resource tree. Return lookup(<var>m</var>, <var>p</var>, <var>r</var>',
[]).</li>
<li>If <var>p</var> is empty: 
<ol>
<li>if <var>r</var> has a method <var>m</var>, then return
[<var>r</var>,<var>v</var>];</li>
<li>otherwise, if <var>r</var> has a child labelled as repeated variable path
segment and that child has a method <var>m</var>, then let <var>r</var>' be
child with that label and return [<var>r</var>',<var>v</var>];</li>
<li>otherwise, return an error.</li> 
</ol>
</li>
<li>Let the first segment in <var>p</var> be <var>s</var> and let <var>p</var>'
be a list of the 2nd and subsequent members of <var>p</var>.</li>
<li>If <var>r</var> has a child labelled with the string that results from
converting <var>s</var> to a string, then let <var>r</var>' be the child with
that label. Return lookup(<var>m</var>, <var>p</var>', <var>r</var>',
<var>v</var>).</li>
<li>If <var>r</var> has an edge to a child labelled as a single path segment
parameter, then let <var>r</var>' be that child and let <var>v</var>' be the
result of adding <var>s</var> to the end of <var>v</var>. Return
lookup(<var>m</var>, <var>p</var>', <var>r</var>', <var>v</var>').</li>
<li>If <var>r</var> has an edge to a child labelled as a rest parameter and that
child has a method <var>m</var>, then let <var>r</var>' be that child, and let
<var>v</var>' be the result of concatenating <var>v</var> and <var>p</var>.
Return [<var>r</var>',<var>v</var>'].</li>
<li>Otherwise, return an error.</li>
</ol>
<p>
The syntax allows only the last of a resource method's path parameters to be a
rest parameter. When a list of path segments is bound to the path parameters of
a resource method, one path segment is bound to each path parameter that is not
a rest parameter and a list of the remaining path segments is bound to the rest
parameter, if any.
</p>

</section>

<section>
<h5 id="section_6.8.1.4">6.8.1.4 Initialization</h5>
<p>
A <code>method-defn</code> with a <code>method-name</code> of <code>init</code>
is used to initialize the object and is treated specially. The return type of
the <code>init</code> method must be a subtype of the union of error and nil,
and must contain nil; if <code>init</code> returns an error, it means that
initialization of the object failed.
</p>
<p>
The parameter list of an <code>init</code> method within an
<code>object-constructor-expr</code> must be empty.
</p>
<p>
At any point in the body of a <code>init</code> method, the compiler
determines which fields are potentially uninitialized. A field is potentially
uninitialized at some point if that field does not have an initializer and it
is not definitely assigned at that point. It is a compile error if a
<code>init</code> method:
</p>
<ul>
<li>accesses a field at a point where it is potentially initialized, or</li>
<li>at a point where there is any potentially uninitialized field
<ul>
<li>returns nil, or</li>
<li>uses the <code>self</code> variable other than to access or modify the value of a field.</li>
</ul>
</li>
</ul>
<p>
If the <code>object-constructor-expr</code> is explicitly isolated, then a field
can only be assigned to by an <code>assignment-stmt</code> with a right hand
side that is an isolated expression. The requirement to access <code>self</code>
within a lock statement does not apply to the <code>init</code> method.
</p>
<p>
The visibility of the <code>init</code> method cannot be <code>private</code>.
</p>
<p>
Any <code>init</code> method is not part of the shape of an object, and so does
not affect when an object value belongs to a type. The <code>init</code> method
can be called in a <code>method-call-expr</code> only when the expression
preceding the <code>.</code> is <code>self</code>.
</p>
<p>
A missing <code>init</code> method is equivalent to an isolated
<code>init</code> method with no parameters and an empty body (which will always
return nil).
</p>
</section>

</section>
<section>
<h4 id="section_6.8.2">6.8.2 New expression</h4>

<pre class="grammar"><span class="ntdfn" id="new-expr">new-expr</span> := <a href="#explicit-new-expr"><span class="ntref">explicit-new-expr</span></a> | <a href="#implicit-new-expr"><span class="ntref">implicit-new-expr</span></a>
<span class="ntdfn" id="explicit-new-expr">explicit-new-expr</span> := <code>new</code> <a href="#class-descriptor"><span class="ntref">class-descriptor</span></a> <code>(</code> <a href="#arg-list"><span class="ntref">arg-list</span></a> <code>)</code>
<span class="ntdfn" id="class-descriptor">class-descriptor</span> := <a href="#identifier"><span class="ntref">identifier</span></a> | <a href="#qualified-identifier"><span class="ntref">qualified-identifier</span></a> | <a href="#stream-type-descriptor"><span class="ntref">stream-type-descriptor</span></a>
</pre>
<p>
A new-expr constructs a new object or stream. The class-descriptor in an
explicit-new-expr must refer to a class or a stream type.
</p>
<p>
When the class-descriptor refers to a class, the explicit-new-expr allocates
storage for an object of the type defined by the class and initializes it by
passing the supplied arg-list to the <code>init</code> method defined by the
class. It is a compile error if the type-descriptor if the arg-list does not
match the signature of the class's <code>init</code> method. If the result of
calling the <code>init</code> method is an error value e, then the result of
evaluating the explicit-new-expr is e; otherwise the result is the newly
initialized object. The explicit-new-expr is isolated if the type of the
<code>init</code> is isolated and the expression for every argument in the
arg-list is isolated.
</p>
<p>
When the class-reference refers to a stream type <code>stream&lt;T,E&gt;</code>,
the arg-list must either be empty or be a single argument belonging to object
type StreamImplementor&lt;T,E?&gt;. When the arg-list is empty, the result will
be an empty stream (i.e. a stream whose next method returns nil). When the
arg-list evaluates to a StreamImplementor object, the result will be a stream
that wraps that object. The explicit-new-expr is isolated if the the arg-list is
empty or if the expression for the single argument is isolated.
</p>
<p>
An explicit-type-expr specifying a class-descriptor T has static type T, except
that if T is an class type and the type of the <code>init</code> method is
E?, where E is a subtype of error, then it has static type T|E.
</p>
<pre class="grammar"><span class="ntdfn" id="implicit-new-expr">implicit-new-expr</span> := <code>new</code> [<code>(</code> <a href="#arg-list"><span class="ntref">arg-list</span></a> <code>)</code>]
</pre>
<p>
An implicit-new-expr is equivalent to an explicit-new-expr that specifies the
applicable contextually expected type as the class-descriptor. An
implicit-new-expr consisting of just <code>new</code> is equivalent to
<code>new()</code>. It is an error if the applicable contextually expected type
is not a class or stream type.
</p>
</section>
</section>
<section>
<h3 id="section_6.9">6.9 Variable reference expression</h3>

<pre class="grammar"><span class="ntdfn" id="variable-reference-expr">variable-reference-expr</span> := <a href="#variable-reference"><span class="ntref">variable-reference</span></a>
<span class="ntdfn" id="variable-reference">variable-reference</span> := <a href="#identifier"><span class="ntref">identifier</span></a> | <a href="#qualified-identifier"><span class="ntref">qualified-identifier</span></a> | <a href="#xml-qualified-name"><span class="ntref">xml-qualified-name</span></a>
<span class="ntdfn" id="xml-qualified-name">xml-qualified-name</span> := <a href="#xml-namespace-prefix"><span class="ntref">xml-namespace-prefix</span></a> <code>:</code> <a href="#identifier"><span class="ntref">identifier</span></a>
</pre>
<p>
A variable-reference can refer to a variable, a parameter, a constant (defined
with a module constant declaration), a function, a type (defined with a module
type definition) or a class (defined with a module class definition).
</p>
<p>
When the variable reference has a prefix and the prefix has been declared using
an xmlns-decl rather than an import-decl, then the result of evaluating the
variable-reference-expr is a string of the form:
</p>
<pre>
   {<var>namespace-uri</var>}<var>local-name</var>
</pre>
<p>
where the namespace-uri comes from xml-namespace-uri specified in the
xmlns-decl, and the local-name comes from the identifier following the colon.
</p>
<p>
If the variable-reference references a type defined with a module type
definition or a class defined with a module class definition, then the result of
evaluating the variable-reference-expr is a typedesc value for that type or
class.
</p>
<p>
A variable-reference-expr is isolated if it refers to an identifier bound by a
let-expr to an expression that is isolated.
</p>
<p>
A variable-reference-expr that refers to a variable declared by a
module-var-decl that includes <code>isolated</code> is only allowed within a
lock-stmt.
</p>
</section>
<section>
<h3 id="section_6.10">6.10 Field access expression</h3>

<pre class="grammar"><span class="ntdfn" id="field-access-expr">field-access-expr</span> := <a href="#expression"><span class="ntref">expression</span></a> <code>.</code> <a href="#field-name"><span class="ntref">field-name</span></a>
</pre>
<p>
A field-access-expr is typically used to access a field of an object or a field
of a record. More generally, it can be used to access a member of an object or a
member of a mapping. The semantics depends on the static type T of expression. A
field-access-expr where T is a subtype of xml is interpreted as an
xml-required-attribute-access-expr.
</p>
<p>
If T is a subtype of the object basic type, then T must have a member with name
field-name. The field-access-expr is evaluated by first evaluating the
expression to get a value <var>obj</var>. If the member is a field, then the
result of the expression if the value of that field of <var>obj</var> and the
static type of the field-access-expr is the type of that field of T. If that
member is a method, then the result of the expression is a new function value
that when called will call the method with <code>self</code> bound to
<var>obj</var>; the isolated bit of the new function value is set if and only if
the isolated bits of both <var>obj</var> and the method are set; the type
descriptor of the new function value will have the same annotations as the type
descriptor of the method. The rest of this subsection applies when T is not a
subtype of the object basic type.
</p>
<p>
Let T' be the intersection of T and basic type mapping, let K be the singleton type
containing just the string field-name, and let M be the member type for K in T'.
The compile-time requirements on the field-access-expr depend on whether the
type descriptor describing T is lax:
</p>
<ul>
<li>if it is lax, then the only compile-time requirement is M is non-empty;</li>
<li>if it is not lax, then T must be a subtype of the mapping basic type and K
must be a required key type for T.</li>
</ul>
<p>
The static type of field-access-expr is M|E, where E is empty if K is a required
key type and T' is a subtype of T, and error otherwise (E can only be error in
the lax case.) In the lax case, if M is lax, then the static type of the
field-access-expr is lax even if E is an error.
</p>
<p>
A field-access-expr is evaluated as follows:
</p>
<ol>
<li>expression is evaluated resulting in a value <var>v</var>
</li>
<li>if <var>v</var> has basic type error, the result is <var>v</var> (this can
only happen in the lax case)</li>
<li>otherwise, if <var>v</var> does not have basic type mapping, the result is a
new error value (this can only happen in the lax case)</li>
<li>otherwise, if <var>v</var> does not have a member whose key is field-name,
the result is a new error value (this can only happen in the lax case)</li>
<li>otherwise, the result is the member of <var>v</var> whose key is
field-name.</li>
</ol>

</section>
<section>
<h3 id="section_6.11">6.11 Optional field access expression</h3>

<pre class="grammar"><span class="ntdfn" id="optional-field-access-expr">optional-field-access-expr</span> := <a href="#expression"><span class="ntref">expression</span></a> <code>?.</code> <a href="#field-name"><span class="ntref">field-name</span></a>
</pre>
<p>
An optional-field-access-expr accesses a possibly undefined mapping member,
returning <code>()</code> if the member does not exist.
</p>
<p>
An optional-field-access-expr where the static type of <code>expression</code> is
a subtype of xml is interpreted as an xml-optional-attribute-access-expr.
</p>
<p>
Let T be the static type of expression, let T' be the intersection of T and
basic type mapping, let K be the singleton type containing just the string
field-name and let M be the member type of K in T'. The compile-time
requirements on the optional-field-access-expr depend on whether the type
descriptor describing T is lax:
</p>
<ul>
<li>if it is lax, then the only compile-time requirement is that M is
non-empty;</li>
<li>if it is not lax, then, in addition, T must be a subtype of the union of
<code>()</code> and the mapping basic type, and the type descriptor for T must
include <code>field-name</code> as an individual-field-descriptor (if the type
descriptor is a union, then this requirement must be satisfied by at least one
member of the union).</li>
</ul>
<p>
The static type of the optional-field-access-expr is M|N|E where
</p>
<ul>
<li>N is <code>()</code> if <code>()</code> is a subtype of T or K is not a
required key type for T', and empty otherwise;</li>
<li>E is <code>error</code> if T' is not a subtype of T?, and empty otherwise (E
can only be error in the lax case).</li>
</ul>

<p>
An optional-field-access-expr is evaluated as follows:
</p>
<ol>
<li>expression is evaluated resulting in a value <var>v</var>
</li>
<li>if <var>v</var> is <code>()</code>, the result is <code>()</code>
</li>
<li>otherwise, if <var>v</var> has basic type error, the result is <var>v</var>
(this can only happen in the lax case)</li>
<li>otherwise, if <var>v</var> does not have basic type mapping, the result is a
new error value (this can only happen in the lax case)</li>
<li>otherwise, if <var>v</var> does not have a member whose key is field-name,
the result is <code>()</code>
</li>
<li>otherwise, the result is the member of <var>v</var> whose key is
field-name.</li>
</ol>

</section>

<section>
<h3 id="section_6.12">6.12 XML attribute access expression</h3>

<pre class="grammar"><span class="ntdfn" id="xml-attribute-access-expr">xml-attribute-access-expr</span> := <a href="#xml-required-attribute-access-expr"><span class="ntref">xml-required-attribute-access-expr</span></a> | <a href="#xml-optional-attribute-access-expr"><span class="ntref">xml-optional-attribute-access-expr</span></a>
<span class="ntdfn" id="xml-required-attribute-access-expr">xml-required-attribute-access-expr</span> := <a href="#expression"><span class="ntref">expression</span></a> <code>.</code> <a href="#xml-attribute-name"><span class="ntref">xml-attribute-name</span></a>
<span class="ntdfn" id="xml-optional-attribute-access-expr">xml-optional-attribute-access-expr</span> := <a href="#expression"><span class="ntref">expression</span></a> <code>?.</code> <a href="#xml-attribute-name"><span class="ntref">xml-attribute-name</span></a>
<span class="ntdfn" id="xml-attribute-name">xml-attribute-name</span> := <a href="#xml-qualified-name"><span class="ntref">xml-qualified-name</span></a> | <a href="#qualified-identifier"><span class="ntref">qualified-identifier</span></a> | <a href="#identifier"><span class="ntref">identifier</span></a>
</pre>

<p>
An XML attribute access expression provides convenient access to an attribute of
an XML element. It is a compile-time requirement that the static type of the
expression is a subtype of xml.
</p>
<p>
A string representing the name of the attribute is computed at compile-time from
the xml-attribute-name. When the xml-attribute-name is an identifier without a
prefix, the attribute name string is the identifier. When the xml-attribute-name
has a prefix, normally the xml-attribute-name is an xml-qualified-name, in which
the prefix is an xml-namespace-prefix declared using an xmlns-decl. In this
case, the xml-qualified-name is expanded at compile-time into an attribute name
string of the form
</p>
<pre>
   {<var>namespace-uri</var>}<var>local-name</var>
</pre>
<p>
where the namespace-uri comes from xml-namespace-uri specified in the
xmlns-decl, and the local-name comes from the identifier following the colon.
</p>
<p>
It is also allowed for the xml-attribute-name to be specified as a
qualified-identifier, in which the prefix is a module-prefix declared using an
import-decl. In this case the qualified-identifier must refer to a
module-const-decl of type string, and the attribute name string is the value of
the referenced constant. This allows e.g. <code>xml:lang</code> to work.
</p>
<p>
An xml-optional-attribute-access-expr is evaluated as follows. The expression is
evaluated resulting in an xml value <var>v</var>. If <var>v</var> is an empty
xml value, the result is <code>()</code>. Otherwise, if <var>v</var> is not a
singleton element, the result is an error. Otherwise, let <var>m</var> be that
element's attribute map and let <var>k</var> be the attribute name string
computed at compile-time from the xml-attribute-name. If <var>m</var> has a
member <var>s</var> with key <var>k</var>, the the result is <var>s</var>.
Otherwise, the result is <code>()</code>.
</p>
<p>
An xml-required-attribute-access-expr is evaluated the same as an
xml-optional-attribute-expr, except that for cases where the result of the
xml-optional-attribute-expr would be <code>()</code>, the result of the
xml-required-attribute-access-expr is an error.
</p>
<p>
The static type of an xml-required-attribute-access-expr is
<code>string|error</code> The static type of an
xml-optional-attribute-access-expr is <code>string|error|()</code>.
</p>

</section>
<section>
<h3 id="section_6.13">6.13 Annotation access expression</h3>

<pre class="grammar"><span class="ntdfn" id="annot-access-expr">annot-access-expr</span> := <a href="#expression"><span class="ntref">expression</span></a> <code>.@</code> <a href="#annot-tag-reference"><span class="ntref">annot-tag-reference</span></a>
</pre>
<p>
The annot-tag-reference must refer to an annotation tag declared with an
annotation declaration. The static type of expression must be a subtype of
<code>typedesc</code>.
</p>
<p>
An <code>annot-access-expr</code> is evaluated by first evaluating
<code>expression</code> resulting in a typedesc value <em>t</em>. If <em>t</em>
has an annotation with the tag referenced by <code>annot-tag-reference</code>,
then the result of the <code>annot-access-expr</code> is the value of that
annotation; otherwise, the result is nil.
</p>
<p>
The static type of the <code>annot-access-expr</code> is T? where T is the type
of the annotation tag.
</p>
</section>
<section>
<h3 id="section_6.14">6.14 Member access expression</h3>

<pre class="grammar"><span class="ntdfn" id="member-access-expr">member-access-expr</span> := <a href="#container-expression"><span class="ntref">container-expression</span></a> <code>[</code> (<a href="#key-expression"><span class="ntref">key-expression</span></a> | <a href="#multi-key-expression"><span class="ntref">multi-key-expression</span></a>) <code>]</code>
<span class="ntdfn" id="container-expression">container-expression</span> := <a href="#expression"><span class="ntref">expression</span></a>
<span class="ntdfn" id="key-expression">key-expression</span> := <a href="#expression"><span class="ntref">expression</span></a>
<span class="ntdfn" id="multi-key-expression">multi-key-expression</span> := <a href="#expression"><span class="ntref">expression</span></a> (<code>,</code> <a href="#expression"><span class="ntref">expression</span></a>)+
</pre>
<p>
A member-access-expr accesses a member of a structured value using its key,
or a constituent of a sequence value using its index.
</p>
<p>
The requirements on the static type of container-expression and key-expression are as
follows:
</p>
<ul>
<li>if the static type of container-expression is a subtype of string or of xml
or of basic type list, then the contextually expected type for key-expression is
int and the static type of key-expression must be a subtype of int;</li>
<li>if the static type of container-expression is a subtype of table, then the
contextually expected type for key-expression is <code><var>K</var></code> and
the static type of key-expression must be a subtype of
<code><var>K</var></code>, where the static type of container-expression is
<code>table&lt;<var>R</var>&gt; key&lt;<var>K</var>&gt;</code>;</li>
<li>otherwise the static type of container-expression must be a subtype of the
union of nil and basic type map; in this case the contextually expected type for
key-expression is string and the static type of key-expression must be a subtype
of string.</li>
</ul>
<p>
A multi-key-expression is allowed only when the static type of a
container-expression is a subtype of table. A multi-key-expression
<code>E<sub>1</sub>, E<sub>2</sub>,..., E<sub>n</sub></code> is equivalent to a
list-constructor-expr <code>[E<sub>1</sub>, E<sub>2</sub>,...,
E<sub>n</sub>]</code>.
</p>

<p>
A member-access-expr is evaluated as follows:
</p>
<ol>
<li>the container-expression is evaluated to get a value <var>c</var>;</li>
<li>the key-expression is evaluated to get a value <var>k</var>;</li>
<li>depending on the basic type of <var>c</var>
<ul>
<li>if it is string, and <var>k</var> is &lt; 0 or â¥ the length of
<var>c</var>, then the evaluation completes abruptly with a panic; otherwise,
the result is a string of length 1 containing the character with index
<var>k</var> in <var>c</var>;</li>
<li>if it is xml, and <var>k</var> is &lt; 0, then the evaluation completes
abruptly with a panic; if <var>k</var> is â¥ the length of <var>c</var>, then
the result is an empty xml value; otherwise, the result is a singleton xml
value containing the item with index <var>k</var> in <var>c</var>;</li>
<li>if it is list, and <var>k</var> is &lt; 0 or â¥ the length of
<var>c</var>, then the evaluation completes abruptly with a panic; otherwise,
the result is the member of <var>c</var> with index <var>k</var>;</li>
<li>if it is table, then if <var>c</var> does not contain a member with key
<var>k</var>, the result is <code>()</code>; otherwise, the result is the member
of <var>c</var> with key <var>k</var>.</li>
<li>if it is mapping, then if <var>c</var> is <code>()</code> or <var>c</var>
does not contain a member with key <var>k</var>, the result is <code>()</code>;
otherwise, the result is the member of <var>c</var> with key <var>k</var>.</li>
</ul>
</li>
</ol>
<p>
Let T the static type of container-expression. If T is a subtype of string, then
the static type of the member-access-expr is <a href="#built-in_subtypes"><code>string:Char</code></a>, that is the subtype of
strings containing strings of length 1. If T is a subtype of xml&lt;M&gt;, then
the static type of the member-access-expr is M|E, where E is the type of the
empty xml value. If T is a subtype of table&lt;R&gt;, then the static type of
member-access-expr is R?. Otherwise, let K be the static type of key-expression
and let M be the member type of K in T; if T contains nil, or T is a subtype of
mapping and K is an optional key type for T, then the static type of the
member-access-expr is M?, otherwise the static type is M.
</p>

</section>
<section>
<h3 id="function_call">6.15 Function call expression</h3>

<pre class="grammar"><span class="ntdfn" id="function-call-expr">function-call-expr</span> := <a href="#function-reference"><span class="ntref">function-reference</span></a> <code>(</code> <a href="#arg-list"><span class="ntref">arg-list</span></a> <code>)</code>
<span class="ntdfn" id="function-reference">function-reference</span> := <a href="#variable-reference"><span class="ntref">variable-reference</span></a>
<span class="ntdfn" id="arg-list">arg-list</span> :=
   <a href="#positional-args"><span class="ntref">positional-args</span></a> [<code>,</code> <a href="#other-args"><span class="ntref">other-args</span></a>]
   | [<a href="#other-args"><span class="ntref">other-args</span></a>]
<span class="ntdfn" id="other-args">other-args</span> := <a href="#named-args"><span class="ntref">named-args</span></a> | <a href="#rest-arg"><span class="ntref">rest-arg</span></a>
</pre>
<p>
A function-call-expr is evaluated by constructing an argument list and passing
the argument list to the function referred to by the variable-name. The argument
list will be used to bind the parameters of the function before the body of the
function is executed. If the function terminates normally, then the result of
the function-call-expr is the return value of the function; otherwise the
function-call-expr completes abruptly with a panic. The static type of the
function-call-expr is the return type of the function type; this type is
permitted to be <code>never</code>.
</p>
<p>
The function-reference must refer to a variable with function type. The type
descriptor of that function type is used to construct an argument list from the
specified arg-list. Note that it is the type descriptor of the declared type of
the variable that is used for this purpose, rather than the runtime type
descriptor of the referenced function value. The expressions occurring in the
arg-list are evaluated in the order in which they occur in the arg-list; the
contextually expected type for the expression comes from the static type
required for the expression as specified below.
</p>
<pre class="grammar"><span class="ntdfn" id="positional-args">positional-args</span> := <a href="#positional-arg"><span class="ntref">positional-arg</span></a> (<code>,</code> <a href="#positional-arg"><span class="ntref">positional-arg</span></a>)*
<span class="ntdfn" id="positional-arg">positional-arg</span> := <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
The result of evaluating the <var>i</var>-th positional-arg becomes the
<var>i</var>-th member of the argument list. The static type of the expression
for the <var>i</var>-th positional-arg must be a subtype of the type declared
for the <var>i</var>-th parameter that is not a rest-param, if there is such a
parameter; otherwise, there must be a rest-param and the static type must be a
subtype of the type declared for the rest-param.
</p>
<pre class="grammar"><span class="ntdfn" id="named-args">named-args</span> := <a href="#named-arg"><span class="ntref">named-arg</span></a> (<code>,</code> <a href="#named-arg"><span class="ntref">named-arg</span></a>)*
<span class="ntdfn" id="named-arg">named-arg</span> := <a href="#arg-name"><span class="ntref">arg-name</span></a> <code>=</code> <a href="#expression"><span class="ntref">expression</span></a>
<span class="ntdfn" id="arg-name">arg-name</span> := <a href="#identifier"><span class="ntref">identifier</span></a>
</pre>
<p>
The arg-name of every named-arg must be distinct. Each named-arg must correspond
to either a parameter that is not a rest-param or to a field of an
included-record-param. In the latter case, there are two possibilities.
</p>
<ul>
<li>The field is described by an individual-field-descriptor with a type that is not
<code>never</code>.</li>
<li>The field is described by a record-rest-descriptor, either explicitly as
part of an exclusive-record-type-descriptor or implicitly as part of an
inclusive-record-type-descriptor. In this case:
<ul>
<li>for every parameter name and every individual-field-descriptor of an
included-record-param with a type that is not <code>never</code>, the
record-type-descriptor must include an individual-field-descriptor that has type
<code>never</code> and is optional, and so disallows a field with that
name;</li>
<li>the record-type-descriptor must not include any other
individual-field-descriptor; and</li>
<li>there must be no other included-record-param with a
record-rest-descriptor.</li>
</ul>
</li>
</ul>
<p>
It is an error if there is a named-arg and a positional-arg that correspond to
the same parameter. If there is a named-arg or positional-arg corresponding to
an included-record-param, it is an error for a named-arg to specify a field of
that included-record-param. The static type of the expression of the named-arg
must be a subtype of the type declared for the corresponding parameter or
field-descriptor.
</p>
<pre class="grammar"><span class="ntdfn" id="rest-arg">rest-arg</span> := <code>...</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
The static type of the expression in a rest-arg must be either a list type or a
mapping type. If it is a list type, then the rest-arg is equivalent to
specifying each member of the list as a positional-arg. If it is a mapping type,
then the rest-arg is equivalent to specifying each field of the mapping as a
named-arg, with the name and value of the named-arg coming from the name and
value of the field. In either case, the static type of the expression must be
such as to ensure that the equivalent named-args or positional-args would be
valid.
</p>
<p>
If there is neither a named-arg nor a positional-arg for a parameter that is not
a rest-param, then a default value is computed for the parameter, if possible;
otherwise, it is an error. Default values are computed in parameter declaration
order.
</p>
<ul>
<li>If the parameter is a required-param, it is an error.</li>
<li>If the parameter is a defaultable-param, then the value for the parameter is
computed from the default value in the function's type descriptor.
<ul>
<li>If the default value for a defaultable-param was specifed
using an expression, then it is computed by calling the closure stored in the
type descriptor, passing it the previous arguments in the argument list.</li>
<li>If the default value for a defaultable-param was specified as
<code>&lt;&gt;</code>, then the value for the parameter will be a typedesc value
determined at compile-time from the contextually expected type of the
function-call-expr as follows. Let the name of the parameter for which a default
of <code>&lt;&gt;</code> was specified be <var>t</var>. Let the type of
<var>t</var> be typedesc&lt;<var>T</var>&gt;. Let the return type descriptor for
the function be <var>R</var>, which will have references to <var>t</var>. Let
the contextually expected type for the function-call-expr be <var>C</var>. Then
the default value is found by unifying <var>C</var> and <var>R</var>: the
default value is a typedesc value that describes the maximal type <var>S</var>,
such that <var>S</var> is a subtype of <var>T</var>, and <var>R</var> with
<var>S</var> substituted for <var>t</var> is a subtype of <var>C</var>.</li>
</ul>
</li>
<li>If the parameter is an included-record-param, then a new mapping value is
constructed for it using its record-type-descriptor. The mapping value will have
a field for each named-arg that corresponds to a field of this
included-record-param, with the name and value of the field coming from the name
and value of the named-arg. The mapping value will also have a field for each
individual-field-descriptor with a default-expr for which there was no
corresponding named-arg. It is an error if the record-type-descriptor has an
individual-field-descriptor that is not optional and has no default and there is
not corresponding named-arg.</li>
</ul>
<p>
A function-call-expr is isolated if the type of the function being called is
isolated and the expression for every argument is isolated. In addition, a call
to the <code>clone</code> or <code>cloneReadOnly</code> functions defined by the
lang.value module of the lang library is always isolated.
</p>
<p>
When there is a need to call a function value resulting from the evaluation of
an expression, the result of the expression evaluation can be assigned to a
variable and then the function called by using a reference to the variable.
</p>
</section>
<section>
<h3 id="section_6.16">6.16 Method call expression</h3>

<pre class="grammar"><span class="ntdfn" id="method-call-expr">method-call-expr</span> := <a href="#expression"><span class="ntref">expression</span></a> <code>.</code> <a href="#method-name"><span class="ntref">method-name</span></a> <code>(</code> <a href="#arg-list"><span class="ntref">arg-list</span></a> <code>)</code>
</pre>
<p>
A <code>method-call-expr</code> either calls an object's method, calls an
object's field where the type of the field is a function or calls a function in
the lang library. The static type of the method-call-expr is the return type of
the function type of the function that is called; this type is permitted to be
<code>never</code>. The evaluation of the method-call-expr starts by evaluating
<code>expression</code> resulting in some value <var>v</var>. There is no
contextually expected type for <code>expression</code>.
</p>
<p>
If the static type of <code>expression</code> is a subtype of object, and the
object type includes a method named <code>method-name</code>, then the
<code>method-call-expr</code> is executed by calling that method on
<var>v</var>. The <code>arg-list</code> is used to construct an argument list
that is passed to the method in the same way as with a
<code>function-call-expr</code>. A <code>method-call-expr</code> cannot be used
to call a remote method. A remote method of a client object can be called by a
<code>client-remote-method-call-action</code>. In this case, a method-call-expr
is isolated if the expression preceding <code>.</code> is isolated, the
expression for each argument in the arg-list is isolated and the type of the
method being called is isolated.
</p>
<p>
Otherwise, if the static type of <code>expression</code> is a subtype of object,
and the object type includes a field named <code>method-name</code> with a
function type, then the <code>method-call-expr</code> is executed by calling the
value of that field. The <code>arg-list</code> is used to construct an argument
list that is passed to the method in the same way as with a
<code>function-call-expr</code>. In this case, a method-call-expr is isolated if
the type of the function is isolated and the expression for each argument in the
arg-list is isolated.
</p>
<p>
Otherwise, the <code>method-call-expr</code> will be turned into a call to a
function in the lang library <code>m:method-name(expression, arg-list)</code>,
where m is an automatically created module prefix for a module lang.M of the lang
library, where M is selected as follows.
</p>
<ul>
<li>If the static type of <code>expression</code> is a subtype of some basic
type with identifier B, and the module lang.B contains a function
<code>method-name</code> then M is B. The identifier for a basic type is the
reserved identifier used in type descriptors for subtypes of that basic type, as
listed in the <a href="#lang_library">Lang library</a> section.</li>
<li>Otherwise, M is <code>value</code>.</li>
</ul>
<p>
It is a compile-time error if the resulting function call does not satisfy all
the constraints that would apply if it has been written explicitly as a
<code>function-call-expr</code>. The <code>method-call-expr</code> expression is
isolated under the same conditions that the corresponding
<code>function-call-expr</code> would be isolated.
</p>
</section>
<section>
<h3 id="section_6.17">6.17 Error constructor</h3>

<pre class="grammar"><span class="ntdfn" id="error-constructor-expr">error-constructor-expr</span> := <code>error</code> [<a href="#error-type-reference"><span class="ntref">error-type-reference</span></a>] <code>(</code> <a href="#error-arg-list"><span class="ntref">error-arg-list</span></a> <code>)</code>
<span class="ntdfn" id="error-arg-list">error-arg-list</span> := <a href="#positional-arg"><span class="ntref">positional-arg</span></a> [<code>,</code> <a href="#positional-arg"><span class="ntref">positional-arg</span></a>] (<code>,</code> <a href="#named-arg"><span class="ntref">named-arg</span></a>)*
</pre>
<p>
An error constructor constructs a new error value. If an error-type-reference is
specified, it must denote a type that is a subtype of error; the effect is the
same as making the contextually expected type be that specified by the
error-type-reference. If there is no applicable contextually expected type, then
it is the same as if there were a contextually expected type of
<code>error</code>.
</p>
<p>
The applicable contextually expected type E must be definite. The type-ids of
the constructed error value are those induced by E. Note that it is allowed for
E to refer to an intersection-type-descriptor.
</p>
<p>
The first positional-arg is of type string and specifies the error message; the
second positional-arg, if present, is of type <code>error?</code>, with a
default of nil, and specifies the cause.
</p>
<p>
Evaluating the error-constructor-expr constructs a new detail mapping. Each
named-arg specifies a field of the error detail mapping; the static type of each
named-arg must be a subtype of <code>value:Cloneable</code>. The type descriptor
E implies a type descriptor D for the detail mapping. The arg-name of every
named-arg must be specified as the field-name of an individual-field-descriptor
occurring in D, unless there are no such field names. Fields with default
values will also be added to the detail record based on D in the same way as the
mapping-constructor-expr adds fields with default values based on the
contextually expected type. The contextually expected type for each named-arg is
determined from D in the same way as for a mapping-constructor-expr. The detail
mapping is constructed as immutable, with its members being the result of
applying the ImmutableClone abstract operation to the result of evaluating each
named-arg and every defaultable arg.
</p>
<p>
The stack trace in the constructed error value describes the execution stack at
the point where the error constructor was evaluated.
</p>

</section>
<section>
<h3 id="section_6.18">6.18 Anonymous function expression</h3>

<pre class="grammar"><span class="ntdfn" id="anonymous-function-expr">anonymous-function-expr</span> := <a href="#explicit-anonymous-function-expr"><span class="ntref">explicit-anonymous-function-expr</span></a> | <a href="#infer-anonymous-function-expr"><span class="ntref">infer-anonymous-function-expr</span></a>
<span class="ntdfn" id="explicit-anonymous-function-expr">explicit-anonymous-function-expr</span> := [<a href="#annots"><span class="ntref">annots</span></a>] <a href="#function-quals"><span class="ntref">function-quals</span></a> <code>function</code> <a href="#function-signature"><span class="ntref">function-signature</span></a> (<a href="#block-function-body"><span class="ntref">block-function-body</span></a>|<a href="#expr-function-body"><span class="ntref">expr-function-body</span></a>)
</pre>
<p>
Evaluating an anonymous-function-expr creates a closure, whose basic type is
function. With an explicit-anonymous-function-expr, the type of the function is
specified explicitly as usual with a function-signature. With an
infer-anonymous-function-expr, the type of the function is inferred.
</p>
<p>
If block-function-body refers to a block-scope variable defined
outside of the block-function-body, the closure will capture a reference to that
variable; the captured reference will refer to the same storage as the original
reference not a copy.
</p>

<pre class="grammar"><span class="ntdfn" id="infer-anonymous-function-expr">infer-anonymous-function-expr</span> := <a href="#infer-param-list"><span class="ntref">infer-param-list</span></a> <a href="#expr-function-body"><span class="ntref">expr-function-body</span></a>
<span class="ntdfn" id="infer-param-list">infer-param-list</span> :=
   <a href="#identifier"><span class="ntref">identifier</span></a>
   | <code>(</code>[<a href="#identifier"><span class="ntref">identifier</span></a> (<code>,</code> <a href="#identifier"><span class="ntref">identifier</span></a>)*]<code>)</code>
</pre>
<p>
An infer-anonymous-function-expr can only be used in a context where a function
type is expected. Both the types of the parameters and whether the function type
is <code>isolated</code> are inferred from the expected function type. The
function type will be inferred to be <code>transactional</code> if the
expr-function-body calls any functions with a transactional type.
The scope of the parameters is <code>expr-function-body</code>.
The static type of the infer-anonymous-function-expr will be a function type
whose return type is the static type of the <code>expression</code> in
<code>expr-function-body</code>. If the contextually expected type for the
<code>anonymous-function-expr</code> is a function type with return type T, then
the contextually expected type for <code>expression</code> in
<code>expr-function-body</code> is T.
</p>
</section>

<section>
<h3 id="section_6.19">6.19 Let expression</h3>

<pre class="grammar"><span class="ntdfn" id="let-expr">let-expr</span> := <code>let</code> <a href="#let-var-decl"><span class="ntref">let-var-decl</span></a> [<code>,</code> <a href="#let-var-decl"><span class="ntref">let-var-decl</span></a>]* <code>in</code> <a href="#expression"><span class="ntref">expression</span></a>
<span class="ntdfn" id="let-var-decl">let-var-decl</span> := [<a href="#annots"><span class="ntref">annots</span></a>] <a href="#typed-binding-pattern"><span class="ntref">typed-binding-pattern</span></a> <code>=</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>

<p>
A let-expr binds variables and then evaluates an expression with those variables in scope.
</p>
<p>
A let-expr <code>let T B = E<sub>1</sub> in E<sub>2</sub></code> is evaluated as
follows. E<sub>1</sub> is evaluated resulting in a value v. The typed binding
pattern T B is matched to v, causing assignments to the variables occuring in B.
Then E<sub>2</sub> is evaluated with those variables in scope; the resulting
value is the result of the let-expr.
</p>
<p>
A let-expr <code>let D<sub>1</sub>, D<sub>2</sub>,...,D<sub>n</sub> in E</code>
is transformed into <code>let D<sub>1</sub> in let D<sub>2</sub> in ... let
D<sub>n</sub> in E</code>.
</p>
<p>
The typed-binding-pattern is used unconditionally, meaning that it is a compile
error if the static types do not guarantee the success of the match. If the
typed-binding-pattern uses <code>var</code>, then the type of the variable is
inferred from the precise static type of the expression following
<code>=</code>.
</p>
<p>
Since expressions cannot modify variables, the variables bound in a let-var-decl
are implicitly final. A let-expr is isolated if the expression following
<code>in</code> is isolated; a reference in that expression to a variable bound
by a let-var-decl will be treated as isolated if the expression initializing the
variable in the let-var-decl is isolated.
</p>

</section>

<section>
<h3 id="section_6.20">6.20 Type cast expression</h3>

<pre class="grammar"><span class="ntdfn" id="type-cast-expr">type-cast-expr</span> := <code>&lt;</code> <a href="#type-cast-param"><span class="ntref">type-cast-param</span></a> <code>&gt;</code> <a href="#expression"><span class="ntref">expression</span></a>
<span class="ntdfn" id="type-cast-param">type-cast-param</span> := [<a href="#annots"><span class="ntref">annots</span></a>] <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> | <a href="#annots"><span class="ntref">annots</span></a>
</pre>
<p>
A <code>type-cast-expr</code> casts the value resulting from evaluating
<code>expression</code> to the type described by the type-descriptor, performing
a numeric conversion if required.
</p>
<p>
Normally, the parameter for a type-cast-expr includes a type-descriptor.
However, it is also allowed for the parameter to consist only of annotations; in
this case, the only effect of the type cast is for the contextually expected
type for expression to be augmented with the specified annotations. The rest of
this subsection describes the normal case, where the type-cast-expr includes a
type-descriptor.
</p>
<p>
A type-cast-expr is evaluated by first evaluating <code>expression</code>
resulting in a value v. Let T be the type described by
<code>type-descriptor</code>. If v belongs T, then the result of the
type-cast-expr is v. Otherwise, if T includes shapes from exactly one basic
numeric type N and v belongs to another basic numeric type, then let n be
NumericConvert(N, v); if n is not an error and n belongs to T, then the result
of the type-cast-expr is n. Otherwise, the evaluation of the type-cast-expr
completes abruptly with a panic.
</p>
<p>
Let T be the static type described by <code>type-descriptor</code>, and let TE
be the static type of <code>expression</code>. Then the static type of the
<code>type-cast-expr</code> is the intersection of T and TE', where TE' is TE
with its numeric shapes transformed to take account of the possibility of the
numeric conversion specified in the previous paragraph.
It is a compile-time error to attempt to use a type cast to
<em>cast away</em> an error: if the intersection of TE and <code>error</code> is
non-empty, then the intersection of T and <code>error</code> must also be
non-empty. A <code>checkpanic</code> expression can be used instead to assert
that the result of an expression will never be an error.
</p>
<p>
The contextually expected type for <code>expression</code> is the intersection
of the contextually expected type of the <code>type-cast-expr</code> and the
type described by the <code>type-descriptor</code>.
</p>
<p>
Note that a <code>type-cast-expr</code> of <code>&lt;readonly&gt;</code> can be
used both to cause constructors withing the <code>expression</code> to construct
values with the read-only bit on and to verify that the value resulting from
the evaluation of <code>expression</code> has its read-only bit on.
</p>

</section>
<section>
<h3 id="section_6.21">6.21 Typeof expression</h3>

<pre class="grammar"><span class="ntdfn" id="typeof-expr">typeof-expr</span> := <code>typeof</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
The result of a <code>typeof-expr</code> is a typedesc value for the runtime
type of v, where v is the result of evaluating <code>expression</code>.
</p>
<p>
The runtime type of v is the narrowest type to which v belongs.
</p>
<ul>
<li>When v is a simple value, the resulting typedesc will describe a type
consisting of a single shape, which is the shape of the value. The typedesc will
not have any annotations. Each evaluation of <code>typeof</code> with a simple
value produces a new typedesc value.</li>
<li>When v is a reference value, each evaluation of <code>typeof</code> with an
identical reference value produces an identical typedesc value. The type
descriptor resulting from <code>typeof</code> will be the same as the type
descriptor used to construct the value. For containers, this is the same as the
inherent type; when the container is immutable, it will be a singleton type. For
an object, this is the same as the type descriptor used with new. For an error,
this is the same as the type descriptor used in the functional-constructor-expr.
Any annotations that were attached to the type descriptor used to construct the
value will this be available on the constructed value.</li>
</ul>
<p>
The static type of <code>typeof-expr</code> is typedesc&lt;T&gt;, where T is the
static type of <code>expression</code>.
</p>
</section>
<section>
<h3 id="section_6.22">6.22 Unary expression</h3>

<pre class="grammar"><span class="ntdfn" id="unary-expr">unary-expr</span> :=
   <code>+</code> <a href="#expression"><span class="ntref">expression</span></a>
   | <code>-</code> <a href="#expression"><span class="ntref">expression</span></a>
   | <code>~</code> <a href="#expression"><span class="ntref">expression</span></a>
   | <code>!</code> <a href="#expression"><span class="ntref">expression</span></a>

</pre>
<p>
The unary <code>-</code> operator performs negation. The static type of the
operand must be a number; the static type of the result is the same basic type
as the static type of the operand. The semantics for each basic type are as
follows:
</p>
<ul>
<li>int: negation for int is the same as subtraction from zero; a panic will
occur on overflow, which happens when the operand is -2<sup>63</sup>)</li>
<li>float, decimal: negation for floating point types corresponds to the negate
operation as defined by IEEE 754-2008 (this is not the same as subtraction from
zero);</li>
</ul>
<p>
If the contextually expected type for a <code>-</code> expression is T, then the
contextualy expected type for the operand expressions is T', where a value v is
in T' if it belongs to int, decimal or float, and T contains a value with the
same basic type as v.
</p>
<p>
The unary + operator returns the value of its operand expression. The static
type of the operand must be a number, and the static type of the result is the
same as the static type of the operand expression.
</p>
<p>
The ~ operator inverts the bits of its operand expression. The static type of
the operand must be int, and the static type of the result is an int.
</p>
<p>
The <code>!</code> operator performs logical negation. The static type of the
operand expression must be boolean. The <code>!</code> operator returns true if
its operand is false and false if its operand is true.
</p>
</section>
<section>
<h3 id="section_6.23">6.23 Multiplicative expression</h3>

<pre class="grammar"><span class="ntdfn" id="multiplicative-expr">multiplicative-expr</span> :=
   <a href="#expression"><span class="ntref">expression</span></a> <code>*</code> <a href="#expression"><span class="ntref">expression</span></a>
   | <a href="#expression"><span class="ntref">expression</span></a> <code>/</code> <a href="#expression"><span class="ntref">expression</span></a>
   | <a href="#expression"><span class="ntref">expression</span></a> <code>%</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
The <code>*</code> operator performs multiplication; the <code>/</code> operator
performs division; the <code>%</code> operator performs remainder.
</p>
<p>
The static type of both operand expressions is required to be a subtype of the
same basic type; this basic type will be the static type of the result. The
following basic types are allowed:
</p>
<ul>
<li>int
<ul>
<li>
<code>*</code> performs integer multiplication; a panic will occur on overflow</li>
<li>
<code>/</code> performs integer division, with any fractional part discarded
ie with truncation towards zero; a panic will occur on division by zero or
overflow, which happens if the first operand is -2<sup>63</sup> and the second
operand is -1</li>
<li>
<code>%</code> performs integer remainder consistent with integer division,
so that if <code><var>x</var>/<var>y</var></code> does not result in a panic,
then <code>(<var>x</var>/<var>y</var>)*<var>y</var> +
(<var>x</var>%<var>y</var>)</code> is equal to <code><var>x</var></code>; a
panic will occur if the second operand is zero; if the first operand is
-2<sup>63</sup> and the second operand is -1, then the result is 0</li>
</ul>
</li>
<li>float, decimal
<ul>
<li>
<code>*</code> performs the multiplication operation with the destination
format being the same as the source format, as defined by IEEE 754-2008; this
never causes a panic to occur</li>
<li>
<code>/</code> performs the division operation with the destination format
being the same as the source format, as defined by IEEE 754-2008; this never
causes a panic to occur</li>
<li>
<code>%</code> performs a remainder operation; the remainder is not the
IEEE-defined remainder operation but is instead a remainder operation analogous
to integer remainder; more precisely,
<ul>
<li>if <code><var>x</var></code> is NaN or <code><var>y</var></code> is NaN or
<code><var>x</var></code> is an infinity or <code><var>y</var></code> is a zero,
then <code><var>x</var> % <var>y</var></code> is NaN</li>
<li>for finite <code>x</code>, and infinite <code>y</code>, <code><var>x</var> %
<var>y</var></code> is <code><var>x</var></code>
</li>
<li>for finite <code><var>x</var></code> and finite non-zero
<code><var>y</var></code>, <code><var>x</var> % <var>y</var></code> is equal to
the result of rounding <code><var>x</var> - (<var>y</var> Ã <var>n</var>)</code>
to the nearest representable value using the roundTiesToEven rounding mode,
where <code><var>n</var></code> is the integer that is nearest to the
mathematical quotient of <code><var>x</var></code> and <code><var>y</var></code>
without exceeding it in magnitude; if the result is zero, then its sign is that
of <code><var>x</var></code>
</li>
<li>no exceptions are thrown</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>
If the contextually expected type for a multiplicative-expr is T, then the
contextualy expected type for both operand expressions is T', where a value v is
in T' if it belongs to int, decimal or float, and T contains a value with the
same basic type as v.
</p>
</section>
<section>
<h3 id="section_6.24">6.24 Additive expression</h3>

<pre class="grammar"><span class="ntdfn" id="additive-expr">additive-expr</span> :=
   <a href="#expression"><span class="ntref">expression</span></a> <code>+</code> <a href="#expression"><span class="ntref">expression</span></a>
   | <a href="#expression"><span class="ntref">expression</span></a> <code>-</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
The <code>+</code> operator is used for both addition and concatenation; the
<code>-</code> operator is used for subtraction.
</p>
<p>
It is required that either
</p>
<ul>
<li>the static type of both operand expressions is a subtype of the same basic
type, in which case this basic type will be the static type of the result,
or</li>
<li>the static type of one operand expression must be a subtype of xml and of
the other operand expression must be a subtype of string, in which case the
static type of the result is xml</li>
</ul>
<p>
The semantics for each basic type is as follows:
</p>
<ul>
<li>int
<ul>
<li>
<code>+</code> performs integer addition; a panic will occur on
overflow</li>
<li>
<code>-</code> performs integer subtraction; a panic will occur on
overflow</li>
</ul>
</li>
<li>float, decimal
<ul>
<li>
<code>+</code> performs the addition operation with the destination format
being the same as the source format, as defined by IEEE 754-2008; this never
causes a panic to occur</li>
<li>
<code>-</code> performs the subtraction operation with the destination
format being the same as the source format, as defined by IEEE 754-2008; this
never causes a panic to occur</li>
</ul>
</li>
<li>string, xml
<ul>
<li>if both operands are a string, then the result is a string that is the
concatenation of the operands</li>
<li>if both operands are xml, then the result is a new xml value that is the
concatenation of the operands; this does not perform a copy on
the constituents of the operand values</li>
<li>if one operand is an empty string and one is xml, then
the result is the xml value operand</li>
<li>if one operand is a non-empty string and one is xml, then the string is
treated as if it were an xml singleton text value whose characters are the same
as the characters of the string;</li>
</ul>
</li>
</ul>
<p>
If the contextually expected type for a multiplicative-expr is T, then the
contextualy expected type for both operand expressions is T', where a value v is
in T' if it belongs to int, decimal, float, string or xml and T contains a value
with the same basic type as v.
</p>

</section>
<section>
<h3 id="section_6.25">6.25 Shift expression</h3>

<pre class="grammar"><span class="ntdfn" id="shift-expr">shift-expr</span> :=
   <a href="#expression"><span class="ntref">expression</span></a> <code>&lt;&lt;</code> <a href="#expression"><span class="ntref">expression</span></a>
   <a href="#expression"><span class="ntref">expression</span></a> <code>&gt;&gt;</code> <a href="#expression"><span class="ntref">expression</span></a>
   <a href="#expression"><span class="ntref">expression</span></a> <code>&gt;&gt;&gt;</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
A shift-expr performs a bitwise shift. Both operand expressions must have static
type that is a subtype of int. The left hand operand is the value to be shifted;
the right hand value is the shift amount; all except the bottom 6 bits of the
shift amount are masked out (as if by x &amp; 0x3F). Then a bitwise shift is
performed depending on the operator:
</p>
<ul>
<li>
<code>&lt;&lt;</code> performs a left shift, the bits shifted in on the
right are zero</li>
<li>
<code>&gt;&gt;</code> performs a signed right shift; the bits shifted in on the
left are the same as the most significant bit</li>
<li>
<code>&gt;&gt;&gt;</code> performs a unsigned right shift, the bits shifted in on the
left are zero</li>
</ul>
<p>
If the operator is &gt;&gt; or &gt;&gt;&gt; and the left hand operand is a
subtype of <code>int:Unsigned<var>K</var></code> when <code><var>K</var></code>
is 8, 16 or 32, then the static type of the result is
<code>int:Unsigned<var>N</var></code> where <code><var>N</var></code> is the
smallest such <code><var>K</var></code>; otherwise, the static type of the
result is <code>int</code>.
</p>
</section>
<section>
<h3 id="section_6.26">6.26 Range expression</h3>

<pre class="grammar"><span class="ntdfn" id="range-expr">range-expr</span> :=
   <a href="#expression"><span class="ntref">expression</span></a> <code>...</code> <a href="#expression"><span class="ntref">expression</span></a>
   | <a href="#expression"><span class="ntref">expression</span></a> <code>..&lt;</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
The result of a range-expr is a new object belonging to the object type
Iterable&lt;int,()&gt; that will iterate over a sequence of integers in increasing
order, where the sequence includes all integers n such that
</p>
<ul>
<li>the value of the first expression is less than or equal to n, and</li>
<li>n is
<ul>
<li>if the operator is <code>...</code>, less than or equal to the value of the
second expression</li>
<li>if the operator is <code>..&lt;</code>, less than the value of the second
expression</li>
</ul>
</li>
</ul>
<p>
It is a compile error if the static type of either expression is not a subtype
of int.
</p>
<p>
A range-expr is designed to be used in a foreach statement, but it can be used
elsewhere.
</p>
<p>
A range-expr is always isolated.
</p>
</section>
<section>
<h3 id="section_6.27">6.27 Relational expression</h3>

<pre class="grammar"><span class="ntdfn" id="relational-expr">relational-expr</span> :=
   <a href="#expression"><span class="ntref">expression</span></a> <code>&lt;</code> <a href="#expression"><span class="ntref">expression</span></a>
   | <a href="#expression"><span class="ntref">expression</span></a> <code>&gt;</code> <a href="#expression"><span class="ntref">expression</span></a>
   | <a href="#expression"><span class="ntref">expression</span></a> <code>&lt;=</code> <a href="#expression"><span class="ntref">expression</span></a>
   | <a href="#expression"><span class="ntref">expression</span></a> <code>&gt;=</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
A relational-expr tests the relative order of two values. There must be an <a href="#ordering">ordered</a> type to which the static type of both operands
belong. The static type of the result is boolean.
</p>
<p>
A relational-expr is evaluated by first evaluating the two expressions,
resulting in values x and y. The result of relational-expr is true if and only
if the result of the Compare(x,y) operation is
</p>
<ul>
<li>LT, if the operator is <code>&lt;</code>
</li>
<li>GT, if the operator is <code>&gt;</code>
</li>
<li>LT or EQ, if the operator is <code>&lt;=</code>
</li>
<li>GT or EQ, if the operator is <code>&gt;=</code>
</li>
</ul>
<p>
and otherwise false.
</p>
</section>
<section>
<h3 id="section_6.28">6.28 Type test expression</h3>

<pre class="grammar"><span class="ntdfn" id="is-expr">is-expr</span> :=
   <a href="#expression"><span class="ntref">expression</span></a> <code>is</code> <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a>
</pre>
<p>
An is-expr tests where a value belongs to a type.
</p>
<p>
An is-expr is evaluated by evaluating the expression yielding a result v. If v
belongs to the type denoted by type-descriptor, then the result of the is-expr
is true; otherwise the result of the is-expr is false.
</p>
</section>
<section>
<h3 id="section_6.29">6.29 Equality expression</h3>

<pre class="grammar"><span class="ntdfn" id="equality-expr">equality-expr</span> :=
   <a href="#expression"><span class="ntref">expression</span></a> <code>==</code> <a href="#expression"><span class="ntref">expression</span></a>
   | <a href="#expression"><span class="ntref">expression</span></a> <code>!=</code> <a href="#expression"><span class="ntref">expression</span></a>
   | <a href="#expression"><span class="ntref">expression</span></a> <code>===</code> <a href="#expression"><span class="ntref">expression</span></a>
   | <a href="#expression"><span class="ntref">expression</span></a> <code>!==</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
An equality-expr tests whether two values are equal. For all four operators, it
is a compile time error if the intersection of the static types of the operands
is empty.
</p>
<p>
The === operator tests for exact equality. The !== operator results in the
negation of the result of the === operator. Two values v<sub>1</sub> and
v<sub>2</sub> are exactly equal if they have the same basic type T and
</p>
<ul>
<li>T is simple type, and  v<sub>1</sub> and v<sub>2</sub> are identical values
within the possible of values allowed for T;</li>
<li>T is a sequence type, and the length of v<sub>1</sub> is the same as the length of v<sub>2</sub> and
<ul>
<li>the length is 1, and either
<ul>
<li>v<sub>1</sub> and v<sub>2</sub> both have storage identity and that storage
identity is the same, or</li>
<li>v<sub>1</sub> and v<sub>2</sub> both do not have storage identity and the
shape of v<sub>1</sub> is the same as the shape of v<sub>2</sub>
</li>
</ul>
</li>
<li>the length is not 1, and every constituent of v<sub>1</sub> is exactly equal
as the corresponding constituent of v<sub>2</sub>;</li>
</ul>
</li>
<li>T is a structural or behavioural type, and the storage identity of
v<sub>1</sub> is the same as the storage identity of v<sub>2</sub>.</li>
</ul>
<p>
The == operator tests for deep equality. The != operator results in the negation
of the result of the == operator. For both == and !=, both operands must have a
static type that is a subtype of anydata. Two values v1, v2 are deeply equal if
DeepEquals(v1, v2) is true.
</p>
<p>
Note that === and == are the same for simple values except for floating point types.
</p>
<p>
For the float type, the operators differ as regards floating point zero: ==
treats positive and negative zero from the same basic type as equal whereas ===
treats them as unequal. Both == and === treat two NaN values from the same basic
type as equal. This means that neither of these operators correspond to
operations defined by IEEE 754-2008, because they do not treat NaN in the
special way defined for those operations.
</p>
<p>
For the decimal type, the operators differ in whether they consider the
precision of the value. For example, <code>1.0 == 1.00</code> is true but
<code>1.0 === 1.00</code> is false.
</p>

</section>
<section>
<h3 id="section_6.30">6.30 Binary bitwise expression</h3>

<pre class="grammar"><span class="ntdfn" id="binary-bitwise-expr">binary-bitwise-expr</span> :=
   <a href="#bitwise-and-expr"><span class="ntref">bitwise-and-expr</span></a>
   | <a href="#bitwise-xor-expr"><span class="ntref">bitwise-xor-expr</span></a>
   | <a href="#bitwise-or-expr"><span class="ntref">bitwise-or-expr</span></a>
<span class="ntdfn" id="bitwise-and-expr">bitwise-and-expr</span> := <a href="#expression"><span class="ntref">expression</span></a> <code>&amp;</code> <a href="#expression"><span class="ntref">expression</span></a>
<span class="ntdfn" id="bitwise-xor-expr">bitwise-xor-expr</span> := <a href="#expression"><span class="ntref">expression</span></a> <code>^</code> <a href="#expression"><span class="ntref">expression</span></a>
<span class="ntdfn" id="bitwise-or-expr">bitwise-or-expr</span> := <a href="#expression"><span class="ntref">expression</span></a> <code>|</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
A binary-bitwise-expr does a bitwise AND, XOR, or OR operation on its operands.
</p>
<p>
The static type of both operands must be a subtype of int. The static type of
the result is as follows:
</p>
<ul>
<li>for AND, if the type of either operand is a subtype of
<code>int:Unsigned<var>K</var></code> when <code><var>K</var></code> is 8, 16 or
32, then the static type of the result is <code>int:Unsigned<var>N</var></code>
where <code><var>N</var></code> is the smallest such <code><var>K</var></code>;
otherwise, the static type of the result is <code>int</code>;</li>
<li>for XOR or OR, if the type of both operands is a
subtype of <code>int:Unsigned<var>K</var></code> when <code><var>K</var></code>
is 8, 16 or 32, then the static type of the result is
<code>int:Unsigned<var>N</var></code> where <code><var>N</var></code> is the
smallest such <code><var>K</var></code>; otherwise, the static type of the result
is <code>int</code>.</li>
</ul>
</section>

<section>
<h3 id="section_6.31">6.31 Logical expression</h3>

<pre class="grammar"><span class="ntdfn" id="logical-expr">logical-expr</span> := <a href="#logical-and-expr"><span class="ntref">logical-and-expr</span></a> | <a href="#logical-or-expr"><span class="ntref">logical-or-expr</span></a>
<span class="ntdfn" id="logical-and-expr">logical-and-expr</span> := <a href="#expression"><span class="ntref">expression</span></a> <code>&amp;&amp;</code> <a href="#expression"><span class="ntref">expression</span></a>
<span class="ntdfn" id="logical-or-expr">logical-or-expr</span> := <a href="#expression"><span class="ntref">expression</span></a> <code>||</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>

<p>
The static type of each expression in a logical-expr must be a subtype of
boolean.
</p>
<p>
A logical-and-expr is evaluated as follows:
</p>
<ol>
<li>the left-hand expression is evaluated, resulting in a value <var>x</var>;</li>
<li>if <var>x</var> is <code>false</code>, then the result of the
logical-and-expr is <var>x</var>, and the right-hand expression is not
evaluated;</li>
<li>otherwise, the result of the logical-and-expr is the result of evaluating
the right-hand expression.</li>
</ol>
<p>
A logical-or-expr is evaluated as follows:
</p>
<ol>
<li>the left-hand expression is evaluated, resulting in a value <var>x</var>;</li>
<li>if <var>x</var> is <code>true</code>, then the result of the
logical-or-expr is <var>x</var>, and the right-hand expression is not
evaluated;</li>
<li>otherwise, the result of the logical-or-expr is the result of evaluating
the right-hand expression.</li>
</ol>
</section>

<section>
<h3 id="section_6.32">6.32 Conditional expression</h3>

<pre class="grammar"><span class="ntdfn" id="conditional-expr">conditional-expr</span> :=
   <a href="#expression"><span class="ntref">expression</span></a> <code>?</code> <a href="#expression"><span class="ntref">expression</span></a> <code>:</code> <a href="#expression"><span class="ntref">expression</span></a>
   | <a href="#expression"><span class="ntref">expression</span></a> <code>?:</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
L <code>?:</code> R is evaluated as follows:
</p>
<ol>
<li>Evaluate L to get a value x</li>
<li>If x is not nil, then return x.</li>
<li>Otherwise, return the result of evaluating R.</li>
</ol>
</section>
<section>
<h3 id="section_6.33">6.33 Checking expression</h3>

<pre class="grammar"><span class="ntdfn" id="checking-expr">checking-expr</span> := <a href="#checking-keyword"><span class="ntref">checking-keyword</span></a> <a href="#expression"><span class="ntref">expression</span></a>
<span class="ntdfn" id="checking-keyword">checking-keyword</span> := <code>check</code> | <code>checkpanic</code>
</pre>
<p>
Evaluates expression resulting in value v. If v has basic type error, then
</p>
<ul>
<li>if the checking-keyword is <code>check</code>, then the check-expression
completes abruptly with a check-fail with associated value v;</li>
<li>if the checking-keyword is <code>checkpanic</code>, then the check-expression
completes abruptly with a panic with associated value v.</li>
</ul>
<p>
If the static type of expression <code><var>Expr</var></code> is T|E, where E is
a subtype of error, then the static type of <code>check <var>Expr</var></code>
or <code>checkpanic <var>Expr</var></code> is T. However, if:
</p>
<ul>
<li>the checking-keyword is <code>check</code>,</li>
<li>the above rules would result in a compile-time error,</li>
<li>the static type of <code><var>Expr</var></code> is lax,</li>
<li>T is a subtype of <code>json</code>, and</li>
<li>there is a contextually expected type S, where S is a subtype of
<code>()|int|float|decimal|string</code>,</li>
</ul>
<p>
then instead <code>check <var>Expr</var></code> is treated as <code>check
<var>val</var>:ensureType(<var>Expr</var>, <var>s</var>)</code>, where
<code><var>s</var></code> is a typedesc value representing S and
<code><var>val</var></code> refers to the <code>value</code> module in langlib.
</p>
</section>
<section>
<h3 id="section_6.34">6.34 Trap expression</h3>
<p>
The trap expression stops a panic and gives access to the error value associated
with the panic.
</p>
<pre class="grammar"><span class="ntdfn" id="trap-expr">trap-expr</span> := <code>trap</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>  
<p>
Semantics are:
</p>
<ul>
<li>Evaluate <code>expression</code> resulting in value v
<ul>
<li>If evaluation completes abruptly with panic with associated value e, then
result of trap-exp is e</li>
<li>Otherwise result of trap-expr is v</li>
</ul>
</li>
<li>If type of <code>expr</code> is T, then type of <code>trap expr</code> is
T|error. It is permitted for T to be <code>never</code>.</li>
</ul>
</section>

<section>
<h3 id="section_6.35">6.35 Query expression</h3>
<p>
A query expression provides a language-integrated query feature using SQL-like
syntax. In this version of Ballerina, the functionality is similar to a list
comprehensions; future versions will provided richer functionality.
</p>

<pre class="grammar"><span class="ntdfn" id="query-expr">query-expr</span> := [<a href="#query-construct-type"><span class="ntref">query-construct-type</span></a>] <a href="#query-pipeline"><span class="ntref">query-pipeline</span></a> <a href="#select-clause"><span class="ntref">select-clause</span></a> [<a href="#on-conflict-clause"><span class="ntref">on-conflict-clause</span></a>]
<span class="ntdfn" id="query-construct-type">query-construct-type</span> :=
  <code>table</code> <a href="#key-specifier"><span class="ntref">key-specifier</span></a>
  | <code>stream</code>
<span class="ntdfn" id="query-pipeline">query-pipeline</span> := <a href="#from-clause"><span class="ntref">from-clause</span></a> <a href="#intermediate-clause"><span class="ntref">intermediate-clause</span></a>*
<span class="ntdfn" id="intermediate-clause">intermediate-clause</span> :=
   <a href="#from-clause"><span class="ntref">from-clause</span></a>
   | <a href="#where-clause"><span class="ntref">where-clause</span></a>
   | <a href="#let-clause"><span class="ntref">let-clause</span></a>
   | <a href="#join-clause"><span class="ntref">join-clause</span></a>
   | <a href="#order-by-clause"><span class="ntref">order-by-clause</span></a>
   | <a href="#limit-clause"><span class="ntref">limit-clause</span></a>
</pre>
<p>
A query expression consists of a sequence of clauses. The semantics of clauses
is specified in terms of transforming a sequence of frames, where a frame is a
binding of variables to values. The input to each clause is a sequence of
frames. As each clause is executed, it iterates over its input frames and emits
output: the final clause, which is a <code>select</code> clause, emits output
<em>values</em>; the other clauses emit output <em>frames</em>. When a
query-expr is evaluated, its clauses are executed in a pipeline by making the
sequence of frames emitted by one clause be the input to the next clause. Each
clause in the pipeline is executed lazily, pulling input from its preceding
clause. The input to the first clause is a single empty frame.
</p>
<p>
The execution of a clause may complete early with an error value, in which case
this error value is the result of the query, except when constructing a stream.
Otherwise, the result of evaluating a query expression is a single value, which
is constructed from the sequence of values emitted by the last clause. The
result must be one of the following basic types:
</p>
<ul>
<li>list - the constructed list has a member for each emitted value; every
emitted value must beloing to type T, where T[] is the type of the constructed
value</li>
<li>table - the constructed table has a member for each emitted value; every
emitted value must belong to type T, where table&lt;T&gt; is the type of the
constructed value</li>
<li>string - the constructed string is the concatenation of the emitted values;
every emitted value must be of type string</li>
<li>xml - the constructed xml value is the concatenation of the emitted values;
every emitted value must be of type xml</li>
<li>stream - the stream generates the emitted values</li>
</ul>
<p>
A query-expr that constructs a stream must start with the <code>stream</code>
keyword and is evaluated differently from a query-expr that constructs a value
of other basic types. The clauses in the query-expr are executed lazily: clauses
in the query-expr becomes closures, which are called as a result of next
operations being performed on the stream. If a next operation causes the
execution of a clause that completes early with an error value, then the error
value is returned by the next operation; the evaluation of the query-expr will
already have resulted in a stream value. If the next operation results in the
evaluation of an expression within the query-expr completing abruptly with a
check-fail, the associated error value will be returned as the result of the
next operation. If the next operation results in the evaluation of an expression
within the query-expr completely abruptly with a panic, then the next operation
will complete abruptly with a panic.
</p>
<p>
If the query-expr starts with <code>table</code>, then the query-expr will
construct a table; the key-specifier specifies the key sequence of the
constructed table in the same way as with a table-constructor-expr. Otherwise,
the applicable contextually expected type determines the basic type of the value
constructed. If there is no contextually expected type, then the basic type of
the value constructed is the basic type of expression following <code>in</code>;
it is a compile-time error if the static type of this expression is not a
subtype of one of the basic types that a query expression can construct.
</p>
<p>
When during the construction of a table, an emitted value is added as a new
member, it replaces any existing member with the same key value; when a new
member replaces an existing member, it will have the same position in the order
of members as the existing member. This behavior may be controlled by an
<code>on conflict</code> clause.
</p>
<p>
Variables bound by the clauses of a query-pipeline are implicitly final, and
cannot be modified.
</p>

<section>
<h4 id="section_6.35.1">6.35.1 From clause</h4>
<pre class="grammar"><span class="ntdfn" id="from-clause">from-clause</span> := <code>from</code> <a href="#typed-binding-pattern"><span class="ntref">typed-binding-pattern</span></a> <code>in</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
A <code>from</code> clause is executed as follows:
</p>
<ul>
<li>for each input frame <var>f</var>
<ul>
<li>evaluate the <code>in</code> expression with <var>f</var> in scope resulting
in an iterable value <var>c</var>;</li>
<li>create an Iterator object <var>i</var> from <var>c</var>
</li>
<li>do the following in a loop <var>L</var>
<ul>
<li>call <code><var>i</var>.next()</code> resulting in a value <var>r</var>;</li>
<li>if <var>r</var> is an error, then complete execution of the from-clause
early with error <var>r</var>;</li>
<li>if <var>r</var> is <code>()</code>, stop loop <var>L</var>;</li>
<li>let <var>v</var> be <code><var>r</var>.value</code>;</li>
<li>emit a frame consisting of <var>f</var> augmented with the variables
resulting from binding typed-binding-pattern to <var>v</var>.</li>
</ul>
</li>  
</ul>
</li>  
</ul>
</section>

<section>
<h4 id="section_6.35.2">6.35.2 Where clause</h4>
<pre class="grammar"><span class="ntdfn" id="where-clause">where-clause</span> := <code>where</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
A <code>where</code> clause is executed as follows:
</p>
<ul>
<li>for each input frame <var>f</var> 
<ul>
<li>execute the <code>expression</code> with <var>f</var> in scope resulting in
value <var>b</var>;</li>
<li>if <var>b</var> is true, emit <var>f</var>.</li>
</ul>
</li> 
</ul>
</section>

<section>
<h4 id="section_6.35.3">6.35.3 Let clause</h4>
<pre class="grammar"><span class="ntdfn" id="let-clause">let-clause</span> := <code>let</code> <a href="#let-var-decl"><span class="ntref">let-var-decl</span></a> [<code>,</code> <a href="#let-var-decl"><span class="ntref">let-var-decl</span></a>]* 
</pre>
<p>
A <code>let</code> clause consisting of a single let-var-decl is executed as follows:
</p>
<ul>
<li>for each input frame <var>f</var> 
<ul>
<li>evaluate the expression with <var>f</var> in scope resulting in a value <var>v</var>;</li>
<li>emit a frame consisting of <var>f</var> augmented with the result of binding
type-binding-pattern to <var>v</var>.</li>
</ul>
</li> 
</ul>
<p>
A <code>let</code> clause with more than one <code>let-var-decl</code> is
transformed into multiple <code>let</code> clauses: <code>let x<sub>1</sub> =
E<sub>1</sub>, x<sub>2</sub> = E<sub>2</sub></code> is transformed into
<code>let x<sub>1</sub> = E<sub>1</sub> let x<sub>2</sub> =
E<sub>2</sub></code>.
</p>
</section>

<section>
<h4 id="section_6.35.4">6.35.4 Join clause</h4>
<pre class="grammar"><span class="ntdfn" id="join-clause">join-clause</span> := [<code>outer</code>] <code>join</code> <a href="#typed-binding-pattern"><span class="ntref">typed-binding-pattern</span></a> <code>in</code> <a href="#expression"><span class="ntref">expression</span></a> <a href="#join-on-condition"><span class="ntref">join-on-condition</span></a>
<span class="ntdfn" id="join-on-condition">join-on-condition</span> := <code>on</code> <a href="#expression"><span class="ntref">expression</span></a> <code>equals</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
A join clause performs an inner or left outer equijoin.
</p>
<p>
A <code>join</code> clause is executed as follows:
</p>
<ul>
<li>compute a mapping for the right side of the join; during this computation
variable bindings from input frames are not in scope:
<ul>
<li>create an empty mapping <var>m</var> that maps from keys to lists of frames
(using <a href="#DeepEquals">DeepEquals</a> to compare keys);</li>
<li>evaluate the expression following <code>in</code> resulting in an iterable
value <var>c</var>;</li>
<li>create an Iterator object <var>i</var> from <var>c</var>;</li>
<li>do the following in a loop <var>L</var>
<ul>
<li>call <code><var>i</var>.next()</code> resulting in a value <var>r</var>;</li>
<li>if <var>r</var> is an error, then complete execution of the join-clause
early with error <var>r</var>;</li>
<li>if <var>r</var> is <code>()</code>, stop loop <var>L</var>;</li>
<li>let <var>v</var> be <code><var>r</var>.value</code>;</li>
<li>let <var>f</var> be a frame with the result of binding the
typed-binding-pattern to <var>v</var>;</li>
<li>evaluate the expression to right of <code>equals</code> with <var>f</var>
in scope resulting in a value <var>k</var>;</li>
<li>add an entry to <var>m</var> with key <var>k</var> and and frame <var>f</var>;</li>
</ul>
</li>
</ul>
</li>
<li>for each input frame <var>f</var>
<ul>
<li>evaluate the expression to the left of <code>equals</code> with frame <var>f</var>
in scope resulting in a value <var>k</var>;</li>
<li>let <var>fs</var> be the list of frames for key <var>k</var> in <var>m</var>;</li>
<li>for each frame <var>f'</var> in <var>fs</var>
<ul>
<li>emit a frame consisting of <var>f</var> augmented with <var>f'</var>;</li>
</ul>
</li>
<li>if <code>outer</code> was specified and <var>fs</var> is empty, then emit a
single frame consisting of <var>f</var> augmented with a frame that binds every
variable occurring in typed-binding-pattern to <code>()</code>.
</li>
</ul>
</li>
</ul>
<p>
In the above, if <var>c</var> evaluates to a table, and the result of evaluating
the expression to the right of <code>equals</code> for a member of the table
will always be the key value for that member of the table, then the above can be
optimized by using the table instead of creating a new mapping.
</p>
<p>
Variables bound by previous clauses are not in scope for the expression
following <code>in</code>, nor for the expression on the right of
<code>equals</code>. Variables bound by the typed-binding-pattern are not in
scope for the expression following <code>in</code>, nor for the expression on
the left of <code>equals</code>.
</p>
<p>
When <code>outer</code> is specified, the typed-binding-pattern is treated
specially: the inferable-type-descriptor in the typed-binding-pattern must be
<code>var</code>, and for each variable occurring in the typed-binding-pattern,
if the type that would be inferred usually for the variable would be
<var>T</var>, then the type inferred in this case will be
<var>T</var><code>?</code>.
</p>

</section>

<section>
<h4 id="section_6.35.5">6.35.5 Order by clause</h4>
<pre class="grammar">
<span class="ntdfn" id="order-by-clause">order-by-clause</span> := <code>order</code> <code>by</code> <a href="#order-key"><span class="ntref">order-key</span></a> [<code>,</code> <a href="#order-key"><span class="ntref">order-key</span></a>]*
<span class="ntdfn" id="order-key">order-key</span> := <a href="#expression"><span class="ntref">expression</span></a> [<a href="#order-direction"><span class="ntref">order-direction</span></a>]
<span class="ntdfn" id="order-direction">order-direction</span> := <code>ascending</code> | <code>descending</code>
</pre>
<p>
The static type of the expression in an order-key must be an <a href="#ordering">ordered</a> type. The order-direction is <code>ascending</code>
if not explicitly specified.
</p>
<p>
An <code>order-by</code> clause is executed by constructing a list
of entries, where each entry consists of:
</p>
<ul>
<li>a frame</li>
<li>a list of keys, one for each order-key in the order-by-clause, and</li>
<li>an integer index</li>
</ul>
<p>
In order to define the correct ordering of the list, we first define a CompareK
operation that compares two keys with a specified direction: CompareK(x,y,d) is
CompareA(x,y) if d is ascending and otherwise (d is descending) is
Reverse(CompareD(x,y)), where Reverse applied to LT, EQ, GT is GT, EQ, LT
respectively. Now define an operation CompareKL(x,y,d) applying to two lists of
keys and a list of directions as follows. Let x be
[x<sub>1</sub>,x<sub>2</sub>,...,x<sub>n</sub>], y be
[y<sub>1</sub>,y<sub>2</sub>,...,y<sub>n</sub>], and d be [d<sub>1</sub>,
d<sub>2</sub>,...,d<sub>n</sub>]. Then let r be
CompareK(x<sub>1</sub>,y<sub>1</sub>,d<sub>1</sub>). Then the result of
CompareKL(x,y,d) is:
</p>
<ul>
<li>r, if r is not EQ</li>
<li>otherwise, EQ, if n is 1</li>
<li>otherwise,
CompareKL([x<sub>2</sub>,...,x<sub>n</sub>],[y<sub>2</sub>,...,y<sub>n</sub>],[d<sub>2</sub>,...,d<sub>n</sub>]).</li>
</ul>
<p>
Then in a correct ordering of the list of entries when the list of directions is
d, an entry with keys with keys x and index i is before an entry with keys y and
index j if CompareKL(x,y,d) is LT or if CompareKL(x,y,d) is EQ and i is less
than j.
</p>
<p>
An <code>order-by</code> clause is executed as follows:
</p>
<ul>
<li>create an empty list <var>E</var> of entries</li>
<li>for each input frame <var>f</var> add an entry to <var>E</var> in which
<ul>
<li>the frame is <var>f</var>
</li>
<li>the list of keys is a list of the results of evaluating each order-key's
expression with <var>f</var> in scope</li>
<li>the index is the length of <var>E</var>
</li>
</ul>
</li>
<li>sort <var>E</var> so that it is ordered correctly as described above</li>
<li>for each entry in <var>E</var>, emit the entry's frame</li>
</ul>

</section>
<section>
<h4 id="section_6.35.6">6.35.6 Limit clause</h4>
<pre class="grammar">
<span class="ntdfn" id="limit-clause">limit-clause</span> := <code>limit</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
A <code>limit</code> clause limits the number of frames emitted by a query pipeline.
</p>
<p>
A <code>limit</code> clause is executed as follows:
</p>
<ul>
<li>evaluate expression resulting in a value <var>n</var>; variable bindings
from input frames are not in scope for this evaluation;</li>
<li>if <var>n</var> is less than zero, then panic;</li>
<li>for each input frame <var>f</var>, while <var>n</var> is greater than 0
<ul>
<li>decrement <var>n</var>;</li>
<li>emit <var>f</var>.</li> 
</ul>
</li> 
</ul>

<p>
The static type of expression must be a subtype of <code>int</code>.
</p>

</section>

<section>
<h4 id="section_6.35.7">6.35.7 Select clause</h4>
<pre class="grammar">
<span class="ntdfn" id="select-clause">select-clause</span> := <code>select</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
A <code>select</code> clause is executed as follows:
</p>
<ul>
<li>for each input frame <var>f</var> 
<ul>
<li>evaluate the expression with <var>f</var> in scope resulting in value <var>v</var>
</li>
<li>emit <var>v</var>
</li> 
</ul>
</li> 
</ul>
</section>

<section>
<h4 id="section_6.35.8">6.35.8 On conflict clause</h4>
<pre class="grammar">
<span class="ntdfn" id="on-conflict-clause">on-conflict-clause</span> := <code>on</code> <code>conflict</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
An <code>on conflict</code> clause is allowed only for a query expression that
constructs a table with a key sequence. The expression is evaluated when the
<code>select</code> clause emits a value that conflicts with a previous value,
in the sense that both values have the same key value in the table. The
expression is evaluated with the same frame in scope as the select clause that
emitted the value that conflicts with the previous value. The static type of the
expression must be a subtype of <code>error?</code>. If the result of evaluating
the expression is an error <var>e</var>, then the result of evaluating the
query-expr is <var>e</var>. Otherwise, the result must be nil, and the earlier
new value replaces the earlier conflicting value, in the same way as if there
not been an <code>on conflict</code> clause.
</p>
<p>
Note that the expression may have side-effects; for example, it may call a
function that logs an error.
</p>
</section>

</section>
<section>
<h3 id="section_6.36">6.36 XML navigation expression</h3>
<p>
XML navigation expressions allow for convenient navigation of XML element structure,
in a similar way to XPath.
</p>

<pre class="grammar"><span class="ntdfn" id="xml-navigate-expr">xml-navigate-expr</span> := <a href="#xml-filter-expr"><span class="ntref">xml-filter-expr</span></a> | <a href="#xml-step-expr"><span class="ntref">xml-step-expr</span></a>
</pre>
<section>
<h4 id="section_6.36.1">6.36.1 XML name pattern</h4>
<pre class="grammar"><span class="ntdfn" id="xml-name-pattern">xml-name-pattern</span> := <a href="#xml-atomic-name-pattern"><span class="ntref">xml-atomic-name-pattern</span></a> [<code>|</code> <a href="#xml-atomic-name-pattern"><span class="ntref">xml-atomic-name-pattern</span></a>]*

<span class="ntdfn" id="xml-atomic-name-pattern">xml-atomic-name-pattern</span> :=
  <code>*</code>
  | <a href="#identifier"><span class="ntref">identifier</span></a>
  | <a href="#xml-namespace-prefix"><span class="ntref">xml-namespace-prefix</span></a> <code>:</code> <a href="#identifier"><span class="ntref">identifier</span></a>
  | <a href="#xml-namespace-prefix"><span class="ntref">xml-namespace-prefix</span></a> <code>:</code> <code>*</code>
</pre>

<p>
An XML name pattern matches a string specifying the name of an XML element.
</p>
<p>
An xml-atomic-name-pattern that is <code>*</code> matches any name.
</p>
<p>
An xml-namespace-prefix in an xml-atomic-name-pattern must be declared by an
xmlns-decl. If there is an in-scope default namespace (declared by an
xmlns-decl), an xml-atomic-pattern that is just an identifier specifies a
name in that default namespace.
</p>
</section>
<section>
<h4 id="section_6.36.2">6.36.2 XML filter expression</h4>
<pre class="grammar"><span class="ntdfn" id="xml-filter-expr">xml-filter-expr</span> := <a href="#expression"><span class="ntref">expression</span></a> <code>.&lt;</code> <a href="#xml-name-pattern"><span class="ntref">xml-name-pattern</span></a> <code>&gt;</code>
</pre>
<p>
An xml-filter-expr selects constituents of a sequence that are elements with a
name matching a specified name pattern. The static type of the expression must
be a subtype of xml. The static type of the xml-filter-expr is
<code>xml&lt;xml:Element&gt;</code>.
</p>
</section>
<section>
<h4 id="section_6.36.3">6.36.3 XML step expression</h4>
<p>
An xml-step-expr provides access to the children or descendants of an element,
similar to a location path in XPath.
</p>
<pre class="grammar"><span class="ntdfn" id="xml-step-expr">xml-step-expr</span> := <a href="#expression"><span class="ntref">expression</span></a> <a href="#xml-step-start"><span class="ntref">xml-step-start</span></a> <a href="#xml-step-extend"><span class="ntref">xml-step-extend</span></a>*

<span class="ntdfn" id="xml-step-start">xml-step-start</span> :=
   <a href="#xml-all-children-step"><span class="ntref">xml-all-children-step</span></a>
   | <a href="#xml-element-children-step"><span class="ntref">xml-element-children-step</span></a>
   | <a href="#xml-element-descendants-step"><span class="ntref">xml-element-descendants-step</span></a>
<span class="ntdfn" id="xml-all-children-step">xml-all-children-step</span> := <code>/*</code>
<span class="ntdfn" id="xml-element-children-step">xml-element-children-step</span> := <code>/&lt;</code> <a href="#xml-name-pattern"><span class="ntref">xml-name-pattern</span></a> <code>&gt;</code>
<span class="ntdfn" id="xml-element-descendants-step">xml-element-descendants-step</span> := <code>/**/&lt;</code> <a href="#xml-name-pattern"><span class="ntref">xml-name-pattern</span></a> <code>&gt;</code>

<span class="ntdfn" id="xml-step-extend">xml-step-extend</span> :=
   <code>.&lt;</code> <a href="#xml-name-pattern"><span class="ntref">xml-name-pattern</span></a> <code>&gt;</code>
   | <code>[</code> <a href="#expression"><span class="ntref">expression</span></a> <code>]</code>
   | <code>.</code> <a href="#method-name"><span class="ntref">method-name</span></a> <code>(</code> <a href="#arg-list"><span class="ntref">arg-list</span></a> <code>)</code>
</pre>
<p>
The production for xml-step-expr is ambiguous with the productions for
member-access-expr and method-call-expr: this must be resolved by preferring the
parse that includes as much as possible in the xml-step-expr.
</p>
<p>
The static type of the expression must be a subtype of xml.
</p>
<p>
An xml-step-expr that starts with an xml-all-children-step
</p>
<pre>
   <var>E</var> /* <var>X</var>
</pre>
<p>
is equivalent to
</p>
<pre>
   xml:map(xml:elements(<var>E</var>), v =&gt; xml:getChildren(v) <var>X</var>)
</pre>
<p>
where <code>v</code> is a variable name not used in <code><var>X</var></code>.
</p>
<p>
An xml-step-expr that starts with an xml-element-children-step
</p>
<pre>
   <var>E</var> /&lt; <var>NP</var> &gt; <var>X</var>
</pre>
<p>
is equivalent to
</p>
<pre>
   xml:map(xml:elements(<var>E</var>), v =&gt; xml:getChildren(v) .&lt;<var>NP</var>&gt; <var>X</var>)
</pre>
<p>
where <code>v</code> is a variable name not used in <code><var>X</var></code>.
</p>
<p>
An xml-step-expr that starts with an xml-element-descendants-step
</p>
<pre>
   <var>E</var> /**/&lt; <var>NP</var> &gt; <var>X</var>
</pre>
<p>
is equivalent to
</p>
<pre>
   xml:map(xml:elements(<var>E</var>), v =&gt; xml:getDescendants(v) .&lt;<var>NP</var>&gt; <var>X</var>)
</pre>
<p>
where <code>v</code> is a variable name not used in <code><var>X</var></code>.
</p>
</section>
</section>
<section>
<h3 id="section_6.37">6.37 Transactional expression</h3>

<pre class="grammar"><span class="ntdfn" id="transactional-expr">transactional-expr</span> := <code>transactional</code>
</pre>
<p>
A <code>transactional-expr</code> evaluates to true if the expression is being
evaluated in transaction mode and false otherwise.
</p>

</section>

</section>
<section>
<h2 id="actions_statements">7. Actions and statements</h2>
<section>
<h3 id="section_7.1">7.1 Actions</h3>

<pre class="grammar"><span class="ntdfn" id="action">action</span> :=
   <a href="#start-action"><span class="ntref">start-action</span></a>
   | <a href="#wait-action"><span class="ntref">wait-action</span></a>
   | <a href="#send-action"><span class="ntref">send-action</span></a>
   | <a href="#receive-action"><span class="ntref">receive-action</span></a> 
   | <a href="#flush-action"><span class="ntref">flush-action</span></a>
   | <a href="#client-remote-method-call-action"><span class="ntref">client-remote-method-call-action</span></a>
   | <a href="#query-action"><span class="ntref">query-action</span></a>
   | <a href="#type-cast-action"><span class="ntref">type-cast-action</span></a>
   | <a href="#checking-action"><span class="ntref">checking-action</span></a>
   | <a href="#trap-action"><span class="ntref">trap-action</span></a>
   | <a href="#commit-action"><span class="ntref">commit-action</span></a>
   | <code>(</code> <a href="#action"><span class="ntref">action</span></a> <code>)</code>
<span class="ntdfn" id="action-or-expr">action-or-expr</span> := <a href="#action"><span class="ntref">action</span></a> | <a href="#expression"><span class="ntref">expression</span></a>
<span class="ntdfn" id="type-cast-action">type-cast-action</span> := <code>&lt;</code> <a href="#type-cast-param"><span class="ntref">type-cast-param</span></a> <code>&gt;</code> <a href="#action"><span class="ntref">action</span></a>
<span class="ntdfn" id="checking-action">checking-action</span> := <a href="#checking-keyword"><span class="ntref">checking-keyword</span></a> <a href="#action"><span class="ntref">action</span></a>
<span class="ntdfn" id="trap-action">trap-action</span> := <code>trap</code> <a href="#action"><span class="ntref">action</span></a>
</pre>
<p>
Actions are an intermediate syntactic category between expressions and
statements. Actions are similar to expressions, in that they yield a value.
However, an action cannot be nested inside an expression; it can only occur as
part of a statement or nested inside other actions. This is because actions are
shown in the sequence diagram in the graphical syntax.
</p>
<p>
The syntax for actions is defined by the above grammar and precedence rules. The
precedence rules are that a client-remote-method-call-action has higher
precedence than a checking-action or a trap-action.
</p>
<p>
An action is evaluated in the same way as an expression. Static typing for
actions is the same as for expressions.
</p>
<p>
A <code>type-cast-action</code>, <code>checking-action</code> or
<code>trap-action</code> is evaluated in the same way as a
<code>type-cast-expr</code>, <code>checking-expr</code> or
<code>trap-expr</code> respectively.
</p>

</section>
<section>
<h3 id="section_7.2">7.2 Threads and strands</h3>

<p>
Ballerina's concurrency model supports both threads and coroutines. A Ballerina
program is executed on one or more threads. A thread may run on a separate core
simultaneously with other threads, or may be pre-emptively multitasked with
other threads onto a single core.
</p>
<p>
Each thread is divided into one or more <em>strands</em>. No two strands
belonging to the same thread can run simultaneously. Instead, all the strands
belonging to a particular thread are cooperatively multitasked. Strands within
the same thread thus behave as coroutines relative to each other. A strand
enables cooperative multitasking by <em>yielding</em>. When a strand yields,
the runtime scheduler may suspend execution of the strand, and switch its thread
to executing another strand. The following actions cause a strand to yield:
</p>
<ul>
<li>worker-receive-action</li>
<li>wait-action</li>
<li>flush-action</li>
<li>sync-send-action</li>
</ul>
<p>
In addition, any function with an external-function-body can potentially yield;
it should only do so if it performs a system call that would block or calls a
Ballerina function that itself yields. The `sleep` function in
<code>lang.runtime</code> will make the strand yield. Other functions in the
lang library do not themselves yield, although if they call a function passed as
an argument, that function may result in yielding.
</p>
<p>
There are two language constructs whose execution causes the creation of new
strands: named-worker-decl and start-action. These constructs may use
annotations to indicate that the newly created strand should be in a separate
thread from the current strand. In the absence of such annotations, the new
strand must be part of the same thread as the current strand.
</p>

</section>
<section>
<h3 id="section_7.3">7.3 Function bodies</h3>

<section>
<h4 id="section_7.3.1">7.3.1 Function parameters</h4>
<p>
Before the block-function-body of a function-defn is executed, the parameters
declared in the function-signature of the function-defn are initialized from the
argument list that was constructed by the function-call-expr. The non-rest
parameters are initialized from the arguments in the argument list in order. The
conformance of the argument list to the param-list declared for the function
ensures that each parameter will be initialized to a value that belongs to the
declared type of the parameter. If there is a rest-param, then that is a
initialized to a newly created list containing the remaining arguments in the
argument-list; the inherent type of this list will be T[] where T is the type of
the rest-param. The conformance of the argument list ensures that the members of
this list will belong to type T.
</p>
<p>
The parameters are in scope for the block-function-body. They are implicitly
final: they can be read but not modified.
</p>
</section>

<section>
<h4 id="section_7.3.2">7.3.2 Workers</h4>

<pre class="grammar"><span class="ntdfn" id="block-function-body">block-function-body</span> :=
   <code>{</code> [<a href="#default-worker-init"><span class="ntref">default-worker-init</span></a> <a href="#named-worker-decl"><span class="ntref">named-worker-decl</span></a>+] <a href="#default-worker"><span class="ntref">default-worker</span></a> <code>}</code>
<span class="ntdfn" id="default-worker-init">default-worker-init</span> := <a href="#statement"><span class="ntref">statement</span></a>*
<span class="ntdfn" id="default-worker">default-worker</span> := <a href="#statement"><span class="ntref">statement</span></a>*
<span class="ntdfn" id="named-worker-decl">named-worker-decl</span> :=
   [<a href="#annots"><span class="ntref">annots</span></a>] [<a href="#transactional-qual"><span class="ntref">transactional-qual</span></a>] <code>worker</code> <a href="#worker-name"><span class="ntref">worker-name</span></a> <a href="#return-type-descriptor"><span class="ntref">return-type-descriptor</span></a> <a href="#statement-block"><span class="ntref">statement-block</span></a>
<span class="ntdfn" id="worker-name">worker-name</span> := <a href="#identifier"><span class="ntref">identifier</span></a>
</pre>
<p>
A worker represents a single strand of a function invocation. A statement
is always executed in the context of a current worker. A worker is in one of
three states: active, inactive or terminated. When a worker is in the
terminated state, it has a termination value. A worker terminates either
normally or abnormally. An abnormal termination results from a panic, and in
this case the termination value is always an error. If the termination value of
a normal termination is an error, then the worker is said to have terminated
with failure; otherwise the worker is said to have terminated with success. Note
that an error termination value resulting from a normal termination is
distinguished from an error termination value resulting from an abnormal
termination.
</p>
<p>
A function always has a single default worker, which is unnamed. The strand for
a function's default worker is the same as the strand of the worker on which
function was called. When a function is called, the current worker becomes
inactive, and a default worker for the called function is started. When the
default worker terminates, the function returns to its caller, and the caller's
worker is reactivated. Thus only one worker in each strand is active at any
given time. If a function's default worker terminates normally, then its
termination value provides the return value of the function. If a function's
default worker terminates abnormally, then the evaluation of the function call
expression completes abruptly with a panic and the worker's termination value
provides the associated value for the abrupt completion of the function call.
The function's return type is the same as the return type of the function's
default worker.
</p>
<p>
A function also has zero or more named workers. Each named worker runs on its
own new strand. The termination of a function is independent of the termination
of its named workers. The termination of a named worker does not automatically
result in the termination of its function. When a function's default worker
terminates, causing the function to terminate, the function does not
automatically wait for the termination of its named workers.
</p>
<p>
A named worker has a return type. If the worker terminates normally, the
termination value will belong to the return type. If the return type of a worker
is not specified, it defaults to nil as for functions.
</p>
<p>
A named-worker is a transactional scope only if it is declared as
<code>transactional</code>. This is allowed only if the block-function-body is a
transactional scope, i.e. if it is the body of a function declared as
<code>transactional</code>.
</p>
<p>
When a function has named workers, the function's default worker executes in
three stages, as follows:
</p>
<ol>
<li>The statements in default-worker-init are executed.</li>
<li>All the named workers are started. Each named worker executes its
statement-block on its strand.</li>
<li>The statements in default-worker are executed. This happens without waiting
for the termination of the named workers started in stage 2.</li>
</ol>
<p>
Parameters and variables declared in default-worker-init are in scope within
named workers, whereas variables declared in default-worker are not.
</p>
<p>
The execution of a worker's statements may result in the execution of a
statement that causes the worker to terminate. For example, a return statement
causes the worker to terminate. If this does not happen, then the worker
terminates as soon as it has finished executing its statements. In this case,
the worker terminates normally, and the termination value is nil. In other
words, falling off the end of a worker is equivalent to <code>return;</code>,
which is in turn equivalent to <code>return ();</code>.
</p>
<p>
The scope of a worker-name in a named-worker-decl that is part of a
block-function-body is the entire block-function-body with the exception of the
default-worker-init. When a worker-name is in scope, it can be used in a
variable-reference-expr. The result of evaluating such a variable reference is a
future value that refers to the value to be returned by that named worker. The
static type of the result is future&lt;T&gt;, where T is the return type of the
worker.
</p>
<p>
A strand can initiate a wait on another strand by using a wait-action with a
value of type future. Only one wait on a strand can succeed; this wait receives
the value returned by the strand. Any other waits on that strand fail. It is a
compile-time error if for any named worker it is possible for the name of that
worker to be evaluated as a variable-reference more than once for any execution
of that worker. This ensures that wait operations that use just a worker-name to
identify the strand to wait on cannot fail at runtime.
</p>
<p>
In the above, function includes method, and function call includes method call.
</p>
</section>

<section>
<h4 id="section_7.3.3">7.3.3 Expression-bodied functions</h4>

<pre class="grammar"><span class="ntdfn" id="expr-function-body">expr-function-body</span> := <code>=&gt;</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>

<p>
An expr-function-body is used for an expression-bodied function, that is a
function whose body is specified by an expression. An expr-function-body of the
form <code>=&gt; <var>E</var></code> is short for a block-function-body <code>{
return <var>E</var>}</code>.
</p>

</section>

<section>
<h4 id="section_7.3.4">7.3.4 External functions</h4>

<pre class="grammar"><span class="ntdfn" id="external-function-body">external-function-body</span> := <code>=</code> [<a href="#annots"><span class="ntref">annots</span></a>] <code>external</code> 
</pre>

<p>
An <code>external-function-body</code> means that the implementation of the
function is not provided in the Ballerina source module. A function-defn-body
with a function-signature that is dependently-typed must be an
external-function-body.
</p>

</section>
<section>
<h4 id="isolated_functions">7.3.5 Isolated functions</h4>
<p>
The body of a function or method declared as <code>isolated</code> must meet the
following requirements.
</p>
<ul>
<li>Only isolated functions can be called:
<ul>
<li>in a function-call-expr, the function-reference must refer to a function
whose static type is isolated;</li>
<li>in a method-call-expr, the method-name must refer to a method or
function whose static type is isolated;</li>
<li>in a new-expr or object-constructor-expr, the init method that is called
must be declared as isolated (a missing init method is equivalent is implicitly
isolated).</li>
</ul>
</li>
<li>Non-isolated module-level state can only be read in two cases, specifically
a variable-reference can refer to an an identifier declared by a
module-var-decl or listener-decl only if:
<ul>
<li>the identifier is declared by a module-var-decl that includes
<code>final</code> or <code>configurable</code> but does not include
<code>isolated</code>, or is declared by a listener-decl or a service-decl,
and</li>
<li>the static type of the variable is a subtype of <code>isolated object
{}</code> or of <code>readonly</code> (which will always be the case if the
identifier is declared as <code>configurable</code>).</li>
</ul>
</li>
<li>Non-isolated module-level state cannot be mutated: an identifier in a
variable-reference-lvexpr or in a capture-binding-pattern in a
destructuring-assignment-stmt must not refer to a variable defined by a
module-var-decl that does not include <code>isolated</code>.</li>
<li>Captured variables are restricted as follows: if the body is part of an
anonymous-function-expr, then any captured variable references must refer to
variables that are both final (either explicitly or implicitly) and have a
static type that is a subtype of <code>readonly|isolated object {}</code>.</li>
<li>New workers cannot be started: the following constructs are not allowed
<ul>
<li>named-worker-decl</li>
<li>fork-stmt</li>
<li>start-action</li>
</ul>
</li>
</ul>
<p>
If an isolated function has an <code>external-function-body</code>, then the
above requirements also apply to the external implementation as regards its
access to the mutable state of the Ballerina program, in the sense that it must
only access the mutable state that is reachable from the parameters passed to
the function. In addition, the function should have well-defined behaviour if it
is called concurrently on multiple strands.
</p>
</section>
</section>
<section>
<h3 id="section_7.4">7.4 Statement execution</h3>

<pre class="grammar"><span class="ntdfn" id="statement">statement</span> := 
   <a href="#action-stmt"><span class="ntref">action-stmt</span></a>
   | <a href="#local-var-decl-stmt"><span class="ntref">local-var-decl-stmt</span></a>
   | <a href="#xmlns-decl-stmt"><span class="ntref">xmlns-decl-stmt</span></a>
   | <a href="#assignment-stmt"><span class="ntref">assignment-stmt</span></a>
   | <a href="#compound-assignment-stmt"><span class="ntref">compound-assignment-stmt</span></a>
   | <a href="#destructuring-assignment-stmt"><span class="ntref">destructuring-assignment-stmt</span></a>
   | <a href="#call-stmt"><span class="ntref">call-stmt</span></a>
   | <a href="#if-else-stmt"><span class="ntref">if-else-stmt</span></a>
   | <a href="#regular-compound-stmt"><span class="ntref">regular-compound-stmt</span></a>
   | <a href="#continue-stmt"><span class="ntref">continue-stmt</span></a>
   | <a href="#break-stmt"><span class="ntref">break-stmt</span></a>
   | <a href="#stmt-with-on-fail"><span class="ntref">stmt-with-on-fail</span></a>
   | <a href="#fail-stmt"><span class="ntref">fail-stmt</span></a>
   | <a href="#retry-stmt"><span class="ntref">retry-stmt</span></a>
   | <a href="#transaction-stmt"><span class="ntref">transaction-stmt</span></a>
   | <a href="#retry-transaction-stmt"><span class="ntref">retry-transaction-stmt</span></a>
   | <a href="#rollback-stmt"><span class="ntref">rollback-stmt</span></a>
   | <a href="#panic-stmt"><span class="ntref">panic-stmt</span></a>
   | <a href="#return-stmt"><span class="ntref">return-stmt</span></a>
   | <a href="#fork-stmt"><span class="ntref">fork-stmt</span></a>
</pre>
<p>
The execution of any statement may involve the evaluation of actions and
expressions, and the execution of substatements. The following sections
describes how each kind of statement is evaluated, assuming that the evaluation
of those expressions and actions completes normally, and assuming that the
execution of any substatements does not cause termination of the current worker.
Except where explicitly stated to the contrary, statements handle abrupt
completion of the evaluation of expressions and actions as follows. There are
two possibilities.
</p>
<ul>
<li>If the abrupt termination is a check-fail with associated value e, then
control flow is transferred as if by a <code>fail-stmt</code> with an expression
that evaluates to e.</li>
<li>If the abrupt termination is a panic with associated value, then the current
worker is terminated as if by a <code>panic-stmt</code> with an expression that
evaluates to e.</li>
</ul>
<p>
If the execution of a substatement causes termination of the current worker,
then the execution of the statement terminates at that point.
</p>

<pre class="grammar">
<span class="ntdfn" id="regular-compound-stmt">regular-compound-stmt</span> :=
  <a href="#do-stmt"><span class="ntref">do-stmt</span></a>
  | <a href="#match-stmt"><span class="ntref">match-stmt</span></a>
  | <a href="#foreach-stmt"><span class="ntref">foreach-stmt</span></a>
  | <a href="#while-stmt"><span class="ntref">while-stmt</span></a>
  | <a href="#lock-stmt"><span class="ntref">lock-stmt</span></a>
</pre>
<p>
A <code>regular-compound-stmt</code> can be combined with an
<code>on-fail-clause</code> to make a <code>stmt-with-on-fail</code>.
</p>
<pre class="grammar">
<span class="ntdfn" id="statement-block">statement-block</span> := <code>{</code> <a href="#statement"><span class="ntref">statement</span></a>* <code>}</code>
</pre>
<p>
A <code>statement-block</code> is a syntactic grouping of statements, which are
executed sequentially.
</p>

</section>


<section>
<h3 id="section_7.5">7.5 Fork statement</h3>

<pre class="grammar"><span class="ntdfn" id="fork-stmt">fork-stmt</span> := <code>fork</code> <code>{</code> <a href="#named-worker-decl"><span class="ntref">named-worker-decl</span></a>+ <code>}</code>
</pre>
<p>
The fork statement starts one or more named workers, which run in parallel with
each other, each in its own new strand.
</p>
<p>
Variables and parameters in scope for the fork-stmt remain in scope within the
workers (similar to the situation with parameters and workers in a function
body).
</p>
<p>
The scope of the worker-name in a named-worker-decl that is part of a fork-stmt
consists of both other workers in the same fork-stmt and the block containing
the fork-stmt starting from the point immediately after the fork-stmt. Within
its scope, the worker-name can be used in a variable-reference-expr in the same
way as the worker-name of a named-worker-decl that is part of a
block-function-body.
</p>
</section>
<section>
<h3 id="section_7.6">7.6 Start action</h3>

<pre class="grammar"><span class="ntdfn" id="start-action">start-action</span> := [<a href="#annots"><span class="ntref">annots</span></a>] <code>start</code> (<a href="#function-call-expr"><span class="ntref">function-call-expr</span></a>|<a href="#method-call-expr"><span class="ntref">method-call-expr</span></a>|<a href="#client-remote-method-call-action"><span class="ntref">client-remote-method-call-action</span></a>)
</pre>

<p>
The keyword <code>start</code> causes the following function or method
invocation to be executed on a new strand. The arguments for the function or
method call are evaluation on the current strand. A start-action returns a value
of basic type future immediately. If the static type of the call expression or
action <code><var>C</var></code> is T, then the static type of <code>start
<var>C</var></code> is future&lt;T&gt;; it is permitted for T to be
<code>never</code>.
</p>


</section>
<section>
<h3 id="section_7.7">7.7 Wait action</h3>
<p>
A wait-action waits for one or more strands to terminate, and gives access to
their termination values.
</p>

<pre class="grammar"><span class="ntdfn" id="wait-action">wait-action</span> :=
   <a href="#single-wait-action"><span class="ntref">single-wait-action</span></a>
   | <a href="#multiple-wait-action"><span class="ntref">multiple-wait-action</span></a>
   | <a href="#alternate-wait-action"><span class="ntref">alternate-wait-action</span></a>

<span class="ntdfn" id="wait-future-expr">wait-future-expr</span> := <a href="#expression"><span class="ntref">expression</span></a> <em>but not</em> <a href="#mapping-constructor-expr"><span class="ntref">mapping-constructor-expr</span></a>
</pre>
<p>
A wait-future-expr is used by a wait-action to refer to the worker to be waited
for. Its static type must be future&lt;T&gt; for some T. As elsewhere, a
wait-future-expr can use an in-scope worker-name in a variable-reference-expr to
refer to named worker.
</p>
<p>
Evaluation of a wait-action performs a wait operation on the future value that
results from evaluating a wait-future-expr. This wait operation may complete
normally or abruptly. The wait operation initiates a wait for the strand that
the future refers to. If the wait fails, then the wait operation completes
normally and the result is an error. If the wait succeeds, and the strand
completed normally, then the wait operation completes normally, and the result
is the termination value of the strand. If the wait succeeds, but the strand
completed abnormally, then the wait operation completes abruptly with a panic
and the associated value is the termination value of the strand.
</p>
<p>
In addition to a static type, a wait-future-expr has a compile-time <em>eventual
type</em>. If a wait-future-expr is a variable-reference-expr referring to the
worker-name of a named worker with return type T, then the eventual type of the
wait-future-expr is T. Otherwise, the eventual of a wait-future-expr with static
type future&lt;T&gt; is T|error. The result of a wait operation that completes
normally will belong to the eventual type of the wait-future-expr, since the
compiler ensures that a wait for a wait-future-expr that is a variable reference
to a named worker cannot fail.
</p>
<p>
Note that it is only possible to wait for a named worker, which will start its
own strand. It is not possible to wait for a function's default worker, which
runs on an existing strand.
</p>
<p>
A mapping-constructor-expr is not recognized as a wait-future-expr (it would not
type-check in any case).
</p>
<section>
<h4 id="section_7.7.1">7.7.1 Single wait action</h4>

<pre class="grammar"><span class="ntdfn" id="single-wait-action">single-wait-action</span> := <code>wait</code> <a href="#wait-future-expr"><span class="ntref">wait-future-expr</span></a>
</pre>
<p>
A single-wait-action waits for a single future.
</p>
<p>
A single-wait-action is evaluated by first evaluating wait-future-expr resulting
in a value f of basic type future; the single-wait-action then performs a wait
operation on f.
</p>
<p>
The static type of the single-wait-action is the eventual type of the
wait-future-expr.
</p>
</section>
<section>
<h4 id="section_7.7.2">7.7.2 Multiple wait action</h4>

<pre class="grammar"><span class="ntdfn" id="multiple-wait-action">multiple-wait-action</span> := <code>wait</code> <code>{</code> <a href="#wait-field"><span class="ntref">wait-field</span></a> (<code>,</code> <a href="#wait-field"><span class="ntref">wait-field</span></a>)* <code>}</code>
<span class="ntdfn" id="wait-field">wait-field</span> :=
  <a href="#variable-name"><span class="ntref">variable-name</span></a>
  | <a href="#field-name"><span class="ntref">field-name</span></a> <code>:</code> <a href="#wait-future-expr"><span class="ntref">wait-future-expr</span></a>
</pre>
<p>
A multiple-wait-action waits for multiple futures, returning the result as a
record.
</p>
<p>
A wait-field that is a variable-name <code>v</code> is equivalent to a
wait-field <code>v: v</code>, where <code>v</code> must be the name of an
in-scope named worker.
</p>
<p>
A multiple-wait-action is evaluated by evaluating each wait-future-expr
resulting in a value of type future for each wait-field. The
multiple-wait-action then performs a wait operation on all of these futures. If
all the wait operations complete normally, then it constructs a record with a
field for each wait-field, whose name is the field-name and whose value is the
result of the wait operation. If any of the wait operations complete abruptly,
then the multiple-wait-action completes abruptly.
</p>
<p>
The static type of the multiple-wait-action is a record where the static type of
each field is the eventual type of the corresponding wait-future-expr.
</p>
</section>
<section>
<h4 id="section_7.7.3">7.7.3 Alternate wait action </h4>

<pre class="grammar"><span class="ntdfn" id="alternate-wait-action">alternate-wait-action</span> := <code>wait</code> <a href="#wait-future-expr"><span class="ntref">wait-future-expr</span></a> (<code>|</code> <a href="#wait-future-expr"><span class="ntref">wait-future-expr</span></a>)+
</pre>
<p>
An alternate-wait-action waits for one of multiple futures to terminate.
</p>
<p>
An alternate-wait-action is evaluated by first evaluating each wait-future-expr,
resulting in a set of future values. The alternate-wait-action then performs a
wait operation on all of these members of this set. As soon as one of the wait
operations completes normally with a non-error value v, the
alternate-wait-action completes normally with result v. If all of the wait
operations complete normally with an error, then it completes normally with
result e, where e is the result of the last wait operation to complete. If any
of the wait operations completely abruptly before the alternate-wait-action
completes, then the alternate-wait-action completes abruptly.
</p>
<p>
The static type of the alternate-wait-action is the union of the eventual type
of all of its wait-future-exprs.
</p>
</section>
</section>
<section>
<h3 id="section_7.8">7.8 Worker message passing</h3>
<p>
Messages can be sent between workers.
</p>
<p>
Sends and receives are matched up at compile-time. This allows the connection
between the send and the receive to be shown in the sequence diagram. It is also
guarantees that any sent message will be received, provided that neither the
sending nor the receiving worker terminate abnormally or with an error.
</p>
<p>
Messages can only be sent between workers that are peers of each other. A
function's default worker and its named workers are peers of each other. The
workers created in a fork-stmt are also peers of each other. The workers created
in a fork-stmt are not peers of a function's default worker nor of its named
workers.
</p>

<pre class="grammar"><span class="ntdfn" id="peer-worker">peer-worker</span> := <a href="#worker-name"><span class="ntref">worker-name</span></a> | <code>function</code>
</pre>
<p>
A worker-name refers to a worker named in a named-worker-decl, which must be in
scope; <code>function</code> refers to the function's default worker. The
referenced worker must be a peer worker.
</p>
<p>
Each worker maintains a separate logical queue for each peer worker to which it
sends messages; a sending worker sends a message by adding it to the queue; a
receiving worker receives a message by removing it from the sending worker's
queue for that worker; messages are removed in the order in which they were
added to the queue.
</p>
<section>
<h4 id="section_7.8.1">7.8.1 Send action</h4>

<pre class="grammar"><span class="ntdfn" id="send-action">send-action</span> := <a href="#sync-send-action"><span class="ntref">sync-send-action</span></a> | <a href="#async-send-action"><span class="ntref">async-send-action</span></a>
<span class="ntdfn" id="sync-send-action">sync-send-action</span> := <a href="#expression"><span class="ntref">expression</span></a> <code>-&gt;&gt;</code> <a href="#peer-worker"><span class="ntref">peer-worker</span></a>
<span class="ntdfn" id="async-send-action">async-send-action</span> := <a href="#expression"><span class="ntref">expression</span></a> <code>-&gt;</code> <a href="#peer-worker"><span class="ntref">peer-worker</span></a> <code>;</code>
</pre>
<p>
A send-action sends a message to the worker that is identified by peer-worker. A
send-action starts by evaluating the expression, resulting in a value
<code><var>v</var></code>; the Clone abstract operation is then applied to
<code><var>v</var></code> resulting in value <code><var>c</var></code>. This
value <code><var>c</var></code> is added to the message queue maintained by the
sending worker for messages to be sent to the sending worker;this queue
continues to exist even if the receiving worker has already terminated.
</p>
<p>
For each send-action S, the compiler determines a unique corresponding
receive-action R, such that a message sent by S will be received by R, unless
R's worker has terminated abnormally or with failure. It is a compile-time error
if this cannot be done. The compiler determines a <em>failure type</em> for the
corresponding receive-action. If the receive-action was not executed and its
worker terminated normally, then the termination value of the worker will belong
to the failure type. The failure type will be a (possibly empty) subtype of
error.
</p>
<p>
The difference between async-send-action and sync-send-action is in what happens
after the message is added to the queue. The evaluation of async-send-action
completes immediately after this, and the result is always <code>()</code>. A
subsequent flush action can be used to check whether the message was received.
With sync-send-action, evaluation waits until the receiving worker either
executes a receive action that receives the queued message or terminates. The
evaluation of sync-send-action completes as follows:
</p>
<ul>
<li>if the queued message was received, then normally with result nil;</li>
<li>otherwise
<ul>
<li>if the receiving worker terminated with failure, then normally with the
result being the the termination value of the receiving worker, which will be an
error;</li>
<li>if the receiving worker terminated abnormally, then abruptly with a panic,
with the associated value being the termination value of the receiving worker.</li>
</ul>
</li>
</ul>
<p>
The static type of the sync-send-action is F|() where F is the failure type of
the corresponding receive action. If F is empty, then this static type will be
equivalent to ().
</p>
<p>
The static type of the <code>expression</code> must be a subtype of
<code>value:Cloneable</code>. The contextually expected type used to interpret
<code>expression</code> is the contextually expected type from the corresponding
receive-action.
</p>
<p>
If the receive-action corresponding to an async-send-action has a non-empty
failure type, then it is a compile-time error unless it can be determined that a
sync-send-action or a flush-action will be executed before the sending worker
terminates with success.
</p>
<p>
If a worker W is about to terminate normally and there are messages still to be
sent in a queue (which must be the result of executing an async-send-action), then
the worker waits until the messages have been received or some receiving worker
terminates. If a receiving worker R terminates without the message being
received, R must have terminated abnormally, because the rule in the preceding
paragraph. In this case, W terminates abnormally and W will use R's termination
value as its termination value.
</p>
</section>
<section>
<h4 id="section_7.8.2">7.8.2 Receive action</h4>

<pre class="grammar"><span class="ntdfn" id="receive-action">receive-action</span> := <a href="#single-receive-action"><span class="ntref">single-receive-action</span></a> | <a href="#multiple-receive-action"><span class="ntref">multiple-receive-action</span></a>
</pre>
<section>
<h5 id="section_7.8.2.1">7.8.2.1 Single receive action</h5>

<pre class="grammar"><span class="ntdfn" id="single-receive-action">single-receive-action</span> := <code>&lt;-</code> <a href="#peer-worker"><span class="ntref">peer-worker</span></a>
</pre>
<p>
A single-receive-action receives a message from a single worker.
</p>
<p>
For each single-receive-action R receiving from worker W, the compiler
determines a <em>corresponding send set</em>. The corresponding send set S is a
set of send actions in W, such that
</p>
<ul>
<li>in any execution of W that terminates successfully, exactly one member of S
is executed and is executed once only</li>
<li>if R is evaluated, it will receive the single message sent by a member of S,
unless W has terminated abnormally or with failure.</li>
</ul>
<p>
The compiler terminates a failure type for the corresponding send set. If no
member of the corresponding send set was evaluated and the sending worker
terminated normally, then the termination value of the sending worker will
belong to the failure type. The failure type will be a (possibly empty) subtype
of error.
</p>
<p>
A single-receive-action is evaluated by waiting until there is a message
available in the queue or the sending worker terminates.  The evaluation of
single-receive-action completes as follows:
</p>
<ul>
<li>if a message becomes available in the queue, then the first available
message is removed and the evaluation completes normally with the result being
that message;</li>
<li>otherwise
<ul>
<li>if the sending worker terminated with failure, then normally with the result
being the the termination value of the sending worker, which will be an error;</li>
<li>if the sending worker terminated abnormally, then abruptly with a panic,
with the associated value being the termination value of the sending worker.</li>
</ul>
</li>
</ul>
<p>
The static type of the single-receive-action is T|F where T is the union of the
static type of the expressions in the corresponding send set and F is the
failure type of the corresponding send set.
</p>
</section>
<section>
<h5 id="section_7.8.2.2">7.8.2.2 Multiple receive action</h5>

<pre class="grammar"><span class="ntdfn" id="multiple-receive-action">multiple-receive-action</span> :=
   <code>&lt;-</code>  <code>{</code> <a href="#receive-field"><span class="ntref">receive-field</span></a> (<code>,</code> <a href="#receive-field"><span class="ntref">receive-field</span></a>)* <code>}</code>
<span class="ntdfn" id="receive-field">receive-field</span> :=
   <a href="#peer-worker"><span class="ntref">peer-worker</span></a>
   | <a href="#field-name"><span class="ntref">field-name</span></a> <code>:</code> <a href="#peer-worker"><span class="ntref">peer-worker</span></a>
</pre>
<p>
A multiple-receive-action receives a message from multiple workers.
</p>
<p>
A peer-worker can occur at most once in a multiple-receive-action.
</p>
<p>
A receive-field consisting of a peer-worker <code>W</code> is equivalent to a
field <code>W:W</code>.
</p>
<p>
The compiler determines a corresponding send set for each receive field, in the
same way as for a single-receive-action. A multiple-receive-action is evaluated
by waiting until there is a message available in the queue for every
peer-worker.  If any of the peer workers W terminate before a message becomes
available, then the evaluation of the multiple-receive-action completes as
follows
</p>
<ul>
<li>if the sending worker terminated with failure, then normally with the result
being the the termination value of the sending worker, which will be an error;</li>
<li>if the sending worker terminated abnormally, then abruptly with a panic,
with the associated value being the termination value of the sending worker.</li>
</ul>
<p>
Otherwise, the result of the evaluation of multiple-receive-action completes by
removing the first message from each queue and constructing a record with one
field for each receive-field, where the value of the record is the message
received.
</p>
<p>
The contextually expected typed for the multiple-receive-action determines a
contextually expected type for each receive-field, in the same way as for a
mapping constructor. The contextually expected type for each receive-field
provides the contextually expected type for the expression in each member of the
corresponding send set.
</p>
<p>
The static type of multiple-receive-action is R|F where
</p>
<ul>
<li>R is a record type, where R is determined in the same way as for a mapping
constructor, where the static type of each field comes from the union of the
static types of the expressions in each member of the corresponding send set and
the contextually expected type is the contextually expected type of the
multiple-receive-action</li>
<li>F is the union of the failure types for the corresponding send set for each
receive-field</li>
</ul>
</section>
</section>
<section>
<h4 id="section_7.8.3">7.8.3 Flush action</h4>

<pre class="grammar"><span class="ntdfn" id="flush-action">flush-action</span> := <code>flush</code> [<a href="#peer-worker"><span class="ntref">peer-worker</span></a>]
</pre>
<p>
If peer-worker is specified, then flush waits until the queue of messages to be
received by peer-worker is empty or until the peer-worker terminates.
</p>
<p>
Send-receive correspondence for async-send-action implies that the queue will
eventually become empty, unless the peer-worker terminates abnormally or with
failure. The evaluation of flush-action completes as follows:
</p>
<ul>
<li>if the queue of messages is empty, then normally with result nil;</li>
<li>otherwise
<ul>
<li>if the peer-worker terminated with failure, then normally with the result
being the the termination value of the peer-worker, which will be an error;</li>
<li>if the peer-worker terminated abnormally, then abruptly with a panic, with
the associated value being the termination value of the peer-worker.</li>
</ul>
</li>
</ul>
<p>
If the flush-action has a preceding async-send-action without any intervening
sync-send-action or other flush-action, then the static type of the flush-action
is F|(), where F is the failure type of the receive-action corresponding to that
async-send-action. Otherwise, the static type of the flush-action is nil.
</p>
<p>
If peer-worker is omitted, then the flush-action flushes the queues to all other
workers. In this case, the static type will be the union of the static type of
flush on each worker separately.
</p>
</section>
<section>
<h4 id="section_7.8.4">7.8.4 Send-receive correspondence</h4>
<p>
This section provides further details about how compile-time correspondence is
established between sends and receive. This is based on the concept of the index
of a message in its queue: a message has index n in its queue if it is the nth
message added to the queue during the current execution of the worker.
</p>
<ul>
<li>A send action/statement has index i in its queue if the message that it adds
to the queue is always the i-th message added to the queue during the execution
of its worker. It is a compile time error if a send statement or action does not
have an index in its queue.</li>
<li>A receive action has index i in a queue if any message that it removes from
the queue is always the i-th message removed from the queue during the execution
of its worker. It is a compile time error if a receive action does not have an
index in each of its queues.</li>
<li>A send action/statement and a receive action correspond if they have the
same index in a queue.</li>
<li>It is a compile time error if two or more receive actions have the same
index in a queue.</li>
<li>A send action/statement is in the same send set as another send
action/statement if they have the same index in a queue. It is allowed for a
send set to have more than one member.</li>
<li>The maximum index that a receive action has in a queue must be the same as
the maximum index that a send action or statement has in that queue.</li>
<li>It is a compile time error if it is possible for a worker to terminate with
success before it has executed all its receive actions.</li>
<li>It is a compile time error if it is possible for a worker to terminate with
success before it has executed one member from every send set.</li>
</ul>
</section>
</section>

<section>
<h3 id="section_7.9">7.9 Outbound network interaction</h3>

<p>
A client object is a stub that allows a worker to send network messages to a
remote system according to some protocol. A local variable declared with client
object type will be depicted as a lifeline in the function's sequence diagram.
The remote methods of the client object correspond to distinct network messages
defined by the protocol for the role played by the client object. The return
value of a remote method represents the protocol's response. A
client-remote-method-call-action is depicted as a horizontal arrow from the
worker lifeline to the client object lifeline.
</p>

<pre class="grammar"><span class="ntdfn" id="client-remote-method-call-action">client-remote-method-call-action</span> := <a href="#expression"><span class="ntref">expression</span></a> <code>-&gt;</code> <a href="#method-name"><span class="ntref">method-name</span></a> <code>(</code> <a href="#arg-list"><span class="ntref">arg-list</span></a> <code>)</code>
</pre>
<p>
Calls a remote method of a client object. This works the same as a method call
expression, except that it is used for a client object method with the
<code>remote</code> qualifier.
</p>

</section>

<section>
<h3 id="section_7.10">7.10 Query action</h3>
<pre class="grammar"><span class="ntdfn" id="query-action">query-action</span> := <a href="#query-pipeline"><span class="ntref">query-pipeline</span></a> <a href="#do-clause"><span class="ntref">do-clause</span></a>
<span class="ntdfn" id="do-clause">do-clause</span> := <code>do</code> <a href="#statement-block"><span class="ntref">statement-block</span></a>
</pre>
<p>
The clauses in the query-pipeline of query-action are executed in the same way
as the clauses in the query-pipeline of a query-expr.
</p>
<p>
The query-action is executed as follows. For each input frame <var>f</var>
emitted by the query-pipeline, execute the statement-block with <var>f</var> in
scope. If a clause in the query-pipeline completes early with error
<var>e</var>, the result of the query-action is <var>e</var>. Otherwise, the
result of the query-action is nil.
</p>

</section>

<section>
<h3 id="section_7.11">7.11 Local variable declaration statements</h3>

<pre class="grammar"><span class="ntdfn" id="local-var-decl-stmt">local-var-decl-stmt</span> :=
   <a href="#local-init-var-decl-stmt"><span class="ntref">local-init-var-decl-stmt</span></a>
   | <a href="#local-no-init-var-decl-stmt"><span class="ntref">local-no-init-var-decl-stmt</span></a>
<span class="ntdfn" id="local-init-var-decl-stmt">local-init-var-decl-stmt</span> :=
   [<a href="#annots"><span class="ntref">annots</span></a>] [<code>final</code>] <a href="#typed-binding-pattern"><span class="ntref">typed-binding-pattern</span></a> <code>=</code> <a href="#action-or-expr"><span class="ntref">action-or-expr</span></a> <code>;</code>
</pre>
<p>
A <code>local-var-decl-stmt</code> is used to declare variables with a scope
that is local to the block in which they occur.
</p>
<p>
The scope of variables declared in a <code>local-var-decl-stmt</code> starts
immediately after the statement and continues to the end of the statement block
in which it occurs.
</p>
<p>
A local-init-var-decl-stmt is executed by evaluating the action-or-expr
resulting in a value, and then matching the typed-binding-pattern to the value,
causing assignments to the variables occurring in the typed-binding-pattern. The
typed-binding-pattern is used unconditionally, meaning that it is a compile
error if the static types do not guarantee the success of the match. If the
typed-binding-pattern uses <code>var</code>, then the type of the variables is
inferred from the static type of the action-or-expr; if the
local-init-var-decl-stmt includes final, the precise type is used, and otherwise
the broad type is used. If the typed-binding-pattern specifies a
type-descriptor, then that type-descriptor provides the contextually expected
type for action-or-expr.
</p>
<p>
If <code>final</code> is specified, then the variables declared must not be
assigned to outside the local-init-var-decl-stmt.
</p>

<pre class="grammar"><span class="ntdfn" id="local-no-init-var-decl-stmt">local-no-init-var-decl-stmt</span> :=
   [<a href="#annots"><span class="ntref">annots</span></a>] [<code>final</code>] <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> <a href="#variable-name"><span class="ntref">variable-name</span></a> <code>;</code>
</pre>
<p>
A local variable declared <code>local-no-init-var-decl-stmt</code> must be
definitely assigned at each point that the variable is referenced. This means
that the compiler must be able to verify that the local variable will have been
assigned before that point. If <code>final</code> is specified, then the
variable must not be assigned more than once. The <code>type-descriptor</code>
must not be <code>never</code>.
</p>
</section>
<section>
<h3 id="conditional_variable_type_narrowing">7.12 Conditional variable type narrowing</h3>
<p>
Usually the type of a reference to a variable is determined by the variable's
declaration, either explicitly specified by a type descriptor or inferred from
the static type of the initializer. However, the language also recognizes two
kinds of case where the way a local variable or parameter is used means that is
known at compile-time that within a particular region of code the value of the
variable will belong to a type that is narrower than the declared type. In these
cases, references to the variable within particular regions of code will have a
static type that is narrower that the variable type. One kind of case, which is
described in this section, is when a variable is used in a boolean expression in
a conditional context. The other kind of case is when a variable is used in a
match statement; this is described in the <a href="#match_statement">Match
statement</a> section.
</p>
<p>
Type narrowing makes use of the <em>read-only difference</em> between two types,
which is defined as follows. We use the notation T
â<sub><em>ro</em></sub> S for the read-only difference of T and S. T
â<sub><em>ro</em></sub> S is computed separately for each uniform type.
Let T<sup>U</sup> be the subset of T belonging to uniform type U, i.e. the
intersection of T and U. For a uniform type U that is immutable, T<sup>U</sup>
â<sub><em>ro</em></sub> S<sup>U</sup> is the same as T<sup>U</sup> -
S<sup>U</sup> (set difference); for a uniform type U that is mutable,
T<sup>U</sup> â<sub><em>ro</em></sub> S<sup>U</sup> is empty if
T<sup>U</sup> is a subset of S<sup>U</sup>, and T<sup>U</sup> otherwise. T
â<sub><em>ro</em></sub> S is the union for every uniform type U of
T<sup>U</sup> â<sub><em>ro</em></sub> S<sup>U</sup>. This definition of
read-only difference ensures that if a value x belongs to T but not does not
belong to S, then x belongs to T â<sub><em>ro</em></sub> S.
</p>
<p>
Given an expression E with static type boolean, and a variable x with static
type Tx, we define how to determine
</p>
<ul>
<li>a narrowed type for x implied by truth of E and</li>
<li>a narrowed type for x implied by falsity of E</li>
</ul>
<p>
based on the syntactic form of E as follows.
</p>
<ul>
<li>If E has the form x is T, then
<ul>
<li>the narrowed type for x implied by truth of E is the intersection of Tx and
T</li>
<li>the narrowed type for x implied by falsity of E is Tx
â<sub><em>ro</em></sub> T</li>
</ul>
</li>
<li>If E has the form x == E1 or E1 == x where the static type of E1 is an
expression whose static type is a singleton simple type T1, then
<ul>
<li>the narrowed type for x implied by truth of E is the intersection of Tx and
T1</li>
<li>the narrowed type for x implied by falsity of E is Tx
â<sub><em>ro</em></sub> T1</li>
</ul>
</li>
<li>If E has the form x != E1 or E1 != x where the static type of E1 is an
expression whose static type is a singleton simple type T1, then
<ul>
<li>the narrowed type for x implied by truth of E is Tx
â<sub><em>ro</em></sub> T1</li>
<li>the narrowed type for x implied by falsity of E is the intersection of Tx
and T1</li>
</ul>
</li>
<li>If E has the form !E1, then
<ul>
<li>the narrowed type for x implied by truth of E is the narrowed type for x
implied by falsity of E1</li>
<li>the narrowed type for x implied by falsity of E is the narrowed type for x
implied by truth of E1</li>
</ul>
</li>
<li>If E has the form E1 &amp;&amp; E2
<ul>
<li>the narrowed type for x implied by truth of E is the intersection of T1 and
T2, where T1 is the narrowed type for x implied by the truth of T1 and T2 is the
narrowed type for x implied by the truth of T2</li>
<li>the narrowed type for x implied by falsity of E is T1|T2, where T1 is the
narrowed type for x implied by the falsity of E1, and T2 is the intersection of
T3 and T4, where T3 is the narrowed type for x implied by the truth of E1 and T4
is the narrowed type for x implied by the falsity of E2</li>
</ul>
</li>
<li>If E has the form E1 || E2, then
<ul>
<li> the narrowed type for x implied by truth of E is T1|T2, where T1 is the
narrowed type for x implied by the truth of E1, and T2 is the intersection of T3
and T4, where T3 is the narrowed type for x implied by the falsity of E1 and T4
is the narrowed type for x implied by the truth of E2</li>
<li>the narrowed type for x implied by falsity of E is the intersection of T1
and T2, where T1 is narrowed type for x implied by the falsity of E1 and T2 is
the narrowed type for x implied by the falsity of E2</li>
</ul>
</li>
<li>If E has any other form, then
<ul>
<li>the narrowed type for x implied by the truth of E is Tx</li>
<li>the narrowed type for x implied by the falsity of E is Tx</li>
</ul>
</li>
</ul>
<p>
Narrowed types apply to regions of code as follows:
</p>
<ul>
<li>in an expression E1 || E2, the narrowed types implied by the falsity of E1
apply within E2</li>
<li>in an expression E1 &amp;&amp; E2, the narrowed types implied by the truth of E1
apply within E2</li>
<li>in an expression E1 ? E2 : E3, the narrowed types implied by the truth of E1
apply within E2 and the narrowed types implied by the falsity of E1 apply within
E3</li>
<li>in a statement if E1 { B1 } else { B2 }, the narrowed types implied by the
truth of E1 apply within B1 and the narrowed types implied by the falsity of E1
apply within E2</li>
<li>in a match-clause P if E =&gt; { B }, the narrowed types implied by the truth
of E apply within B</li>
<li>the narrowed type for a variable x no longer applies as soon as there is a
possibility of x being assigned to</li>
</ul>
</section>
<section>
<h3 id="XML_namespace_declaration_statement">7.13 XML namespace declaration statement</h3>

<pre class="grammar"><span class="ntdfn" id="xmlns-decl-stmt">xmlns-decl-stmt</span> := <a href="#xmlns-decl"><span class="ntref">xmlns-decl</span></a>
<span class="ntdfn" id="xmlns-decl">xmlns-decl</span> := <code>xmlns</code> <a href="#xml-namespace-uri"><span class="ntref">xml-namespace-uri</span></a> [ <code>as</code> <a href="#xml-namespace-prefix"><span class="ntref">xml-namespace-prefix</span></a> ] <code>;</code>
<span class="ntdfn" id="xml-namespace-uri">xml-namespace-uri</span> := <a href="#simple-const-expr"><span class="ntref">simple-const-expr</span></a>
<span class="ntdfn" id="xml-namespace-prefix">xml-namespace-prefix</span> := <a href="#identifier"><span class="ntref">identifier</span></a>
</pre>
<p>
An <code>xmlns-decl</code> is used to declare a XML namespace. If there is
an <code>xml-namespace-prefix</code>, then the in-scope namespaces that are used
to perform namespace processing on an <code>xml-template-expr</code> will include a
binding of that prefix to the specified <code>xml-namespace-uri</code>;
otherwise the in-scope namespaces will include a default namespace with the
specified <code>xml-namespace-uri</code>.
</p>
<p>
An <code>xml-namespace-prefix</code> declared by an <code>xmlns-decl</code>
is in the same symbol space as a <code>module-prefix</code> declared by an
<code>import-decl</code>. This symbol space is distinct from a module's main
symbol space used by other declarations. An <code>xmlns-decl</code> in a
<code>xmlns-decl-stmt</code> declares the prefix within the scope of the current
block.
</p>
<p>
The prefix <code>xmlns</code> is predeclared as
<code>http://www.w3.org/2000/xmlns/</code> and cannot be redeclared.
</p>
<p>
The static type of the <code>simple-const-expr</code> must be a subtype of
string.
</p>
</section>
<section>
<h3 id="section_7.14">7.14 Assignment</h3>

<p>
There are three kinds of assignment statement:
</p>
<ul>
<li>an ordinary assignment statement, which is usually called simply an
assignment statement,</li>
<li>a compound assignment statement, and</li>
<li>a destructuring assignment statement.</li>
</ul>
<p>
The first two of these build on the concept of an <em>lvalue</em>, whereas the
last one builds on the concept of a binding pattern.
</p>

<section>
<h4 id="section_7.14.1">7.14.1 Lvalues</h4>

<p>
An lvalue is what the left hand side of an assignment evaluates to. An lvalue
refers to a storage location which is one of the following:
</p>
<ul>
<li>a variable;</li>
<li>a specific named field of an object;</li>
<li>the member of a structured value having a specific out-of-line key, which
will be either an integer or a string according as the structured value is a
list or a mapping.</li>
</ul>
<p>
Note that an lvalue cannot refer to a member of a table.
</p>

<p>
An lvalue that is both defined and initialized refers to a storage location that
holds a value:
</p>
<ul>
<li>an lvalue referring to a variable is always defined but may be
uninitialized;</li>
<li>an lvalue referring to a specific named field of an object is always defined
but may not be initialized until the <code>init</code> method returns</li>
<li>an lvalue referring to member of a structured value having a specific key is
undefined if the structured value does not have a member with that key; if such an
lvalue is defined, it is also initialized; note that an lvalue always refers to
a structured value that is already constructed.</li>
</ul>

<pre class="grammar"><span class="ntdfn" id="lvexpr">lvexpr</span> :=
   <a href="#variable-reference-lvexpr"><span class="ntref">variable-reference-lvexpr</span></a>
   | <a href="#field-access-lvexpr"><span class="ntref">field-access-lvexpr</span></a>
   | <a href="#member-access-lvexpr"><span class="ntref">member-access-lvexpr</span></a>
</pre>

<p>
The left hand side of an assignment is syntactically a restricted type of
expression, called an lvexpr. When the evaluation of an lvexpr completes
normally, its result is an lvalue. The evaluation of an lvexpr can also complete
abruptly, with a panic or check-fail, just as with the evaluation of an
expression.
</p>
<p>
The compiler determines a static type for each lvexpr just as it does for
expressions, but the meaning is slightly different. For an lvexpr L to have
static type T means that if the runtime evaluation of L completes normally
resulting in an lvalue x, then if x is defined and initialized, it refers to a
storage location that holds a value belonging to type T. In addition to a type,
the compiler determines for each lvexpr whether it is potentially undefined and
whether it is potentially uninitialized.
</p>
<p>
An lvalue supports three operations: store, read and filling-read.
</p>
<p>
The fundamental operation on an lvalue is to store a value in the storage
location it refers to. This operation does not required the lvalue to be defined
or initialized; a successful store operation on an undefined lvalue will result
in the addition of a member to the structured value; a store on an uninitialized lvalue
will initialize it. When an lvalue refers to a variable, it is possible to
determine at compile-time whether the store of a value is permissible based on
the declaration of the variable and the static type of the value to be stored.
However, when the lvalue refers to a member of a structured value, this is not in
general possible for three reasons.
</p>
<ol>
<li>The guarantee provided by an lvalue having a static type T is not that the
referenced storage location can hold every value that belongs to type T; rather
the guarantee is that every value that the referenced storage location can hold
belongs to type T. This is because structured types are covariant in their
member types. The values that the storage location can actually hold are
determined by the inherent type of the structured value.</li>
<li>The member may not be defined and the inherent type of the structured value may not
allow a member with that specific key. The permissible keys of a structured value can
be constrained by closed record types, fixed-length array types, and tuple types
(with any rest descriptor).</li>
<li>The structured value may be immutable. The static type of an lvalue referring to a
member of a structured value makes no guaranteees that the structured value is not immutable.</li>
</ol>
<p>
The first of these reasons also applies to lvalues that refer to fields of
objects. Accordingly, stores to lvalues other than lvalues that refer to
variables must be verified at runtime to ensure that they are not impermissible
for any of the above three reasons. An attempt to perform an impermissible store
results in a panic at runtime.
</p>
<p>
List values maintain the invariant that there is a unique integer n, the length
of the list, such that a member k of the list is defined if and only if k is a
non-negative integer less than n. When a store is performed on an lvalue
referring to a member k of a list value and the length of the list is n and k is
&gt; n, then each member with index i for each â¤ i &lt; k is filled in, by
using the FillMember abstract operation. The FillMember abstract operation may
fail; in particular it will fail if the list is a fixed-length array. If the
FillMember operation fails, then the attempt to store will panic.
</p>
<p>
An lvalue also allows a read operation, which is used by the compound assignment
statement. Unlike a store operation, a read operation cannot result in a runtime
panic. A read operation cannot be performed on an lvalue that is undefined or
uninitialized.
</p>
<p>
Finally, a lvalue supports a filling-read operation, which is used to support
chained assignment. A filling-read is performed only an lvalue with a static
type that is a structured type. It differs from a read operation only when it is
performed on a potentially undefined lvalue. If the lvalue is undefined at
runtime, then the filling-read will use the FillMember abstract operation on the
member that the lvalue refers to. If the FillMember operation fails, then the
filling-read panics. Unlike the read operation, the filling-read operation can
be performed on an undefined lvalue; it cannot, however, be performed on an
uninitialized lvalue.
</p>
<p>
The evaluation of an lvexpr is specified in terms of the evaluation of its
subexpressions, the evaluation of its sub-lvexprs, and store and
filling-read operations on lvalues. If any of these result in a panic, then
the evaluation of the lvexpr completes abruptly with a panic.
</p>

<pre class="grammar"><span class="ntdfn" id="variable-reference-lvexpr">variable-reference-lvexpr</span> := <a href="#variable-reference"><span class="ntref">variable-reference</span></a>
</pre>
<p>
The result of evaluating variable-reference-lvexpr is an lvalue referring to a
variable. Its static type is the declared or inferred type of the variable. The
lvexpr is potentially uninitialized if it is possible for execution to have
reached this point without initializing the referenced variable.
</p>
<p>
A variable-reference-lvexpr that refers to a variable declared by a
module-var-decl that includes <code>isolated</code> is only allowed within a
lock-stmt.
</p>

<pre class="grammar"><span class="ntdfn" id="field-access-lvexpr">field-access-lvexpr</span> := <a href="#lvexpr"><span class="ntref">lvexpr</span></a> <code>.</code> <a href="#field-name"><span class="ntref">field-name</span></a>
</pre>

<p>
The static type of lvexpr must be either a subtype of the mapping basic type
or a subtype of the object basic type.
</p>
<p>
In the case where the static type of lvexpr is a subtype of the object basic
type, the object type must have a field with the specified name, and the
resulting lvalue refers to that object field.
</p>
<p>
In the case where the static type of lvexpr is a subtype of the mapping basic
type, the semantics are as follows.
</p>
<ul>
<li>The following requirements apply at compile time: the type of lvexpr must
include mapping shapes that have the specified field-name; type descriptor for
lvexpr must include <code>field-name</code> as an individual-field-descriptor (if
lvexpr is a union, then this requirement applies to every member of the union);
lvexpr must not be potentially uninitialized, but may be potentially
undefined.</li>
<li>
It is evaluated as follows:
<ol>
<li>evaluate lvexpr to get lvalue <var>lv</var>;</li>
<li>perform a filling-read operation on <var>lv</var> to get mapping value
<var>m</var>;</li>
<li>the result is an lvalue referring to the member of <var>m</var> with the
specified field-name.</li>
</ol>
</li>
<li>The static type of the field-access-expr is the member type for the key type
K in T, where T is the static type of the lvexpr and K is the singleton string
type containing the field-name; the field-access-expr is potentially undefined
if K is an optional key type for T.</li>
</ul>

<pre class="grammar"><span class="ntdfn" id="member-access-lvexpr">member-access-lvexpr</span> := <a href="#lvexpr"><span class="ntref">lvexpr</span></a> <code>[</code> <a href="#expression"><span class="ntref">expression</span></a> <code>]</code>
</pre>
<p>
The static type of lvexpr must be either a subtype of the mapping basic type or
a subtype of the list basic type. In the former case, the contextually expected
type of expression must be string and it is an error if the static type of
expression is not string; in the latter case, the contextually expected type of
expression must be int and it is an error if the static type of expression is
not int.
</p>
<p>
It is evaluated as follows:
</p>
<ol>
<li>evaluate expression to get a string or int <var>k</var>;</li>
<li>evaluate lvexpr to get lvalue <var>lv</var>;</li>
<li>perform a filling-read operation on <var>lv</var> to get a list or mapping value
<var>v</var>;</li>
<li>the result is an lvalue referring to the member of <var>c</var> with key
<var>k</var>.</li>
</ol>
<p>
The static type of the member-access-lvexpr is the member type for the key type K
in T, where T is the static type of the lvexpr and K is the static type type of
expression; the member-access-lvexpr is potentially undefined if K is an optional
key type for T.
</p>

</section>
<section>
<h4 id="section_7.14.2">7.14.2 Assignment statement</h4>

<pre class="grammar"><span class="ntdfn" id="assignment-stmt">assignment-stmt</span> := <a href="#lvexpr"><span class="ntref">lvexpr</span></a> <code>=</code> <a href="#action-or-expr"><span class="ntref">action-or-expr</span></a> <code>;</code>
</pre>
<p>
The static type of action-or-expr must be a subtype of the static type of
lvexpr. The static type of lvexpr provides the contextually expected type for
action-or-expr. It is not an error for lvexpr to be potentially undefined or
potentially uninitialized.
</p>
<p>
It is executed at as follows:
</p>
<ol>
<li>execute action-or-expr to get a value <var>v</var>;</li>
<li>evaluate lvexpr to get an lvalue <var>lv</var>;</li>
<li>perform the store operation of <var>lv</var> with value <var>v</var>.</li>
</ol>

</section>
<section>
<h4 id="section_7.14.3">7.14.3 Compound assignment statement</h4>

<pre class="grammar"><span class="ntdfn" id="compound-assignment-stmt">compound-assignment-stmt</span> := <a href="#lvexpr"><span class="ntref">lvexpr</span></a> <a href="#CompoundAssignmentOperator"><span class="ntref">CompoundAssignmentOperator</span></a> <a href="#action-or-expr"><span class="ntref">action-or-expr</span></a> <code>;</code>
<span class="ntdfn" id="CompoundAssignmentOperator">CompoundAssignmentOperator</span> := <a href="#BinaryOperator"><span class="ntref">BinaryOperator</span></a> <code>=</code>
<span class="ntdfn" id="BinaryOperator">BinaryOperator</span> := <code>+</code> | <code>-</code> | <code>*</code> | <code>/</code> | <code>&amp;</code> | <code>|</code> | <code>^</code> | <code>&lt;&lt;</code> | <code>&gt;&gt;</code> | <code>&gt;&gt;&gt;</code>
</pre>
<p>
It is a compile error if lvexpr is potentially undefined unless the static type
of lvexpr is a subtype of the list basic type. It is a compile error if lvexpr
is potentially uninitialized.
</p>
<p>
Let T1 be the static type of lvexpr, and let T2 be the static type of
action-expr. Then let T3 be the static type of an expression E1 BinaryOp E2
where E1 has type T1 and E2 has type T2. It is a compile error if T3 is not a
subtype of T1.
</p>
<p>
It is executed as follows:
</p>
<ol>
<li>execute action-or-expr to get a value <var>v2</var>;</li>
<li>evaluate lvexpr to get an lvalue <var>lv</var>;</li>
<li>if <var>lv</var> is undefined, panic (<var>lv</var> must refer to an
undefined member of a list)</li>
<li>perform the read operation on <var>lv</var> to get a value
<var>v1</var>
</li>
<li>perform the operation specified by BinaryOperator on operands <var>v1</var>
and <var>v2</var>, resulting in a value <var>v3</var>
</li>
<li>perform the store operation on <var>lv</var> with value <var>v3</var>.</li>
</ol>

</section>
<section>
<h4 id="section_7.14.4">7.14.4 Destructuring assignment statement</h4>

<pre class="grammar"><span class="ntdfn" id="destructuring-assignment-stmt">destructuring-assignment-stmt</span> :=
   <a href="#binding-pattern-not-variable-reference"><span class="ntref">binding-pattern-not-variable-reference</span></a> <code>=</code> <a href="#action-or-expr"><span class="ntref">action-or-expr</span></a> <code>;</code>
<span class="ntdfn" id="binding-pattern-not-variable-reference">binding-pattern-not-variable-reference</span> :=
   <a href="#wildcard-binding-pattern"><span class="ntref">wildcard-binding-pattern</span></a>
   | <a href="#list-binding-pattern"><span class="ntref">list-binding-pattern</span></a>
   | <a href="#mapping-binding-pattern"><span class="ntref">mapping-binding-pattern</span></a>
   | <a href="#error-binding-pattern"><span class="ntref">error-binding-pattern</span></a>
</pre>
<p>
A destructuring assignment is executed by evaluating the action-or-expr
resulting in a value v, and then matching the binding pattern to v, causing
assignments to the variables occurring in the binding pattern.
</p>
<p>
The binding-pattern has a static type implied by the static type of the
variables occurring in it. The static type of action-or-expr must be a subtype
of this type.
</p>
<p>
A binding pattern within a destructuring assignment must not refer to a variable
declared by a module-var-decl that includes <code>isolated</code>.
</p>

</section>
</section>
<section>
<h3 id="section_7.15">7.15 Action statement</h3>

<pre class="grammar"><span class="ntdfn" id="action-stmt">action-stmt</span> := <a href="#action"><span class="ntref">action</span></a> <code>;</code>
</pre>
<p>
An action-stmt is a statement that is executed by evaluating an action and
discarding the resulting value, which must be nil. It is a compile-time error if
the static type of an action in an action-stmt is not nil.
</p>
</section>
<section>
<h3 id="section_7.16">7.16 Call statement</h3>

<pre class="grammar"><span class="ntdfn" id="call-stmt">call-stmt</span> := <a href="#call-expr"><span class="ntref">call-expr</span></a> <code>;</code>
<span class="ntdfn" id="call-expr">call-expr</span> :=
   <a href="#function-call-expr"><span class="ntref">function-call-expr</span></a>
   | <a href="#method-call-expr"><span class="ntref">method-call-expr</span></a>
   | <a href="#checking-keyword"><span class="ntref">checking-keyword</span></a> <a href="#call-expr"><span class="ntref">call-expr</span></a>
</pre>
<p>
A call-stmt is executed by evaluating call-expr as an expression and discarding
the resulting value, which must be nil. The static type of the call-expr in an
call-stmt must be a subtype of nil; it is permitted to be <code>never</code>.
</p>
</section>
<section>
<h3 id="section_7.17">7.17 Conditional statement</h3>

<pre class="grammar"><span class="ntdfn" id="if-else-stmt">if-else-stmt</span> :=
   <code>if</code> <a href="#expression"><span class="ntref">expression</span></a> <a href="#statement-block"><span class="ntref">statement-block</span></a> 
   [ <code>else</code> <code>if</code> <a href="#expression"><span class="ntref">expression</span></a> <a href="#statement-block"><span class="ntref">statement-block</span></a> ]* 
   [ <code>else</code> <a href="#statement-block"><span class="ntref">statement-block</span></a> ]
</pre>
<p>
The if-else statement is used for conditional execution.
</p>
<p>
The static type of the expression following <code>if</code> must be boolean.
When an expression is true then the corresponding statement block is executed
and the if statement completes. If no expression is true then, if the else block
is present, the corresponding statement block is executed.
</p>
</section>
<section>
<h3 id="section_7.18">7.18 Do statement</h3>
<pre class="grammar"><span class="ntdfn" id="do-stmt">do-stmt</span> := <code>do</code> <a href="#statement-block"><span class="ntref">statement-block</span></a>
</pre>
<p>
A <code>do-stmt</code> is executed by executing its
<code>statement-block</code>.
</p>
</section>
<section>
<h3 id="match_statement">7.19 Match statement</h3>

<pre class="grammar"><span class="ntdfn" id="match-stmt">match-stmt</span> := <code>match</code> <a href="#action-or-expr"><span class="ntref">action-or-expr</span></a> <code>{</code> <a href="#match-clause"><span class="ntref">match-clause</span></a>+ <code>}</code>
<span class="ntdfn" id="match-clause">match-clause</span> :=
  <a href="#match-pattern-list"><span class="ntref">match-pattern-list</span></a> [<a href="#match-guard"><span class="ntref">match-guard</span></a>] <code>=&gt;</code> <a href="#statement-block"><span class="ntref">statement-block</span></a>
<span class="ntdfn" id="match-guard">match-guard</span> := <code>if</code> <a href="#expression"><span class="ntref">expression</span></a>
</pre>
<p>
A match statement selects a statement block to execute based on which patterns a
value matches.
</p>
<p>
A match-stmt is executed as follows:
</p>
<ol>
<li>the expression is evaluated resulting in some value v;</li>
<li>for each match-clause in order:
<ol>
<li>a match of match-pattern-list against v is attempted</li>
<li>if the attempted match fails, the execution of the match-stmt continues to
the next match-clause</li>
<li>if the attempted match succeeds, then the variables in match-pattern are
created</li>
<li>if there is a match-guard, then the expression in match-guard is executed
resulting in a value b</li>
<li>if b is false, then the execution of the match-stmt continues to the next
match-clause</li>
<li>otherwise, the statement-block in the match-clause is executed</li>
<li>execution of the match-stmt completes</li>
</ol>
</li>
</ol>
<p>
The scope of any variables created in a match-pattern-list of a match-clause is
both the match-guard, if any, and the statement-block in that match-clause. The
static type of the expression in match-guard must be a subtype of boolean.
</p>

<pre class="grammar"><span class="ntdfn" id="match-pattern-list">match-pattern-list</span> := 
  <a href="#match-pattern"><span class="ntref">match-pattern</span></a> (<code>|</code> <a href="#match-pattern"><span class="ntref">match-pattern</span></a>)*
</pre>
<p>
A match-pattern-list can be matched against a value. An attempted match can
succeed or fail. A match-pattern-list is matched against a value by attempting
to match each match-pattern until a match succeeds.
</p>
<p>
All the match-patterns in a given match-pattern-list must bind the same set of
variables.
</p>

<pre class="grammar"><span class="ntdfn" id="match-pattern">match-pattern</span> :=
  <code>var</code> <a href="#binding-pattern"><span class="ntref">binding-pattern</span></a>
   | <a href="#wildcard-match-pattern"><span class="ntref">wildcard-match-pattern</span></a>
   | <a href="#const-pattern"><span class="ntref">const-pattern</span></a>
   | <a href="#list-match-pattern"><span class="ntref">list-match-pattern</span></a>
   | <a href="#mapping-match-pattern"><span class="ntref">mapping-match-pattern</span></a>
   | <a href="#error-match-pattern"><span class="ntref">error-match-pattern</span></a>
</pre>
<p>
A match-pattern combines the destructuring done by a binding-pattern with the
ability to match a constant value.
</p>
<p>
Note that an identifier can be interpreted in two different ways within a
match-pattern:
</p>
<ul>
<li>in the scope of a <code>var</code>, an identifier names a variable which is
to be bound to a part of the matched value when a pattern match succeeds;</li>
<li>outside the scope of a var, an identifier references a constant that a value
must match for the pattern match to succeed.</li>
</ul>
<p>
A match-pattern must be linear: a variable that is to be bound cannot occur more
than once in a match-pattern.
</p>

<pre class="grammar"><span class="ntdfn" id="const-pattern">const-pattern</span> := <a href="#simple-const-expr"><span class="ntref">simple-const-expr</span></a>
</pre>
<p>
A const-pattern denotes a single value. Matching a const-pattern denoting a
value p against a value v succeeds if DeepEquals(p,v) is true. The static type
of the simple-const-expr in a const-pattern must be a subtype of anydata.
Successfully matching a const-pattern does not cause any variables to be
created.
</p>
<p>
Matching a wildcard-match-pattern against a value succeeds if the value belongs to
type any, in other words if the basic type of the value is not error.
</p>

<pre class="grammar"><span class="ntdfn" id="wildcard-match-pattern">wildcard-match-pattern</span> := <code>_</code>
<span class="ntdfn" id="list-match-pattern">list-match-pattern</span> := <code>[</code> <a href="#list-member-match-patterns"><span class="ntref">list-member-match-patterns</span></a> <code>]</code>
<span class="ntdfn" id="list-member-match-patterns">list-member-match-patterns</span> :=
   <a href="#match-pattern"><span class="ntref">match-pattern</span></a> (<code>,</code> <a href="#match-pattern"><span class="ntref">match-pattern</span></a>)* [<code>,</code> <a href="#rest-match-pattern"><span class="ntref">rest-match-pattern</span></a>]
   | [ <a href="#rest-match-pattern"><span class="ntref">rest-match-pattern</span></a> ]
<span class="ntdfn" id="mapping-match-pattern">mapping-match-pattern</span> := <code>{</code> <a href="#field-match-patterns"><span class="ntref">field-match-patterns</span></a> <code>}</code>
<span class="ntdfn" id="field-match-patterns">field-match-patterns</span> :=
   <a href="#field-match-pattern"><span class="ntref">field-match-pattern</span></a> (<code>,</code> <a href="#field-match-pattern"><span class="ntref">field-match-pattern</span></a>)* [<code>,</code> <a href="#rest-match-pattern"><span class="ntref">rest-match-pattern</span></a>]
   | [ <a href="#rest-match-pattern"><span class="ntref">rest-match-pattern</span></a> ] 
<span class="ntdfn" id="field-match-pattern">field-match-pattern</span> := <a href="#field-name"><span class="ntref">field-name</span></a> <code>:</code> <a href="#match-pattern"><span class="ntref">match-pattern</span></a>
<span class="ntdfn" id="rest-match-pattern">rest-match-pattern</span> := <code>...</code> <code>var</code> <a href="#variable-name"><span class="ntref">variable-name</span></a>
<span class="ntdfn" id="error-match-pattern">error-match-pattern</span> := <code>error</code> [<a href="#error-type-reference"><span class="ntref">error-type-reference</span></a>] <code>(</code> <a href="#error-arg-list-match-pattern"><span class="ntref">error-arg-list-match-pattern</span></a> <code>)</code>
<span class="ntdfn" id="error-arg-list-match-pattern">error-arg-list-match-pattern</span> :=
   <a href="#error-message-match-pattern"><span class="ntref">error-message-match-pattern</span></a> [<code>,</code> <a href="#error-cause-match-pattern"><span class="ntref">error-cause-match-pattern</span></a>] [<code>,</code> <a href="#error-field-match-patterns"><span class="ntref">error-field-match-patterns</span></a>]
   | [<a href="#error-field-match-patterns"><span class="ntref">error-field-match-patterns</span></a>]
<span class="ntdfn" id="error-message-match-pattern">error-message-match-pattern</span> := <a href="#simple-match-pattern"><span class="ntref">simple-match-pattern</span></a>
<span class="ntdfn" id="error-cause-match-pattern">error-cause-match-pattern</span> := <a href="#simple-match-pattern"><span class="ntref">simple-match-pattern</span></a> | <a href="#error-match-pattern"><span class="ntref">error-match-pattern</span></a>
<span class="ntdfn" id="simple-match-pattern">simple-match-pattern</span> :=
   <a href="#wildcard-match-pattern"><span class="ntref">wildcard-match-pattern</span></a>
   | <a href="#const-pattern"><span class="ntref">const-pattern</span></a>
   | <code>var</code> <a href="#variable-name"><span class="ntref">variable-name</span></a>
<span class="ntdfn" id="error-field-match-patterns">error-field-match-patterns</span> :=
   <a href="#named-arg-match-pattern"><span class="ntref">named-arg-match-pattern</span></a> (<code>,</code> <a href="#named-arg-match-pattern"><span class="ntref">named-arg-match-pattern</span></a>)* [<code>,</code> <a href="#rest-match-pattern"><span class="ntref">rest-match-pattern</span></a>]
   | <a href="#rest-match-pattern"><span class="ntref">rest-match-pattern</span></a>
<span class="ntdfn" id="named-arg-match-pattern">named-arg-match-pattern</span> := <a href="#arg-name"><span class="ntref">arg-name</span></a> <code>=</code> <a href="#match-pattern"><span class="ntref">match-pattern</span></a>
</pre>

<p>
Matching a <code>mapping-match-pattern</code> against a mapping value succeeds
if and only every <code>field-match-pattern</code> matches against a field of
the value. The variable in the <code>rest-match-pattern</code>, if specified, is
bound to a new mapping that contains just the fields for which that did not
match a <code>field-match-pattern</code>.
</p>
<p>
For every match pattern, there is a set of shapes that the pattern matches. The
type corresponding to the match pattern is the type containing these shapes. The
value matches the pattern if and only if it looks like the type. A mutable value
thus can match the pattern without belonging to the corresponding type. However,
an immutable value that matches the pattern will always belong to the type.
In particular, for the match of an <code>error-match-pattern</code> with an
<code>error-type-reference</code> against an error value to succeed, the
error value must belong to the referenced error type.
</p>
<p>
A variable is the <em>matched variable</em> of a <code>match-stmt</code> if
the <code>action-or-expression</code> following <code>match</code> is a
<code>variable-reference</code> that references this variable. The type of a
matched variable is subject to narrowing within regions of the
<code>match-stmt</code> as follows. The matched variable has a narrowed
type at the start of each match-clause, which is determined by previous
<code>match-clause</code>s; the type for the first <code>match-clause</code> is
the normal static type of the variable. Narrowing is applied to each
<code>match-clause</code> as follows:
</p>
<ul>
<li>let <var>T</var> be the narrowed type of the matched variable at the start
of the match-clause;</li>
<li>let <var>P</var> be the union of the corresponding types of each
<code>match-pattern</code> in the <code>match-pattern-list</code> of the
<code>match-clause</code>;</li>
<li>let <var>N</var> be the intersection of <var>T</var> and
<var>P</var>;</li>
<li>let <var>R</var> be the set difference of <var>T</var> and
<var>P</var>;</li>
<li>if <var>N</var> is a subtype of <code>readonly</code>, then the narrowed
type for the <code>match-guard</code>, if any, and <code>statement-block</code>
of the <code>match-clause</code> is <var>N</var>; otherwise it is
<var>T</var>;</li>
<li>if there is a match-guard, then the type narrowing described in <a href="#conditional_variable_type_narrowing">Conditional variable type
narrowing</a> is done in addition to the type narrowing described here;</li>
<li>if <var>R</var> is a subtype of <code>readonly</code> and there is no
<code>match-guard</code>, then the narrowed type for the next
<code>match-clause</code> is <var>R</var>; otherwise, it is <var>T</var>.</li>
</ul>

</section>
<section>
<h3 id="section_7.20">7.20 Loops</h3>
<section>
<h4 id="section_7.20.1">7.20.1 Foreach statement</h4>

<pre class="grammar"><span class="ntdfn" id="foreach-stmt">foreach-stmt</span> :=
   <code>foreach</code> <a href="#typed-binding-pattern"><span class="ntref">typed-binding-pattern</span></a> <code>in</code> <a href="#action-or-expr"><span class="ntref">action-or-expr</span></a> <a href="#statement-block"><span class="ntref">statement-block</span></a>
</pre>
<p>
A foreach statement iterates over an iterable value, executing a statement block
once for each value in the iterable value's iteration sequence. The static type
of action-or-expr must be an iterable type with an iteration completion type of
nil.
</p>
<p>
The scope of any variables created in typed-binding-pattern is statement-block. These
variables are implicitly final.
</p>
<p>
In more detail, a foreach statement executes as follows:
</p>
<ol>
<li>evaluate the action-or-expr resulting in a value c</li>
<li>create an iterator object i from c as follows
<ol>
<li>if c is a basic type that is iterable, then i is the result of calling
c.iterator()</li>
<li>if c is an object and c belongs to Iterable&lt;T,()&gt; for some T, then i is the
result of calling c.iterator()</li>
</ol>
</li>
<li>call i.next() resulting in a value n</li>
<li>if n is nil, then terminate execution of the foreach statement</li>
<li>match typed-binding-pattern to n.value causing assignments to any variables
that were created in typed-binding-pattern</li>
<li>execute statement-block with the variable bindings from step 5 in scope; in the
course of so doing
<ol>
<li>the execution of a break-stmt terminates execution of the foreach statement</li>
<li>the execution of a continue-stmt causes execution to proceed immediately to
step 3</li>
</ol>
</li>
<li>go back to step 3</li>
</ol>
<p>
In step 2, the compiler will give an error if the static type of expression is
not suitable for 2a or 2b.
</p>
<p>
In step 5, the typed-binding-pattern is used unconditionally, and the compiler
will check that the static types guarantee that the match will succeed. If the
typed-binding-pattern uses var, then the type will be inferred from the type of
<code>action-or-expr</code>.
</p>
</section>
<section>
<h4 id="section_7.20.2">7.20.2 While statement</h4>

<pre class="grammar"><span class="ntdfn" id="while-stmt">while-stmt</span> := <code>while</code> <a href="#expression"><span class="ntref">expression</span></a> <a href="#statement-block"><span class="ntref">statement-block</span></a>
</pre>
<p>
A while statement repeatedly executes a statement block so long as a
boolean-valued expression evaluates to true.
</p>
<p>
In more detail, a while statement executes as follows:
</p>
<ol>
<li>evaluate expression;</li>
<li>if expression evaluates to false, terminate execution of the while
statement;</li>
<li>execute statement-block; in the course of so doing
<ol>
<li>the execution of a break-stmt results in termination of execution of the
while statement</li>
<li>the execution of a continue-stmt causes execution to proceed immediately to
step 1</li>
</ol>
</li>
<li>go back to step 1.</li>
</ol>
<p>
The static type of <code>expression</code> must be a subtype of boolean.
</p>
</section>
<section>
<h4 id="section_7.20.3">7.20.3 Continue statement</h4>

<pre class="grammar"><span class="ntdfn" id="continue-stmt">continue-stmt</span> := <code>continue</code> <code>;</code>
</pre>
<p>
A continue statement is only allowed if it is lexically within a
while-stmt or a foreach-stmt. Executing a continue statement causes execution of
the nearest enclosing while-stmt or foreach-stmt to jump to the end of the
outermost statement-block in the while-stmt or foreach-stmt.
</p>
</section>
<section>
<h4 id="section_7.20.4">7.20.4 Break statement</h4>

<pre class="grammar"><span class="ntdfn" id="break-stmt">break-stmt</span> := <code>break</code> <code>;</code>
</pre>
<p>
A break statement is only allowed if it is lexically within a
while-stmt or a foreach-stmt. Executing a break statement causes the nearest
enclosing while-stmt or foreach-stmt to terminate.
</p>
</section>
</section>

<section>
<h3 id="lock_statement">7.21 Lock statement</h3>
<pre class="grammar"><span class="ntdfn" id="lock-stmt">lock-stmt</span> := <code>lock</code> <a href="#statement-block"><span class="ntref">statement-block</span></a>
</pre>

<p>
A lock-stmt executing in the context of some strand must execute its statement-block
in such a way that the effect on the state of the program is consistent with the
execution of the statement-block not being interleaved with the execution of a
lock-stmt on any other strand.
</p>
<p>
A naive implementation can simply acquire a single, program-wide, recursive mutex
before executing a lock statement, and release the mutex after completing the
execution of the lock statement. A more sophisticated implementation can perform
compile-time analysis to infer a more fine-grained locking strategy that will
have the same effects as the naive implementation.
</p>
<p>
It is not allowed to start a new strand within a lock. More precisely, when a
strand has started but not yet completed the execution of a lock-stmt, the
execution of a named-worker-decl or a start-action on that strand will result in
a panic. It is a compile-time error for a named-worker-decl or start-action to
occur lexically within a lock-stmt. The compiler may also give a compile-time
error if a function definition contains a named-worker-decl or start-action, and
there is a function call lexically within the lock-stmt that might result
directly or indirectly in a call to that defined function.
</p>
<p>
There are two cases where a variable is restricted to be used only within a
lock statement:
</p>
<ul>
<li>when the variable is an isolated module-level variable; since isolated
module-level variables are not allowed to be public, this restriction applies to
all functions in the module;</li>
<li>when the variable is <code>self</code> within an isolated object and
<code>self</code> occurs in a field-access-expr <code>self.<var>x</var></code>,
unless the field <code><var>x</var></code> is isolated; since non-isolated
fields are required to be private, this restriction applies only to the object's
methods.</li>
</ul>
<p>
When a lock statement contains one of the above two cases of restricted variable
usage, the lock statement is subject to the following additional requirements,
which maintain the invariant that the restricted variable is an isolated root.
</p>
<ul>
<li>Only one such variable can occur in the lock statement.</li>
<li>A function or method can be called in the lock statement only if the type of
the function is isolated.</li>
<li>Transferring values out of the lock statement is constrained: the expression
following a return statement must be an isolated expression; an assignment to a
variable defined outside the lock statement is allowed only if left-hand side is
just a variable name and the right hand side is an isolated expression. An
assignment to the restricted variable is not subject to this constraint.
</li>
<li>Transferring values into the lock statement is constrained: a
variable-reference-expr within the lock statement that refers to a variable or
parameter defined outside the lock statement is allowed only if the
variable-reference-expr occurs within an expression that is isolated. A
variable-reference-expr that refers to the restricted variable is not subject to
this constraint. Within a non-isolated object, <code>self</code> behaves like a
parameter.
</li>
</ul>

</section>

<section>
<h3 id="section_7.22">7.22 Fail and retry</h3>
<p>
The execution of a statement can fail either as the result of <code>check</code>
expression or action, or from an explicit <code>fail</code> statement. When
execution of a statement fails, control flow transfers to the nearest lexically
enclosing failure-handling statement. The failure handling statements are
stmt-with-on-fail, retry-stmt, transaction-stmt and retry-transaction-stmt. If
there is no such statement, it terminates the current worker normally. Note that
failure is completely distinct from panic.
</p>
<p>
When execution fails there is an associated error value, which is passed to the
failure-handling statement if there is one. If there is no failure-handling
statement, then the error value becomes the return value of the worker. The
possible failure control flows are known at compile-time, as are the types of
the associated error values. For every statement, the type of the error value
associated with a failure causing control to transfer out of the block is
determined at compile-time. This is in contrast with panics, for which the type
of associated error value is not known at compile-time.
</p>

<section>
<h4 id="section_7.22.1">7.22.1 Fail statement</h4>
<pre class="grammar"><span class="ntdfn" id="fail-stmt">fail-stmt</span> := <code>fail</code> <a href="#expression"><span class="ntref">expression</span></a> <code>;</code>
</pre>
<p>
Executing a fail-stmt will cause control flow to transfer to the nearest
lexically enclosing failure handling statement.
</p>
<p>
The static type of the expression must be a subtype of error. Execution of the
fail-stmt evaluates the expression; the resulting error value is passed to the
failure handling statement or becomes the termination value of the current
worker.
</p>

</section>
<section>
<h4 id="section_7.22.2">7.22.2 On fail clause</h4>
<pre class="grammar"><span class="ntdfn" id="stmt-with-on-fail">stmt-with-on-fail</span> := <a href="#regular-compound-stmt"><span class="ntref">regular-compound-stmt</span></a> <a href="#on-fail-clause"><span class="ntref">on-fail-clause</span></a>
<span class="ntdfn" id="on-fail-clause">on-fail-clause</span> := <code>on</code> <code>fail</code> <a href="#typed-binding-pattern"><span class="ntref">typed-binding-pattern</span></a> <a href="#statement-block"><span class="ntref">statement-block</span></a>
</pre>
<p>
A <code>stmt-with-on-fail</code> is executed by executing the
<code>regular-compound-stmt</code>. A <code>check</code> expression or action,
or a <code>fail</code> statement may cause control to transfer to the
<code>on-fail-cause</code>. In this case, the <code>typed-binding-pattern</code>
is matched to the associated error value, binding the variables occurring within
the <code>typed-binding-pattern</code>; the <code>statement-block</code> is then
executed with these bindings in scope. Otherwise, the
<code>on-fail-clause</code> is not executed.
</p>
<p>
The static type of the associated error value is determined from the static type
of the relevant <code>check</code> expressions and actions, and
<code>fail</code> statements. It is a compile error unless the match of the
<code>typed-binding-pattern</code> with the associated error value is guaranteed
to succeed by the static type of the associated error value.
</p>
</section>

<section>
<h4 id="section_7.22.3">7.22.3 Retry statement</h4>
<pre class="grammar"><span class="ntdfn" id="retry-stmt">retry-stmt</span> := <code>retry</code> <a href="#retry-spec"><span class="ntref">retry-spec</span></a> <a href="#statement-block"><span class="ntref">statement-block</span></a>
<span class="ntdfn" id="retry-spec">retry-spec</span> := [<a href="#type-parameter"><span class="ntref">type-parameter</span></a>] [ <code>(</code> <a href="#arg-list"><span class="ntref">arg-list</span></a> <code>)</code> ]
</pre>
<p>
The type-parameter in a retry-spec specifies a class, which must be a subtype of
RetryManager&gt;F&lt;, where F is the failure type of the statement-block; this
implies that the parameter type of the class's shouldRetry method must be a
supertype of F. The arg-list in a retry-spec specifies parameters to be passed
to the class's <code>init</code> method; as with <code>new</code>, the arg-list
can be omitted if the class's <code>init</code> method has no required
arguments.
</p>
<p>
A retry-stmt is executed as follows:
</p>
<ol>
<li>Create an object r of type RetryManager by calling <code>new T(A)</code>,
where T and A are the type-descriptor in the type-parameter and the arg-list
respectively.</li>
<li>Execute the statement-block.</li>
<li>If the execution failed with associated error e, then call
<code>r.shouldRetry(e)</code>. If the result is true, go back to the previous
step. If the result is false, then continue with the fail.</li>
</ol>
<p>
If the type-parameter is omitted, it defaults to
<code>DefaultRetryManager</code> defined in langlib error module.
</p>

</section>

</section>

<section>
<h3 id="transactions">7.23 Transactions</h3>

<p>
Ballerina provides language support for distributed transactions. A global
transaction consists of one or more transaction branches, where a branch
corresponds to work done by a single strand of a Ballerina program that is part
of the global transaction. Every transaction branch is uniquely identified by an
XID, which consists of an identifier of the global transaction and an identifier
of a branch with the global transaction.
</p>
<p>
At runtime, there is a mapping from each strand to a transaction stack, which is
a stack of transaction branches. A strand is in <em>transaction mode</em>, if
its transaction stack is non-empty; the top of a strand's transaction stack is
the current transaction branch for that strand.
</p>
<p>
Static checking is based on the idea of a transactional scope: this is a lexical
region of the program where it is known that at runtime the strand executing the
region will always be in transactional mode. A function with the
<code>transactional</code> qualifier can only be called in a transactional
scope; this includes function calls using <code>start</code>.
</p>
<p>
A running instance of a Ballerina program includes a transaction manager. This
may run in the same process as the Ballerina program or in a separate process.
It should not be connected over an unreliable network. The transaction manager
of a program is responsible for managing the transaction branches of all the
program's strands.
</p>
<p>
When a global transaction involves multiple Ballerina programs, there must be a
network protocol that allows that transaction managers for each Ballerina
program to communicate. The protocol must also allow a remote method or resource
method on a service object to be informed of the global transaction, if any, to
which it belongs. When a listener object determines that a remote method or
resource method of a service object is to be a part of a global transaction
manager, then it will create a new transaction branch, join it to the global
transaction and push that on the transaction stack for the strand on which the
method is called; if the method is declared as <code>transactional</code>, the
listener will not call the method unless it can do this. Similarly, the protocol
must allow a remote method on a client object that is called in transaction mode
to send information about the global transaction of which it is part; if the
method is declared as <code>transactional</code>, then as usual the method can
only be called in transaction mode; it also implies that the client object
implementation is transaction-aware, and that the recipient of the message sent
by the remote method must join the global transaction. A global transaction can
combine Ballerina programs with programs written in other programming languages
provided they agree on this network protocol.
</p>
<p>
A strand in transaction mode can register commit or rollback handlers with the
transaction manager; the handlers are functions which will be called by the
transaction manager when the decision has been made whether to commit or
rollback the global transaction to which the current transaction branch belongs.
</p>
<p>
Note that internal storage in Ballerina is not transactional. Rolling back a
transaction does <em>not</em> automatically restore the mutable values are
variables to their state when the transaction started. It is up to the
programmer to do this using commit or rollback handlers.
</p>
<p>
When a new strand is created by a named-worker-decl that includes a
<code>transactional</code> qualifier or by using <code>start</code> to call a
function with a <code>transactional</code> qualifier, a new transaction branch
will be created and joined to the global transaction; this transaction branch
will be pushed onto transaction stack for the newly created strand.
</p>
<p>
Ballerina also has the concept that a transaction may be part of a sequence of
retries, where the last transaction can complete with either a rollback or
commit, and the preceding transactions all completed with a rollback.
</p>

<section>
<h4 id="section_7.23.1">7.23.1 Transaction manager</h4>

<p>
The semantics of Ballerina's transactional language features are defined in
terms of the following abstract operations on the transaction manager. These
operations cover only the interface between the application and the transaction
manager, not the interface between the resource manager and the application.
These operations are all performed by a Ballerina program in the context of a
strand. The transaction manager supports additional operations, which are
defined in the langlib transaction module.
</p>

<section>
<h5 id="section_7.23.1.1">7.23.1.1 Begin operation</h5>
<p>
The Begin operation starts a global transaction and pushes a transaction branch
for the new global transaction onto the current strand's transaction stack. This
transaction branch is the initiating branch of the global transaction. The
current strand will be in transaction mode.
</p>
<p>
The Begin operation has an optional parameter that contains information about
the previous transactions in a sequence of retries.
</p>
</section>

<section>
<h5 id="section_7.23.1.2">7.23.1.2 Commit operation</h5>
<p>
The Commit operation is only called in transaction mode, and when the current
transaction branch is the initiating branch of a global transaction. The Commit
operation always removes the topmost transaction branch from the strand's transaction
stack. The Commit operation initiates a commit of the global transaction that
the current transaction branch belongs to.
</p>
<p>
When the commit is initiated, the transaction manager runs a two-phase commit
protocol if necessary. First, it requests each participant to prepare to commit
and waits for the participants to respond. There are two possibilities. If it
receives a response from each participant that it is prepared to commit, then
the transaction manager will make a decision to commit. If it receives a
response from any participant that it cannot commit or it gives up waiting for a
response from any participant, then the transaction manager will make a decision
to rollback; in this case, it will create an error value for the cause of the
rollback.
</p>
<p>
Once the transaction manager has made a decision whether to commit, it calls the
handlers that were registered with it for for the branches of the global
transaction that it is managing; the commit handlers are called if the decision
was to commit and the rollback handlers are called if the decision was to
rollback. The error value for the cause of the rollback will be passed as an
argument to the call of each rollback handler. At this point, the Commit
operation can return. The transaction manager will also communicate its decision
to the transaction's participants, which will result in them running commit or
rollback handlers for their branches.
</p>
<p>
The Commit operation has an optional parameter which is a RetryManager object or
nil, which defaults to nil. If this parameter is non-nil and the decision is to
rollback, then the transaction manager will call the RetryManager object's
shouldRetry method, record the result and then pass it as the willRetry
parameter to any rollback handlers.
</p>
<p>
If the transaction manager decided to rollback, then the Commit operation
returns the error value for the reason for the rollback. Otherwise, it returns
nil.
</p>

</section>

<section>
<h5 id="section_7.23.1.3">7.23.1.3 Rollback operation</h5>
<p>
The Rollback operation is only called in transaction mode, and when the current
transaction branch is the initiating branch of a global transaction. The
Rollback operation always removes the topmost transaction from the strand's
transaction stack. The Rollback operations initiates a commit of the global
transaction that the current transaction branch belongs to. The transaction
manager calls the rollback handlers that were registered with it for the
branches of the global transaction that it is managing. The Rollback operation
has a parameter which is either an error value or nil; this is passed as an
argument to any rollback handlers.
</p>
<p>
The Rollback operation also has an optional parameter which is a RetryManager object
or nil, which defaults to nil. If this parameter is non-nil, then the
transaction manager will call the RetryManager object's shouldRetry method,
record the result and then pass it as the willRetry parameter to any rollback
handlers.
</p>

</section>
</section>

<section>
<h4 id="section_7.23.2">7.23.2 Transaction statement</h4>

<p>
A transaction is performed using a transaction statement. The semantics of the
transaction statement guarantees that every transaction manager Begin operation
will be paired with a Rollback or Commit operation.
</p>
<pre class="grammar"><span class="ntdfn" id="transaction-stmt">transaction-stmt</span> := <code>transaction</code> <a href="#statement-block"><span class="ntref">statement-block</span></a>
</pre>
<p>
The statement-block must contain at least one commit-action. In addition, the
compiler must be able to verify that any exit out of the statement-block that is
neither a panic nor a fail will have executed a commit-action or
rollback-stmt.
</p>
<p>
A transaction-stmt is executed as follows:
</p>
<ul>
<li>Perform the transaction Begin() operation.</li>
<li>Execute the statement-block. While executing the statement-block, any panic
does not immediately terminate the current worker; rather control is transferred
back to the transaction-stmt, so that the transaction-stmt can handle it as
described in the next step.</li>
<li>If the new transaction that was begun is still the current transaction, then
the statement-block must have failed or panicked. In this case, perform a
Rollback(e) operation, where e is the error associated with the fail or panic,
and then continue with the fail or panic.</li>
</ul>
<p>
The statement-block of a transaction-stmt is a transactional scope, except for
any statements that could potentially be executed after the execution of a
commit-action or rollback-stmt.
</p>
<p>
It is an error for a transactional-stmt to appear in a transactional scope.
However, it is not an error if the current strand is in transaction mode when a
transaction-stmt is executed: in this case, the Begin() operation performed by
the transaction-stmt will, as usual, start a new transaction, which will be
completely independent of any existing transactions.
</p>
</section>


<section>
<h4 id="section_7.23.3">7.23.3 Retry transaction statement</h4>

<pre class="grammar"><span class="ntdfn" id="retry-transaction-stmt">retry-transaction-stmt</span> := <code>retry</code> <a href="#retry-spec"><span class="ntref">retry-spec</span></a> <a href="#transaction-stmt"><span class="ntref">transaction-stmt</span></a>
</pre>
<p>
A retry-transaction-stmt is the same as a retry-stmt containing a
transaction-stmt, except as follows.
</p>
<ul>
<li>When a transaction is retried, information about the previous transaction is
passed as a parameter to the Begin() operation.</li>
<li>If the transaction committed successfully, but the statement-block of the
transaction-stmt failed, then the transaction-stmt will not be retried.</li>
<li>The RetryManager is passed as a parameter to the Commit() and Rollback()
operations and the shouldRetry method is then called by those operations, so
that the result is available to the rollback handlers. The transaction manager
records the result of calling shouldRetry, and this is used to determine whether
to retry.</li>
</ul>
</section>

<section>
<h4 id="section_7.23.4">7.23.4 Commit action</h4>

<pre class="grammar"><span class="ntdfn" id="commit-action">commit-action</span> := <code>commit</code>
</pre>
<p>
A <code>commit-action</code> is only allowed if it is lexically within the
<code>statement-block</code> of a <code>transaction-stmt.</code>
</p>
<p>
Evaluating the <code>commit-action</code> performs the transaction manager
Commit() operation; the result of this operation is the result of the
<code>commit-action</code>. The type of the result is
<code>transaction:Error?</code>. Note that the commit action does not alter the
flow of control.
</p>

</section>

<section>
<h4 id="section_7.23.5">7.23.5 Rollback statement</h4>

<pre class="grammar"><span class="ntdfn" id="rollback-stmt">rollback-stmt</span> := <code>rollback</code> [<a href="#expression"><span class="ntref">expression</span></a>] <code>;</code>
</pre>
<p>
A <code>rollback-stmt</code> is only allowed if it is lexically within the
<code>statement-block</code> of a <code>transaction-stmt.</code>
</p>
<p>
The <code>rollback-stmt</code> performs the transaction manager Rollback(e)
operation, where e is the result of executing the <code>expression</code>, if
present, and nil otherwise. Note that like the commit action, the rollback
statement does not alter the flow of control.
</p>

</section>

</section>
<section>
<h3 id="section_7.24">7.24 Panic statement</h3>

<pre class="grammar"><span class="ntdfn" id="panic-stmt">panic-stmt</span> := <code>panic</code> <a href="#expression"><span class="ntref">expression</span></a> <code>;</code>
</pre>
<p>
A panic statement terminates the current worker abnormally. The result of
evaluating <code>expression</code> provides the termination value of the worker.
</p>
<p>
The static type of <code>expression</code> must be a subtype of error.
</p>
</section>

<section>
<h3 id="section_7.25">7.25 Return statement</h3>

<pre class="grammar"><span class="ntdfn" id="return-stmt">return-stmt</span> := <code>return</code> [ <a href="#action-or-expr"><span class="ntref">action-or-expr</span></a> ] <code>;</code>
</pre>
<p>
A return statement terminates the current worker normally.The result of
evaluating the action-or-expr provides the termination value of the worker. If
action-or-expr is omitted, then the termination value is nil.
</p>
</section>


</section>
<section>
<h2 id="module_level">8. Module-level declarations</h2>
<p>
Each source part in a Ballerina module must match the production
<code>module-part</code>.
</p>
<p>
The import declarations must come before other declarations; apart from this,
the order of the definitions and declarations at the top-level of a module is
not constrained.
</p>

<pre class="grammar"><span class="ntdfn" id="module-part">module-part</span> := <a href="#import-decl"><span class="ntref">import-decl</span></a>* <a href="#other-decl"><span class="ntref">other-decl</span></a>*
<span class="ntdfn" id="other-decl">other-decl</span> :=
   <a href="#listener-decl"><span class="ntref">listener-decl</span></a>
   | <a href="#service-decl"><span class="ntref">service-decl</span></a>
   | <a href="#function-defn"><span class="ntref">function-defn</span></a>
   | <a href="#module-type-defn"><span class="ntref">module-type-defn</span></a>
   | <a href="#module-class-defn"><span class="ntref">module-class-defn</span></a>
   | <a href="#module-var-decl"><span class="ntref">module-var-decl</span></a>
   | <a href="#module-const-decl"><span class="ntref">module-const-decl</span></a>
   | <a href="#module-enum-decl"><span class="ntref">module-enum-decl</span></a>
   | <a href="#module-xmlns-decl"><span class="ntref">module-xmlns-decl</span></a>
   | <a href="#annotation-decl"><span class="ntref">annotation-decl</span></a>
</pre>
<section>
<h3 id="section_8.1">8.1 Import declaration</h3>

<pre class="grammar"><span class="ntdfn" id="import-decl">import-decl</span> := <code>import</code> [<a href="#org-name"><span class="ntref">org-name</span></a> <code>/</code>] <a href="#module-name"><span class="ntref">module-name</span></a> [<code>as</code> <a href="#import-prefix"><span class="ntref">import-prefix</span></a>] <code>;</code>
<span class="ntdfn" id="import-prefix">import-prefix</span> := <a href="#module-prefix"><span class="ntref">module-prefix</span></a> | <code>_</code>
<span class="ntdfn" id="module-prefix">module-prefix</span> := <a href="#identifier"><span class="ntref">identifier</span></a> | <a href="#predeclared-prefix"><span class="ntref">predeclared-prefix</span></a>
<span class="ntdfn" id="org-name">org-name</span> := <a href="#identifier"><span class="ntref">identifier</span></a>
<span class="ntdfn" id="module-name">module-name</span> := <a href="#identifier"><span class="ntref">identifier</span></a> (<code>.</code> <a href="#identifier"><span class="ntref">identifier</span></a>)*

<span class="ntdfn" id="qualified-identifier">qualified-identifier</span> := <a href="#module-prefix"><span class="ntref">module-prefix</span></a> <code>:</code> <a href="#identifier"><span class="ntref">identifier</span></a>
</pre>
<p>
If org-name is omitted, it is defaulted from the organization of the importing
module.
</p>
<p>
A <code>module-prefix</code> is a name that is used locally within the source of
a module to refer to another module. A <code>module-prefix</code> in a
qualified-identifier must refer to a <code>module-prefix</code> specified in an
import-declaration in the same source part.
</p>
<p>
An import-prefix of <code>_</code> causes the module to be imported without
making its symbols available via a module-prefix. In this case, the effect of
importing the module will be just to cause the module to be included in the
program and initialized. It is an error for a source-part to import a module
using a module-prefix and then not to use that module-prefix.
</p>
<p>
A <code>module-prefix</code> declared by an <code>import-decl</code> is in the
same symbol space as a <code>xmlns-namespace-prefix</code> declared by an
<code>xmlns-decl</code>. This symbol space is distinct from a module's main
symbol space used by other declarations.
</p>
<p>
It is an error for a module to directly or indirectly import itself. In other
words, the directed graph of module imports must be acyclic.
</p>
<pre class="grammar"><span class="ntdfn" id="predeclared-prefix">predeclared-prefix</span> :=
   <code>boolean</code>
   | <code>decimal</code>
   | <code>error</code>
   | <code>float</code>
   | <code>future</code>
   | <code>int</code>
   | <code>map</code>
   | <code>object</code>
   | <code>stream</code>
   | <code>string</code>
   | <code>table</code>
   | <code>transaction</code>
   | <code>typedesc</code>
   | <code>xml</code>
</pre>
<p>
A reserved keyword <code><var>t</var></code> that is a predeclared-prefix is
predeclared as referring to the <code>lang.<var>t</var></code> lang library
module, but this can be overridden by an import-decl that imports a module using
that prefix. A predeclared-prefix can be used as a module-prefix without using a
QuotedIdentifier.
</p>

</section>

<section>
<h3 id="section_8.2">8.2 Module and program execution</h3>
<p>
A Ballerina program consists of one or more modules; one of these modules is
distinguished as the <em>root</em> module. The source code for a module uses
import declarations to identify the modules on which it depends directly. At
compile-time, a root module is specified, and the modules comprising the program
are inferred to be those that the root module imports directly or indirectly.
The directed graph of module imports must be acyclic.
</p>
<p>
Program execution may terminate successfully or unsuccessfully. Unsuccessful
program termination returns an error value. Program execution consists of two
consecutive phases: an initialization phase and a listening phase.
</p>
<p>
Module initialization is performed by calling an initialization function, which
is synthesized by the compiler for each module. Module initialization can fail,
in which case the initialization function returns an error value. The
initialization phase of program execution consists of initializing each of the
program's modules. If the initialization of a module is unsuccessful, then
program execution immediately terminates unsuccessfully, returning the error
value returned by the initialization function.
</p>
<p>
The initialization of a program's modules is ordered so that a module will not
be initialized until all of the modules on which it depends have been
initialized. (Such an ordering will always be possible, since the graph of
module imports is required to be acyclic.) The order in which modules are
initialized follows the order in which modules are imported so far as is
consistent with the previous constraint.
</p>
<p>
A module's initialization function performs expression evaluation so as to
initialize the identifiers declared in the module's declarations; if evaluation
of an expression completes abruptly, then the module initialization function
immediately returns the error value associated with the abrupt completion. If a
module defines a function named <code>init</code>, then a module's
initialization function will end by calling this function; if it terminates
abruptly or returns an error, then the module's initialization function will
return an error value. Note that the <code>init</code> function of the root
module will be the last function called during a program's initialization phase.
</p>
<p>
This specification does not define any mechanism for processing the program
command-line arguments typically provided by an operating system. The Ballerina
standard library provides a function to retrieve these command-line arguments.
In addition, the Ballerina platform provides a convenient mechanism for
processing these arguments. This works by generating a new command-line
processing module from the specified root module. The <code>init</code>
function of the generated module retrieves the command-line arguments, parses
them, and calls a public function of the specified root module (typically the
<code>main</code> function). The parsing of the command-line arguments is
controlled by the declared parameter types, annotations and names of the public
functions. The generated module, which imports the specified root module,
becomes the new root module.
</p>
<p>
A configuration is supplied as input to program execution. A
<em>configuration</em> consists of mapping from names of configurable
module-level variables to values. The values in a configuration always belong to
the type <code>anydata&amp;readonly</code>. The value for a variable in the
configuration is used during module initialization to initialize the variable
instead of the value specified in the module. A configurable module-level
variable may require that a configuration include a value for it. Except for
this requirement, a configuration may be empty. Before initializing any module,
the initialization phase must check that there is a value of the correct type
supplied for every configurable module-level variable that requires
configuration. If not, the module initialization phase terminates unsuccessfull.
</p>
<p>
If the initialization phase of program execution completes successfully, then
execution proceeds to the listening phase, which is described in the next
section. The termination of the listening phase, which may be successful or
unsuccessful, terminates the program execution.
</p>
</section>

<section>
<h3 id="listeners_and_services">8.3 Listeners and services</h3>

<p>
Service objects support network interaction using remote methods and resource
methods. Listeners provide the interface between the network and service
objects. A listener object receives network messages from a remote process
according to some protocol and translates the received messages into calls on
the remote and resource methods of service objects that have been attached to
the listener object. It is up to the listener object to determine how this
translation happens; the type of the listener object constrains the type of a
service that can be attached to the listener. (This constraint cannot yet be
fully expressed by Ballerina's type system.)
</p>
<p>
A service object's remote or resource method uses its return value to indicate
to the listener what further handling of the network message is needed. An error
return value is used to indicate that the method encountered some sort of error
in handling the network message. When a service object is returned, it means
that the listener should use that service object to further handle the network
message. When no further handling is needed, the return value should be nil.
</p>
<p>
The return value can also be used to supply a response to the network message.
This has the limitation that the method cannot control what happens if there is
an error in sending a response. It also has the limitation that it cannot handle
complex message exchange patterns, although returning multiple responses to a
single request can be modelled by returning a stream. A listener object can
avoid these limitations by passing a client object as a parameter to the service
object's remote or resource method; the service object then makes calls on the
remote methods of the client object in order to send a response back to the
client.
</p>
<p>
The methods defined by the Listener object type allow for the
management of the lifecycle of a listener object and its attached services. A
listener declaration registers a listener object with a module, so that it can
be managed by the module. The runtime state of each module includes a list of
listener objects that have been registered with the module. A listener object
that has been registered with a module is called a <em>module listener</em>
</p>
<p>
If at the start of the listening phase of program execution there are no module
listeners, then the listening phase immediately terminates successfully.
Otherwise, the <code>start</code> method of each module listener is called; if
any of these calls returns an error value, then the listening phase terminates
unsuccessfully with this error value as its return value.
</p>
<p>
The listening phase of program execution continues until either the program
explicitly exits, by calling a standard library function, or the user explicitly
requests the termination of the program using an implementation-dependent
operating system facility (such as a signal on a POSIX system). In the latter
case, the <code>gracefulStop</code> or <code>immediateStop</code> method of
each registered listener will be called before termination.
</p>

<section>
<h4 id="section_8.3.1">8.3.1 Listener declaration</h4>

<pre class="grammar"><span class="ntdfn" id="listener-decl">listener-decl</span> :=
   <a href="#metadata"><span class="ntref">metadata</span></a>
   [<code>public</code>] <code>listener</code> [<a href="#type-descriptor"><span class="ntref">type-descriptor</span></a>] <a href="#variable-name"><span class="ntref">variable-name</span></a> <code>=</code> <a href="#expression"><span class="ntref">expression</span></a> <code>;</code>
</pre>
<p>
A <code>listener-decl</code> declares a module listener. A module listener
declares a variable in a similar way to a final variable declaration, but the
type of the variable is always a subtype of the Listener object type,
and it has the additional semantic of registering the variable's value with the
module as a listener. As with a variable declared in a final variable
declaration, the variable can be referenced by a variable-reference, but cannot
be assigned to. A module may have multiple multiple listeners.
</p>
<p>
When a listener-decl is initialized as part of module initialization, its
expression is evaluated. If expression evaluation completes abruptly or the
result of the expression is an error, then module initialization fails.
Otherwise the variable is initialized with the result of the evaluation.
</p>
<p>
If the type-descriptor is present, it specifies the static type of the variable.
The static type of <code>expression</code> must be equivalent to a union L|E,
where L is a listener object type and E is subtype of error, which may be
<code>never</code>; if the type-descriptor is not present, then L is used as the
static type of the variable.
</p>

</section>

<section>
<h4 id="section_8.3.2">8.3.2 Service declaration</h4>

<pre class="grammar"><span class="ntdfn" id="service-decl">service-decl</span> :=
   <a href="#metadata"><span class="ntref">metadata</span></a> [<a href="#isolated-qual"><span class="ntref">isolated-qual</span></a>]
   <code>service</code> [<a href="#type-descriptor"><span class="ntref">type-descriptor</span></a>] [<a href="#attach-point"><span class="ntref">attach-point</span></a>] <code>on</code> <a href="#expression-list"><span class="ntref">expression-list</span></a> <a href="#object-constructor-block"><span class="ntref">object-constructor-block</span></a>
<span class="ntdfn" id="attach-point">attach-point</span> := <a href="#absolute-resource-path"><span class="ntref">absolute-resource-path</span></a> | <a href="#string-literal"><span class="ntref">string-literal</span></a>
<span class="ntdfn" id="absolute-resource-path">absolute-resource-path</span> :=
   <a href="#root-resource-path"><span class="ntref">root-resource-path</span></a>
   | (<code>/</code> <a href="#resource-path-segment-name"><span class="ntref">resource-path-segment-name</span></a>)+
<span class="ntdfn" id="root-resource-path">root-resource-path</span> := <code>/</code>

<span class="ntdfn" id="expression-list">expression-list</span> := <a href="#expression"><span class="ntref">expression</span></a> (<code>,</code> <a href="#expression"><span class="ntref">expression</span></a>)*
</pre>
<p>
A <code>service-decl</code> creates a service object and attaches it to one or more
listeners. 
</p>
<p>
The static type S for the constructed service object is specified by the
type-descriptor if present, and otherwise is the union of a type inferred from
each expression in the expression list as follows. Each expression in the
expression-list must have a type Listener&lt;T,A&gt;|E where T is a subtype of
<code>service object {}</code>, A is a subtype of
<code>string[]|string|()</code> and E is a subtype of <code>error</code>; the
inferred type is T. The object-constructor-block has the same semantics as in an
object-constructor-expr with a <code>service</code> qualifier and a
type-reference that refers to S. If the service-decl includes
<code>isolated</code>, then it is equivalent to an object-constructor-expr with
an <code>isolated</code> qualifier as well as a <code>service</code> qualifier.
</p>
<p>
The <code>attach-point</code> determines the second argument passed to the
<code>attach</code> method: if the <code>attach-point</code> is absent, then the
argument is nil; if it is a <code>string-literal</code>, then the argument is a
string; otherwise, it is an <code>absolute-resource-path</code> and the argument
is an array of strings, with one string for each
<code>resource-path-segment-name</code>. Attaching service objects
<var>s</var><sub>1</sub>,...,<var>s</var><sub><var>n</var></sub> with absolute
resource paths <var>p</var><sub>1</sub>,...,<var>p</var><sub><var>n</var></sub>
is equivalent to attaching a single service object with <var>n</var>
<code>get</code> resource methods to <code>/</code>, where the <var>i</var>-th
resource method has a path <var>p</var><sub>i</sub> (an
<code>absolute-resource-path</code> is turned into a
<code>relative-resource-path</code> with the same
<code>resource-path-segment-name</code>s) and returns
<var>s</var><sub><var>i</var></sub>.
</p>
<p>
A service-decl is initialized as part of module initialization as follows. The
object-constructor-block is evaluated as in an object-constructor-expr resulting
in a service object <code><var>s</var></code>. Then for each expression in
expression-list:
</p>
<ol>
<li>the expression is evaluated resulting in a value which is either an error or
an object <code><var>obj</var></code> belonging to a listener object type;</li>
<li>if it is an error, module initialization fails;</li>
<li>otherwise, <code><var>obj</var></code> is registered as a module listener
(registering the same object multiple times is the same as registering it
once);</li>
<li>
<code><var>s</var></code> is then attached to <code><var>obj</var></code>
using <code><var>obj</var></code>'s <code>attach</code> method;</li>
<li>if the call to <code>attach</code> fails, then module initialization
fails.</li>
</ol>
</section>

<section>
<h4 id="section_8.3.3">8.3.3 Isolated inference</h4>

<p>
A listener object can use the isolated bit of a service object and of a service
object's remote method to determine whether it is safe to make concurrent calls
to the remote object or the remote method.
</p>
<p>
The compiler may infer that a service object or a service object's remote method
is isolated even it is not explicitly declared as such. In doing so, it analyzes
a module to determine whether there is a set of declarations and definitions in
the module, where each of them is a <code>service-decl</code>,
<code>module-var-decl</code>, <code>module-class-defn</code>
<code>function-defn</code> or <code>method-defn</code>, and none of them
explicitly specified an <code>isolated</code> qualifier, such that if all them
explicitly specified an <code>isolated</code> qualifier, then they all would
meet the requirements for <a href="#isolated_functions">isolated functions</a>
and isolated objects. If so, then the isolated bit of values resulting from them
is set in the same way as if <code>isolated</code> qualifiers had been
explicitly specified.
</p>
<p>
This inference is purely an optimization to improve service concurrency and is
subject to two constraints. First, any inferences do not affect the static types
visible to other modules. Second, anything explicitly declared as
<code>isolated</code> must satisfy the requirements of this specification
without without relying on inference.
</p>

</section>
</section>

<section>
<h3 id="section_8.4">8.4 Function definition</h3>

<pre class="grammar"><span class="ntdfn" id="function-defn">function-defn</span> := 
   <a href="#metadata"><span class="ntref">metadata</span></a>
   [<code>public</code>] <a href="#function-quals"><span class="ntref">function-quals</span></a>
   <code>function</code> <a href="#identifier"><span class="ntref">identifier</span></a> <a href="#function-signature"><span class="ntref">function-signature</span></a> <a href="#function-defn-body"><span class="ntref">function-defn-body</span></a>
<span class="ntdfn" id="function-defn-body">function-defn-body</span> :=
   <a href="#block-function-body"><span class="ntref">block-function-body</span></a>
   | <a href="#expr-function-body"><span class="ntref">expr-function-body</span></a> <code>;</code>
   | <a href="#external-function-body"><span class="ntref">external-function-body</span></a> <code>;</code>
</pre>
<p>
If a module has a function-defn with an identifier of <code>init</code>, it is
called called automatically by the system at the end of the initialization of
that module; if this call returns an error, then initialization of the module
fails. The following special requirements apply to the <code>init</code>
function of a module: it must not be declared <code>public</code>; its return
type must both be a subtype of <code>error?</code> and contain <code>()</code>;
it must have no parameters.
</p>
<p>
If the function-quals includes <code>transactional</code>, then
expr-function-body and the block-function-body are transactional scopes.
</p>

</section>

<section>
<h3 id="section_8.5">8.5 Module type definition</h3>

<pre class="grammar"><span class="ntdfn" id="module-type-defn">module-type-defn</span> :=
   <a href="#metadata"><span class="ntref">metadata</span></a>
   [<code>public</code>] <code>type</code> <a href="#identifier"><span class="ntref">identifier</span></a> <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> <code>;</code>
</pre>

<p>
A module-type-defn binds the identifier to the specified type descriptor. The
binding is in the main symbol space. The type-descriptor is resolved as part of
module initialization.
</p>

</section>

<section>
<h3 id="section_8.6">8.6 Module class definition</h3>
<p>
A class is a type descriptor that in addition to describing an object type also
defines a way to construct an object belonging to the type; in particular, it
provides the method definitions that are associated with the object when it is
constructed.
</p>

<pre class="grammar"><span class="ntdfn" id="module-class-defn">module-class-defn</span> :=
   <a href="#metadata"><span class="ntref">metadata</span></a>
   [<code>public</code>] <a href="#class-type-quals"><span class="ntref">class-type-quals</span></a> <code>class</code> <a href="#identifier"><span class="ntref">identifier</span></a> <code>{</code>
      <a href="#class-member"><span class="ntref">class-member</span></a>*
  <code>}</code>
<span class="ntdfn" id="class-type-quals">class-type-quals</span> := (<code>distinct</code> | <code>readonly</code> | <a href="#isolated-qual"><span class="ntref">isolated-qual</span></a> | <a href="#object-network-qual"><span class="ntref">object-network-qual</span></a>)*
<span class="ntdfn" id="class-member">class-member</span> :=
   <a href="#object-field"><span class="ntref">object-field</span></a>
   | <a href="#method-defn"><span class="ntref">method-defn</span></a>
   | <a href="#remote-method-defn"><span class="ntref">remote-method-defn</span></a>
   | <a href="#resource-method-defn"><span class="ntref">resource-method-defn</span></a>
   | <a href="#object-type-inclusion"><span class="ntref">object-type-inclusion</span></a>
</pre>
<p>
It is an error for a keyword to appear more than once in
<code>class-type-quals</code>.
</p>
<p>
As in an object constructor expression, a visibility qualifier of
<code>private</code> can be used within a class definition; this means that the
visibility region consists of all method definitions in the class definition. If
class has private fields or methods, then it is not possible to define another
object type descriptor that is a subtype of the class's type.
</p>
<p>
If <code>class-type-quals</code> contains <code>readonly</code>, then an object
constructed using the class will have its read-only bit set; the effective type
of each field is thus the intersection of the specified type and
<code>readonly</code>; furthermore, an object shape belongs to the class's type
only if its read-only bit is set.
</p>
<p>
If <code>class-type-quals</code> contains <code>isolated</code>, then the
defined object type is an isolated type, and an object constructed using the
type will have its isolated bit set. An <code>object-field</code> or
<code>method-defn</code> occurring as a <code>class-member</code> in an isolated
class is subject to same requirements as when it occurs as an
<code>object-member</code> in an <code>object-constructor-expr</code> that is
explicitly isolated.
</p>
<p>
If an <code>object-type-inclusion</code> references a type-descriptor that is a
class, then only the type of the class is included: the definitions of the
methods and any initializers for the fields are not included. If a class uses an
object-type-inclusion to include an object type T, then each method declared in
T must be defined in the class using a <code>method-defn</code> with the same
visibility. If T has a method or field with module-level visibility, then C must
be in the same module. If the class is readonly (i.e.
<code>class-type-quals</code> includes <code>readonly</code>), then an
<code>object-type-inclusion</code> in the class is allowed to directly or
indirectly reference a <code>readonly</code> class or <code>readonly</code> type
descriptor.
</p>
<p>
If <code>class-type-quals</code> contains <code>distinct</code>, then the
primary type-id of the class will the type-id of that occurrence of
<code>distinct</code>, and the secondary type-ids will be the union of the
type-ids of the included object types. If <code>class-type-quals</code> does not
contain <code>distinct</code>, then the type-ids of the class come from the
included object types in the same way as with an object type descriptor.
</p>
<p>
An object of a class is initialized by:
</p>
<ol>
<li>allocating storage for the object</li>
<li>initializing each field with its initializer, if it has one</li>
<li>initializing the methods of the object using the class's method definitions</li>
<li>calling the class's <code>init</code> method, if there is one</li>
</ol>
<p>
The parameter list of an <code>init</code> method within an
<code>module-class-defn</code> is not required to be empty, unlike within an
<code>object-constructor-expr</code>.
</p>

</section>

<section>
<h3 id="section_8.7">8.7 Module variable declaration</h3>

<pre class="grammar"><span class="ntdfn" id="module-var-decl">module-var-decl</span> := <a href="#module-init-var-decl"><span class="ntref">module-init-var-decl</span></a> | <a href="#module-no-init-var-decl"><span class="ntref">module-no-init-var-decl</span></a>
</pre>
<p>
A module-var-decl declares a variable. The scope of variables declared in a
module-var-decl is the entire module. The variable may be initialized in the
declaration or within the module's <code>init</code> function. If
<code>final</code> is specified, then it is not allowed to assign to the
variable after it is initialized.
</p>
<pre class="grammar">
<span class="ntdfn" id="module-init-var-decl">module-init-var-decl</span> := <a href="#metadata"><span class="ntref">metadata</span></a> [<code>public</code>] <a href="#module-init-var-quals"><span class="ntref">module-init-var-quals</span></a> <a href="#typed-binding-pattern"><span class="ntref">typed-binding-pattern</span></a> <code>=</code> <a href="#module-var-init"><span class="ntref">module-var-init</span></a> <code>;</code>
<span class="ntdfn" id="module-init-var-quals">module-init-var-quals</span> := (<code>final</code> | <a href="#isolated-qual"><span class="ntref">isolated-qual</span></a>)* | <code>configurable</code>
<span class="ntdfn" id="module-var-init">module-var-init</span> := <a href="#expression"><span class="ntref">expression</span></a> | <code>?</code>
</pre>
<p>
A module-init-var-decl declares and initializes a variable. It is an error for a
keyword to appear more than once in <code>module-init-var-quals</code>. If the
typed-binding-pattern uses <code>var</code>, then the type of the variables is
inferred from the static type of <code>expression</code>; if the module-var-decl
includes <code>final</code> or <code>configurable</code>, the precise type is
used, and otherwise the broad type is used. If the typed-binding-pattern
specifies a type-descriptor, then that type-descriptor provides the contextually
expected type for action-or-expr.
</p>
<p>
If the module-init-var-decl includes <code>public</code>, then the
typed-binding-pattern must not use <code>var</code>.
</p>
<p>
If a module-init-var-decl includes an isolated-qual, then the variable declared
is isolated. In this case, <code>public</code> must not be specified, the
binding-pattern in the typed-binding-pattern must be just a variable-name, and
the expression must be an isolated expression. A variable declared as an
isolated variable can be accessed only within a lock-stmt. When an isolated-qual
occurs in a position where the grammar would allow it to be parsed as part of
module-init-var-quals or typed-binding-pattern, the former parse is used.
</p>
<p>
If <code>configurable</code> is specified, then the initializer specified in the
module-var-init may be overridden at the time of module initialization by a
value supplied when the program is run. If such a value is supplied, then the
expression in the module-var-init is not evaluated and the variable is
initialized with the supplied value instead. A module-var-init of <code>?</code>
is allowed only when <code>configurable</code> is specified and means that a
configurable value must be supplied for this variable. If
<code>configurable</code> is specified, then the typed-binding-pattern must use
an explicit type-descriptor rather than <code>var</code> and the binding-pattern
must be just a variable-name. The type specified by the type-descriptor must be
a subtype of <code>anydata</code>. A variable declared as
<code>configurable</code> is implicitly final, and cannot be assigned to outside
the declaration. The static type of a variable declared as
<code>configurable</code> is implicitly <code>readonly</code>: the type
specified in the type-descriptor is intersected with <code>readonly</code>. A
configurable variable can thus always be referenced within an isolated function.
</p>

<pre class="grammar"><span class="ntdfn" id="module-no-init-var-decl">module-no-init-var-decl</span> := <a href="#metadata"><span class="ntref">metadata</span></a> [<code>public</code>] [<code>final</code>] <a href="#type-descriptor"><span class="ntref">type-descriptor</span></a> <a href="#variable-name"><span class="ntref">variable-name</span></a> <code>;</code>
</pre>
<p>
A module variable declared with <code>module-no-init-var-decl</code> must be
initialized in the module's <code>init</code> function. It must be definitely
assigned at each point that the variable is referenced. If <code>final</code> is
specified, then the variable must not be assigned more than once. The
<code>type-descriptor</code> must not be <code>never</code>.
</p>

</section>
<section>
<h3 id="section_8.8">8.8 Module constant declaration</h3>

<pre class="grammar"><span class="ntdfn" id="module-const-decl">module-const-decl</span> :=
   <a href="#metadata"><span class="ntref">metadata</span></a>
   [<code>public</code>] <code>const</code> [<a href="#type-descriptor"><span class="ntref">type-descriptor</span></a>] <a href="#identifier"><span class="ntref">identifier</span></a> <code>=</code> <a href="#const-expr"><span class="ntref">const-expr</span></a> <code>;</code>
</pre>
<p>
A module-const-decl declares a compile-time constant. A compile-time constant is
an named immutable value, known at compile-time. A compile-time constant can be
used like a variable, and can also be referenced in contexts that require a
value that is known at compile-time, such as in a type-descriptor or in a
match-pattern.
</p>
<p>
The type of the constant is the intersection of <code>readonly</code> and the
singleton type containing just the shape of the value named by the constant. The
type of the constant determines the static type of a variable-reference-expr
that references this constant.
</p>
<p>
If type-descriptor is present, then it provides the contextually expected type
for the interpretation of const-expr. It is a compile-time error if the static
type of const-expr is not a subtype of that type. The type-descriptor must
specify a type that is a subtype of anydata and must not be <code>never</code>.
Note that the type-descriptor does not specify the type of the constant,
although the type of the constant will all be a subtype of the type specified by
the type-descriptor.
</p>
</section>

<section>
<h3 id="section_8.9">8.9 Module enumeration declaration</h3>

<pre class="grammar"><span class="ntdfn" id="module-enum-decl">module-enum-decl</span> :=
   <a href="#metadata"><span class="ntref">metadata</span></a>
   [<code>public</code>] <code>enum</code> <a href="#identifier"><span class="ntref">identifier</span></a> <code>{</code> <a href="#enum-member"><span class="ntref">enum-member</span></a> (<code>,</code> <a href="#enum-member"><span class="ntref">enum-member</span></a>)* <code>}</code>
<span class="ntdfn" id="enum-member">enum-member</span> := <a href="#metadata"><span class="ntref">metadata</span></a> <a href="#identifier"><span class="ntref">identifier</span></a> [<code>=</code> <a href="#const-expr"><span class="ntref">const-expr</span></a>]
</pre>
<p>
A module-enum-decl provides a convenient syntax for declaring a union of string constants.
</p>
<p>
Each enum-member is defined as compile-time constant in the same way as if it
had been defined using a module-const-decl. The result of evaluating the
const-expr must be a string. If the const-expr is omitted, it defaults to be the
same as the identifier.
</p>
<p>
The identifier is defined as a type in the same was as if it had been defined by
a module-type-defn, with the type-descriptor being the union of the constants
defined by the members.
</p>
<p>
If the module-enum-decl is public, then both the type and the constants are public.
</p>
<p>
So for example:
</p>
<pre>
public enum Color {
  RED,
  GREEN,
  BLUE
}
</pre>
<p>
is exactly equivalent to:
</p>
<pre>
public const RED = "RED";
public const GREEN = "GREEN";
public const BLUE = "BLUE";
public type Color RED|GREEN|BLUE;
</pre>
</section>

<section>
<h3 id="section_8.10">8.10 Module XML namespace declaration</h3>
<pre class="grammar"><span class="ntdfn" id="module-xmlns-decl">module-xmlns-decl</span> := <a href="#xmlns-decl"><span class="ntref">xmlns-decl</span></a>
</pre>

<p>
A <code>module-xmlns-decl</code> declares an XML namespace prefix with module
scope. It applies only to the source part in which it occurs, as with an
import-decl.
</p>
<p>
The semantics of xmlns-decl are described in the <a href="#XML_namespace_declaration_statement">XML namespace declaration
statement</a> section.
</p>

</section>

</section>
<section>
<h2 id="metadata">9. Metadata</h2>
<p>
Ballerina allows metadata to be attached to a construct by specifying the
metadata before the construct.
</p>

<pre class="grammar"><span class="ntdfn" id="metadata">metadata</span> := [<a href="#DocumentationString"><span class="ntref">DocumentationString</span></a>] [<a href="#annots"><span class="ntref">annots</span></a>]
</pre>
<p>
There are two forms of metadata: documentation and annotations.
</p>
<section>
<h3 id="section_9.1">9.1 Annotations</h3>

<pre class="grammar"><span class="ntdfn" id="annots">annots</span> := <a href="#annotation"><span class="ntref">annotation</span></a>+
<span class="ntdfn" id="annotation">annotation</span> := <code>@</code> <a href="#annot-tag-reference"><span class="ntref">annot-tag-reference</span></a> <a href="#annot-value"><span class="ntref">annot-value</span></a>
</pre>
<p>
Annotations provide structured metadata about a particular construct. Multiple
annotations can be applied to a single construct. An annotation consists of a
tag and a value.
</p>

<pre class="grammar"><span class="ntdfn" id="annotation-decl">annotation-decl</span> :=
   <a href="#metadata"><span class="ntref">metadata</span></a>
   [<code>public</code>] [<code>const</code>] <code>annotation</code> [<a href="#type-descriptor"><span class="ntref">type-descriptor</span></a>] <a href="#annot-tag"><span class="ntref">annot-tag</span></a> 
   [<code>on</code> <a href="#annot-attach-points"><span class="ntref">annot-attach-points</span></a>] <code>;</code>
<span class="ntdfn" id="annot-tag">annot-tag</span> := <a href="#identifier"><span class="ntref">identifier</span></a>
</pre>
<p>
An annotation-decl declares an annotation tag. Annotations tags are in a
separate symbol space and cannot conflict with other module level declarations
and definitions. The annotation tag symbol space is also distinct from the
symbol space used by module prefixes and XML namespace prefixes.
</p>
<p>
The type-descriptor specifies the type of the annotation tag. The type must be a
subtype of one of the following three types: <code>true</code>,
<code>map&lt;value:Cloneable&gt;</code>,
<code>map&lt;value:Cloneable&gt;[]</code>. If the type-descriptor is omitted,
then the type is <code>true</code>.
</p>

<pre class="grammar"><span class="ntdfn" id="annot-tag-reference">annot-tag-reference</span> := <a href="#qualified-identifier"><span class="ntref">qualified-identifier</span></a> | <a href="#identifier"><span class="ntref">identifier</span></a>
<span class="ntdfn" id="annot-value">annot-value</span> := [<a href="#mapping-constructor-expr"><span class="ntref">mapping-constructor-expr</span></a>]
</pre>
<p>
An annot-tag-reference in an annotation must refer to an annot-tag declared in
an annotation declaration. When an annot-tag-reference is a
qualified-identifier, then the module-prefix of the qualified-identifier is
resolved using import declarations into a reference to a module, and that module
must contain an annotation-decl with the same identifier. An annot-tag-reference
that is an identifier rather than a qualified-identifier does <em>not</em> refer
to an annotation defined within the same module. Rather the compilation
environment determines which identifiers can occur as an
annotation-tag-reference, and for each such identifier which module defines that
annotation tag.
</p>
<p>
Each annotation has a value. For every construct that has an annotation with a
particular tag, there is also an <em>effective value</em> for that annotation
tag, which is constructed from the values of all annotations with that tag that
were attached to that construct. The effective value belongs to the type
declared for the annotation tag. The type of the annotation tag determines the
type of the annotation value and whether multiple annotations with the same tag
on a single construct are allowed. For an annotation tag declared with type T,
if T is M[] for some type mapping type M, then the type of the annotation value
is M, multiple annotations are allowed, and the effective value is an array of
the values for each annotation; otherwise the type of the annotation value is T,
multiple annotations are not allowed, the effective value is the value of the
single annotation.
</p>
<p>
If the type of the annotation value is <code>true</code>, then a
mapping-constructor-expr is not allowed, and the annotation value is
<code>true</code>. Otherwise the type of the annotation value must be a mapping
type M; if a mapping-constructor-expr is not specified, then it defaults to
<code>{ }</code>; the mapping-constructor-expr must have static type M and the
annotation value is the result of evaluating the mapping-constructor-expr with M
as the contextually expected type.
</p>
<p>
If the annotation-decl for a tag specifies <code>const</code>, then a
mapping-constructor-expr in annotations with that tag must be a const-expr and
is evaluated at compile-time with the semantics of a const-expr. Otherwise, the
mapping-constructor-expr is evaluated when the annotation is evaluated and the
ImmutableClone abstract operation is applied to the result.
</p>
<p>
An annotation applied to a module-level declaration is evaluated when the module
is initialized. An annotation applied to a service constructor is evaluated when
the service constructor is evaluated. An annotation occurring within a type
descriptor is evaluated when the type descriptor is resolved.
</p>

<pre class="grammar"><span class="ntdfn" id="annot-attach-points">annot-attach-points</span> := <a href="#annot-attach-point"><span class="ntref">annot-attach-point</span></a> (<code>,</code> <a href="#annot-attach-point"><span class="ntref">annot-attach-point</span></a>)*
<span class="ntdfn" id="annot-attach-point">annot-attach-point</span> :=
   <a href="#dual-attach-point"><span class="ntref">dual-attach-point</span></a>
   | <a href="#source-only-attach-point"><span class="ntref">source-only-attach-point</span></a>
<span class="ntdfn" id="dual-attach-point">dual-attach-point</span> := [<code>source</code>] <a href="#dual-attach-point-ident"><span class="ntref">dual-attach-point-ident</span></a>
<span class="ntdfn" id="dual-attach-point-ident">dual-attach-point-ident</span> :=
   <code>type</code>
   | <code>class</code>
   | [<code>object</code>|<code>service</code> <code>remote</code>] <code>function</code>
   | <code>parameter</code>
   | <code>return</code>
   | <code>service</code>
   | [<code>object</code>|<code>record</code>] <code>field</code>
<span class="ntdfn" id="source-only-attach-point">source-only-attach-point</span> := <code>source</code> <a href="#source-only-attach-point-ident"><span class="ntref">source-only-attach-point-ident</span></a>
<span class="ntdfn" id="source-only-attach-point-ident">source-only-attach-point-ident</span> :=
   <code>annotation</code>
   | <code>external</code>
   | <code>var</code>
   | <code>const</code>
   | <code>listener</code>
   | <code>worker</code>
</pre>
<p>
The <code>annot-attach-points</code> specify the constructs to which an
annotation can be attached.
</p>
<p>
When an attachment point is prefixed with <code>source</code>, then the
annotation is attached to a fragment of the source rather than to any runtime
value, and thus is not available at runtime. If any of the attachment points
specify <code>source</code>, the annotation-decl must specify
<code>const</code>.
</p>
<p>
When an attachment point is not prefixed with source, then the annotation is
accessible at runtime by applying the annotation access operator to a typedesc
value.
</p>
<p>
The available attachment points are described in the following table.
</p>
<table>
  <tr>
   <td><strong>Attachment point name</strong></td>
   <td><strong>Syntactic attachment point(s)</strong></td>
   <td><strong>Attached to which type descriptor at runtime</strong></td>
  </tr>
  <tr>
   <td>type</td>
   <td>module-type-defn, module-enum-decl, type-cast-expr</td>
   <td>defined type</td>
  </tr>
  <tr>
   <td>class</td>
   <td>module-class-defn</td>
   <td>defined type (which will be type of objects constructed using this class)</td>
  </tr>
  <tr>
   <td>function</td>
   <td>function-defn, method-decl, method-defn, anonymous-function-expr</td>
   <td>type of function</td>
  </tr>
  <tr>
   <td>object function</td>
   <td>method-decl, method-defn</td>
   <td>type of function</td>
  </tr>
  <tr>
   <td>service remote function</td>
   <td>method-defn with remote qualifier on service object</td>
   <td>type of function, on service value</td>
  </tr>
  <tr>
   <td>return</td>
   <td>return-type-descriptor</td>
   <td>indirectly to type of function</td>
  </tr>
  <tr>
   <td>parameter</td>
   <td>required-param, defaultable-param, included-record-param, rest-param</td>
   <td>indirectly to type of function</td>
  </tr>
  <tr>
   <td>service</td>
   <td>service-decl, object-constructor-expr with service qualifier</td>
   <td>type of service</td>
  </tr>
  <tr>
   <td>field</td>
   <td>individual-field-descriptor, object-field-descriptor</td>
   <td>type of mapping or object</td>
  </tr>
  <tr>
   <td>object field</td>
   <td>object-field-descriptor, object-field</td>
   <td>type of object</td>
  </tr>
  <tr>
   <td>record field</td>
   <td>individual-field-descriptor</td>
   <td>type of mapping</td>
  </tr>
  <tr>
   <td>listener</td>
   <td>listener-decl</td>
   <td>none</td>
  </tr>
  <tr>
   <td>var</td>
   <td>module-var-decl, local-var-decl-stmt, let-var-decl</td>
   <td>none</td>
  </tr>
  <tr>
   <td>const</td>
   <td>module-const-decl, enum-member</td>
   <td>none</td>
  </tr>
  <tr>
   <td>annotation</td>
   <td>annotation-decl</td>
   <td>none</td>
  </tr>
  <tr>
   <td>external</td>
   <td>external-function-body</td>
   <td>none</td>
  </tr>
  <tr>
   <td>worker</td>
   <td>named-worker-decl, start-action</td>
   <td>none</td>
  </tr>
</table>
</section>
<section>
<h3 id="section_9.2">9.2 Documentation</h3>
<p>
A documentation string is an item of metadata that can be associated with
module-level Ballerina constructs and with method declarations. The purpose of
the documentation strings for a module is to enable a programmer to use the
module. Information not useful for this purpose should be provided in in
comments.
</p>
<p>
A documentation string has the format of one or more lines each of which has a
<code>#</code> optionally preceded by blank space.
</p>
<p>
The documentation statement is used to document various Ballerina constructs.
</p>

<pre class="grammar"><span class="ntdfn" id="DocumentationString">DocumentationString</span> := <a href="#DocumentationLine"><span class="ntref">DocumentationLine</span></a> +
<span class="ntdfn" id="DocumentationLine">DocumentationLine</span> := <a href="#BlankSpace"><span class="ntref">BlankSpace</span></a>* <code>#</code> [<a href="#Space"><span class="ntref">Space</span></a>] <a href="#DocumentationContent"><span class="ntref">DocumentationContent</span></a>
<span class="ntdfn" id="DocumentationContent">DocumentationContent</span> := (^ 0xA)* 0xA
<span class="ntdfn" id="BlankSpace">BlankSpace</span> := <a href="#Tab"><span class="ntref">Tab</span></a> | <a href="#Space"><span class="ntref">Space</span></a>
<span class="ntdfn" id="Space">Space</span> := 0x20
<span class="ntdfn" id="Tab">Tab</span> := 0x9
</pre>
<p>
A <code>DocumentationString</code> is recognized only at the beginning of a
line. The content of a documentation string is the concatenation of the
<code>DocumentationContent</code> of each <code>DocumentationLine</code> in the
<code>DocumentationString</code>. Note that a single space following the # is
not treated as part of the DocumentationContent.
</p>
<p>
The content of a <code>DocumentationString</code> is parsed as Ballerina
Flavored Markdown (BFM). BFM is also used for a separate per-module
documentation file, conventionally called <code>Module.md</code>.
</p>
</section>
<section>
<h3 id="section_9.3">9.3 Ballerina Flavored Markdown</h3>
<p>
Ballerina Flavored Markdown is GitHub Flavored Markdown, with some additional
conventions.
</p>
<p>
In the documentation string attached to a function or method, there must be
documentation for each parameter, and for the return value if the return value
is not nil. The documentation for the parameters and a return value must consist
of a Markdown list, where each list item must have the form <code>ident -
doc</code>, where ident is either the parameter name or return, and doc is the
documentation of that parameter or of the return value.
</p>
<p>
The documentation for an object must contain a list of fields rather than
parameters. Private fields should not be included in the list.
</p>
<p>
BFM also provides conventions for referring to Ballerina-defined names from
within documentation strings in a source file. An identifier in backticks
<code>`X`</code>, when preceded by one of the following words:
</p>
<ul>
<li><code>type</code></li>
<li><code>service</code></li>
<li><code>variable</code></li>
<li><code>var</code></li>
<li><code>annotation</code></li>
<li><code>module</code></li>
<li><code>function</code></li>
<li><code>parameter</code></li>
</ul>
<p>
is assumed to be a reference to a Ballerina-defined name of the type indicated
by the word. In the case of <code>parameter</code>, the name must be unqualified
and be the name of a parameter of the function to which the documentation string
is attached. For other cases, if the name is unqualified it must refer to a
public name of the appropriate type in the source file's module; if it is a
qualified name M:X, then the source file must have imported M, and X must refer
to a public name of an appropriate type in M. BFM also recognizes
<code>`f()`</code> as an alternative to <code>function `f`</code>. In both
cases, f can have any of the following forms (where `m` is a module import, `x` is a
function name, `T` is an object type name, and `y` is a method name):
</p>

<pre>    x()
    m:x()
    T.y()
    m:T.y()
</pre>
<p>
Example
</p>

<pre>    # Adds parameter `x` and parameter `y`
    # + x - one thing to be added
    # + y - another thing to be added
    # + return - the sum of them
    function add (int x, int y) returns int { return x + y; }
</pre>

<p>
The Ballerina platform may define additional conventions, in particular relating
to headings with particular content. For example, a heading with a content of
<code>Deprecated</code> can be used to provide information about the deprecation
of the name to which the documentation string is attached.
</p>

</section>
</section>
<section>
<h2 id="lang_library">10. Lang library</h2>

<p>
Modules in the <code>ballerina</code> organization with a module name starting
with <code>lang.</code> are reserved for use by this specification. These
modules are called the <em>lang library</em>.
</p>

<section>
<h3 id="section_10.1">10.1 Generic types</h3>
<p>
Modules in the lang library can make use generic typing. Since generic typing
has not yet been added to Ballerina, the source code for the modules use an
annotation to describe generic typing as follows. When a module type definition
has a <code>@typeParam</code> annotation, it means that this type serves as a
type parameter when it is used in a function definition: all uses of the type
parameter in a function definition refer to the same type; the definition of the
type is an upper bound on the type parameter. A parameter of a function
definition can be annotated with an <code>@isolatedParam</code> annotation; this
is allowed when the function is declared as isolated and the type of the
parameter is a function type; the meaning is that when the function is called in
a context that requires it to be isolated, then the argument supplied for the
parameter must also be isolated. In effect, the function is parameterized with
the isolated qualifier.
</p>
<p>
<strong>Note</strong> We plan to provide full support for generic types in
a future version of this specification.
</p>
</section>

<section>
<h3 id="built-in_subtypes">10.2 Built-in subtypes</h3>
<p>
A module in the lang library can provide types that are <em>built-in</em> in the
sense that their meaning is defined by this specification. Each such built-in
type is a subtype of a single basic type; a built-in type that is a subtype of a
basic type <code><var>B</var></code> is provided by the module
<code>lang.<var>B</var></code>.
</p>
<p>
The built-types provided by lang library modules are described in the following
table.
</p>

<table>
<tr>
<th>Basic type</th>
<th>Type name</th>
<th>Criteria for <em>v</em> to belong to type</th>
</tr>
<tr>
<td rowspan="6">int</td>
<td>Unsigned8</td>
<td>0 â¤ <em>v</em> â¤ 255</td>
</tr>
<tr>
<td>Signed8</td>
<td>-128 â¤ <em>v</em> â¤ 127</td>
</tr>
<tr>
<td>Unsigned16</td>
<td>0 â¤ <em>v</em> â¤ 65,535</td>
</tr>
<tr>
<td>Signed16</td>
<td>-32,768 â¤ <em>v</em> â¤ 32,767</td>
</tr>
<tr>
<td>Unsigned32</td>
<td>0 â¤ <em>v</em> â¤ 4,294,967,295</td>
</tr>
<tr>
<td>Signed32</td>
<td>-2,147,483,648â¬ â¤ <em>v</em> â¤ 2,147,483,6487</td>
</tr>
<tr>
<td>string</td>
<td>Char</td>
<td>
<em>v</em> has length 1</td>
</tr>
<tr>
<td rowspan="4">xml</td>
<td>Element</td>
<td>
<em>v</em> is an element singleton</td>
</tr>
<tr>
<td>ProcessingInstruction</td>
<td>
<em>v</em> is a processing instruction singleton</td>
</tr>
<tr>
<td>Comment</td>
<td>
<em>v</em> is a comment singleton</td>
</tr>
<tr>
<td>Text</td>
<td>
<em>v</em> is either the empty xml value or a text singleton</td>
</tr>
</table>
<p>
Each built-in type has a type definition in the module that provides it. The
type descriptor of the type definition is the corresponding basic type. The type
definition has a <code>@builtinSubtype</code> annotation, which indicates that
the meaning of the type name is built-in, as specified in the above table,
rather than coming from its type descriptor. It is an error to use the
<code>@builtinSubtype</code> annotation except in a lang library module.
</p>
<p>
So, for example, the <code>lang.int</code> module would include the definition:
</p>
<pre>
@builtinSubtype
type Signed32 int;
</pre>
<p>
Semantically, these types behave like a predefined type that can be referenced
by an unqualified name, such as <code>byte</code>. Syntactically, these types
are referenced by a <code>type-reference</code> in the same way as if their
definitions were not built-in. A built-in type <code>T</code> which is a subtype
of basic type <code>B</code> can be referenced by a type-reference
<code>M:T</code>, where <code>M</code> is a module-prefix referring to module
<code>ballerina/lang.B</code>.
</p>
<p>
For convenience, this specification refers to the built-in subtype T provided by
the module for basic type B as B:T. For example, in this specification
<code>int:Signed32</code> refers to the <code>Signed32</code> built-in subtype
of <code>int</code>, which is provided by the <code>lang.int</code> module.
</p>
<p>
The <code>int:Unsigned8</code> type is equivalent to the predefined
<code>byte</code> type.
</p>
</section>

<section>
<h3 id="section_10.3">10.3 Lang library modules</h3>
<p>
The lang library consists of the following modules. With the exception of the
<code>lang.value</code>, <code>lang.transaction</code> and
<code>lang.runtime</code> modules, each corresponds to a basic type.
</p>

<section>
<h4 id="lang.array">10.3.1 <code>lang.array</code> module</h4>

<p>The <code>lang.array</code> module corresponds to basic type list.</p>

<pre class="langlib">

# A type parameter that is a subtype of `any|error`.
# Has the special semantic that when used in a declaration
# all uses in the declaration must refer to same type.
@typeParam
type Type any|error;

# A type parameter that is a subtype of `any|error`.
# Has the special semantic that when used in a declaration
# all uses in the declaration must refer to same type.
@typeParam
type Type1 any|error;

# A type parameter that is a subtype of `anydata|error`.
# Has the special semantic that when used in a declaration
# all uses in the declaration must refer to same type.
@typeParam
type AnydataType anydata;

# Returns the number of members of an array.
#
# + arr - the array
# + return - number of members in `arr`
public isolated function length((any|error)[] arr) returns int = external;

# Returns an iterator over an array.
#
# + arr - the array
# + return - a new iterator object that will iterate over the members of `arr`.
public isolated function iterator(Type[] arr) returns object {
    public isolated function next() returns record {|
        Type value;
    |}?;
} = external;

# Returns a new array consisting of index and member pairs.
#
# + arr - the array
# + return - array of index, member pairs
public isolated function enumerate(Type[] arr) returns [int, Type][] = external;


# Applies a function to each member of an array and returns an array of the results.
#
# + arr - the array
# + func - a function to apply to each member
# + return - new array containing result of applying `func` to each member of `arr` in order
public isolated function 'map(Type[] arr, @isolatedParam function(Type val) returns Type1 func) returns Type1[] = external;

# Applies a function to each member of an array.
# The function `func` is applied to each member of array `arr` in order.
#
# + arr - the array
# + func - a function to apply to each member
public isolated function forEach(Type[] arr, @isolatedParam function(Type val) returns () func) returns () = external;

# Selects the members from an array for which a function returns true.
#
# + arr - the array
# + func - a predicate to apply to each member to test whether it should be selected
# + return - new array only containing members of `arr` for which `func` evaluates to true
public isolated function filter(Type[] arr, @isolatedParam function(Type val) returns boolean func) returns Type[] = external;

# Combines the members of an array using a combining function.
# The combining function takes the combined value so far and a member of the array,
# and returns a new combined value.
#
# + arr - the array
# + func - combining function
# + initial - initial value for the first argument of combining function `func`
# + return - result of combining the members of `arr` using `func`
#
# For example
# ```
# reduce([1, 2, 3], function (int total, int n) returns int { return total + n; }, 0)
# ```
# is the same as `sum(1, 2, 3)`.
public isolated function reduce(Type[] arr, @isolatedParam function(Type1 accum, Type val) returns Type1 func, Type1 initial) returns Type1 = external;

# Returns a slice of an array.
#
# + arr - the array
# + startIndex - index of first member to include in the slice
# + endIndex - index of first member not to include in the slice
# + return - new array containing members of `arr` with index &gt;= `startIndex` and &lt; `endIndex` 
public isolated function slice(Type[] arr, int startIndex, int endIndex = arr.length()) returns Type[] = external;

# Removes a member of an array.
#
# + arr - the array
# + index - index of member to be removed from `arr`
# + return - the member of `arr` that was at `index`
# This removes the member of `arr` with index `index` and returns it.
# It panics if there is no such member.
public isolated function remove(Type[] arr, int index) returns Type = external;

# Removes all members of an array.
# + arr - the array
# Panics if any member cannot be removed.
public isolated function removeAll((any|error)[] arr) returns () = external;

# Changes the length of an array.
# 
# + arr - the array of which to change the length
# + length - new length
# `setLength(arr, 0)` is equivalent to `removeAll(arr)`.
public isolated function setLength((any|error)[] arr, int length) returns () = external;

# Returns the index of first member of `arr` that is equal to `val` if there is one.
# Returns `()` if not found.
# Equality is tested using `==`.
#
# + arr - the array
# + val - member to search for
# + startIndex - index to start the search from
# + return - index of the member if found, else `()`
public isolated function indexOf(AnydataType[] arr, AnydataType val, int startIndex = 0) returns int? = external;

# Returns the index of last member of `arr` that is equal to `val` if there is one.
# Returns `()` if not found.
# Equality is tested using `==`.
#
# + arr - the array
# + val - member to search for
# + startIndex - index to start searching backwards from
# + return - index of the member if found, else `()`
public isolated function lastIndexOf(AnydataType[] arr, AnydataType val, int startIndex = arr.length() - 1) returns int? = external;

# Reverses the order of the members of an array.
#
# + arr - the array to be reversed
# + return - new array with the members of `arr` in reverse order
public isolated function reverse(Type[] arr) returns Type[] = external;

# Direction for `sort` function.
public enum SortDirection {
   ASCENDING = "ascending",
   DESCENDING = "descending"
}

# A type of which any ordered type must be a subtype.
# Whether a type is an ordered type cannot be defined in
# terms of being a subtype of a type, so being a subtype
# of `OrderedType` is a necessary but not sufficient condition
# for a type to be an ordered type.
public type OrderedType ()|boolean|int|float|decimal|string|OrderedType[];

# Sorts an array.
# If the member type of the array is not sorted, then the `key` function
# must be specified.
# Sorting works the same as with the `sort` clause of query expressions.
#
# + arr - the array to be sorted; 
# + direction - direction in which to sort
# + key - function that returns a key to use to sort the members
# + return - new array consisting of the members of `arr` in sorted order
public isolated function sort(Type[] arr, SortDirection direction = ASCENDING,
        (isolated function(Type val) returns OrderedType)? key = ()) returns Type[] = external;


# Removes and returns the last member of an array.
# The array must not be empty.
#
# + arr - the array
# + return - removed member
public isolated function pop(Type[] arr) returns Type = external;

# Adds values to the end of an array.
#
# + arr - the array
# + vals - values to add to the end of the array
public isolated function push(Type[] arr, Type... vals) returns () = external;


# Removes and returns first member of an array.
# The array must not be empty.
#
# + arr - the array
# + return - the value that was the first member of the array
public isolated function shift(Type[] arr) returns Type = external;

# Adds values to the start of an array.
# The values newly added to the array will be in the same order
# as they are in `vals`.
# 
# + arr - the array
# + vals - values to add to the start of the array
public isolated function unshift(Type[] arr, Type... vals) returns () = external;


# Returns the string that is the Base64 representation of an array of bytes.
# The representation is the same as used by a Ballerina Base64Literal.
# The result will contain only characters  `A..Z`, `a..z`, `0..9`, `+`, `/` and `=`.
# There will be no whitespace in the returned string.
#
# + arr - the array
# + return - Base64 string representation
public isolated function toBase64(byte[] arr) returns string = external;

# Returns the byte array that a string represents in Base64.
# `str` must consist of the characters `A..Z`, `a..z`, `0..9`, `+`, `/`, `=`
# and whitespace as allowed by a Ballerina Base64Literal.
#
# + str - Base64 string representation
# + return - the byte array or error
public isolated function fromBase64(string str) returns byte[]|error = external;

# Returns the string that is the Base16 representation of an array of bytes.
# The representation is the same as used by a Ballerina Base16Literal.
# The result will contain only characters  `0..9`, `a..f`.
# There will be no whitespace in the returned string.
#
# + arr - the array
# + return - Base16 string representation
public isolated function toBase16(byte[] arr) returns string = external;

# Returns the byte array that a string represents in Base16.
# `str` must consist of the characters `0..9`, `A..F`, `a..f`
# and whitespace as allowed by a Ballerina Base16Literal.
#
# + str - Base16 string representation
# + return - the byte array or error
public isolated function fromBase16(string str) returns byte[]|error = external;

# Returns a stream of the members of an array.
#
# + arr - the array
# + returns - stream of members of the array
# The returned stream will use an iterator over `arr` and
# will therefore handle mutation of `arr` in the same way
# as an iterator does.
# Theutation of the `arr`
public isolated function toStream(T[] arr) returns stream&lt;T,()&gt; = external;
</pre>

</section>

<section>
<h4 id="lang.boolean">10.3.2 <code>lang.boolean</code> module</h4>

<p>The <code>lang.boolean</code> module corresponds to basic type boolean.</p>

<pre class="langlib">

# Converts a string to a boolean.
# Returns the boolean of which `s` is a string representation.
# The accepted representations are `true`, `false`
# (in any combination of lower- and upper-case),
# and also `1` for true and `0` for `false`.
# This is the inverse of `value:toString` applied to a `boolean`.
#
# + s - string representing a boolean valie
# + return - boolean that `s` represents, or an error if there is no such boolean
public isolated function fromString(string s) returns boolean|error = external;
</pre>

</section>

<section>
<h4 id="lang.decimal">10.3.3 <code>lang.decimal</code> module</h4>

<p>The <code>lang.decimal</code> module corresponds to basic type decimal.</p>

<pre class="langlib">

# Sum of zero or more decimal values.
#
# + xs - decimal values to sum
# + return - sum of all the `xs`; 0 if `xs` is empty
public isolated function sum(decimal... xs) returns decimal = external;

# Maximum of one or more decimal values.
#
# + x - first decimal value
# + xs - other decimal values
# + return - maximum value of `x` and all the `xs`
public isolated function max(decimal x, decimal... xs) returns decimal = external;

# Minimum of one or more decimal values
#
# + x - first decimal value
# + xs - other decimal values
# + return - minimum value of `x` and all the `xs`.
public isolated function min(decimal x, decimal... xs) returns decimal = external;

# IEEE abs operation.
#
# + x - decimal value to operate on
# + return - absolute value of `x`
public isolated function abs(decimal x) returns decimal = external;

# Round a decimal to the closest integral value.
# Returns the decimal value that is a mathematical integer and closest to `x`.
# If there are two such values, choose the one that is even
# (this is the round-to-nearest rounding mode, which is the default for IEEE
# and for Ballerina).
# Same as Java Math.rint method
# Same as .NET Math.Round method
# IEEE 754 roundToIntegralTiesToEven operation
# Note that `&lt;int&gt;x` is the same as `&lt;int&gt;x.round()`
#
# + x - decimal value to operate on
# + return - closest decimal value to `x` that is a mathematical integer
public isolated function round(decimal x) returns decimal = external;

# Rounds a decimal down to the closest integral value.
#
# + x - decimal value to operate on
# + return - largest (closest to +â) decimal value not greater than `x` that is a mathematical integer.
public isolated function floor(decimal x) returns decimal = external;

# Rounds a decimal up to the closest integral value.
#
# + x - decimal value to operate on
# + return - smallest (closest to -â) decimal value not less than `x` that is a mathematical integer
public isolated function ceiling(decimal x) returns decimal = external;

# Return the decimal value represented by `s`.
# `s` must follow the syntax of DecimalFloatingPointNumber as defined by the Ballerina specification
# with the following modifications
# - the DecimalFloatingPointLiteral may have a leading `+` or `-` sign
# - a FloatingPointTypeSuffix is not allowed
# This is the inverse of `value:toString` applied to an `decimal`.
#
# + s - string representation of a decimal
# + return - decimal representation of the argument or error
public isolated function fromString(string s) returns decimal|error = external;
</pre>

</section>

<section>
<h4 id="lang.error">10.3.4 <code>lang.error</code> module</h4>

<p>The <code>lang.error</code> module corresponds to basic type error.</p>

<pre class="langlib">


# Type for value that can be cloned.
# This is the same as in lang.value, but is copied here to avoid a dependency.

type Cloneable readonly|xml|Cloneable[]|map&lt;Cloneable&gt;|table&lt;map&lt;Cloneable&gt;&gt;;

# The type to which error detail records must belong.
public type Detail record {|
   Cloneable...;
|};

# A type parameter that is a subtype of error `Detail` record type.
# Has the special semantic that when used in a declaration
# all uses in the declaration must refer to same type.
@typeParam
type DetailType Detail;

# Returns the error's message.
#
# + e - the error value
# + return - error message
public isolated function message(error e) returns string = external;

# Returns the error's cause.
#
# + e - the error value
# + return - error cause
public isolated function cause(error e) returns error? = external;

# Returns the error's detail record.
# The returned value will be immutable.
# + e - the error value
# + return - error detail value
public isolated function detail(error&lt;DetailType&gt; e) returns readonly &amp; DetailType = external;

# Type representing a stack frame.
# A call stack is represented as an array of stack frames.
# This type is also present in lang.runtime to avoid a dependency.
public type StackFrame readonly &amp; object {
   # Returns a string representing this StackFrame.
   # This must not contain any newline characters.
   # + return - a string
   public function toString() returns string;
};

# Returns an array representing an error's stack trace.
#
# + e - the error value
# + return - an array representing the stack trace of the error value
# The first member of the array represents the top of the call stack.
public isolated function stackTrace(error e) returns StackFrame[] = external;

# Converts an error to a string.
#
# + e - the error to be converted to a string
# + return - a string resulting from the conversion
#
# The details of the conversion are specified by the ToString abstract operation
# defined in the Ballerina Language Specification, using the direct style.
public isolated function toString(error e) returns string = external;

# Converts an error to a string that describes the value in Ballerina syntax.
# + e - the error to be converted to a string
# + return - a string resulting from the conversion
#
# The details of the conversion are specified by the ToString abstract operation
# defined in the Ballerina Language Specification, using the expression style.
public isolated function toBalString(error e) returns string = external;

# A type of error which can be retried.
public type Retriable distinct error;

# The RetryManager used by default.
public class DefaultRetryManager {
   private int count;
   public function init(int count = 3) {
     this.count = count;
   }
   public function shouldRetry(error e) returns boolean {
      if e is Retriable &amp;&amp; count &gt;  0 {
         count -= 1;
         return true;
      }
      else {
         return false;
      }
   }
}
</pre>

</section>

<section>
<h4 id="lang.float">10.3.5 <code>lang.float</code> module</h4>

<p>The <code>lang.float</code> module corresponds to basic type float.</p>

<pre class="langlib">


# The number Ï
public const float PI = 3.141592653589793;
# Euler's number
public const float E =  2.718281828459045;
# IEEE not-a-number value
public const float NaN = 0.0/0.0;

# IEEE positive infinity
public const float Infinity = 1.0/0.0;

# Tests whether a float is finite.
# Exactly one of isFinite, isInfinite and IsNaN will be true for any float value
#
# + x - the float to be tested
# + return - true if `x` is finite, i.e. neither NaN nor +â nor -â
public isolated function isFinite(float x) returns boolean = external;

# Tests whether a float is infinite.
# Exactly one of isFinite, isInfinite and IsNaN will be true for any float value
#
# + x - the float to be tested
# + return - true if `x` is either +â or -â
public isolated function isInfinite(float x) returns boolean = external;

# Tests whether a float is NaN.
# Exactly one of isFinite, isInfinite and IsNaN will be true for any float value.
#
# + x - the float to be tested
# + return - true if `x` is NaN
public isolated function isNaN(float x) returns boolean = external;

# Sum of zero or more float values.
# Result is NaN if any arg is NaN
#
# + xs - float values to sum
# + return - sum of all the `xs`, +0.0 if `xs` is empty
public isolated function sum(float... xs) returns float = external;

# Maximum of zero or more float values.
# Result is -â if no args
# NaN if any arg is NaN
#
# + xs - float values to operate on
# + return - maximum value of all the `xs`
public isolated function max(float... xs) returns float = external;

# Minimum of zero or more float values.
# Result is +â if no args
# Result is NaN if any arg is NaN
#
# + xs - float values to operate on
# + return - minimum value of all the `xs`
public isolated function min(float... xs) returns float = external;

# IEEE abs operation.
#
# + x - float value to operate on
# + return - absolute value of `x`
public isolated function abs(float x) returns float = external;

# Round a float value to the closest integral value.
# Returns the float value that is a mathematical integer and closest to `x`.
# If there are two such values, choose the one that is even
# (this is the round-to-nearest rounding mode, which is the default for IEEE and for Ballerina).
# Same as Java Math.rint method
# Same as .NET Math.Round method
# IEEE roundToIntegralTiesToEven operation
# Note that `&lt;int&gt;x` is the same as `&lt;int&gt;x.round()`
#
# + x - float value to operate on
# + return - closest float value to `x` that is a mathematical integer
public isolated function round(float x) returns float = external;

# Rounds a float down to the closest integral value.
#
# + x - float value to operate on
# + return - largest (closest to +â) float value not greater than `x` that is a mathematical integer.
public isolated function floor(float x) returns float = external;

# Rounds a float up to the closest integral value.
#
# + x - float value to operate on
# + return - smallest (closest to -â) decimal value not less than `x` that is a mathematical integer
public isolated function ceiling(float x) returns float = external;

# Returns the square root of a float value.
# Corresponds to IEEE squareRoot operation.
#
# + x - float value to operate on
# + return - square root of `x`
public isolated function sqrt(float x) returns float = external;

# Returns the cube root of a float value.
# Corresponds to IEEE rootn(x, 3) operation.
#
# + x - float value to operate on
# + return - cube root of `x`
public isolated function cbrt(float x) returns float = external;

# Raises one float value to the power of another float values.
# Corresponds to IEEE pow(x, y) operation.
#
# + x - base value
# + y - the exponent
# + return - `x` raised to the power of `y`
public isolated function pow(float x, float y) returns float = external;

# Returns the natural logarithm of a float value
# Corresponds to IEEE log operation.
#
# + x - float value to operate on
# + return - natural logarithm of `x`
public isolated function log(float x) returns float = external;

# Returns the base 10 logarithm of a float value.
# Corresponds to IEEE log10 operation.
#
# + x - float value to operate on
# + return - base 10 logarithm of `x`
public isolated function log10(float x) returns float = external;

# Raises Euler's number to a power.
# Corresponds to IEEE exp operation.
#
# + x - float value to operate on
# + return - Euler's number raised to the power `x`
public isolated function exp(float x) returns float = external;

# Returns the sine of a float value.
# Corresponds to IEEE sin operation.
#
# + x - float value, specifying an angle in radians
# + return - the sine of `x`
public isolated function sin(float x) returns float = external;

# Returns the cosine of a float value.
# Corresponds to IEEE cos operation.
#
# + x - float value, specifying an angle in radians
# + return - the cosine of `x`
public isolated function cos(float x) returns float = external;

# Returns the tangent of a float value.
# Corresponds to IEEE tan operation
#
# + x - float value, specifying an angle in radians
# + return - the tangent of `x`
public isolated function tan(float x) returns float = external;

# Returns the arccosine of a float value.
# Corresponds to IEEE acos operation
#
# + x - float value to operate on
# + return - the arccosine of `x` in radians
public isolated function acos(float x) returns float = external;

# Returns the arctangent of a float value.
# Corresponds to IEEE atan operation.
#
# + x - float value to operate on
# + return - the arctangent of `x` in radians
public isolated function atan(float x) returns float = external;

# Returns the arcsine of a float value.
# Corresponds to IEEE asin operation.
#
# + x - float value to operate on
# + return - the arcsine of `x` in radians
public isolated function asin(float x) returns float = external;

# Performs the 2-argument arctangent operation.
# Corresponds IEEE atan2(y, x) operation.
#
# + y - the y-coordinate
# + x - the x-coordinate
# + return - the angle in radians from the positive x-axis to the point
#   whose Cartesian coordinates are `(x, y)`
public isolated function atan2(float y, float x) returns float = external;

# Returns the hyperbolic sine of a float value.
# Corresponds to IEEE sinh operation.
#
# + x - float value to operate on
# + return - hyperbolic sine of `x`
public isolated function sinh(float x) returns float = external;

# Returns the hyperbolic cosine of a float value.
# Corresponds to IEEE cosh operation.
#
# + x - float value to operate on
# + return - hyperbolic cosine of `x`
public isolated function cosh(float x) returns float = external;

# Returns the hyperbolic tangent of a float value.
# Corresponds to IEEE tanh operation.
#
# + x - float value to operate on
# + return - hyperbolic tangent of `x`
public isolated function tanh(float x) returns float = external;

# Return the float value represented by `s`.
# `s` must follow the syntax of DecimalFloatingPointNumber as defined by the Ballerina specification
# with the following modifications
# - the DecimalFloatingPointNumber may have a leading `+` or `-` sign
# - `NaN` is allowed
# - `Infinity` is allowed with an optional leading `+` or `-` sign
# - a FloatingPointTypeSuffix is not allowed
# This is the inverse of `value:toString` applied to an `float`.
#
# + s - string representation of a float
# + return - float value or error
public isolated function fromString(string s) returns float|error = external;

# Returns a string that represents `x` as a hexadecimal floating point number.
# The returned string will comply to the grammar of HexFloatingPointLiteral
# in the Ballerina spec with the following modifications:
# - it will have a leading `-` sign if negative
# - positive infinity will be represented by `Infinity`
# - negative infinity will be represented by `-Infinity`
# - NaN will be represented by `NaN`
# The representation includes `0x` for finite numbers.
#
# + x - float value
# + return - hexadecimal floating point hex string representation
public isolated function toHexString(float x) returns string = external;

# Return the float value represented by `s`.
# `s` must follow the syntax of HexFloatingPointLiteral as defined by the Ballerina specification
# with the following modifications
# - the HexFloatingPointLiteral may have a leading `+` or `-` sign
# - `NaN` is allowed
# - `Infinity` is allowed with an optional leading `+` or `-` sign
#
# + s - hexadecimal floating point hex string representation
# + return - float value or error
public isolated function fromHexString(string s) returns float|error = external;

# Returns IEEE 64-bit binary floating point format representation of `x` as an int.
#
# + x - float value
# + return - `x` bit pattern as an int
public isolated function toBitsInt(float x) returns int = external;

# Returns the float that is represented in IEEE 64-bit floating point by `x`.
# All bit patterns that IEEE defines to be NaNs will all be mapped to the single float NaN value.
#
# + x - int value
# + return - `x` bit pattern as a float
public isolated function fromBitsInt(int x) returns float = external;
</pre>

</section>

<section>
<h4 id="lang.future">10.3.6 <code>lang.future</code> module</h4>

<p>The <code>lang.future</code> module corresponds to basic type future.</p>

<pre class="langlib">

# Requests cancellation of a future.
# + f - the future to be cancelled
# This sets the cancellation flag in the strand corresponding to `f`.
# Each time that a strand yields, it will check the cancellation flag
# and terminate abnormally if the flag is set.
public isolated function cancel(future f) returns () = external;
</pre>

</section>

<section>
<h4 id="lang.int">10.3.7 <code>lang.int</code> module</h4>

<p>The <code>lang.int</code> module corresponds to basic type int.</p>

<pre class="langlib">

# Built-in subtype that allows signed integers that can be represented in 32 bits using two's complement.
# This allows an int between -2^31 and 2^31 - 1 inclusive.
# i.e. between -2,147,483,648 and 2,147,483,647 inclusive.
@builtinSubtype
public type Signed32 int;

# Built-in subtype that allows non-negative integers that can be represented in 16 bits using two's complement.
# This allows an int between -2^15 and 2^15 - 1 inclusive.
# i.e. between -32,768 and 32,767 inclusive.
@builtinSubtype
public type Signed16 int;

# Built-in subtype that allows non-negative integers that can be represented in 8 bits using two's complement.
# This allows an int between -2^7 and 2^7 - 1 inclusive.
# i.e. between -128 and 127 inclusive.
@builtinSubtype
public type Signed8 int;

# Built-in subtype that allows non-negative integers that can be represented in 32 bits.
# This allows an int between 0 and 2^32 - 1 inclusive,
# i.e. between 0 and 4,294,967,295 inclusive.
@builtinSubtype
public type Unsigned32 int;

# Built-in subtype that allows non-negative integers that can be represented in 16 bits.
# This allows an int between 0 and 2^16 - 1 inclusive,
# i.e. between 0 and 65,535 inclusive.
@builtinSubtype
public type Unsigned16 int;

# Built-in subtype that allows non-negative integers that can be represented in 8 bits.
# This allows an int between 0 and 2^8 - 1 inclusive,
# i.e. between 0 and 255 inclusive.
# This is the same as `byte`.
@builtinSubtype
public type Unsigned8 int;

# Maximum value of type `int`.
public const MAX_VALUE = 9223372036854775807;
# Minimum value of type `int`.
public const MIN_VALUE = -9223372036854775807 - 1; // -9223372036854775808 would overflow
# Maximum value of type `Signed32`.
public const SIGNED32_MAX_VALUE = 2147483647;
# Minimum value of type `Signed32`.
public const SIGNED32_MIN_VALUE = -2147483648;
# Maximum value of type `Signed16`.
public const SIGNED16_MAX_VALUE = 32767;
# Minimum value of type `Signed16`.
public const SIGNED16_MIN_VALUE = -32768;
# Maximum value of type `Signed8`.
public const SIGNED8_MAX_VALUE = 127;
# Minimum value of type `Signed8`.
public const SIGNED8_MIN_VALUE = -128;
# Maximum value of type `Unsigned32`.
public const UNSIGNED32_MAX_VALUE = 4294967295;
# Maximum value of type `Unsigned16`.
public const UNSIGNED16_MAX_VALUE = 65535;
# Maximum value of type `Unsigned8`.
public const UNSIGNED8_MAX_VALUE = 255;


# Returns absolute value of an int.
#
# + n - int value to be operated on
# + return - absolute value of `n`
public isolated function abs(int n) returns int = external;

# Returns sum of zero or more int values.
#
# + ns - int values to sum
# + return - sum of all the `ns`; 0 is `ns` is empty
public isolated function sum(int... ns) returns int = external;

# Maximum of one or more int values.
#
# + n - first int value
# + ns - other int values
# + return - maximum value of value of `x` and all the `xs`
public isolated function max(int n, int... ns) returns int = external;

# Minimum of one or more int values
#
# + n - first int value
# + ns - other int values
# + return - minimum value of `n` and all the `ns`
public isolated function min(int n, int... ns) returns int = external;

# Returns the integer that `s` represents in decimal.
# Returns error if `s` is not the decimal representation of an integer.
# The first character may be `+` or `-`.
# This is the inverse of `value:toString` applied to an `int`.
#
# + s - string representation of a integer value
# + return - int representation of the argument or error
public isolated function fromString(string s) returns int|error = external;

# Returns representation of `n` as hexdecimal string.
# There is no `0x` prefix. Lowercase letters a-f are used.
# Negative numbers will have a `-` prefix. No sign for
# non-negative numbers.
#
# + n - int value
# + return - hexadecimal string representation of int value
public isolated function toHexString(int n) returns string = external;

# Returns the integer that `s` represents in hexadecimal.
# Both uppercase A-F and lowercase a-f are allowed.
# It may start with an optional `+` or `-` sign.
# No `0x` or `0X` prefix is allowed.
# Returns an error if the `s` is not in an allowed format.
#
# + s - hexadecimal string representation of int value
# + return - int value or error
public isolated function fromHexString(string s) returns int|error = external;
</pre>

</section>

<section>
<h4 id="lang.map">10.3.8 <code>lang.map</code> module</h4>

<p>The <code>lang.map</code> module corresponds to basic type mapping.</p>

<pre class="langlib">

# A type parameter that is a subtype of `any|error`.
# Has the special semantic that when used in a declaration
# all uses in the declaration must refer to same type.
@typeParam
type Type any|error;

# A type parameter that is a subtype of `any|error`.
# Has the special semantic that when used in a declaration
# all uses in the declaration must refer to same type.
@typeParam
type Type1 any|error;

# Returns number of members of a map.
#
# + m - the map
# + return - number of members in `m`
public isolated function length(map&lt;any|error&gt; m) returns int = external;

# Returns an iterator over a map.
# The iterator will iterate over the members of the map not the keys.
# The `entries` function can be used to iterate over the keys and members together.
# The `keys` function can be used to iterator over just the keys.
# 
# + m - the map
# + return - a new iterator object that will iterate over the members of `m`
public isolated function iterator(map&lt;Type&gt; m) returns object {
    public isolated function next() returns record {|
        Type value;
    |}?;
} = external;

# Returns the member of map `m` with key `k`.
# This for use in a case where it is known that the map has a specific key,
# and accordingly panics if `m` does not have a member with key `k`.
#
# + m - the map
# + k - the key
# + return - member with key `k`
public isolated function get(map&lt;Type&gt; m, string k) returns Type = external;

# Returns a map containing [key, member] pair as the value for each key.
#
# + m - the map
# + return - a new map of [key, member] pairs
public isolated function entries(map&lt;Type&gt; m) returns map&lt;[string, Type]&gt; = external;


# Applies a function each member of a map and returns a map of the result.
# The resulting map will have the same keys as the argument map.
#
# + m - the map
# + func - a function to apply to each member
# + return - new map containing result of applying function `func` to each member
public isolated function 'map(map&lt;Type&gt; m, @isolatedParam function(Type val) returns Type1 func) returns map&lt;Type1&gt; = external;

# Applies a function to each member of a map.
# The function `func` is applied to each member of `m`.
#
# + m - the map
# + func - a function to apply to each member
public isolated function forEach(map&lt;Type&gt; m, @isolatedParam function(Type val) returns () func) returns () = external;

# Selects the members from a map for which a function returns true.
#
# + m - the map
# + func - a predicate to apply to each element to test whether it should be included
# + return - new map containing members for which `func` evaluates to true
public isolated function filter(map&lt;Type&gt; m, @isolatedParam function(Type val) returns boolean func) returns map&lt;Type&gt; = external;

# Combines the members of a map using a combining function.
# The combining function takes the combined value so far and a member of the map,
# and returns a new combined value.
#
# + m - the map
# + func - combining function
# + initial - initial value for the first argument of combining function `func`
# + return - result of combining the members of `m` using `func`
public isolated function reduce(map&lt;Type&gt; m, @isolatedParam function(Type1 accum, Type val) returns Type1 func, Type1 initial) returns Type1 = external;

# Removes a member of a map.
#
# + m - the map
# + k - the key
# + return - the member of `m` that had key `k`
# This removes the member of `m` with key `k` and returns it.
# It panics if there is no such member.
public isolated function remove(map&lt;Type&gt; m, string k) returns Type = external;

# Removes a member of a map with a given key, if the map has member with the key.
#
# + m - the map
# + k - the key
# + return - the member of `m` that had key `k`, or `()` if `m` does not have a key `k`
# If `m` has a member with key `k`, it removes and returns it;
# otherwise it returns `()`.
public isolated function removeIfHasKey(map&lt;Type&gt; m, string k) returns Type? = external;

# Removes all members of a map.
# This panics if any member cannot be removed.
#
# + m - the map
public isolated function removeAll(map&lt;any|error&gt; m) returns () = external;

# Tests whether m has a member with key `k`.
#
# + m - the map
# + k - the key
# + return - true if m has a member with key `k`
public isolated function hasKey(map&lt;Type&gt; m, string k) returns boolean = external;

# Returns a list of all the keys of map `m`.
#
# + m - the map
# + return - a new list of all keys
public isolated function keys(map&lt;any|error&gt; m) returns string[] = external;

# Returns a list of all the members of a map.
#
# + m - the map
# + return - an array whose members are the members of `m`
public isolated function toArray(map&lt;Type&gt; m) returns Type[] = external;
</pre>

</section>

<section>
<h4 id="lang.object">10.3.9 <code>lang.object</code> module</h4>

<p>The <code>lang.object</code> module corresponds to basic type object.</p>

<pre class="langlib">

# Distinct Iterable type.
# An object can make itself iterable by using `*object:Iterable;`,
# and then defining an `iterator` method.
public type Iterable distinct object {
    # Create a new iterator.
    #
    # + return - a new iterator object
    public function iterator() returns object {
        public function next() returns record {| any|error value; |}|error?;
    }
}

# Distinct RawTemplate type.
# A raw template expression constructs an object belonging to this type.
public type RawTemplate distinct object {
    # An array of the strings containing the characters in BacktickString
    # outside of interpolations, split at the interpolation points.
    # The length of this array is one greater than
    # the length of the `insertions` array.
    public (readonly &amp; string[]) strings;
    # An array containing the results of evaluating the
    # interpolations in the BacktickString.
    public (any|error)[] insertions;
};
</pre>

</section>

<section>
<h4 id="lang.stream">10.3.10 <code>lang.stream</code> module</h4>

<p>The <code>lang.stream</code> module corresponds to basic type stream.</p>

<pre class="langlib">


# A type parameter that is a subtype of `any|error`.
# Has the special semantic that when used in a declaration
# all uses in the declaration must refer to same type.
@typeParam
type Type any|error;

# A type parameter that is a subtype of `error`.
# Has the special semantic that when used in a declaration
# all uses in the declaration must refer to same type.
@typeParam
type ErrorType error;

# A type parameter that is a subtype of `error?`.
# Has the special semantic that when used in a declaration
# all uses in the declaration must refer to same type.
# This represents the result type of an iterator.
@typeParam
type CompletionType error?;

# A type parameter that is a subtype of `any|error`.
# Has the special semantic that when used in a declaration
# all uses in the declaration must refer to same type.
@typeParam
type Type1 any|error;

# Returns an iterator over a stream.
#
# + stm - the stream
# + return - a new iterator object that will iterate over the members of `stm`.
public isolated function iterator(stream&lt;Type,CompletionType&gt; stm) returns object {
    public isolated function next() returns record {|
        Type value;
    |}|CompletionType;
} = external;

# Returns the next member of the stream.
#
# + stm - the stream
# + return - a record containing the next member of the stream, if there is one, or,
#   otherwise, the completion value
public isolated function next(stream&lt;Type,CompletionType&gt; stm) returns record {|
        Type value;
    |}|CompletionType = external;

# Closes a stream.
# This releases any system resources being used by the stream.
# Closing a stream that has already been closed has no efffect and returns `()`.
#
# + stm - the stream to close
# + return - () if the close completed successfully, otherwise an error
public isolated function close(stream&lt;Type,CompletionType&gt; stm) returns CompletionType? = external;


# Applies a function to each member of a stream and returns a stream of the results.
#
# + stm - the stream
# + func - a function to apply to each member
# + return - new stream containing result of applying `func` to each member of `stm` in order
public isolated function 'map(stream&lt;Type,CompletionType&gt; stm, @isolatedParam function(Type val) returns Type1 func)
   returns stream&lt;Type1,CompletionType&gt; = external;

# Applies a function to each member of a stream.
# The function `func` is applied to each member of stream `stm` in order.
#
# + stm - the stream
# + func - a function to apply to each member
public isolated function forEach(stream&lt;Type,CompletionType&gt; stm, @isolatedParam function(Type val) returns () func) returns CompletionType = external;

# Selects the members from a stream for which a function returns true.
#
# + stm - the stream
# + func - a predicate to apply to each member to test whether it should be selected
# + return - new stream only containing members of `stm` for which `func` evaluates to true
public isolated function filter(stream&lt;Type,CompletionType&gt; stm, @isolatedParam function(Type val) returns boolean func)
   returns stream&lt;Type,CompletionType&gt; = external;

# Combines the members of a stream using a combining function.
# The combining function takes the combined value so far and a member of the stream,
# and returns a new combined value.
#
# + stm - the stream
# + func - combining function
# + initial - initial value for the first argument of combining function `func`
# + return - result of combining the members of `stm` using `func`
public isolated function reduce(stream&lt;Type,ErrorType?&gt; stm, @isolatedParam function(Type1 accum, Type val) returns Type1 func, Type1 initial)
   returns Type1|ErrorType = external;
</pre>

</section>

<section>
<h4 id="lang.string">10.3.11 <code>lang.string</code> module</h4>

<p>The <code>lang.string</code> module corresponds to basic type string.</p>

<pre class="langlib">

# Built-in subtype of string containing strings of length 1.
@builtinSubtype
type Char string;

# Returns the length of the string.
#
# + str - the string
# + return - the number of characters (code points) in `str`
public isolated function length(string str) returns int = external;

# Returns an iterator over the string.
# The iterator will yield the substrings of length 1 in order.
#
# + str - the string to be iterated over
# + return - a new iterator object
public isolated function iterator(string str) returns object {
    public isolated function next() returns record {| Char value; |}?;
} = external;

# Concatenates zero or more strings.
#
# + strs - strings to be concatenated
# + return - concatenation of all of the `strs`; empty string if `strs` is empty
public isolated function concat(string... strs) returns string = external;

# Returns the code point of a character in a string.
#
# + str - the string
# + index - an index in `str`
# + return - the Unicode code point of the character at `index` in `str`
public isolated function getCodePoint(string str, int index) returns int = external;

# Returns a substring of a string.
#
# + str - source string.
# + startIndex - the starting index, inclusive
# + endIndex - the ending index, exclusive
# + return - substring consisting of characters with index &gt;= startIndex and &lt; endIndex
public isolated function substring(string str, int startIndex, int endIndex = str.length()) returns string = external;

# Lexicographically compares strings using their Unicode code points.
# This orders strings in a consistent and well-defined way,
# but the ordering will often not be consistent with cultural expectations
# for sorted order.
#
# + str1 - the first string to be compared
# + str2 - the second string to be compared
# + return - an int that is less than, equal to or greater than zero,
#    according as `str1` is less than, equal to or greater than `str2`
public isolated function codePointCompare(string str1, string str2) returns int = external;

# Joins zero or more strings together with a separator.
#
# + separator - separator string
# + strs - strings to be joined
# + return - a string consisting of all of `strs` concatenated in order
#     with `separator` in between them
public isolated function 'join(string separator, string... strs) returns string = external;

# Finds the first occurrence of one string in another string.
#
# + str - the string in which to search
# + substr - the string to search for
# + startIndex - index to start searching from
# + return - index of the first occurrence of `substr` in `str` that is &gt;= `startIndex`,
#    or `()` if there is no such occurrence
public isolated function indexOf(string str, string substr, int startIndex = 0) returns int? = external;

# Finds the last occurrence of one string in another string.
#
# + str - the string in which to search
# + substr - the string to search for
# + startIndex - index to start searching backwards from
# + return - index of the last occurrence of `substr` in `str` that is &lt;= `startIndex`,
#    or `()` if there is no such occurrence
public isolated function lastIndexOf(string str, string substr, int startIndex = str.length() - substr.length()) returns int? = external;

# Tests whether a string includes another string.
#
# + str - the string in which to search
# + substr - the string to search for
# + startIndex - index to start searching from
# + return - `true` if there is an occurrence of `substr` in `str` at an index &gt;= `startIndex`,
#    or `false` otherwise
public isolated function includes(string str, string substr, int startIndex = 0) returns boolean = external;

# Tests whether a string starts with another string.
#
# + str - the string to be tested
# + substr - the starting string
# + return - true if `str` starts with `substr`; false otherwise
public isolated function startsWith(string str, string substr) returns boolean = external;

# Tests whether a string ends with another string.
#
# + str - the string to be tested
# + substr - the ending string
# + return - true if `str` ends with `substr`; false otherwise
public isolated function endsWith(string str, string substr) returns boolean = external;


# Converts occurrences of A-Z to a-z.
# Other characters are left unchanged.
#
# + str - the string to be converted
# + return - `str` with any occurrences of A-Z converted to a-z
public isolated function toLowerAscii(string str) returns string = external;

# Converts occurrences of a-z to A-Z.
# Other characters are left unchanged.
#
# + str - the string to be converted
# + return - `str` with any occurrences of a-z converted to A-Z
public isolated function toUpperAscii(string str) returns string = external;


# Tests whether two strings are the same, ignoring the case of ASCII characters.
# A character in the range a-z is treated the same as the corresponding character in the range A-Z.
#
# + str1 - the first string to be compared
# + str2 - the second string to be compared
# + return - true if `str1` is the same as `str2`, treating upper-case and lower-case
# ASCII letters as the same; false, otherwise
public isolated function equalsIgnoreCaseAscii(string str1, string str2) returns boolean = external;

# Removes ASCII white space characters from the start and end of a string.
# The ASCII white space characters are 0x9...0xD, 0x20.
#
# + str - the string
# + return - `str` with leading or trailing ASCII white space characters removed
public isolated function trim(string str) returns string = external;

# Represents `str` as an array of bytes using UTF-8.
#
# + str - the string
# + return - UTF-8 byte array
public isolated function toBytes(string str) returns byte[] = external;

# Constructs a string from its UTF-8 representation in `bytes`.
#
# + bytes - UTF-8 byte array
# + return - `bytes` converted to string or error
public isolated function fromBytes(byte[] bytes) returns string|error = external;

# Converts a string to an array of code points.
#
# + str - the string
# + return - an array with a code point for each character of `str`
public isolated function toCodePointInts(string str) returns int[] = external;

# Converts a single character string to a code point.
#
# + ch - a single character string
# + return - the code point of `ch`
public isolated function toCodePointInt(Char ch) returns int = external;

# Constructs a string from an array of code points.
# An int is a valid code point if it is in the range 0 to 0x10FFFF inclusive,
# but not in the range 0xD800 or 0xDFFF inclusive.
#
# + codePoints - an array of ints, each specifying a code point
# + return - a string with a character for each code point in `codePoints`; or an error
# if any member of `codePoints` is not a valid code point
public isolated function fromCodePointInts(int[] codePoints) returns string|error = external;

# Constructs a single character string from a code point.
# An int is a valid code point if it is in the range 0 to 0x10FFFF inclusive,
# but not in the range 0xD800 or 0xDFFF inclusive.
#
# + codePoint - an int specifying a code point
# + return - a single character string whose code point is `codePoint`; or an error
# if `codePoint` is not a valid code point
public isolated function fromCodePointInt(int codePoint) returns Char|error = external;
</pre>

</section>

<section>
<h4 id="lang.table">10.3.12 <code>lang.table</code> module</h4>

<p>The <code>lang.table</code> module corresponds to basic type table.</p>

<pre class="langlib">

# A type parameter that is a subtype of `map&lt;any|error&gt;`.
# Has the special semantic that when used in a declaration
# all uses in the declaration must refer to same type.
@typeParam
type MapType map&lt;any|error&gt;;

# A type parameter that is a subtype of `map&lt;any|error&gt;`.
# Has the special semantic that when used in a declaration
# all uses in the declaration must refer to same type.
@typeParam
type MapType1 map&lt;any|error&gt;;

# A type parameter that is a subtype of `anydata`.
# Has the special semantic that when used in a declaration
# all uses in the declaration must refer to same type.
@typeParam
type KeyType anydata;

# Returns number of members of a table.
#
# + t - the table
# + return - number of members in `t`
public isolated function length(table&lt;map&lt;any|error&gt;&gt; t) returns int = external;

# Returns an iterator over a table.
# The iterator will iterate over the members of the table not the keys.
# The `entries` function can be used to iterate over the keys and members together.
# The `keys` function can be used to iterator over just the keys.
# 
# + t - the table
# + return - a new iterator object that will iterate over the members of `t`
public isolated function iterator(table&lt;MapType&gt; t) returns object {
    public isolated function next() returns record {|
        MapType value;
    |}?;
} = external;

# Returns the member of table `t` with key `k`.
# This for use in a case where it is known that the table has a specific key,
# and accordingly panics if `t` does not have a member with key `k`.
#
# + t - the table
# + k - the key
# + return - member with key `k`
public isolated function get(table&lt;MapType&gt; key&lt;KeyType&gt; t, KeyType k) returns MapType = external;

# Adds a member `val` to table `t`, replacing any member with the same key value.
# If `val` replaces an existing member, it will have the same position
# in the order of the members as the existing member;
# otherwise, it will be added as the last member.
# It panics if `val` is inconsistent with the inherent type of `t`.
public isolated function put(table&lt;MapType&gt; t, MapType val) = external;

# Adds a member `val` to table `t`.
# It will be added as the last member.
# It panics if `val` has the same key as an existing member of `t`,
# or if `val` is inconsistent with the inherent type of `t`.
public isolated function add(table&lt;MapType&gt; t, MapType val) = external;


# Applies a function each member of a table and returns a table of the result.
#
# + t - the table
# + func - a function to apply to each member
# + return - new table containing result of applying function `func` to each member
public isolated function map(table&lt;MapType&gt; t, @isolatedParam function(MapType val) returns MapType1 func)
   returns table&lt;MapType1&gt; key&lt;never&gt; = external;

# Applies a function to each member of a table.
# The function `func` is applied to each member of `t`.
#
# + t - the table
# + func - a function to apply to each member
public isolated function forEach(table&lt;MapType&gt; t, @isolatedParam function(MapType val) returns () func) returns () = external;

# Selects the members from a table for which a function returns true.
# The resulting table will have the same keys as the argument table.
#
# + t - the table
# + func - a predicate to apply to each member to test whether it should be included
# + return - new table containing members for which `func` evaluates to true
public isolated function filter(table&lt;MapType&gt; key&lt;KeyType&gt; t, @isolatedParam function(MapType val) returns boolean func)
   returns table&lt;MapType&gt; key&lt;KeyType&gt; = external;

# Combines the members of a table using a combining function.
# The combining function takes the combined value so far and a member of the table,
# and returns a new combined value.
#
# + t - the table
# + func - combining function
# + initial - initial value for the first argument of combining function `func`
# + return - result of combining the members of `t` using `func`
public isolated function reduce(table&lt;MapType&gt; t, @isolatedParam function(MapType1 accum, MapType val) returns MapType1 func, MapType1 initial) returns MapType1 = external;

# Removes a member of a table.
#
# + t - the table
# + k - the key
# + return - the member of `t` that had key `k`
# This removed the member of `t` with key `k` and returns it.
# It panics if there is no such member.
public isolated function remove(table&lt;MapType&gt; key&lt;KeyType&gt; t, KeyType k) returns MapType = external;

# Removes a member of a table with a given key, if the table has member with the key.
#
# + t - the table
# + k - the key
# + return - the member of `t` that had key `k`, or `()` if `t` does not have a key `k`
# If `t` has a member with key `k`, it removes and returns it;
# otherwise it returns `()`.
public isolated function removeIfHasKey(table&lt;MapType&gt; key&lt;KeyType&gt; t, KeyType k) returns MapType? = external;

# Removes all members of a table.
# This panics if any member cannot be removed.
#
# + t - the table
public isolated function removeAll(table&lt;map&lt;any|error&gt;&gt; t) returns () = external;

# Tests whether `t` has a member with key `k`.
#
# + t - the table
# + k - the key
# + return - true if `t` has a member with key `k`
public isolated function hasKey(table&lt;MapType&gt; key&lt;KeyType&gt; t, KeyType k) returns boolean = external;

# Returns a list of all the keys of table `t`.
#
# + t - the table
# + return - a new list of all keys
public isolated function keys(table&lt;map&lt;any|error&gt;&gt; key&lt;KeyType&gt; t) returns KeyType[] = external;

# Returns a list of all the members of a table.
#
# + t - the table
# + return - an array whose members are the members of `t`
public isolated function toArray(table&lt;MapType&gt; t) returns MapType[] = external;

# Returns the next available integer key.
# + t - the table with a key of type int
# + return - an integer not yet used as a key
# This is maximum used key value + 1, or 0 if no key used
# XXX should it be 0, if the maximum used key value is &lt; 0?
# Provides similar functionality to auto-increment
public isolated function nextKey(table&lt;map&lt;any|error&gt;&gt; key&lt;int&gt; t) returns int = external;
</pre>

</section>

<section>
<h4 id="lang.typedesc">10.3.13 <code>lang.typedesc</code> module</h4>

<p>The <code>lang.typedesc</code> module corresponds to basic type typedesc.</p>

<pre class="langlib">

# A record representing an identifier for a module.
# This uniquely identifies a module within a program.
public type ModuleId readonly &amp; record {|
    # the organization
    string organization;
    # the module name
    string name;
    # platform-specified parts of the identifier
    string[] platformParts;
|};

# A record representing a type-id.
# A type-id uniquely identifies an occurrence of a distinct type descriptor
# within a program.
public type TypeId readonly &amp; record {|
    # An identifier for the module.
    ModuleId moduleId;
    # An identifier within the module identified by `moduleId`.
    # If it is a string, then it is the name of a type defined in the module.
    # If it is an integer, then it is compiler-generated.
    (string|int) localId;
|};

# Returns the type-ids induced by a typedesc value.
# + t - the typedesc
# + primaryOnly - if true, only the primary type-ids will be returned; otherwise,
    all type-ids will be returned
# + return - an array containing the type-ids induced by `t` or nil if `t` is not definite
public isolated function typeIds(typedesc t, boolean primaryOnly = false) returns readonly &amp; TypeId[]?
    = external;
</pre>

</section>

<section>
<h4 id="lang.xml">10.3.14 <code>lang.xml</code> module</h4>

<p>The <code>lang.xml</code> module corresponds to basic type xml.</p>

<pre class="langlib">

# The namespace URI bound to the `xml` prefix.
public const string XML_NAMESPACE_URI = "http://www.w3.org/XML/1998/namespace";
# The namespace URI bound to the `xmlns` prefix.
public const string XMLNS_NAMESPACE_URI = "http://www.w3.org/2000/xmlns/";

# The expanded name of the `xml:space` attribute.
public const string space = "{http://www.w3.org/XML/1998/namespace}space";
# The expanded name of the `xml:lang` attribute.
public const string lang = "{http://www.w3.org/XML/1998/namespace}lang";
# The expanded name of the `xml:base` attribute.
public const string base = "{http://www.w3.org/XML/1998/namespace}base";

# Type for singleton elements.
# Built-in subtype of xml.
@builtinSubtype
public type Element xml;

# Type for singleton processing instructions.
# Built-in subtype of xml.
@builtinSubtype
public type ProcessingInstruction xml;

# Type for singleton comments.
# Built-in subtype of xml.
@builtinSubtype
public type Comment xml;

# Type for zero or more text characters.
# Built-in subtype of xml.
# Adjacent xml text items are automatically concatenated,
# so an xml sequence belongs to this type if it is a singleton test sequence
# or the empty sequence.
@builtinSubtype
public type Text xml;

# Returns number of xml items in `x`.
#
# + x - xml item
# + return - number of XML items in `x`
public isolated function length(xml x) returns int = external;

# A type parameter that is a subtype of any singleton or empty xml sequence.
# Has the special semantic that when used in a declaration
# all uses in the declaration must refer to same type.
@typeParam
type ItemType Element|Comment|ProcessingInstruction|Text;
# A type parameter that is a subtype of `xml`.
# Has the special semantic that when used in a declaration
# all uses in the declaration must refer to same type.
@typeParam
type XmlType xml;

# Returns an iterator over the xml items of `x`
#
# + x - xml sequence to iterate over
# + return - iterator object
# Each item is represented by an xml singleton.
public isolated function iterator(xml&lt;ItemType&gt; x) returns object {
    public isolated function next() returns record {| ItemType value; |}?;
} = external;

# Returns the item of `x` with index `i`.
# This differs from `x[i]` in that it panics if
# `x` does not have an item with index `i`.
#
# + x - the xml sequence 
# + k - the index
# + return - the item with index `i` in `x`
public isolated function get(xml&lt;ItemType&gt; x, int i) returns ItemType = external;

# Concatenates xml and string values.
#
# + xs - xml or string items to concatenate
# + return - an xml sequence that is the concatenation of all the `xs`;
#    an empty xml sequence if the `xs` are empty
public isolated function concat((xml|string)... xs) returns xml = external;

# Returns a string giving the expanded name of `elem`.
#
# + elem - xml element
# + return - element name
public isolated function getName(Element elem) returns string = external;

# Change the name of element `elem` to `xName`.
#
# + elem - xml element
# + xName - new expanded name
public isolated function setName(Element elem, string xName) = external;

# Returns the map representing the attributes of `elem`.
# This includes namespace attributes.
# The keys in the map are the expanded names of the attributes.
#
# + x - xml element
# + return - attributes of `x`
public isolated function getAttributes(Element x) returns map&lt;string&gt; = external;

# Returns the children of `elem`.
#
# + elem - xml element
# + return - children of `elem`
public isolated function getChildren(Element elem) returns xml = external;

# Sets the children of `elem` to `children`.
# This panics if it would result in the element structure
# becoming cyclic.
#
# + elem - xml element
# + children - xml or string to set as children
public isolated function setChildren(Element elem, xml|string children) = external;

# Returns the descendants of `elem`.
#
# + elem - xml element
# + return - descendants of `elem`
# The descendants of an element are the children of the element
# together with, for each of those children that is an element,
# the descendants of that element, ordered so that
# each element immediately precedes all its descendants.
# The order of the items in the returned sequence will thus correspond
# to the order in which the first character of the representation
# of the item would occur in the representation of the element in XML syntax.
public isolated function getDescendants(Element elem) returns xml = external;

# Returns a string with the character data of an xml value.
# + x - the xml value
# + return - a string consisting of all the character data of `x`
# The character data of an xml value is as follows:
# * the character data of a text item is a string with one character for each
#     character information item represented by the text item;
# * the character data of an element item is the character data of its children;
# * the character data of a comment item is the empty string;
# * the character data of a processing instruction item is the empty string;
# * the character data of an empty xml sequence is the empty string;
# * the character data of the concatenation of two xml sequences x1 and x2 is the
#    concatenation of the character data of x1 and the character data of x2.
public isolated function data(xml x) returns string = external;

# Returns the target part of the processing instruction.
#
# + x - xml processing instruction item
# + return - target part of `x`
public isolated function getTarget(ProcessingInstruction x) returns string = external;

# Returns the content of a processing instruction or comment item.
#
# + x - xml item
# + return - the content of `x`
public isolated function getContent(ProcessingInstruction|Comment x) returns string = external;

# Creates a new xml element item.
#
# + name - the name of the new element
# + attributes - the attributes of the new element
# + children - the children of the new element
# + return - an xml sequence consisting of only a new xml element with name `name`,
#   attributes `attributes`, and children `children`
# The element's attribute map is a newly created map, into which any attributes specified
# by the `attributes` map are copied.
public isolated function createElement(string name, map&lt;string&gt; attributes = {}, xml children = xml``)
    returns Element = external;

# Creates a new xml processing instruction item.
#
# + target - the target part of the processing instruction to be constructed
# + content - the content part of the processing instruction to be constructed
# + return - an xml sequence consisting of a processing instruction with target `target`
#     and content `content`
public isolated function createProcessingInstruction(string target, string content)
    returns ProcessingInstruction = external;

# Creates a new xml comment item.
#
# + content - the content of the comment to be constructed.
# + return - an xml sequence consisting of a comment with content `content`
public isolated function createComment(string content) returns Comment = external;

# Constructs an xml value of type Text.
# + data - the character data of the Text item
# + return - an xml sequence that is either empty or consists of one text item
# The returned xml value will be empty when the length of `data` is zero.
public isolated function createText(string data) returns Text = external;

# Returns a subsequence of an xml value.
#
# + x - the xml value
# + startIndex - start index, inclusive
# + endIndex - end index, exclusive
# + return - a subsequence of `x` consisting of items with index &gt;= startIndex and &lt; endIndex
public isolated function slice(xml&lt;ItemType&gt; x, int startIndex, int endIndex = x.length())
    returns xml&lt;ItemType&gt; = external;

# Strips the insignificant parts of the an xml value.
# This first transforms the xml value by leaving out any constituent
# item that is a comment or processing instruction. It then
# transforms this value by leaving out any constituent item that
# is a text item that consists entirely of whitespace, where whitespace
# is as defined by the S production of XML 1.0.
#
# + x - the xml value
# + return - `x` transformed by leaving out insignificant items
public isolated function strip(xml x) returns xml = external;

# Selects elements from an xml value.
# If `nm` is `()`, selects all elements;
# otherwise, selects only elements whose expanded name is `nm`.
# 
# + x - the xml value
# + nm - the expanded name of the elements to be selected, or `()` for all elements
# + return - an xml sequence consisting of all the element items in `x` whose expanded name is `nm`,
#  or, if `nm` is `()`, all element items in `x`
public isolated function elements(xml x, string? nm = ()) returns xml&lt;Element&gt; = external;

# Returns the children of elements in an xml value.
# When `x` is of type Element, it is equivalent to `getChildren`.
# + x - xml value
# + return - xml sequence containing the children of each element x concatenated in order
# This is equivalent to `elements(x).map(getChildren)`.
public isolated function children(xml x) returns xml = external;

# Selects element children of an xml value
# + x - the xml value
# + nm - the expanded name of the elements to be selected, or `()` for all elements
# + return - an xml sequence consisting of child elements of elements in `x`; if `nm`
#  is `()`, returns a sequence of all such elements;
#  otherwise, include only elements whose expanded name is `nm`
# This is equivalent to `children(x).elements(nm)`.
public isolated function elementChildren(xml x, string? nm = ()) returns xml&lt;Element&gt; = external;

# Selects text items from an xml value.
# + x - the xml value
# return - an xml sequence consisting of the concatentation of the text items in `x`
public isolated function text(xml x) returns Text = external;


# Applies a function to each item in an xml sequence, and returns an xml sequence of the results.
# Each item is represented as a singleton value.
#
# + x - the xml value
# + func - a function to apply to each child or `item`
# + return - new xml value containing result of applying function `func` to each child or `item`
public isolated function map(xml&lt;ItemType&gt; x, @isolatedParam function(ItemType item) returns XmlType func)
    returns xml&lt;XmlType&gt; = external;

# Applies a function to each item in an xml sequence.
# Each item is represented as a singleton value.
#
# + x - the xml value
# + func - a function to apply to each item in `x`
public isolated function forEach(xml&lt;ItemType&gt; x, @isolatedParam function(ItemType item) returns () func)
    = external;

# Selects the items from an xml sequence for which a function returns true.
# Each item is represented as a singleton value.
#
# + x - xml value
# + func - a predicate to apply to each item to test whether it should be selected
# + return - new xml sequence containing items in `x` for which `func` evaluates to true
public isolated function filter(xml&lt;ItemType&gt; x, @isolatedParam function(ItemType item) returns boolean func)
    returns xml = external;

# Constructs an xml value from a string.
# This parses the string using the `content` production of the
# XML 1.0 Recommendation.
#
# + s - a string in XML format
# + return - xml value resulting from parsing `s`, or an error
public isolated function fromString(string s) returns xml|error = external;
</pre>

</section>

<section>
<h4 id="lang.transaction">10.3.15 <code>lang.transaction</code> module</h4>

<p>The <code>lang.transaction</code> module supports transactions.</p>

<pre class="langlib">


# Type of error returned by commit action.
type Error distinct error;

# Information about a transaction that does not change
# after the transaction is started.
type Info readonly &amp; record {|
   # Unique identifier for the transaction branch
   byte[] xid;
   # The number of previous attempts in a sequence of retries
   int retryNumber;
   # Information about the previous attempt in a sequence of retries.
   # This will be `()` if the `retryNumber` is 0.
   Info? prevAttempt;
   # The time at which the transaction was started.
   Timestamp startTime;
|};

# An instant in time.
public type Timestamp readonly &amp; object {
    # Returns milliseconds since 1970-01-01T00:00:00Z, not including leap seconds
    public function toMillisecondsInt() returns int;
    # Returns a string representation of the timestamp in ISO 8601 format
    public function toString() returns string;
};

# Returns information about the current transaction
public transactional isolated function info() returns Info = external;

# Returns information about the transaction with
# the specified xid.
public isolated function getInfo(byte[] xid) returns Info? = external;

# Prevents the global transaction from committing successfully.
# This ask the transaction manager that when it makes the decision
# whether to commit or rollback, it should decide to rollback.
#
# + error - the error that caused the rollback or `()`, if there is none
public transactional isolated function setRollbackOnly(error? e) = external;

# Tells whether it is known that the transaction will be rolled back.
# + return - true if it is known that the transaction manager will,
# when it makes the decision whether to commit or rollback, decide
# to rollback
public transactional isolated function getRollbackOnly() returns boolean = external;

# Associates some data with the current transaction branch.
public transactional isolated function setData(readonly data) = external;

# Retrieves data associated with the current transaction branch.
# The data is set using `setData`.
# + return - the data, or `()` if no data has been set.
public transactional isolated function getData() returns readonly = external;

# Type of a commit handler function.
# + info - information about the transaction being committed
public type CommitHandler isolated function(Info info);

# Type of a rollback handler function.
# + info - information about the transaction being committed
# + cause - an error describing the cause of the rollback, if there is
# + willRetry - true if the transaction will be retried, false otherwise
public type RollbackHandler isolated function(Info info, error? cause, boolean willRetry);

# Adds a handler to be called if and when the global transaction commits.
#
# + handler - the function to be called on commit
public transactional isolated function onCommit(CommitHandler handler) = external;

# Adds a handler to be called if and when the global transaction rolls back.
#
# + handler - the function to be called on rollback
public transactional isolated function onRollback(RollbackHandler handler) = external;
</pre>

</section>

<section>
<h4 id="lang.runtime">10.3.16 <code>lang.runtime</code> module</h4>

<p>The <code>lang.runtime</code> module provides functions related to the
language runtime that are not specific to a particular basic type.</p>

<pre class="langlib">

# Sleep for `seconds`.
# + seconds - a decimal giving the length of time to sleep in seconds
# The function will do nothing for the specified period of time before returning.
# This will cause the current strand to yield.
public isolated function sleep(decimal seconds) = external; 

# A listener that is dynamically registered with a module.
public type DynamicListener object {
   public function 'start() returns error?;
   public function gracefulStop() returns error?;
   public function immediateStop() returns error?;
};

# Register a listener object with a module.
# + listener - the listener object to be registered
# The listener becomes a module listener of the module from which this
# function is called.
public isolated function registerListener(DynamicListener listener) = external;

# Deregister a listener from a module.
# + listener - the listener object to be unregistered
# The `listener` ceases to be a module listener of the module from
# which this function is called.
public isolated function deregisterListener(DynamicListener listener) = external;


# Type representing a stack frame.
# A call stack is represented as an array of stack frames.
# This type is also present in lang.error to avoid a dependency.
public type StackFrame readonly &amp; object {
   # Returns a string representing this StackFrame.
   # This must not contain any newline characters.
   # + return - a string
   public function toString() returns string;
};

# Return a stack trace for the current call stack.
# + return - an array representing the current call stack
# The first member of the array represents the top of the call stack.
public isolated function getStackTrace() returns StackFrame[] = external;
</pre>

</section>

<section>
<h4 id="lang.value">10.3.17 <code>lang.value</code> module</h4>

<p>The <code>lang.value</code> module provides functions that work on values of
more than one basic type..</p>

<pre class="langlib">

# The type of value to which `clone` and `cloneReadOnly` can be applied.
public type Cloneable readonly|xml|Cloneable[]|map&lt;Cloneable&gt;|table&lt;map&lt;Cloneable&gt;&gt;;

# A type parameter that is a subtype of `Cloneable`.
# Has the special semantic that when used in a declaration
# all uses in the declaration must refer to same type.
@typeParam
type CloneableType Cloneable;

# Returns a clone of `v`.
# A clone is a deep copy that does not copy immutable subtrees.
# A clone can therefore safely be used concurrently with the original.
# It corresponds to the Clone(v) abstract operation,
# defined in the Ballerina Language Specification.
#
# + v - source value
# + return - clone of `v`
public isolated function clone(CloneableType v) returns CloneableType = external;

# Returns a clone of `v` that is read-only, i.e. immutable.
# It corresponds to the ImmutableClone(v) abstract operation,
# defined in the Ballerina Language Specification.
#
# + v - source value
# + return - immutable clone of `v`
public isolated function cloneReadOnly(CloneableType v) returns CloneableType &amp; readonly = external;

# Constructs a value with a specified type by cloning another value.
# + v - the value to be cloned
# + t - the type for the cloned to be constructed
# + return - a new value that belongs to type `t`, or an error if this cannot be done
# 
# When `v` is a structural value, the inherent type of the value to be constructed
# comes from `t`. When `t` is a union, it must be possible to determine which
# member of the union to use for the inherent type by following the same rules
# that are used by list constructor expressions and mapping constructor expressions
# with the contextually expected type. If not, then an error is returned.
# The `cloneWithType` operation is recursively applied to each member of `v` using
# the type descriptor that the inherent type requires for that member.
# 
# Like the Clone abstract operation, this does a deep copy, but differs in
# the following respects:
# - the inherent type of any structural values constructed comes from the specified
#   type descriptor rather than the value being constructed
# - the read-only bit of values and fields comes from the specified type descriptor
# - the graph structure of `v` is not preserved; the result will always be a tree;
#   an error will be returned if `v` has cycles
# - immutable structural values are copied rather than being returned as is
# - numeric values can be converted using the NumericConvert abstract operation
# - if a record type descriptor specifies default values, these will be used
#   to supply any missing members
public isolated function cloneWithType(anydata v, typedesc&lt;anydata&gt; t = &lt;&gt;) returns t|error = external;

# Safely casts a value to a type.
# This casts a value to a type in the same way as a type cast expression,
# but returns an error if the cast cannot be done, rather than panicking.
# + v - the value to be cast
# + t - a typedesc for the type to which to cast it
# return - `v` cast to the type described by `t`, or an error, if the cast cannot be done
public isolated function ensureType(any|error v, typedesc&lt;any&gt; t = &lt;&gt;) returns t|error = external;

# Performs a direct conversion of a value to a string.
# The conversion is direct in the sense that when applied to a value that is already
# a string it leaves the value unchanged.
#
# + v - the value to be converted to a string
# + return - a string resulting from the conversion
#
# The details of the conversion are specified by the ToString abstract operation
# defined in the Ballerina Language Specification, using the direct style.
public isolated function toString(any v) returns string = external;

# Converts a value to a string that describes the value in Ballerina syntax.
# + v - the value to be converted to a string
# + return - a string resulting from the conversion
#
# If `v` is anydata and does not have cycles, then the result will
# conform to the grammar for a Ballerina expression and when evaluated
# will result in a value that is == to v.
#
# The details of the conversion are specified by the ToString abstract operation
# defined in the Ballerina Language Specification, using the expression style.
public isolated function toBalString(any v) returns string = external;

# Parses and evaluates a subset of Ballerina expression syntax.
# + s - the string to be parsed and evaluated
# return - the result of evaluating the parsed expression, or
# an error if the string cannot be parsed
# The subset of Ballerina expression syntax supported is that produced
# by toBalString when applied to an anydata value.
function fromBalString(string s) returns anydata|error = external;


# Converts a value of type `anydata` to `json`.
# This does a deep copy of `v` converting values that do
# not belong to json into values that do.
# A value of type `xml` is converted into a string as if
# by the `toString` function.
# A value of type `table` is converted into a list of
# mappings one for each row.
# The inherent type of arrays in the return value will be
# `json[]` and of mappings will be `map&lt;json&gt;`.
# A new copy is made of all structural values, including
# immutable values.
#
# + v - anydata value
# + return - representation of `v` as value of type json
# This panics if `v` has cycles.
public isolated function toJson(anydata v) returns json = external;

# Returns the string that represents `v` in JSON format.
# `v` is first converted to `json` as if by the `toJson` function.
#
# + v - anydata value
# + return - string representation of `v` converted to `json`
public isolated function toJsonString(anydata v) returns string = external;

# Parses a string in JSON format and returns the the value that it represents.
# Numbers in the JSON string are converted into Ballerina values of type
# decimal except in the following two cases:
# if the JSON number starts with `-` and is numerically equal to zero, then it is
# converted into float value of `-0.0`;
# otherwise, if the JSON number is syntactically an integer and is in the range representable
# by a Ballerina int, then it is converted into a Ballerina int.
# A JSON number is considered syntactically an integer if it contains neither
# a decimal point nor an exponent.
# 
# Returns an error if the string cannot be parsed.
#
# + str - string in JSON format
# + return - `str` parsed to json or error
public isolated function fromJsonString(string str) returns json|error = external;

# Subtype of `json` that allows only float numbers.
public type JsonFloat ()|boolean|string|float|JsonFloat[]|map&lt;JsonFloat&gt;;

# Parses a string in JSON format, using float to represent numbers.
# Returns an error if the string cannot be parsed.
#
# + str - string in JSON format
# + return - `str` parsed to json or error
public isolated function fromJsonFloatString(string str) returns JsonFloat|error = external;

# Subtype of `json` that allows only decimal numbers.
public type JsonDecimal ()|boolean|string|decimal|JsonDecimal[]|map&lt;JsonDecimal&gt;;

# Parses a string in JSON format, using decimal to represent numbers.
# Returns an error if the string cannot be parsed.
#
# + str - string in JSON format
# + return - `str` parsed to json or error
public isolated function fromJsonDecimalString(string str) returns JsonDecimal|error = external;

# Converts a value of type json to a user-specified type.
# This works the same as `cloneWithType`,
# except that it also does the inverse of the conversions done by `toJson`.
#
# + v - json value
# + t - type to convert to
# + return - value belonging to type `t` or error if this cannot be done
public isolated function fromJsonWithType(json v, typedesc&lt;anydata&gt; t = &lt;&gt;)
    returns t|error = external;

# Converts a string in JSON format to a user-specified type.
# This is a combination of `fromJsonString` followed by
# `fromJsonWithType`.
# + str - string in JSON format
# + t - type to convert to
# + return - value belonging to type `t` or error if this cannot be done
public isolated function fromJsonStringWithType(string str, typedesc&lt;anydata&gt; t = &lt;&gt;)
    returns t|error = external;
    
# Merges two json values.
#
# + j1 - json value
# + j2 - json value
# + return - the merge of `j1` with `j2` or an error if the merge fails
#
# The merge of `j1` with `j2` is defined as follows:
# - if `j1` is `()`, then the result is `j2`
# - if `j2` is `()`, then the result is `j1`
# - if `j1` is a mapping and `j2` is a mapping, then for each entry [k, j] in j2,
#   set `j1[k]` to the merge of `j1[k]` with `j`
#     - if `j1[k]` is undefined, then set `j1[k]` to `j`
#     - if any merge fails, then the merge of `j1` with `j2` fails
#     - otherwise, the result is `j1`.
# - otherwise, the merge fails
# If the merge fails, then `j1` is unchanged.
public isolated function mergeJson(json j1, json j2) returns json|error = external;
</pre>

</section>

</section>

</section>
<section class="appendix">
<h2 id="references">A. References</h2>
<ul>
<li>Unicode</li>
<li>XML</li>
<li>JSON</li>
<li>RFC 3629 UTF-8</li>
<li>IEEE 754-2008</li>
<li>GitHub Markdown</li>
</ul>
</section>
<section class="appendix">
<h2 id="changes">B. Changes since previous releases</h2>
<section>
<h3 id="section_B.1">B.1 Summary of changes from 2020R1 to 2021R1</h3>
<ol>
<li>There has been a major change to how objects works. All object type
descriptors are what was previously called <em>abstract</em>: they declare
methods but do not define them. Objects are now created either by using an
object constructor expression, which includes method definitions, or by applying
<code>new</code> to the name of a class defined by a class definition. The
methods and fields of an object are in a single symbol space. Classes and
object constructors can declare fields as final.</li>
<li>Services have become service objects that work in a similar way to client
objects; resource methods on service objects have become remote methods. Remote
methods are in a separate symbol space from regular methods. There is a new
concept for resource methods.</li>
<li>The <code>readonly</code> type has been added. Fields of records can also be
declared as <code>readonly</code>.</li>
<li>Functions, objects and module-level variables can be declared as
<code>isolated</code>; this works in conjunction with <code>readonly</code> to
support concurrency safety.</li>
<li>Module-level variables can be public, provided they are not isolated.</li>
<li>Intersection types have been added.</li>
<li>Distinct types have been added; these provide the functionality of nominal
types with the framework of a structural type system.</li>
<li>The error type has been revised to take advantage of distinct types. Instead
an error value having a reason string for categorizing the error and separate
message string in the detail record, an error value has a message string in the
error and distinct types are used for categorizing. The cause has also moved
from the detail record into the error value.</li>
<li>The syntax for an error constructor that uses a user-defined type name now
includes the <code>error</code> keyword before the type name.</li>
<li>Language-defined abstract object types now make use of distinct types,
instead of using names prefixed with double underscore.</li>
<li>The <code>__init</code> method of object and the <code>__init</code> function
of modules have been renamed to <code>init</code>.</li>
<li>Module variables can be initialized in the module's <code>init</code>
function.</li>
<li>The table type has been redesigned to be more consistent with other
structural types and no longer has preview status.</li>
<li>Enum declarations have been added.</li>
<li>The return type of a function with an external body can depend on the value
of a parameter of typedesc type, which can be defaulted from the contextually
expected type.</li>
<li>Query expressions support some new clauses: <code>join</code> clause,
<code>order by</code> clause, <code>limit</code> clause and <code>on
conflict</code> clause.</li>
<li>The relational operators (<code>&lt; &lt;= &gt; &gt;=</code>) have been
extended to apply to more than just numeric types.</li>
<li>Raw template expressions have been added.</li>
<li>The ability to specify the visibility of parameter names has been removed: a
parameter can always be specified by name as well as position; a parameter
cannot be declared as <code>public</code>.</li>
<li>Local type definitions have been removed.</li>
<li>The <code>fail</code> statement has been added, along with a <code>on
fail</code> clause for compound statements. If a <code>check</code> expression
or action fails, it behaves like a <code>fail</code> statement rather than a
<code>return</code> statement.</li>
<li>The language has a concept of configurability: module level variables can be
specified to be <code>configurable</code>, which allows their initial values to
be specified at runtime.</li>
<li>An import declaration can no longer specify a version.</li>
<li>The stream type no longer has Preview status.</li>
<li>Module prefixes for the langlib modules that correspond to keywords are
predeclared.</li>
<li>Backslash escapes can be used in identifiers without needing an initial
single quote.</li>
<li>Language support for transactions has been added.</li>
<li>The <code>error&lt;*&gt;</code> feature has been removed, because it does
not work well with distinct error types.</li>
<li>In message passing between workers, the function's default worker is now
referenced using the <code>function</code> keyword rather than the
<code>default</code> keyword.</li>
<li>Make <code>trap</code> expression have lower precedence.</li>
</ol>
</section>
<section>
<h3 id="section_B.2">B.2 Summary of changes from 2019R3 to 2020R1</h3>
<ol>
<li>Query expressions and query actions have been added. This is the first stage
of language-integrated query.</li>
<li>The stream basic type has been added.</li>
<li>Let expressions have been added.</li>
<li>The XML design has been refined and no longer has Preview status.
<ul>
<li>The various kinds of xml item (e.g. element and text) are subtypes of the
<code>xml</code> type.</li>
<li>The <code>xml</code> type can have a type parameter specifying the item
types.</li>
<li>Iteration over xml values exposes characters as text items rather than strings</li>
<li>Adjacent characters in XML content are chunked into a single text item.</li>
<li>The meaning of <code>===</code> for xml has changed.</li>
<li>The item of an xml sequence value x with index i can be accessed using an
expression x[i].</li>
<li>The syntax <code>x@</code> for accessing the attributes of an XML element has
been removed.</li>
</ul>
</li>
<li>The <code>lock</code> statement has been added.</li>
<li>When a list constructor or mapping constructor is used without a
contextually expected type, we now infer a tuple or record type rather than an
array or map type.</li>
<li>The syntax for Unicode escapes in strings has changed from
<code>\u[<em>CodePoint</em>]</code> to <code>\u{<em>CodePoint</em>}</code> so as
to align with ECMAScript. Although this is an incompatible change, the previous
syntax was not implemented.</li>
<li>The <code>never</code> type has been added.</li>
<li>Lang library modules can now provide built-in subtypes of existing basic
types.</li>
<li>There is a lang.boolean lang lib module.</li>
</ol>
</section>
<section>
<h3 id="section_B.3">B.3 Summary of changes from 2019R2 to 2019R3</h3>
<ol>
<li>An import declaration can use <code>as _</code> to include a module in the
program without using its symbols.</li>
<li>The specification of experimental features has been moved to a separate
document.</li>
<li>A wait-action can result in an error value when applied to a future that is
not a named worker.</li>
</ol>
</section>

<section>
<h3 id="section_B.4">B.4 Summary of changes from 2019R1 to 2019R2</h3>
<ol>
<li>The concept of a built-in method has been replaced by the concept of a lang
library. A method call on a value of non-object type is now treated as a
convenient syntax for a call to a function in a module of the lang library. The
design of the many of the existing built-in methods has been changed to fit in
with this. There are many functions in the lang library that were not previously
available as built-in methods.</li>
<li>A mapping value is now iterable as a sequence of its members (like list),
rather than as a sequence of key-value pairs. The <code>entries</code> lang library
function allows it to be iterated as a sequence of key-value pairs.</li>
<li>The basic type <code>handle</code> has been added.</li>
<li>The <code>table&lt;T&gt;</code> type descriptor shorthand has been brought
back.</li>
<li>There is now a variation on <code>check</code> called
<code>checkpanic</code>, which panics rather than returns on error.</li>
<li>A range-expr now returns an object belonging to the Iterable abstract object
type, rather than a list.</li>
<li>The decimal type now uses a simplified subset of IEEE 754-2008 decimal
floating point.</li>
<li>The status of XML-related features has been changed to preview.</li>
<li>The ability to define a method outside the object type has been
removed.</li>
<li>The UnfrozenClone operation has been removed.</li>
<li>The Freeze operation has been replaced by the ImmutableClone operation.</li>
<li>The semantics of field access, member access and assignment are now
fully specified.</li>
<li>A <code>?.</code> operator has been added for access to optional fields.</li>
<li>A type-cast-expr can include annotations.</li>
<li>The error detail record must belong to type Detail defined in the lang
library.</li>
<li>The compile-time requirement that the inherent type of a variable-length
list must allow members to be filled-in has been removed; this is instead caught
at run-time.</li>
<li>Parameter names now have public or module-level visibility, which determines
when a function call can use the parameter name to specify an argument.</li>
<li>A type descriptor <code>record { }</code> is open to <code>anydata</code>
rather than <code>anydata|error</code>.</li>
<li>Calls using <code>start</code> are treated as actions, and so are not
allowed within expressions.</li>
<li>There is a new syntax for allowing arbitrary strings as identifiers to
replace the old delimited identifier syntax <code>^"<var>s</var>"</code>.</li>
</ol>

</section>
<section>
<h3 id="section_B.5">B.5 Summary of changes from 0.990 to 2019R1</h3>
<p>
The specification has switched to a new versioning scheme. The <var>n</var>-th
version of the specification released in year 20<var>xy</var> will be labelled
20<var>xy</var>R<var>n</var>.
</p>
<ol>
<li>Tuples types now use square brackets, rather than parentheses, as do tuple
binding patterns and tuple match patterns. Array constructors and tuple
constructors are now unified into list constructors, which use square brackets.
Tuple types can have zero members or one member, and can use <code>T...</code>
syntax allow trailing members of a specified type.</li>
<li>The way that record type descriptors express openness has changed. Instead
of the <code>!...</code> syntax, there are two flavours of record type
descriptor, which use different delimiters: <code>record {| |}</code> allows any
mapping that has exclusively the specified fields, whereas <code>record {
}</code> allows any mapping that includes the specified fields; the former can
use the <code>T...</code> syntax, whereas the latter cannot. The
<code>!...</code> is no longer allowed for record binding patterns and record
match patterns.</li>
<li>The syntax for an array with an array length that is inferred has changed
from <code>T[!...]</code> to <code>T[*]</code>.</li>
<li>A type descriptor of <code>error&lt;*&gt;</code> can be used to specify an
error type whose subtype is inferred.</li>
<li>A new expression can no longer be used to create values of structural types;
it is only allowed for objects.</li>
<li>Symbolic string literals <code>'ident</code> have been removed (compile time
constants provide a more convenient approach).</li>
<li>
<code>untaint</code> expression has been removed (this will be handled by
annotations instead).</li>
<li>The syntax for named arguments in a function call has reverted to
<code>arg=</code> from <code>arg:</code>, since the latter caused syntactic
ambiguities.</li>
<li>The syntax for error constructors specifies fields of the error detail
separately as named arguments, rather than specifying the error detail as a
single argument; the syntax for binding patterns and match patterns for error
values has also changed accordingly.</li>
<li>The error reason argument can be omitted from an error constructor if it
can be determined from the contextually expected type.</li>
<li>The syntax for annotation declarations has been revised; the places where
annotations are allowed has been revised to match the possible attachment
points.</li>
<li>An <code>.@</code> binary operator has been added for accessing annotations
at runtime.</li>
<li>A unary <code>typeof</code> operator has been added.</li>
<li>The <code>typedesc</code> type now takes an optional type parameter.</li>
<li>The type parameters for <code>future</code> and <code>stream</code> are now
optional.</li>
<li>The syntax for a function with an external implementation has changed to use
<code>=external</code> in place of the curly braces.</li>
<li>A numeric literal can use a suffix of <code>d</code> or <code>f</code> to
indicate that it represents a value belonging to the decimal or float type
respectively.</li>
<li>Record type descriptors may now specify a default value for fields.</li>
<li>Providing a default value for a parameter no longer affects whether a function
call must supply the argument for that parameter positionally or by name. Instead
the argument for any parameter can be supplied either positionally or by name.
To avoid ambiguity, all arguments specified positionally must be specified before
arguments specified by name.</li>
<li>Expressions specifying the default value for function parameters are not
compile time constants, and are evaluated each time they are used to supply a
missing argument.</li>
<li>In the argument list of a function or method call, positional arguments are
now required to be specified before named arguments.</li>
<li>Types may now be defined within a block.</li>
</ol>
</section>
<section>
<h3 id="section_B.6">B.6 Summary of changes from 0.980 to 0.990</h3>
<p>
<strong>Structural types and values</strong>
</p>
<ol>
<li>Concepts relating to typing of mutable structural values have been changed
in order to make type system sound.</li>
<li>The <code>match</code> statement has been redesigned.</li>
<li>The <code>but</code> expression has been removed.</li>
<li>The <code>is</code> expression for dynamic type testing has been added.</li>
<li>The type-cast-expr &lt;T&gt;E now performs unsafe type casts.The only
conversions it performs are numeric conversions.</li>
<li>The <code>anydata</code> type has been added, which is a union of simple and
structural types.</li>
<li>Records are now by default open to <code>anydata|error</code>, rather than
<code>any</code>.</li>
<li>Type parameters for built-in types (map, stream, future), which previously
defaulted to any, are now required.</li>
<li>The type parameter for json (e.g. json&lt;T&gt;) is not allowed any more.</li>
<li>Type for table columns are restricted to subtype of anydata|error.</li>
<li>There are now two flavors of equality operator: == and != for deep equality
(which is allowed only for <code>anydata</code>), and ===  and !== for exact
equality.</li>
<li>There is a built-in clone operation for performing a deep copy on values of
type anydata.</li>
<li>There is a built-in freeze operation for making structural values deeply
immutable.</li>
<li>Compile-time constants (which are always a subtype of anydata and frozen)
have been added.</li>
<li>Singleton types have been generalized: any compile-time constant can be made
into a singleton value.</li>
<li>Variables can be declared final, with a similar semantic to Java.</li>
<li>Errors are now immutable.</li>
<li>Module variables are not allowed to be public: only compile-time constants
can be public.</li>
</ol>
<p>
<strong>Error handling</strong>
</p>
<ol>
<li>The <code>any</code> type no longer includes <code>error</code>.</li>
<li>
<code>check</code> is now an expression.</li>
<li>Exceptions have been replaced by panics
<ol>
<li>the <code>throw</code> statement has been replaced by the <code>panic</code>
statement</li>
<li>the<code> try</code> statement has been replaced by the <code>trap</code>
expression</li>
</ol>
</li>
<li>Object constructors (which could not return errors) have been replaced by
<code>__init</code> methods (which can return errors).</li>
</ol>
<p>
<strong>Concurrency</strong>
</p>
<ol>
<li>Workers in functions have been redesigned. In particular, workers now have a
return value.</li>
<li>The <code>done</code> statement has been removed.</li>
<li>The fork/join statement has been redesigned.</li>
<li>A syntactic category between expression and statement, called action, has
been added.</li>
<li>A synchronous message send action has been added.</li>
<li>A flush action has been added to flush asynchronously sent messages.</li>
<li>A wait action has been added to wait for a worker and get its return value.</li>
<li>Futures have been unified with workers. A future&lt;T&gt; represents a value to
be returned by a named worker.</li>
<li>Error handling of message send/receive has been redesigned.</li>
</ol>
<p>
<strong>Endpoints and services</strong>
</p>
<ol>
<li>Client endpoints have been replaced by client objects, and actions on client
endpoints have been replaced by remote methods on client objects. Remote methods
are called using a remote method call action, which replaces the action
invocation statement.</li>
<li>Module endpoint declaration has been replaced by module listener
declaration, which uses the Listener built-in object type.</li>
<li>The service type has been added as a new basic type of behavioral value,
together with service constructor expressions for creating service values.</li>
<li>Module service definitions have been redesigned.</li>
</ol>
<p>
<strong>Miscellaneous changes</strong>
</p>
<ol>
<li>Public/private visibility qualifiers must be repeated on an outside method
definition.</li>
</ol>
</section>
<section>
<h3 id="section_B.7">B.7 Summary of changes from 0.970 to 0.980</h3>
<ol>
<li>The decimal type has been added.</li>
<li>There are no longer any implicit numeric conversions.</li>
<li>The type of a numeric literal can be inferred from the context.</li>
<li>The error type is now a distinct basic type.</li>
<li>The byte type has been added as a predefined subtype of int; blobs have been
replaced by arrays of bytes.</li>
<li>The syntax of string templates and xml literals has been revised and
harmonized.</li>
<li>The syntax of anonymous functions has been revised to provide two
alternative syntaxes: a full syntax similar to normal function definitions and a
more convenient arrow syntax for when the function body is an expression.</li>
<li>The cases of a match statement are required to be exhaustive.</li>
<li>The + operator is specified to do string and xml concatenation as well as
addition.</li>
<li>Bitwise operators have been added (<code>&lt;&lt;</code>, <code>&gt;&gt;</code>,
<code>&gt;&gt;&gt;</code>, <code>&amp;</code>, <code>|</code>, <code>^</code>,
<code>~</code>) rather than = after the argument name.</li>
<li>In a function call or method call, named arguments have changed to use
<code>:</code>
</li>
<li>A statement with <code>check</code> always handles an error by returning it,
not by throwing it.</li>
<li>
<code>check</code> is allowed in compound assignment statements.</li>
<li>Method names are now looked up differently from field names; values of types
other than objects can now have built-in methods.</li>
<li>The <code>lengthof</code> unary expression has been removed; the length
built-in method can be used instead.</li>
<li>The semantics of &lt;T&gt;expr have been specified.</li>
<li>The value space for tuples and arrays is now unified, in the same way as the
value space for records and maps was unified. This means that tuples are now
mutable. Array types can now have a length.</li>
<li>The <code>next</code> keyword has been changed to <code>continue</code>.</li>
<li>The syntax and semantics of destructuring is now done in a consistent way
for the but expression, the match statement, the foreach statement,
destructuring assignment statements and variable declarations.</li>
<li>The implied initial value is not used as a default initializer in variable
declarations. A local variable whose declaration omits the initializer must be
initialized by an assignment before it is used. A global variable declaration
must always have an initializer. A new expression can be used with any reference
type that has an implicit initial value.</li>
<li>Postfix increment and decrement statements have been removed.</li>
<li>The <code>...</code> and <code>..&lt;</code> operators have been added for
creating integer ranges; this replaces the foreach statement's special treatment
of integer ranges.</li>
<li>An object type can be declared to be abstract, meaning it cannot be used
with <code>new</code>.</li>
<li>By default,  a record type now allows extra fields other than those
explicitly mentioned; <code>T...</code> requires extra fields to be of type T
and <code>!...</code> disallows extra fields.</li>
<li>In a mapping constructor, an expression can be used for the field name by
enclosing the expression in square brackets (as in ECMAScript).</li>
<li>Integer arithmetic operations are specified to throw an exception on
overflow.</li>
<li>The syntax for documentation strings has changed.</li>
<li>The deprecated construct has been removed (data related to deprecation will
be provided by an annotation; documentation related to deprecation will be part
of the documentation string).</li>
<li>The order of fields, methods and constructors in object types is no longer
constrained.</li>
<li>A function or method can be defined as <code>extern</code>. The
<code>native</code> keyword has been removed.</li>
</ol>
</section>
</section>
<section class="appendix">
<h2 id="planned_future_functionality">C. Planned future functionality</h2>

<p>
The vision for the Ballerina language includes a range of functionality
that is not yet included in this specification.
</p>

<ul>
<li>
<em>Security</em> will combine language and platform features to make
programs secure by default.</li>
<li>
<em>Date/time basic types</em> will provide one or more basic types related
to date and time.</li>
<li>
<em>Event stream processing</em> will build on the <code>stream</code> type
to allow queries over timestamped sequences of events</li>
<li>
<em>Generic types</em> will provide types that can be instantiated with one
or more type parameters.</li>
<li>
<em>Flexible message passing</em> will support patterns of communication
between workers/strands, where the number of messages is not fixed and/or
workers are not peers.</li>
<li>
<em>Long-running processes</em> will allow the execution of a program to be
automatically suspended and then later resumed upon the occurrence of particular
external events.</li>
<li>
<em>Reliable messaging</em> will allow for sending messages across the
network with some guarantees about reliability.</li>
</ul>

<p>
<a href="https://github.com/ballerina-platform/ballerina-spec/blob/master/lang/proposals/README.md">Proposals</a>
for new language features relating to this and other functionality are
maintained in the specification's GitHub repository.
</p>

</section>

<section class="appendix">
<h2 id="contributors">D. Other contributors</h2>
<p>
The following contributed to establishing the design principles of the language:
</p>
<ul>
<li>Frank Leymann, <a href="mailto:frank.leymann@iaas.uni-stuttgart.de">frank.leymann@iaas.uni-stuttgart.de</a>
</li>
<li>Srinath Perera, <a href="mailto:srinath@wso2.com">srinath@wso2.com</a>
</li>
<li>Kasun Indrasiri, <a href="mailto:kasun@wso2.com">kasun@wso2.com</a>
</li>
</ul>
<p>
The following also contributed to the language in a variety of ways (in
alphabetical order):
</p>
<ul>
<li>Shafreen Anfar, <a href="mailto:shafreen@wso2.com">shafreen@wso2.com</a>
</li>
<li>Afkham Azeez, <a href="mailto:azeez@wso2.com">azeez@wso2.com</a>
</li>
<li>Anjana Fernando, <a href="mailto:anjana@wso2.com">anjana@wso2.com</a>
</li>
<li>Chanaka Fernando, <a href="mailto:chanakaf@wso2.com">chanakaf@wso2.com</a>
</li>
<li>Joseph Fonseka, <a href="mailto:joseph@wso2.com">joseph@wso2.com</a>
</li>
<li>Paul Fremantle, <a href="mailto:paul@wso2.com">paul@wso2.com</a>
</li>
<li>Antony Hosking, <a href="mailto:antony.hosking@anu.edu.au">antony.hosking@anu.edu.au</a>
</li>
<li>Tyler Jewell, <a href="mailto:tylerjewell@gmail.com">tylerjewell@gmail.com</a>
</li>
<li>Anupama Pathirage, <a href="mailto:anupama@wso2.com">anupama@wso2.com</a>
</li>
<li>Manuranga Perera, <a href="mailto:manu@wso2.com">manu@wso2.com</a>
</li>
<li>Supun Thilina Sethunga, <a href="mailto:supuns@wso2.com">supuns@wso2.com</a>
</li>
<li>Sriskandarajah Suhothayan, <a href="mailto:suho@wso2.com">suho@wso2.com</a>
</li>
<li>Isuru Udana, <a href="mailto:isuruu@wso2.com">isuruu@wso2.com</a>
</li>
<li>Rajith Lanka Vitharana, <a href="mailto:rajithv@wso2.com">rajithv@wso2.com</a>
</li>
<li>Mohanadarshan Vivekanandalingam, <a href="mailto:mohan@wso2.com">mohan@wso2.com</a>
</li>
<li>Lakmal Warusawithana, <a href="mailto:lakmal@wso2.com">lakmal@wso2.com</a>
</li>
<li>Ayoma Wijethunga, <a href="mailto:ayoma@wso2.com">ayoma@wso2.com</a>
</li>
</ul>
</section>
</body>
</html>
</div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{},"content":"\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n  \u003ctitle\u003eBallerina Language Specification\u003c/title\u003e\n  \u003cmeta charset=\"utf-8\"\u003e\n  \u003cstyle type=\"text/css\"\u003e\n    body { font-family: sans-serif; line-height: 1.38;  }\n    pre.grammar code, code.grammar { background-color: #D0D0D0; }\n    pre, code { font-family: Consolas, monospace; }\n    table { border: solid thin; border-collapse: collapse; }\n    td, th { border: solid thin; padding: 0.5em; }\n    p.status { font-size: large; font-weight: bold; }\n  \u003c/style\u003e\n\u003clink rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i\u0026amp;display=swap\"\u003e\n\u003clink rel=\"stylesheet\" href=\"style/ballerina-language-specification.css\"\u003e\n\u003cscript src=\"https://code.jquery.com/jquery-2.2.4.min.js\"\u003e\u003c/script\u003e\u003cscript src=\"style/ballerina-language-specification.js\"\u003e\u003c/script\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003ch1\u003eBallerina Language Specification, 2021R1\u003c/h1\u003e\n\u003cp\u003e\nPrimary contributors:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eJames Clark, \u003ca href=\"mailto:jjc@jclark.com\"\u003ejjc@jclark.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eSanjiva Weerawarana, \u003ca href=\"mailto:sanjiva@weerawarana.org\"\u003esanjiva@weerawarana.org\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eSameera Jayasoma, \u003ca href=\"mailto:sameera@wso2.com\"\u003esameera@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eHasitha Aravinda, \u003ca href=\"mailto:hasitha@wso2.com\"\u003ehasitha@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\n(Other contributors are listed in \u003ca href=\"#contributors\"\u003eAppendix D\u003c/a\u003e.)\n\u003c/p\u003e\n\u003cp\u003e\nCopyright Â© 2018-2021 \u003ca href=\"https://wso2.com/\"\u003eWSO2\u003c/a\u003e\n\u003c/p\u003e\n\u003cp\u003e\nLicensed under the \u003ca href=\"https://creativecommons.org/licenses/by-nd/4.0/\"\u003eCreative Commons\nAttribution-NoDerivatives 4.0 International\u003c/a\u003e license\n\u003c/p\u003e\n\u003cp class=\"status\"\u003e\nLanguage and document status\n\u003c/p\u003e\n\u003cp\u003e\nThe language described in this specification is now stable. We do not plan to\nmake changes that introduce significant incompatibilities.\n\u003c/p\u003e\n\u003cp\u003e\nComments on this document are welcome and should be made by creating an issue in\n\u003ccode\u003e\u003ca href=\"https://github.com/ballerina-platform/ballerina-spec\"\u003ehttps://github.com/ballerina-platform/ballerina-spec\u003c/a\u003e\u003c/code\u003e, which is the\nGitHub repository where this specification is maintained.\n\u003c/p\u003e\n\u003csection class=\"toc\"\u003e\u003ch2\u003eTable of contents\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e1. \u003ca href=\"#introduction\"\u003eIntroduction\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e2. \u003ca href=\"#notation\"\u003eNotation\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e3. \u003ca href=\"#program_structure\"\u003eProgram structure\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e4. \u003ca href=\"#lexical_structure\"\u003eLexical structure\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5. \u003ca href=\"#values_types\"\u003eValues, types and variables\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e5.1 \u003ca href=\"#section_5.1\"\u003eOverview\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e5.1.1 \u003ca href=\"#section_5.1.1\"\u003eType system fundamentals\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.1.2 \u003ca href=\"#section_5.1.2\"\u003eMutation\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.1.3 \u003ca href=\"#section_5.1.3\"\u003eIsolation\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.1.4 \u003ca href=\"#section_5.1.4\"\u003eType descriptors\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.1.5 \u003ca href=\"#section_5.1.5\"\u003eType-ids\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.1.6 \u003ca href=\"#section_5.1.6\"\u003eIterability\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e5.2 \u003ca href=\"#section_5.2\"\u003eSimple values\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e5.2.1 \u003ca href=\"#section_5.2.1\"\u003eNil\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.2.2 \u003ca href=\"#section_5.2.2\"\u003eBoolean\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.2.3 \u003ca href=\"#section_5.2.3\"\u003eInt\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.2.4 \u003ca href=\"#section_5.2.4\"\u003eFloating point types\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e5.2.4.1 \u003ca href=\"#section_5.2.4.1\"\u003eFloat\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.2.4.2 \u003ca href=\"#section_5.2.4.2\"\u003eDecimal\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e5.3 \u003ca href=\"#section_5.3\"\u003eSequence values\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e5.3.1 \u003ca href=\"#section_5.3.1\"\u003eStrings\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.3.2 \u003ca href=\"#XML\"\u003eXML\u003c/a\u003e\u003cul\u003e\u003cli\u003e5.3.2.1 \u003ca href=\"#section_5.3.2.1\"\u003eXML namespaces\u003c/a\u003e\n\u003c/li\u003e\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e5.4 \u003ca href=\"#section_5.4\"\u003eStructured values\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e5.4.1 \u003ca href=\"#section_5.4.1\"\u003eLists\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e5.4.1.1 \u003ca href=\"#section_5.4.1.1\"\u003eArray types\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.4.1.2 \u003ca href=\"#section_5.4.1.2\"\u003eTuple types\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e5.4.2 \u003ca href=\"#section_5.4.2\"\u003eMappings\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e5.4.2.1 \u003ca href=\"#section_5.4.2.1\"\u003eMap types\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.4.2.2 \u003ca href=\"#section_5.4.2.2\"\u003eRecord types\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e5.4.3 \u003ca href=\"#tables\"\u003eTables\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e5.5 \u003ca href=\"#section_5.5\"\u003eBehavioral values\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e5.5.1 \u003ca href=\"#section_5.5.1\"\u003eErrors\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.5.2 \u003ca href=\"#functions\"\u003eFunctions\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.5.3 \u003ca href=\"#section_5.5.3\"\u003eObjects\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e5.5.3.1 \u003ca href=\"#section_5.5.3.1\"\u003eNetwork interaction\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.5.3.2 \u003ca href=\"#section_5.5.3.2\"\u003eFields\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.5.3.3 \u003ca href=\"#section_5.5.3.3\"\u003eMethods\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.5.3.4 \u003ca href=\"#section_5.5.3.4\"\u003eVisibility\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.5.3.5 \u003ca href=\"#section_5.5.3.5\"\u003eTyping\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.5.3.6 \u003ca href=\"#section_5.5.3.6\"\u003eInclusion and type-ids\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e5.5.4 \u003ca href=\"#section_5.5.4\"\u003eFutures\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.5.5 \u003ca href=\"#section_5.5.5\"\u003eType descriptors\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.5.6 \u003ca href=\"#section_5.5.6\"\u003eHandles\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.5.7 \u003ca href=\"#section_5.5.7\"\u003eStreams\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e5.6 \u003ca href=\"#section_5.6\"\u003eOther type descriptors\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e5.6.1 \u003ca href=\"#section_5.6.1\"\u003eType reference\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.6.2 \u003ca href=\"#section_5.6.2\"\u003eSingleton types\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.6.3 \u003ca href=\"#section_5.6.3\"\u003eAny type\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.6.4 \u003ca href=\"#section_5.6.4\"\u003eNever type\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.6.5 \u003ca href=\"#section_5.6.5\"\u003eReadonly type\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.6.6 \u003ca href=\"#distinct_types\"\u003eDistinct types\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.6.7 \u003ca href=\"#section_5.6.7\"\u003eUnion types\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.6.8 \u003ca href=\"#section_5.6.8\"\u003eIntersection types\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.6.9 \u003ca href=\"#section_5.6.9\"\u003eOptional types\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.6.10 \u003ca href=\"#anydata\"\u003eAnydata type\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.6.11 \u003ca href=\"#section_5.6.11\"\u003eJSON types\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.6.12 \u003ca href=\"#byte_type\"\u003eByte type\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e5.7 \u003ca href=\"#built-in_object_types\"\u003eBuilt-in object types\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e5.7.1 \u003ca href=\"#section_5.7.1\"\u003eIterator\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.7.2 \u003ca href=\"#section_5.7.2\"\u003eIterable\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.7.3 \u003ca href=\"#StreamImplementor\"\u003eStreamImplementor\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.7.4 \u003ca href=\"#section_5.7.4\"\u003eListener\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.7.5 \u003ca href=\"#section_5.7.5\"\u003eRawTemplate\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.7.6 \u003ca href=\"#section_5.7.6\"\u003eRetryManager\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e5.8 \u003ca href=\"#section_5.8\"\u003eAbstract operations\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e5.8.1 \u003ca href=\"#FillMember\"\u003eFillMember\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.8.2 \u003ca href=\"#Cloning\"\u003eCloning\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e5.8.2.1 \u003ca href=\"#Clone\"\u003eClone\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.8.2.2 \u003ca href=\"#ImmutableClone\"\u003eImmutableClone\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e5.8.3 \u003ca href=\"#DeepEquals\"\u003eDeepEquals\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.8.4 \u003ca href=\"#section_5.8.4\"\u003eNumericConvert\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.8.5 \u003ca href=\"#ToString\"\u003eToString\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.8.6 \u003ca href=\"#ordering\"\u003eOrdering\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e5.9 \u003ca href=\"#section_5.9\"\u003eBinding patterns and variables\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e5.9.1 \u003ca href=\"#section_5.9.1\"\u003eBinding patterns\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.9.2 \u003ca href=\"#section_5.9.2\"\u003eTyped binding patterns\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e5.9.3 \u003ca href=\"#section_5.9.3\"\u003eVariable and identifier scoping\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e6. \u003ca href=\"#expressions\"\u003eExpressions\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e6.1 \u003ca href=\"#section_6.1\"\u003eExpression evaluation\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.2 \u003ca href=\"#section_6.2\"\u003eStatic typing of expressions\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e6.2.1 \u003ca href=\"#lax_static_typing\"\u003eLax static typing\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.2.2 \u003ca href=\"#section_6.2.2\"\u003eContextually expected type\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.2.3 \u003ca href=\"#section_6.2.3\"\u003ePrecise and broad types\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.2.4 \u003ca href=\"#section_6.2.4\"\u003eIsolated expressions\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e6.3 \u003ca href=\"#section_6.3\"\u003eCasting and conversion\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.4 \u003ca href=\"#section_6.4\"\u003eConstant expressions\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.5 \u003ca href=\"#section_6.5\"\u003eLiterals\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.6 \u003ca href=\"#section_6.6\"\u003eTemplate expressions\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e6.6.1 \u003ca href=\"#section_6.6.1\"\u003eString template expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.6.2 \u003ca href=\"#section_6.6.2\"\u003eXML template expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.6.3 \u003ca href=\"#section_6.6.3\"\u003eRaw template expression\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e6.7 \u003ca href=\"#section_6.7\"\u003eStructural constructors\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e6.7.1 \u003ca href=\"#section_6.7.1\"\u003eList constructor\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.7.2 \u003ca href=\"#section_6.7.2\"\u003eMapping constructor\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.7.3 \u003ca href=\"#section_6.7.3\"\u003eTable constructor\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e6.8 \u003ca href=\"#section_6.8\"\u003eObject construction\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e6.8.1 \u003ca href=\"#section_6.8.1\"\u003eObject constructor\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e6.8.1.1 \u003ca href=\"#section_6.8.1.1\"\u003eFields\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.8.1.2 \u003ca href=\"#section_6.8.1.2\"\u003eMethods\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.8.1.3 \u003ca href=\"#resources\"\u003eResources\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.8.1.4 \u003ca href=\"#section_6.8.1.4\"\u003eInitialization\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e6.8.2 \u003ca href=\"#section_6.8.2\"\u003eNew expression\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e6.9 \u003ca href=\"#section_6.9\"\u003eVariable reference expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.10 \u003ca href=\"#section_6.10\"\u003eField access expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.11 \u003ca href=\"#section_6.11\"\u003eOptional field access expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.12 \u003ca href=\"#section_6.12\"\u003eXML attribute access expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.13 \u003ca href=\"#section_6.13\"\u003eAnnotation access expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.14 \u003ca href=\"#section_6.14\"\u003eMember access expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.15 \u003ca href=\"#function_call\"\u003eFunction call expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.16 \u003ca href=\"#section_6.16\"\u003eMethod call expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.17 \u003ca href=\"#section_6.17\"\u003eError constructor\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.18 \u003ca href=\"#section_6.18\"\u003eAnonymous function expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.19 \u003ca href=\"#section_6.19\"\u003eLet expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.20 \u003ca href=\"#section_6.20\"\u003eType cast expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.21 \u003ca href=\"#section_6.21\"\u003eTypeof expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.22 \u003ca href=\"#section_6.22\"\u003eUnary expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.23 \u003ca href=\"#section_6.23\"\u003eMultiplicative expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.24 \u003ca href=\"#section_6.24\"\u003eAdditive expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.25 \u003ca href=\"#section_6.25\"\u003eShift expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.26 \u003ca href=\"#section_6.26\"\u003eRange expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.27 \u003ca href=\"#section_6.27\"\u003eRelational expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.28 \u003ca href=\"#section_6.28\"\u003eType test expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.29 \u003ca href=\"#section_6.29\"\u003eEquality expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.30 \u003ca href=\"#section_6.30\"\u003eBinary bitwise expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.31 \u003ca href=\"#section_6.31\"\u003eLogical expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.32 \u003ca href=\"#section_6.32\"\u003eConditional expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.33 \u003ca href=\"#section_6.33\"\u003eChecking expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.34 \u003ca href=\"#section_6.34\"\u003eTrap expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.35 \u003ca href=\"#section_6.35\"\u003eQuery expression\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e6.35.1 \u003ca href=\"#section_6.35.1\"\u003eFrom clause\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.35.2 \u003ca href=\"#section_6.35.2\"\u003eWhere clause\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.35.3 \u003ca href=\"#section_6.35.3\"\u003eLet clause\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.35.4 \u003ca href=\"#section_6.35.4\"\u003eJoin clause\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.35.5 \u003ca href=\"#section_6.35.5\"\u003eOrder by clause\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.35.6 \u003ca href=\"#section_6.35.6\"\u003eLimit clause\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.35.7 \u003ca href=\"#section_6.35.7\"\u003eSelect clause\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.35.8 \u003ca href=\"#section_6.35.8\"\u003eOn conflict clause\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e6.36 \u003ca href=\"#section_6.36\"\u003eXML navigation expression\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e6.36.1 \u003ca href=\"#section_6.36.1\"\u003eXML name pattern\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.36.2 \u003ca href=\"#section_6.36.2\"\u003eXML filter expression\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e6.36.3 \u003ca href=\"#section_6.36.3\"\u003eXML step expression\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e6.37 \u003ca href=\"#section_6.37\"\u003eTransactional expression\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e7. \u003ca href=\"#actions_statements\"\u003eActions and statements\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e7.1 \u003ca href=\"#section_7.1\"\u003eActions\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.2 \u003ca href=\"#section_7.2\"\u003eThreads and strands\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.3 \u003ca href=\"#section_7.3\"\u003eFunction bodies\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e7.3.1 \u003ca href=\"#section_7.3.1\"\u003eFunction parameters\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.3.2 \u003ca href=\"#section_7.3.2\"\u003eWorkers\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.3.3 \u003ca href=\"#section_7.3.3\"\u003eExpression-bodied functions\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.3.4 \u003ca href=\"#section_7.3.4\"\u003eExternal functions\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.3.5 \u003ca href=\"#isolated_functions\"\u003eIsolated functions\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e7.4 \u003ca href=\"#section_7.4\"\u003eStatement execution\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.5 \u003ca href=\"#section_7.5\"\u003eFork statement\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.6 \u003ca href=\"#section_7.6\"\u003eStart action\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.7 \u003ca href=\"#section_7.7\"\u003eWait action\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e7.7.1 \u003ca href=\"#section_7.7.1\"\u003eSingle wait action\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.7.2 \u003ca href=\"#section_7.7.2\"\u003eMultiple wait action\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.7.3 \u003ca href=\"#section_7.7.3\"\u003eAlternate wait action \u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e7.8 \u003ca href=\"#section_7.8\"\u003eWorker message passing\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e7.8.1 \u003ca href=\"#section_7.8.1\"\u003eSend action\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.8.2 \u003ca href=\"#section_7.8.2\"\u003eReceive action\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e7.8.2.1 \u003ca href=\"#section_7.8.2.1\"\u003eSingle receive action\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.8.2.2 \u003ca href=\"#section_7.8.2.2\"\u003eMultiple receive action\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e7.8.3 \u003ca href=\"#section_7.8.3\"\u003eFlush action\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.8.4 \u003ca href=\"#section_7.8.4\"\u003eSend-receive correspondence\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e7.9 \u003ca href=\"#section_7.9\"\u003eOutbound network interaction\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.10 \u003ca href=\"#section_7.10\"\u003eQuery action\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.11 \u003ca href=\"#section_7.11\"\u003eLocal variable declaration statements\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.12 \u003ca href=\"#conditional_variable_type_narrowing\"\u003eConditional variable type narrowing\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.13 \u003ca href=\"#XML_namespace_declaration_statement\"\u003eXML namespace declaration statement\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.14 \u003ca href=\"#section_7.14\"\u003eAssignment\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e7.14.1 \u003ca href=\"#section_7.14.1\"\u003eLvalues\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.14.2 \u003ca href=\"#section_7.14.2\"\u003eAssignment statement\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.14.3 \u003ca href=\"#section_7.14.3\"\u003eCompound assignment statement\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.14.4 \u003ca href=\"#section_7.14.4\"\u003eDestructuring assignment statement\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e7.15 \u003ca href=\"#section_7.15\"\u003eAction statement\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.16 \u003ca href=\"#section_7.16\"\u003eCall statement\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.17 \u003ca href=\"#section_7.17\"\u003eConditional statement\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.18 \u003ca href=\"#section_7.18\"\u003eDo statement\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.19 \u003ca href=\"#match_statement\"\u003eMatch statement\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.20 \u003ca href=\"#section_7.20\"\u003eLoops\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e7.20.1 \u003ca href=\"#section_7.20.1\"\u003eForeach statement\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.20.2 \u003ca href=\"#section_7.20.2\"\u003eWhile statement\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.20.3 \u003ca href=\"#section_7.20.3\"\u003eContinue statement\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.20.4 \u003ca href=\"#section_7.20.4\"\u003eBreak statement\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e7.21 \u003ca href=\"#lock_statement\"\u003eLock statement\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.22 \u003ca href=\"#section_7.22\"\u003eFail and retry\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e7.22.1 \u003ca href=\"#section_7.22.1\"\u003eFail statement\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.22.2 \u003ca href=\"#section_7.22.2\"\u003eOn fail clause\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.22.3 \u003ca href=\"#section_7.22.3\"\u003eRetry statement\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e7.23 \u003ca href=\"#transactions\"\u003eTransactions\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e7.23.1 \u003ca href=\"#section_7.23.1\"\u003eTransaction manager\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e7.23.1.1 \u003ca href=\"#section_7.23.1.1\"\u003eBegin operation\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.23.1.2 \u003ca href=\"#section_7.23.1.2\"\u003eCommit operation\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.23.1.3 \u003ca href=\"#section_7.23.1.3\"\u003eRollback operation\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e7.23.2 \u003ca href=\"#section_7.23.2\"\u003eTransaction statement\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.23.3 \u003ca href=\"#section_7.23.3\"\u003eRetry transaction statement\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.23.4 \u003ca href=\"#section_7.23.4\"\u003eCommit action\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.23.5 \u003ca href=\"#section_7.23.5\"\u003eRollback statement\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e7.24 \u003ca href=\"#section_7.24\"\u003ePanic statement\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e7.25 \u003ca href=\"#section_7.25\"\u003eReturn statement\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e8. \u003ca href=\"#module_level\"\u003eModule-level declarations\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e8.1 \u003ca href=\"#section_8.1\"\u003eImport declaration\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e8.2 \u003ca href=\"#section_8.2\"\u003eModule and program execution\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e8.3 \u003ca href=\"#listeners_and_services\"\u003eListeners and services\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e8.3.1 \u003ca href=\"#section_8.3.1\"\u003eListener declaration\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e8.3.2 \u003ca href=\"#section_8.3.2\"\u003eService declaration\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e8.3.3 \u003ca href=\"#section_8.3.3\"\u003eIsolated inference\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e8.4 \u003ca href=\"#section_8.4\"\u003eFunction definition\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e8.5 \u003ca href=\"#section_8.5\"\u003eModule type definition\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e8.6 \u003ca href=\"#section_8.6\"\u003eModule class definition\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e8.7 \u003ca href=\"#section_8.7\"\u003eModule variable declaration\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e8.8 \u003ca href=\"#section_8.8\"\u003eModule constant declaration\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e8.9 \u003ca href=\"#section_8.9\"\u003eModule enumeration declaration\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e8.10 \u003ca href=\"#section_8.10\"\u003eModule XML namespace declaration\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e9. \u003ca href=\"#metadata\"\u003eMetadata\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e9.1 \u003ca href=\"#section_9.1\"\u003eAnnotations\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e9.2 \u003ca href=\"#section_9.2\"\u003eDocumentation\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e9.3 \u003ca href=\"#section_9.3\"\u003eBallerina Flavored Markdown\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e10. \u003ca href=\"#lang_library\"\u003eLang library\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e10.1 \u003ca href=\"#section_10.1\"\u003eGeneric types\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.2 \u003ca href=\"#built-in_subtypes\"\u003eBuilt-in subtypes\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.3 \u003ca href=\"#section_10.3\"\u003eLang library modules\u003c/a\u003e\u003cul\u003e\n\u003cli\u003e10.3.1 \u003ca href=\"#lang.array\"\u003e\u003ccode\u003elang.array\u003c/code\u003e module\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.3.2 \u003ca href=\"#lang.boolean\"\u003e\u003ccode\u003elang.boolean\u003c/code\u003e module\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.3.3 \u003ca href=\"#lang.decimal\"\u003e\u003ccode\u003elang.decimal\u003c/code\u003e module\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.3.4 \u003ca href=\"#lang.error\"\u003e\u003ccode\u003elang.error\u003c/code\u003e module\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.3.5 \u003ca href=\"#lang.float\"\u003e\u003ccode\u003elang.float\u003c/code\u003e module\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.3.6 \u003ca href=\"#lang.future\"\u003e\u003ccode\u003elang.future\u003c/code\u003e module\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.3.7 \u003ca href=\"#lang.int\"\u003e\u003ccode\u003elang.int\u003c/code\u003e module\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.3.8 \u003ca href=\"#lang.map\"\u003e\u003ccode\u003elang.map\u003c/code\u003e module\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.3.9 \u003ca href=\"#lang.object\"\u003e\u003ccode\u003elang.object\u003c/code\u003e module\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.3.10 \u003ca href=\"#lang.stream\"\u003e\u003ccode\u003elang.stream\u003c/code\u003e module\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.3.11 \u003ca href=\"#lang.string\"\u003e\u003ccode\u003elang.string\u003c/code\u003e module\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.3.12 \u003ca href=\"#lang.table\"\u003e\u003ccode\u003elang.table\u003c/code\u003e module\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.3.13 \u003ca href=\"#lang.typedesc\"\u003e\u003ccode\u003elang.typedesc\u003c/code\u003e module\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.3.14 \u003ca href=\"#lang.xml\"\u003e\u003ccode\u003elang.xml\u003c/code\u003e module\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.3.15 \u003ca href=\"#lang.transaction\"\u003e\u003ccode\u003elang.transaction\u003c/code\u003e module\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.3.16 \u003ca href=\"#lang.runtime\"\u003e\u003ccode\u003elang.runtime\u003c/code\u003e module\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e10.3.17 \u003ca href=\"#lang.value\"\u003e\u003ccode\u003elang.value\u003c/code\u003e module\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eA. \u003ca href=\"#references\"\u003eReferences\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eB. \u003ca href=\"#changes\"\u003eChanges since previous releases\u003c/a\u003e\u003cul\u003e\n\u003cli\u003eB.1 \u003ca href=\"#section_B.1\"\u003eSummary of changes from 2020R1 to 2021R1\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eB.2 \u003ca href=\"#section_B.2\"\u003eSummary of changes from 2019R3 to 2020R1\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eB.3 \u003ca href=\"#section_B.3\"\u003eSummary of changes from 2019R2 to 2019R3\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eB.4 \u003ca href=\"#section_B.4\"\u003eSummary of changes from 2019R1 to 2019R2\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eB.5 \u003ca href=\"#section_B.5\"\u003eSummary of changes from 0.990 to 2019R1\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eB.6 \u003ca href=\"#section_B.6\"\u003eSummary of changes from 0.980 to 0.990\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eB.7 \u003ca href=\"#section_B.7\"\u003eSummary of changes from 0.970 to 0.980\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eC. \u003ca href=\"#planned_future_functionality\"\u003ePlanned future functionality\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eD. \u003ca href=\"#contributors\"\u003eOther contributors\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\u003c/section\u003e\n\u003csection\u003e\n\u003ch2 id=\"introduction\"\u003e1. Introduction\u003c/h2\u003e\n\u003cp\u003e\nBallerina is a statically typed, concurrent programming language, focusing on\nnetwork interaction and structured data. It is intended to be the core of a\nlanguage-centric middleware platform. It has all the general-purpose\nfunctionality expected of a modern programming language, but it also has several\nunusual aspects that make it particularly suitable for its intended purpose.\n\u003c/p\u003e\n\u003cp\u003e\nFirst, it provides language constructs specifically for consuming and providing\nnetwork services. Future versions of Ballerina will add language constructs for\nother middleware functionality such as event stream processing and reliable\nmessaging; this is described in more detail in \u003ca href=\"#planned_future_functionality\"\u003eAppendix C\u003c/a\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nSecond, its abstractions and syntax for concurrency and network interaction have\nbeen designed so that there is a close correspondence with sequence diagrams.\nThis enables a bidirectional mapping for any Ballerina function between its\ntextual representation in the syntax described in this specification and its\ngraphical representation as a sequence diagram, such that the sequence diagram\nfully shows the aspects of the behavior of that function that relate to\nconcurrency and network interaction.\n\u003c/p\u003e\n\u003cp\u003e\nThird, it has a type system that is more flexible and allows for looser coupling\nthan traditional statically typed languages. The type system is structural:\ninstead of requiring the program to explicitly say which types are compatible\nwith each other, compatibility of types and values is determined automatically\nbased on their structure; this is particularly useful when combining data from\nmultiple, independently-designed systems. In addition, the type system provides\nunion types and open records. This flexibility allows the type system to be used\nas a schema for the data that is exchanged in distributed applications.\nBallerina's data types are designed to work particularly well with JSON; any\nJSON value has a direct, natural representation as a Ballerina value. Ballerina\nalso provides support for XML and tabular data.\n\u003c/p\u003e\n\u003cp\u003e\nBallerina is not a research language. It is intended to be a pragmatic language\nsuitable for mass-market commercial adoption. It tries to feel familiar to\nprogrammers who are used to popular, modern C-family languages, notably Java, C#\nand JavaScript. It also gets ideas and inspiration from many other existing\nprogramming languages including TypeScript, Go, Rust, D, Kotlin, Swift, Python\nand Perl.\n\u003c/p\u003e\n\u003cp\u003e\nThe Ballerina language has been designed in conjunction with the Ballerina\nplatform, which provides comprehensive support for a module-based software\ndevelopment model, including versioning, dependency management, testing,\ndocumentation, building and sharing. Modules are organized into repositories;\nthere is a globally-shared, central repository, but repositories can also be\nlocal.\n\u003c/p\u003e\n\u003cp\u003e\nThe Ballerina language includes a small library, the lang library, which\nprovides fundamental operations on the data types defined by the language; the\nlang library is defined by this specification. The Ballerina platform includes\nan extensive standard library, which includes not only the usual low-level,\ngeneral-purpose functionality, but also support for a wide variety of network\nprotocols, interface standards, data formats and authentication/authorization\nstandards, which make writing secure, resilient distributed applications\nsignificantly easier than with other languages. The standard library is not\nspecified in this document.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch2 id=\"notation\"\u003e2. Notation\u003c/h2\u003e\n\u003cp\u003e\nProductions are written in the form:\n\u003c/p\u003e\n\n\u003cpre\u003esymbol := rhs\n\u003c/pre\u003e\n\u003cp\u003e\nwhere symbol is the name of a nonterminal, and \u003ccode\u003erhs\u003c/code\u003e is as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e0xX\u003c/code\u003e means the single character whose Unicode code point is\ndenoted by the hexadecimal numeral X\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e^x\u003c/code\u003e means any single Unicode code point that does not match x\nand is not a disallowed character;\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003ex..y\u003c/code\u003e means any single Unicode character whose code point is\ngreater than or equal to that of x and less than or equal to that of y\u003c/li\u003e\n\u003cli\u003e\n\u003ccode class=\"grammar\"\u003estr\u003c/code\u003e means the characters \u003ccode\u003estr\u003c/code\u003e literally\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003esymbol \u003c/code\u003emeans a reference to production for the nonterminal\n\u003ccode\u003esymbol\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003ex|y\u003c/code\u003e means x or y\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003ex\u0026amp;y\u003c/code\u003e means x and y, interleaved in any order\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e[x]\u003c/code\u003e means zero or one times\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003ex?\u003c/code\u003e means x zero or one times\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003ex*\u003c/code\u003e means x zero or more times\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003ex+\u003c/code\u003e means x one or more times\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e(x)\u003c/code\u003e means x (grouping)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe \u003ccode\u003erhs\u003c/code\u003e of a symbol that starts with a lower-case letter implicitly allows white\nspace and comments, as defined by the production \u003ccode\u003eTokenWhiteSpace\u003c/code\u003e,\nbetween the terminals and nonterminals that it references.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch2 id=\"program_structure\"\u003e3. Program structure\u003c/h2\u003e\n\u003cp\u003e\nA Ballerina program is divided into modules. A module has a source form and a\nbinary form. The source form of a module consists of an ordered collection of\none or more source parts; each source part is a sequence of bytes that is the\nUTF-8 encoding of part of the source code for the module. The format of a source\npart is defined by this specification. The format of a binary module is\nspecified by the Ballerina platform.\n\u003c/p\u003e\n\u003cp\u003e\nA source module can reference other modules. Each source module can be\nseparately compiled into a binary module: compilation of a source module needs\naccess only to the binary form of other modules referenced from the source\nmodule. A source module identifies each module that it references using an\norganization name and a module name, which is divided into one or more parts.\nBoth the organization name and each part of the module name are Unicode strings.\nAny organization name starting with the string \u003ccode\u003eballerina\u003c/code\u003e is\nreserved for use by the Ballerina platform.\n\u003c/p\u003e\n\u003cp\u003e\nThe Ballerina platform defines a packaging system for Ballerina modules, which\nallows one or more modules to be combined into a package. The packaging system\ntreats the first part of each module's name as being a package name. All the\nmodules combined into a package share the same package name. Packages have both\na source and a binary format. The source format stores the source form of a\npackage's modules in a hierarchical filesystem. The binary format stores the\nbinary form of a package's module as a sequence of bytes.\n\u003c/p\u003e\n\u003cp\u003e\nBinary packages can be stored in a package repository. Packages are versioned;\nversions are semantic, as described in the SemVer specification. A package\nrepository can store multiple versions of the same package. Thus, within a\nrepository, binary packages are organized into a three-level hierarchy:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eorganization;\u003c/li\u003e\n\u003cli\u003epackage name;\u003c/li\u003e\n\u003cli\u003eversion.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\nThe source format of a package includes a \u003ccode\u003eBallerina.toml\u003c/code\u003e file that\nallows control over the package versions used for referenced modules.\n\u003c/p\u003e\n\u003cp\u003e\nThe packaging system also allows control over which modules are exported from a\npackage; modules that are not exported from a package are visible only to\nmodules within the package.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch2 id=\"lexical_structure\"\u003e4. Lexical structure\u003c/h2\u003e\n\u003cp\u003e\nThe grammar in this document specifies how a sequence of Unicode code points is\ninterpreted as part of the source of a Ballerina module. A Ballerina module part\nis a sequence of octets (8-bit bytes); this sequence of octets is interpreted as\nthe UTF-8 encoding of a sequence of code points and must comply with the\nrequirements of RFC 3629.\n\u003c/p\u003e\n\u003cp\u003e\nAfter the sequence of octets is decoded from UTF-8, the following two\ntransformations must be performed before it is parsed using the grammar in this\ndocument:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eif the sequence starts with a byte order mark (code point 0xFEFF), it must\nbe removed\u003c/li\u003e\n\u003cli\u003enewlines are normalized as follows:\n\u003cul\u003e\n\u003cli\u003ethe two character sequence 0xD 0xA is replaced by 0xA\u003c/li\u003e\n\u003cli\u003ea single 0xD character that is not followed by 0xD is replaced by 0xA\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe sequence of code points must not contain any of the following disallowed\ncode points:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003esurrogates (0xD800 to 0xDFFF)\u003c/li\u003e\n\u003cli\u003enon-characters (the 66 code points that Unicode designates as\nnon-characters)\u003c/li\u003e\n\u003cli\u003eC0 control characters (0x0 to 0x1F and 0x1F) other than whitespace (0x9,\n0xA, 0xC, 0xD)\u003c/li\u003e\n\u003cli\u003eC1 control characters (0x80 to 0x9F)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nNote that the grammar notation ^X does not allow the above disallowed code\npoints.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"identifier\"\u003eidentifier\u003c/span\u003e := \u003ca href=\"#UnquotedIdentifier\"\u003e\u003cspan class=\"ntref\"\u003eUnquotedIdentifier\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#QuotedIdentifier\"\u003e\u003cspan class=\"ntref\"\u003eQuotedIdentifier\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"UnquotedIdentifier\"\u003eUnquotedIdentifier\u003c/span\u003e := (\u003ca href=\"#IdentifierInitialChar\"\u003e\u003cspan class=\"ntref\"\u003eIdentifierInitialChar\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#IdentifierEscape\"\u003e\u003cspan class=\"ntref\"\u003eIdentifierEscape\u003c/span\u003e\u003c/a\u003e) (\u003ca href=\"#IdentifierFollowingChar\"\u003e\u003cspan class=\"ntref\"\u003eIdentifierFollowingChar\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#IdentifierEscape\"\u003e\u003cspan class=\"ntref\"\u003eIdentifierEscape\u003c/span\u003e\u003c/a\u003e)*\n\u003cspan class=\"ntdfn\" id=\"QuotedIdentifier\"\u003eQuotedIdentifier\u003c/span\u003e := \u003ccode\u003e'\u003c/code\u003e (\u003ca href=\"#IdentifierFollowingChar\"\u003e\u003cspan class=\"ntref\"\u003eIdentifierFollowingChar\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#IdentifierEscape\"\u003e\u003cspan class=\"ntref\"\u003eIdentifierEscape\u003c/span\u003e\u003c/a\u003e)+\n\u003cspan class=\"ntdfn\" id=\"IdentifierInitialChar\"\u003eIdentifierInitialChar\u003c/span\u003e :=  \u003ca href=\"#AsciiLetter\"\u003e\u003cspan class=\"ntref\"\u003eAsciiLetter\u003c/span\u003e\u003c/a\u003e | \u003ccode\u003e_\u003c/code\u003e | \u003ca href=\"#UnicodeIdentifierChar\"\u003e\u003cspan class=\"ntref\"\u003eUnicodeIdentifierChar\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"IdentifierFollowingChar\"\u003eIdentifierFollowingChar\u003c/span\u003e := \u003ca href=\"#IdentifierInitialChar\"\u003e\u003cspan class=\"ntref\"\u003eIdentifierInitialChar\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#Digit\"\u003e\u003cspan class=\"ntref\"\u003eDigit\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"IdentifierEscape\"\u003eIdentifierEscape\u003c/span\u003e := \u003ca href=\"#IdentifierSingleEscape\"\u003e\u003cspan class=\"ntref\"\u003eIdentifierSingleEscape\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#NumericEscape\"\u003e\u003cspan class=\"ntref\"\u003eNumericEscape\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"IdentifierSingleEscape\"\u003eIdentifierSingleEscape\u003c/span\u003e := \u003ccode\u003e\\\u003c/code\u003e ^ ( \u003ca href=\"#AsciiLetter\"\u003e\u003cspan class=\"ntref\"\u003eAsciiLetter\u003c/span\u003e\u003c/a\u003e | 0x9 | 0xA | 0xD | \u003ca href=\"#UnicodePatternWhiteSpaceChar\"\u003e\u003cspan class=\"ntref\"\u003eUnicodePatternWhiteSpaceChar\u003c/span\u003e\u003c/a\u003e )\n\u003cspan class=\"ntdfn\" id=\"NumericEscape\"\u003eNumericEscape\u003c/span\u003e := \u003ccode\u003e\\u{\u003c/code\u003e \u003ca href=\"#CodePoint\"\u003e\u003cspan class=\"ntref\"\u003eCodePoint\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e}\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"CodePoint\"\u003eCodePoint\u003c/span\u003e := \u003ca href=\"#HexDigit\"\u003e\u003cspan class=\"ntref\"\u003eHexDigit\u003c/span\u003e\u003c/a\u003e+\n\u003cspan class=\"ntdfn\" id=\"AsciiLetter\"\u003eAsciiLetter\u003c/span\u003e := \u003ccode\u003eA\u003c/code\u003e .. \u003ccode\u003eZ\u003c/code\u003e | \u003ccode\u003ea\u003c/code\u003e .. \u003ccode\u003ez\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"UnicodeIdentifierChar\"\u003eUnicodeIdentifierChar\u003c/span\u003e := ^ ( \u003ca href=\"#AsciiChar\"\u003e\u003cspan class=\"ntref\"\u003eAsciiChar\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#UnicodeNonIdentifierChar\"\u003e\u003cspan class=\"ntref\"\u003eUnicodeNonIdentifierChar\u003c/span\u003e\u003c/a\u003e )\n\u003cspan class=\"ntdfn\" id=\"AsciiChar\"\u003eAsciiChar\u003c/span\u003e := 0x0 .. 0x7F\n\u003cspan class=\"ntdfn\" id=\"UnicodeNonIdentifierChar\"\u003eUnicodeNonIdentifierChar\u003c/span\u003e :=\n   \u003ca href=\"#UnicodePrivateUseChar\"\u003e\u003cspan class=\"ntref\"\u003eUnicodePrivateUseChar\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#UnicodePatternWhiteSpaceChar\"\u003e\u003cspan class=\"ntref\"\u003eUnicodePatternWhiteSpaceChar\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#UnicodePatternSyntaxChar\"\u003e\u003cspan class=\"ntref\"\u003eUnicodePatternSyntaxChar\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"UnicodePrivateUseChar\"\u003eUnicodePrivateUseChar\u003c/span\u003e :=\n   0xE000 .. 0xF8FF\n   | 0xF0000 .. 0xFFFFD\n   | 0x100000 .. 0x10FFFD\n\u003cspan class=\"ntdfn\" id=\"UnicodePatternWhiteSpaceChar\"\u003eUnicodePatternWhiteSpaceChar\u003c/span\u003e := 0x200E | 0x200F | 0x2028 | 0x2029\n\u003cspan class=\"ntdfn\" id=\"UnicodePatternSyntaxChar\"\u003eUnicodePatternSyntaxChar\u003c/span\u003e := \u003cem\u003echaracter with Unicode property Pattern_Syntax=True\u003c/em\u003e\n\u003cspan class=\"ntdfn\" id=\"Digit\"\u003eDigit\u003c/span\u003e := \u003ccode\u003e0\u003c/code\u003e .. \u003ccode\u003e9\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nNote that the set of characters allowed in identifiers follows the requirements\nof Unicode TR31 for immutable identifiers; the set of characters is immutable in\nthe sense that it does not change between Unicode versions.\n\u003c/p\u003e\n\u003cp\u003e\nThe \u003ccode\u003eQuotedIdentifier\u003c/code\u003e syntax allows a reserved keyword\n\u003ccode\u003e\u003cvar\u003eK\u003c/var\u003e\u003c/code\u003e can be used as an identifier by preceding it with a\nsingle quote i.e. \u003ccode\u003e'\u003cvar\u003eK\u003c/var\u003e\u003c/code\u003e. The \u003ccode\u003eIdentifierEscape\u003c/code\u003e\nsyntax allows an arbitrary non-empty string to be treated as an identifier. In a\n\u003ccode\u003eNumericEscape\u003c/code\u003e, \u003ccode\u003eCodePoint\u003c/code\u003e must valid Unicode code\npoint; more precisely, it must be a hexadecimal numeral denoting an integer\n\u003cem\u003en\u003c/em\u003e where 0 â¤ \u003cem\u003en\u003c/em\u003e \u0026lt; 0xD800 or 0xDFFF \u0026lt; n â¤\n0x10FFFF.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"TokenWhiteSpace\"\u003eTokenWhiteSpace\u003c/span\u003e := (\u003ca href=\"#Comment\"\u003e\u003cspan class=\"ntref\"\u003eComment\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#WhiteSpaceChar\"\u003e\u003cspan class=\"ntref\"\u003eWhiteSpaceChar\u003c/span\u003e\u003c/a\u003e)*\n\u003cspan class=\"ntdfn\" id=\"Comment\"\u003eComment\u003c/span\u003e := \u003ccode\u003e//\u003c/code\u003e \u003ca href=\"#AnyCharButNewline\"\u003e\u003cspan class=\"ntref\"\u003eAnyCharButNewline\u003c/span\u003e\u003c/a\u003e*\n\u003cspan class=\"ntdfn\" id=\"AnyCharButNewline\"\u003eAnyCharButNewline\u003c/span\u003e := ^ 0xA\n\u003cspan class=\"ntdfn\" id=\"WhiteSpaceChar\"\u003eWhiteSpaceChar\u003c/span\u003e := 0x9 | 0xA | 0xD | 0x20\n\u003c/pre\u003e\n\u003cp\u003e\n\u003ccode\u003eTokenWhiteSpace\u003c/code\u003e is implicitly allowed on the right hand side of\nproductions for non-terminals whose names start with a lower-case letter.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch2 id=\"values_types\"\u003e5. Values, types and variables\u003c/h2\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_5.1\"\u003e5.1 Overview\u003c/h3\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_5.1.1\"\u003e5.1.1 Type system fundamentals\u003c/h4\u003e\n\u003cp\u003e\nBallerina programs operate on a rich universe of values. This universe of values\nis partitioned into a number of \u003cem\u003ebasic types\u003c/em\u003e; every value belongs to\nexactly one basic type.\n\u003c/p\u003e\n\u003cp\u003e\nValues are of four kinds, each corresponding to a kind of basic type:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003esimple values, like booleans and floating point numbers, which are not\nconstructed from other values;\u003c/li\u003e\n\u003cli\u003estructured values, like mappings and lists, which contain other values;\u003c/li\u003e\n\u003cli\u003esequence values, which combine aspects of simple values and structured\nvalues;\u003c/li\u003e\n\u003cli\u003ebehavioral values, like functions and objects, which are not just data\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThere is a fundamental distinction between values that have a \u003cem\u003estorage\nidentity\u003c/em\u003e and values that do not. A value that has storage identity has an\nidentity that comes from the location where the value is stored. All structural\nand behavioural values have a storage identity, whereas all simple values do\nnot. Storage identity for sequence values is more complicated and will be\nexplained in the section on sequence values.\n\u003c/p\u003e\n\u003cp\u003e\nValues can be stored in variables or as members of structures or in constituents\nof sequences. When a value has no storage identity, it can be stored directly in\nthe variable, structure or sequence. However, when a value has storage identity,\nwhat is stored in the variable, structure or sequence is a reference to the\nlocation where the value is stored rather than the value itself. Storage\nidentity allows values in Ballerina to represent not just trees but graphs.\n\u003c/p\u003e\n\u003cp\u003e\nBallerina provides the ability to test whether two values have the same storage\nidentity, but does not expose the specific storage location of a value. For\nvalues with storage identity, there is the concept of creating a \u003cem\u003enew\u003c/em\u003e\nvalue: this means creating a value that has a storage identity that is different\nfrom any existing value. For values with storage identity, there is also the\nconcept of \u003cem\u003ecopying\u003c/em\u003e: it means to create a value that is the same, except\nfor having a new storage identity. The concept of having storage identity is\nsimilar to the concept of a reference type in some other programming languages,\nbut also accomodates the concept of a sequence value.\n\u003c/p\u003e\n\u003cp\u003e\nBallerina programs use types to categorize values both at compile-time and\nruntime. Types deal with an abstraction of values that does not consider storage\nidentity. This abstraction is called a \u003cem\u003eshape\u003c/em\u003e. A type denotes a set of\nshapes. Subtyping in Ballerina is \u003cem\u003esemantic\u003c/em\u003e: a type S is a subtype of\ntype T if the set of shapes denoted by S is a subset of the set of shapes\ndenoted by T. Every value has a corresponding shape. A shape is specific to a\nbasic type: if two values have different basic types, then they have different\nshapes. The shape of the values contained in a structured value are part of the\nshape of the structured value. Since shapes do not deal with storage identity,\nthey represent trees rather graphs. For simple values, there is no difference\nbetween a shape and a value, with the exception of floating point values where\nthe shape does not consider representation details that do not affect the\nmathematical value being represented.\n\u003c/p\u003e\n\u003cp\u003e\nA value is \u003cem\u003eplain data\u003c/em\u003e if it is a simple value, a sequence value or a\nstructured value that does not contain a behavioral value at any depth.\nMore precisely, a value is defined to be \u003cem\u003eplain data\u003c/em\u003e if it is\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ea simple value,\u003c/li\u003e\n\u003cli\u003ea sequence value, or\u003c/li\u003e\n\u003cli\u003ea structured value, all of whose members are also plain data.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nPlain data values can in general contain cycles of references, but in some\ncontexts are restricted to be acyclic. Plain data values, including values with\ncycles, can be compared for equality.\n\u003c/p\u003e\n\u003cp\u003e\nThe two most important kinds of behavioural values are functions and objects. A\nfunction value can be executed by calling it; when a function is called, it is\npassed values and arguments and returns a value. An object encapsulates data\nwith functions that operate on the data: an object's members are divided into\nfields, which hold the data, and methods, which are the functions that operate\non the data.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_5.1.2\"\u003e5.1.2 Mutation\u003c/h4\u003e\n\u003cp\u003e\nThere are two kinds of things that can be mutated in Ballerina: variables and\nvalues. Mutation of values is tied to storage identity: mutation is only\npossible for values with storage identity. When a value stored in some storage\nlocation is mutated, the change will be visible through all variables referring\nto the value in that location. But not all values with storage identity can be\nmutated: a value may not support mutation even though it has a storage identity.\n\u003c/p\u003e\n\u003cp\u003e\nThe possibility of mutation gives rise to two relations between a value and a\ntype:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ea value \u003cem\u003elooks like\u003c/em\u003e a type at a particular point in the execution of\na program if its shape at that point is a member of the type;\u003c/li\u003e\n\u003cli\u003ea value \u003cem\u003ebelongs to\u003c/em\u003e a type if it looks like the type, and it will\nnecessarily continue to look like the type no matter how the value is mutated.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIf a value cannot be mutated, looking like a type and belonging to a type are\nthe same thing.\n\u003c/p\u003e\n\u003cp\u003e\nWhen a Ballerina program declares a variable to have a compile-time type, this\nmeans that the Ballerina compiler together with the runtime system will ensure\nthat the variable will only ever hold a value that belongs to the type.\nBallerina also provides mechanisms that take a value that looks like a type and\nuse it to create a value that belongs to a type.\n\u003c/p\u003e\n\u003cp\u003e\nEvery value has a read-only bit. If the read-only bit is on, it means that the\nvalue is immutable. A value's read-only bit is fixed when the value is\nconstructed, and cannot be changed thereafter. Ballerina maintains the invariant\nthat immutability is deep: any value reachable from a value with its read-only\nbit set is guaranteed to have its read-only bit set. Here \u003cem\u003ereachable\u003c/em\u003e\nmeans reachable through read operations: every member of a structure value is\nreachable from the structure value; every constituent of a sequence value is\nreachable from the sequence value; every member of an object value is reachable\nfrom the object value. Reachability is transitive: if \u003cvar\u003et\u003c/var\u003e is reachable\nfrom \u003cvar\u003es\u003c/var\u003e, and \u003cvar\u003es\u003c/var\u003e is reachable from \u003cvar\u003er\u003c/var\u003e, then\n\u003cvar\u003et\u003c/var\u003e is reachable from \u003cvar\u003er\u003c/var\u003e. Reachability is also considered\nreflexive: a value is reachable from itself.\n\u003c/p\u003e\n\u003cp\u003e\nSome basic types are inherently immutable: the read-only bit is always on for a\nvalue that belongs to an inherently immutable basic type. All simple types are\ninherently immutable as are functions. Some basic types are selectively\nimmutable: a type is selectively immutable if it is possible to construct both\nvalues of the type that have the read-only bit on and values that do not have\nthe read-only bit on. All structured types are selectively immutable as are\nobjects. Finally, some basic types are inherently mutable: the read-only bit is\nnever on for a value belonging to an inherently mutable basic type.\n\u003c/p\u003e\n\u003cp\u003e\nEach selectively immutable basic type can be partitioned into two\n\u003cem\u003euniform\u003c/em\u003e types, one containing values with the read-only bit on, and one\ncontaining values where the read-only bit is off. For every other basic type,\nthere is a single uniform type. Every uniform type is thus either completely\nreadonly or completely mutable; every value thus belongs to exactly one unform\ntype, and mutation cannot change the uniform type to which a value belongs.\n\u003c/p\u003e\n\u003cp\u003e\nIt is also possible to limit the mutability of variables, by making them final.\nThis means that the value that a variable holds cannot be changed after the\nvariable has been initialized. Unlike immutability of variables, this is not\ndeep. A final variable can hold a mutable value.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_5.1.3\"\u003e5.1.3 Isolation\u003c/h4\u003e\n\u003cp\u003e\nThere are three possible operations on storage: read, write and execute. The\nconcept of immutability relates to reading and writing storage, and provides\nlimited information about execution: execution cannot lead to mutation of an\nimmutable value. For functions and objects, it is useful to have more\ninformation about how execution may lead to mutation. Ballerina has a concept of\n\u003cem\u003eisolation\u003c/em\u003e that provides this.\n\u003c/p\u003e\n\u003cp\u003e\nIn addition to defining when a value is reachable from a value, we can define\nwhen a value is reachable from a variable: a value is reachable from a variable\nif the value is reachable from the value that the variable holds. We\ncan also define when mutable state is reachable from a value or variable: the\nmutable state of a value v is reachable from a value or variable, if v is\nreachable from the value or variable; the mutable state of a variable v is\nreachable only from the variable v.\n\u003c/p\u003e\n\u003cp\u003e\nObjects have an isolated bit in addition to a read-only bit; an object value is\nisolated if its isolated bit is set. Mutable state is defined to be \u003cem\u003efreely\nreachable\u003c/em\u003e from a value or variable if it is reachable without following a\nreference to an isolated object. A variable or value is an \u003cem\u003eisolated\nroot\u003c/em\u003e if its mutable state is isolated from the rest of the program's\nmutable state: any mutable state that is freely reachable from the isolated root\nis reachable from outside only through the isolated root. More precisely, if\nsome mutable state \u003cvar\u003es\u003c/var\u003e is freely reachable from an isolated root value\n\u003cvar\u003er\u003c/var\u003e, then \u003cvar\u003es\u003c/var\u003e is not freely reachable from a variable or value\nthat is not reachable from \u003cvar\u003er\u003c/var\u003e except by following a reference through\n\u003cvar\u003er\u003c/var\u003e; similarly, if some mutable state \u003cvar\u003es\u003c/var\u003e is freely reachable\nfrom an isolated root variable \u003cvar\u003er\u003c/var\u003e, then \u003cvar\u003es\u003c/var\u003e is not freely\nreachable from a value that is not reachable from \u003cvar\u003er\u003c/var\u003e and is not freely\nreachable from any variable other than \u003cvar\u003er\u003c/var\u003e. A variable can also be\ndeclared to be isolated. Ballerina maintains the invariant that isolated objects\nand isolated variables are isolated roots. Ballerina also guarantees that any\nmutable state freely reachable from an isolated object or isolated variable is\naccessed only within the scope of a \u003ca href=\"#lock_statement\"\u003elock\nstatement\u003c/a\u003e, which ensures that there is no data race in accessing that\nmutable state. This implies that there will be no data race accessing any\nmutable state that is reachable (not just freely reachable) from an isolated\nobject or isolated variable.\n\u003c/p\u003e\n\u003cp\u003e\nFunctions and methods have an isolated bit in addition to a read-only bit; a\nfunction or method is isolated if its isolated bit is set. Ballerina guarantees\nthat a call an isolated method or function will only result in access to mutable\nstate if at least one of the following conditions applies:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethe mutable state is freely reachable from an argument passed to the\nfunction or method and the access happens on the strand on which the function is\ncalled; the object on which a method is invoked is considered as an argument for\nthis purpose;\u003c/li\u003e\n\u003cli\u003ethe mutable state is freely reachable from an isolated variable or an\nisolated object;\u003c/li\u003e\n\u003cli\u003ethe mutable state is part of a new value created by the call.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe caller of a function can thus ensure that a function call will not lead to a\ndata race by ensuring that no data race is possible for the mutable state freely\nreachable from the arguments that it passes to the function, for example by\npassing only immutable values or isolated objects.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.1.4\"\u003e5.1.4 Type descriptors\u003c/h4\u003e\n\u003cp\u003e\nBallerina provides a rich variety of type descriptors, which programs use to\ndescribe types. For example, there is a type descriptor for each simple basic\ntype; there is a type descriptor that describes a type as a union of two types;\nthere is a type descriptor that uses a single value to describe a type that\ncontains a single shape. This means that values can look like and belong to\narbitrarily many types, even though they look like or belong to exactly one\n\u003cem\u003ebasic\u003c/em\u003e type.\n\u003c/p\u003e\n\u003cp\u003e\nThe following table summarizes the type descriptors provided by Ballerina.\n\u003c/p\u003e\n\u003ctable\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\u003cstrong\u003eKind\u003c/strong\u003e\u003c/td\u003e\n   \u003ctd\u003e\u003cstrong\u003eName\u003c/strong\u003e\u003c/td\u003e\n   \u003ctd\u003e\u003cstrong\u003eSet of values denoted by type descriptor\u003c/strong\u003e\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd rowspan=\"5\"\u003ebasic, simple\u003c/td\u003e\n   \u003ctd\u003enil\u003c/td\u003e\n   \u003ctd\u003e()\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eboolean\u003c/td\u003e\n   \u003ctd\u003etrue, false\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eint\u003c/td\u003e\n   \u003ctd\u003e64-bit signed integers\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003efloat\u003c/td\u003e\n   \u003ctd\u003e64-bit IEEE 754-2008 binary floating point numbers\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003edecimal\u003c/td\u003e\n   \u003ctd\u003edecimal floating point numbers\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd rowspan=\"2\"\u003ebasic, sequence\u003c/td\u003e\n   \u003ctd\u003estring\u003c/td\u003e\n   \u003ctd\u003ea sequence of Unicode scalar values\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eXML\u003c/td\u003e\n   \u003ctd\u003ea sequence of zero or more elements, processing instructions, comments or\ntext items\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd rowspan=\"5\"\u003ebasic, structured\u003c/td\u003e\n   \u003ctd\u003earray\u003c/td\u003e\n   \u003ctd\u003ean ordered list of values, optionally with a specific length, where a\nsingle type is specified for all members of the list\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003etuple\u003c/td\u003e\n   \u003ctd\u003ean ordered list of values, where a type is specified separately for each\nmember of the list\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003emap\u003c/td\u003e\n   \u003ctd\u003ea mapping from keys, which are strings, to values; specifies mappings in\nterms of a single type to which all keys are mapped\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003erecord\u003c/td\u003e\n   \u003ctd\u003ea mapping from keys, which are strings, to values; specifies maps in\nterms of names of fields (required keys) and value for each field\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003etable\u003c/td\u003e\n   \u003ctd\u003ea ordered collection of mappings, where a mapping is uniquely identified\nwithin the table by a key derived from the mapping\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd rowspan=\"7\"\u003ebasic, behavioral\u003c/td\u003e\n   \u003ctd\u003eerror\u003c/td\u003e\n   \u003ctd\u003ean indication that there has been an error, with a string identifying the\nreason for the error, and a mapping giving additional details about the error\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003efunction\u003c/td\u003e\n   \u003ctd\u003ea function with 0 or more specified parameter types and a single return\ntype\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003efuture\u003c/td\u003e\n   \u003ctd\u003ea value to be returned by a function execution\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eobject\u003c/td\u003e\n   \u003ctd\u003ea combination of named fields and named methods\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003etypedesc\u003c/td\u003e\n   \u003ctd\u003ea type descriptor\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003ehandle\u003c/td\u003e\n   \u003ctd\u003ereference to externally managed storage\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003estream\u003c/td\u003e\n   \u003ctd\u003ea sequence of values that can be generated lazily\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd rowspan=\"11\"\u003eother\u003c/td\u003e\n   \u003ctd\u003esingleton\u003c/td\u003e\n   \u003ctd\u003ea single value described by a literal\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003ereadonly\u003c/td\u003e\n   \u003ctd\u003eany value whose read-only bit is on\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eany\u003c/td\u003e\n   \u003ctd\u003eany value other than an error\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003enever\u003c/td\u003e\n   \u003ctd\u003eno value\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eoptional\u003c/td\u003e\n   \u003ctd\u003ea value that is either () or belongs to a type\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eunion\u003c/td\u003e\n   \u003ctd\u003ea value that belongs to at least one of a number of types\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eintersection\u003c/td\u003e\n   \u003ctd\u003ea value that belongs to all of a number of types\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003edistinct\u003c/td\u003e\n   \u003ctd\u003e\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eanydata\u003c/td\u003e\n   \u003ctd\u003eplain data (a simple value, sequence value or structured value that\n   does not contain behavioral members at any depth)\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003ejson\u003c/td\u003e\n   \u003ctd\u003ethe union of (), int, float, decimal, string, and maps and arrays whose\nvalues are, recursively, json\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003ebyte\u003c/td\u003e\n   \u003ctd\u003eint in the range 0 to 255 inclusive\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003cp\u003e\nA shape is divided into two \u003cem\u003easpects\u003c/em\u003e: the \u003cem\u003eprimary aspect\u003c/em\u003e and\nthe \u003cem\u003eread-only aspect\u003c/em\u003e. A value's read-only bit is a part of the\n\u003cem\u003eread-only aspect\u003c/em\u003e of the value's shape. The read-only bit of values\ncontained in a structured value is part of the read-only aspect of those values\nand of the read-only aspect of the structured value. Everything about a shape\nexcept the read-only bits constitutes the primary aspect of the shape. If two\nplain data values compare equal, then the primary aspect of their shapes is the\nsame, but there may be differences in the read-only aspect.\n\u003c/p\u003e\n\u003cp\u003e\nType descriptors other than \u003ccode\u003ereadonly\u003c/code\u003e describes types using only the\nprimary aspect of shape: whether a value belongs to the type is not affected by\nthe read-only aspect of the value's shape. The \u003ccode\u003ereadonly\u003c/code\u003e type uses\nonly the read-only aspect: whether a value belongs to the \u003ccode\u003ereadonly\u003c/code\u003e\ntype depends only on the read-only aspect of the value's shape.\n\u003c/p\u003e\n\u003cp\u003e\nIn addition to describing a type, a type descriptor may also include information\nused to construct a value of the type, as well as metadata. Whereas the type\ndescribed by a type descriptor is known at compile time, this additional\ninformation may need to be resolved at runtime. The typedesc basic type\nrepresents a type descriptor that has been resolved.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"type-descriptor\"\u003etype-descriptor\u003c/span\u003e :=\n   \u003ca href=\"#simple-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003esimple-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#sequence-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003esequence-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#structured-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003estructured-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#behavioral-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003ebehavioral-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#other-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003eother-type-descriptor\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nFor simplicity, the type-descriptor grammar is ambiguous. The following table\nshows the various types of type descriptor in decreasing order of precedence,\ntogether with associativity.\n\u003c/p\u003e\n\u003ctable\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\u003cstrong\u003eOperator\u003c/strong\u003e\u003c/td\u003e\n   \u003ctd\u003e\u003cstrong\u003eAssociativity\u003c/strong\u003e\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\u003ccode\u003edistinct T\u003c/code\u003e\u003c/td\u003e\n   \u003ctd\u003e\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\n\u003ccode\u003eT[]\u003c/code\u003e\u003cbr\u003e\u003ccode\u003eT?\u003c/code\u003e\n\u003c/td\u003e\n   \u003ctd\u003e\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\u003ccode\u003eT1 \u0026amp; T2\u003c/code\u003e\u003c/td\u003e\n   \u003ctd\u003eleft\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\u003ccode\u003eT1 | T2\u003c/code\u003e\u003c/td\u003e\n   \u003ctd\u003eleft\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\u003ccode\u003efunction(args) returns T\u003c/code\u003e\u003c/td\u003e\n   \u003ctd\u003eright\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.1.5\"\u003e5.1.5 Type-ids\u003c/h4\u003e\n\u003cp\u003e\nBallerina has a feature, called \u003cem\u003edistinct types\u003c/em\u003e, which provides\nfunctionality similar to that provided by nominal types, but which works within\nBallerina's structural type system. Distinct types are similar to the branded\ntypes found in some other structurally typed languages, such as Modula-3.\n\u003c/p\u003e\n\u003cp\u003e\nThe semantics of distinct types are based on type-ids. These are similar to the\nbrands used by branded types. A distinct type is created by the use of the\n\u003ccode\u003edistinct\u003c/code\u003e keyword in either a \u003ca href=\"#distinct-types\"\u003edistinct-type-descriptor\u003c/a\u003e or the\n\u003ccode\u003eclass-type-quals\u003c/code\u003e of a \u003ccode\u003emodule-class-defn\u003c/code\u003e. Each such\noccurrence of the \u003ccode\u003edistinct\u003c/code\u003e keyword has a distinct type-id, which\nuniquely identifies it within a Ballerina program. A type-id has three parts:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003ea module id, which identifies the module within which the\ndistinct-type-descriptor occurs; this consists of an organization, a module\nname, and an array of platform-specified strings, which could include\ninformation about, for example, the repository or version of the package the\nmodule comes from;\u003c/li\u003e\n\u003cli\u003ea local id, which identifies the occurrence of the\n\u003ccode\u003edistinct\u003c/code\u003e within the module; this takes one of two forms:\n\u003cul\u003e\n\u003cli\u003enamed - \n\u003cul\u003e\n\u003cli\u003eif the \u003ccode\u003edistinct\u003c/code\u003e keyword is part of a distinct-type-descriptor\nthat is the only distinct-type-descriptor occurring within a module-type-defn,\nthen the local id is the name of the type defined by the module-type-defn;\u003c/li\u003e\n\u003cli\u003eif the \u003ccode\u003edistinct\u003c/code\u003e keyword is part of the class-type-quals\nof a module-class-defn, then the local id is the name of the class defined\nby the module-class-defn;\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eanonymous - otherwise, the local id is a compiler-generated integer;\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003ea boolean flag saying whether the type-id is public; this flag is on if and\nonly if the local id part is named and is the name of a module-type-defn that is\npublic.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\nDistinct types can be used with only the object or error basic types. An object\nvalue or error value has a set of type-ids. These type-ids are fixed at the\ntime of construction and are immutable thereafter. A value's set of type-ids may\nbe empty. The type-ids of a value are part of the value's shape and so can\naffect when an object belongs to a type. The set of type-ids of an object or\nerror value are divided into primary type-ids and secondary type-ids: the\nsecondary type-ids could be inferred from the primary type-ids using the\nprogram's source.\n\u003c/p\u003e\n\u003cp\u003e\nAn object or error value is always constructed using a specific type descriptor.\nA type descriptor for objects and errors thus performs a dual role: it denotes a\ntype and it defines a mechanism to construct a value of the type. A type\ndescriptor is \u003cem\u003edefinite\u003c/em\u003e if it induces a specific set of type-ids. The\nset of type-ids of an object or error value are those induced by the\ntype-descriptor used to construct it; such a type descriptor must therefore be\ndefinite. A type descriptor that denotes a type that does not allow object or\nerror values induces an empty set of type-ids and so is vacuously definite. For\nother type descriptors, the section that specifies that type descriptor will say\nwhen it is definite, the set of type-ids that it induces when it is, and which\nof those are primary.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.1.6\"\u003e5.1.6 Iterability\u003c/h4\u003e\n\u003cp\u003e\nValues of some basic types are \u003cem\u003eiterable\u003c/em\u003e. An iterable value supports an\niteration operation, which treats the iterable value as consisting of a sequence\nof zero or more simpler values, which are in some sense a part of the iterable\nvalue; the iteration operation provides the values in the sequence, one after\nanother. The sequence of values that an iteration operation on a value provides\nis the \u003cem\u003eiteration sequence\u003c/em\u003e of the value. Each iterable basic type\ndefines the iteration sequence for a value of that basic type. There is also a\nvalue associated with the completion of the iteration operation, which is nil if\nthe iteration completed successfully and an error otherwise. The iteration\noperation thus determines two associated types for an iterable type: the value\ntype, which is the type of the values in the iteration sequence, and the\ncompletion type, which is the type of the iteration completion value.\n\u003c/p\u003e\n\u003cp\u003e\nThe following tables summarizes the iterable basic types.\n\u003c/p\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003cth\u003eBasic type\u003c/th\u003e\n\u003cth\u003eIteration sequence\u003c/th\u003e\n\u003cth\u003eType descriptor\u003c/th\u003e\n\u003cth\u003eValue type\u003c/th\u003e\n\u003cth\u003eCompletion type\u003c/th\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003elength 1 substrings\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003estring\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003estring:Char\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e()\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003exml\u003c/td\u003e\n\u003ctd\u003esingleton xml values\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003exml\u0026lt;T\u0026gt;\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003eT\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e()\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003elist\u003c/td\u003e\n\u003ctd\u003emembers in order\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003eT[]\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003eT\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e()\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003emapping\u003c/td\u003e\n\u003ctd\u003emembers\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003emap\u0026lt;T\u0026gt;\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003eT\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e()\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003etable\u003c/td\u003e\n\u003ctd\u003emembers in order\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003etable\u0026lt;T\u0026gt;\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003eT\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e()\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003estream\u003c/td\u003e\n\u003ctd\u003eitems\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003estream\u0026lt;T,C\u0026gt;\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003eT\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003eC\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_5.2\"\u003e5.2 Simple values\u003c/h3\u003e\n\u003cp\u003e\nA simple value belongs to exactly one of the following basic types:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003enil\u003c/li\u003e\n\u003cli\u003eboolean\u003c/li\u003e\n\u003cli\u003eint\u003c/li\u003e\n\u003cli\u003efloat\u003c/li\u003e\n\u003cli\u003edecimal\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe type descriptor for each simple basic type contains all the values of the\nbasic type.\n\u003c/p\u003e\n\u003cp\u003e\nAll simple basic types are inherently immutable.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"simple-type-descriptor\"\u003esimple-type-descriptor\u003c/span\u003e :=\n   \u003ca href=\"#nil-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003enil-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#boolean-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003eboolean-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#int-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003eint-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#floating-point-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003efloating-point-type-descriptor\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.2.1\"\u003e5.2.1 Nil\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"nil-type-descriptor\"\u003enil-type-descriptor\u003c/span\u003e :=  \u003ccode\u003e(\u003c/code\u003e \u003ccode\u003e)\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"nil-literal\"\u003enil-literal\u003c/span\u003e :=  \u003ccode\u003e(\u003c/code\u003e \u003ccode\u003e)\u003c/code\u003e | \u003ccode\u003enull\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe nil type contains a single value, called nil, which is used to represent the\nabsence of any other value. The nil value is written \u003ccode\u003e()\u003c/code\u003e. The nil\nvalue can also be written \u003ccode\u003enull\u003c/code\u003e, for compatibility with JSON; the\nuse of null should be restricted to JSON-related contexts.\n\u003c/p\u003e\n\u003cp\u003e\nThe nil type is special, in that it is the only basic type that consists of a\nsingle value. The type descriptor for the nil type is not written using a\nkeyword, but is instead written \u003ccode\u003e()\u003c/code\u003e like the value.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.2.2\"\u003e5.2.2 Boolean\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"boolean-type-descriptor\"\u003eboolean-type-descriptor\u003c/span\u003e := \u003ccode\u003eboolean\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"boolean-literal\"\u003eboolean-literal\u003c/span\u003e := \u003ccode\u003etrue\u003c/code\u003e | \u003ccode\u003efalse\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe boolean type consists of the values true and false.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.2.3\"\u003e5.2.3 Int\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"int-type-descriptor\"\u003eint-type-descriptor\u003c/span\u003e := \u003ccode\u003eint\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"int-literal\"\u003eint-literal\u003c/span\u003e := \u003ca href=\"#DecimalNumber\"\u003e\u003cspan class=\"ntref\"\u003eDecimalNumber\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#HexIntLiteral\"\u003e\u003cspan class=\"ntref\"\u003eHexIntLiteral\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"DecimalNumber\"\u003eDecimalNumber\u003c/span\u003e := \u003ccode\u003e0\u003c/code\u003e | \u003ca href=\"#NonZeroDigit\"\u003e\u003cspan class=\"ntref\"\u003eNonZeroDigit\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#Digit\"\u003e\u003cspan class=\"ntref\"\u003eDigit\u003c/span\u003e\u003c/a\u003e*\n\u003cspan class=\"ntdfn\" id=\"HexIntLiteral\"\u003eHexIntLiteral\u003c/span\u003e := \u003ca href=\"#HexIndicator\"\u003e\u003cspan class=\"ntref\"\u003eHexIndicator\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#HexNumber\"\u003e\u003cspan class=\"ntref\"\u003eHexNumber\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"HexNumber\"\u003eHexNumber\u003c/span\u003e := \u003ca href=\"#HexDigit\"\u003e\u003cspan class=\"ntref\"\u003eHexDigit\u003c/span\u003e\u003c/a\u003e+\n\u003cspan class=\"ntdfn\" id=\"HexIndicator\"\u003eHexIndicator\u003c/span\u003e := \u003ccode\u003e0x\u003c/code\u003e | \u003ccode\u003e0X\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"HexDigit\"\u003eHexDigit\u003c/span\u003e := \u003ca href=\"#Digit\"\u003e\u003cspan class=\"ntref\"\u003eDigit\u003c/span\u003e\u003c/a\u003e | \u003ccode\u003ea\u003c/code\u003e .. \u003ccode\u003ef\u003c/code\u003e | \u003ccode\u003eA\u003c/code\u003e .. \u003ccode\u003eF\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"NonZeroDigit\"\u003eNonZeroDigit\u003c/span\u003e := \u003ccode\u003e1\u003c/code\u003e .. \u003ccode\u003e9\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe int type consists of integers between -9,223,372,036,854,775,808 and\n9,223,372,036,854,775,807 (i.e. signed integers than can fit into 64 bits using\na two's complement representation).\n\u003c/p\u003e\n\u003cp\u003e\nThe \u003ca href=\"#byte_type\"\u003e\u003ccode\u003ebyte\u003c/code\u003e type\u003c/a\u003e is a subtype of\n\u003ccode\u003eint\u003c/code\u003e. The \u003ccode\u003elang.int\u003c/code\u003e lang library module also\nprovides \u003ca href=\"#built-in_subtypes\"\u003ebuilt-in subtypes\u003c/a\u003e for signed and\nunsigned integers representable in 8, 16 and 32 bits.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.2.4\"\u003e5.2.4 Floating point types\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"floating-point-type-descriptor\"\u003efloating-point-type-descriptor\u003c/span\u003e := \u003ccode\u003efloat\u003c/code\u003e | \u003ccode\u003edecimal\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"floating-point-literal\"\u003efloating-point-literal\u003c/span\u003e :=\n   \u003ca href=\"#DecimalFloatingPointNumber\"\u003e\u003cspan class=\"ntref\"\u003eDecimalFloatingPointNumber\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#HexFloatingPointLiteral\"\u003e\u003cspan class=\"ntref\"\u003eHexFloatingPointLiteral\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"DecimalFloatingPointNumber\"\u003eDecimalFloatingPointNumber\u003c/span\u003e :=\n   \u003ca href=\"#DecimalNumber\"\u003e\u003cspan class=\"ntref\"\u003eDecimalNumber\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#Exponent\"\u003e\u003cspan class=\"ntref\"\u003eExponent\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#FloatingPointTypeSuffix\"\u003e\u003cspan class=\"ntref\"\u003eFloatingPointTypeSuffix\u003c/span\u003e\u003c/a\u003e]\n   | \u003ca href=\"#DottedDecimalNumber\"\u003e\u003cspan class=\"ntref\"\u003eDottedDecimalNumber\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#Exponent\"\u003e\u003cspan class=\"ntref\"\u003eExponent\u003c/span\u003e\u003c/a\u003e] [\u003ca href=\"#FloatingPointTypeSuffix\"\u003e\u003cspan class=\"ntref\"\u003eFloatingPointTypeSuffix\u003c/span\u003e\u003c/a\u003e]\n   | \u003ca href=\"#DecimalNumber\"\u003e\u003cspan class=\"ntref\"\u003eDecimalNumber\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#FloatingPointTypeSuffix\"\u003e\u003cspan class=\"ntref\"\u003eFloatingPointTypeSuffix\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"DottedDecimalNumber\"\u003eDottedDecimalNumber\u003c/span\u003e :=\n   \u003ca href=\"#DecimalNumber\"\u003e\u003cspan class=\"ntref\"\u003eDecimalNumber\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e.\u003c/code\u003e \u003ca href=\"#Digit\"\u003e\u003cspan class=\"ntref\"\u003eDigit\u003c/span\u003e\u003c/a\u003e*\n   | \u003ccode\u003e.\u003c/code\u003e \u003ca href=\"#Digit\"\u003e\u003cspan class=\"ntref\"\u003eDigit\u003c/span\u003e\u003c/a\u003e+\n\u003cspan class=\"ntdfn\" id=\"Exponent\"\u003eExponent\u003c/span\u003e := \u003ca href=\"#ExponentIndicator\"\u003e\u003cspan class=\"ntref\"\u003eExponentIndicator\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#Sign\"\u003e\u003cspan class=\"ntref\"\u003eSign\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#Digit\"\u003e\u003cspan class=\"ntref\"\u003eDigit\u003c/span\u003e\u003c/a\u003e+\n\u003cspan class=\"ntdfn\" id=\"ExponentIndicator\"\u003eExponentIndicator\u003c/span\u003e := \u003ccode\u003ee\u003c/code\u003e | \u003ccode\u003eE\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"HexFloatingPointLiteral\"\u003eHexFloatingPointLiteral\u003c/span\u003e := \u003ca href=\"#HexIndicator\"\u003e\u003cspan class=\"ntref\"\u003eHexIndicator\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#HexFloatingPointNumber\"\u003e\u003cspan class=\"ntref\"\u003eHexFloatingPointNumber\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"HexFloatingPointNumber\"\u003eHexFloatingPointNumber\u003c/span\u003e :=\n   \u003ca href=\"#HexNumber\"\u003e\u003cspan class=\"ntref\"\u003eHexNumber\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#HexExponent\"\u003e\u003cspan class=\"ntref\"\u003eHexExponent\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#DottedHexNumber\"\u003e\u003cspan class=\"ntref\"\u003eDottedHexNumber\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#HexExponent\"\u003e\u003cspan class=\"ntref\"\u003eHexExponent\u003c/span\u003e\u003c/a\u003e]\n\u003cspan class=\"ntdfn\" id=\"DottedHexNumber\"\u003eDottedHexNumber\u003c/span\u003e :=\n   \u003ca href=\"#HexDigit\"\u003e\u003cspan class=\"ntref\"\u003eHexDigit\u003c/span\u003e\u003c/a\u003e+ \u003ccode\u003e.\u003c/code\u003e \u003ca href=\"#HexDigit\"\u003e\u003cspan class=\"ntref\"\u003eHexDigit\u003c/span\u003e\u003c/a\u003e*\n   | \u003ccode\u003e.\u003c/code\u003e \u003ca href=\"#HexDigit\"\u003e\u003cspan class=\"ntref\"\u003eHexDigit\u003c/span\u003e\u003c/a\u003e+\n\u003cspan class=\"ntdfn\" id=\"HexExponent\"\u003eHexExponent\u003c/span\u003e := \u003ca href=\"#HexExponentIndicator\"\u003e\u003cspan class=\"ntref\"\u003eHexExponentIndicator\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#Sign\"\u003e\u003cspan class=\"ntref\"\u003eSign\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#Digit\"\u003e\u003cspan class=\"ntref\"\u003eDigit\u003c/span\u003e\u003c/a\u003e+\n\u003cspan class=\"ntdfn\" id=\"HexExponentIndicator\"\u003eHexExponentIndicator\u003c/span\u003e := \u003ccode\u003ep\u003c/code\u003e | \u003ccode\u003eP\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"Sign\"\u003eSign\u003c/span\u003e := \u003ccode\u003e+\u003c/code\u003e | \u003ccode\u003e-\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"FloatingPointTypeSuffix\"\u003eFloatingPointTypeSuffix\u003c/span\u003e := \u003ca href=\"#DecimalTypeSuffix\"\u003e\u003cspan class=\"ntref\"\u003eDecimalTypeSuffix\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#FloatTypeSuffix\"\u003e\u003cspan class=\"ntref\"\u003eFloatTypeSuffix\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"DecimalTypeSuffix\"\u003eDecimalTypeSuffix\u003c/span\u003e := \u003ccode\u003ed\u003c/code\u003e | \u003ccode\u003eD\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"FloatTypeSuffix\"\u003eFloatTypeSuffix\u003c/span\u003e :=  \u003ccode\u003ef\u003c/code\u003e | \u003ccode\u003eF\u003c/code\u003e\n\u003c/pre\u003e\n\n\u003csection\u003e\n\u003ch5 id=\"section_5.2.4.1\"\u003e5.2.4.1 Float\u003c/h5\u003e\n\n\u003cp\u003e\nThe float type corresponds to IEEE 754-2008 64-bit binary (radix 2) floating\npoint numbers. A float value can be represented by either a\nDecimalFloatingPointNumber with an optional FloatTypeSuffix, or by a\nHexFloatingPointLiteral.\n\u003c/p\u003e\n\u003cp\u003e\nThe multiple bit patterns that IEEE 754 treats as NaN are considered to be the\nsame value in Ballerina. Positive and negative zero of a floating point basic\ntype are distinct values, following IEEE 754, but are defined to have the same\nshape, so that they will usually be treated as being equal.\n\u003c/p\u003e\n\u003cp\u003e\nIEEE-defined operations on float values must be performed using a\nrounding-direction attribute of roundTiesToEven (which is the default IEEE\nrounding direction, sometimes called \u003cem\u003eround to nearest\u003c/em\u003e). All float\nvalues, including the intermediate results of expressions, must use the value\nspace defined for the float type; implementations must not use extended\nprecision for intermediate results. This ensures that all implementations will\nproduce identical results. (This is the same as what is required by strictfp in\nJava.)\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch5 id=\"section_5.2.4.2\"\u003e5.2.4.2 Decimal\u003c/h5\u003e\n\n\u003cp\u003e\nThe decimal type corresponds to a subset of IEEE 754-2008 128-bit decimal (radix\n10) floating point numbers. Any decimal value can be represented by a\nDecimalFloatingPointNumber with an optional DecimalTypeSuffix.\n\u003c/p\u003e\n\u003cp\u003e\nA decimal value is a triple (\u003cvar\u003es\u003c/var\u003e, \u003cvar\u003ec\u003c/var\u003e, \u003cvar\u003ee\u003c/var\u003e) where\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cvar\u003es\u003c/var\u003e is sign, either 0 or -1\u003c/li\u003e\n\u003cli\u003e\n\u003cvar\u003ec\u003c/var\u003e is the coefficient, an unsigned integer that can be exactly\nrepresented in 34 decimal digits\u003c/li\u003e\n\u003cli\u003e\n\u003cvar\u003ee\u003c/var\u003e is the exponent, a signed integer\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nrepresenting the mathematical value -1\u003csup\u003e\u003cvar\u003es\u003c/var\u003e\u003c/sup\u003e Ã\n\u003cvar\u003ec\u003c/var\u003e Ã 10\u003csup\u003e\u003cvar\u003ee\u003c/var\u003e\u003c/sup\u003e. The range for the exponent\n\u003cvar\u003ee\u003c/var\u003e is implementation dependent, but must be at least the range\nsupported by the IEEE 754-2008 decimal128 format (which is -6176 to 6111\ninclusive).\n\u003c/p\u003e\n\u003cp\u003e\nThe decimal type corresponds to the ANSI X3.274 subset of IEEE 754-2008, which\nhas the following simplifications:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e+0 and -0 are not distinguished; if the coefficent is zero, then the sign is\nalso constrained to be zero;\u003c/li\u003e\n\u003cli\u003eNaN, infinities and subnormals are not supported; operations that would\nresult in one of these values according to the normal rules of IEEE 754-2008\ninstead result in a panic.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nOperations on the decimal type use the roundTiesToEven rounding mode, like the\nfloat type.\n\u003c/p\u003e\n\u003cp\u003e\nThe shape of a decimal value is its mathematical value. Thus two decimal values\nhave the same shape if they represent the same mathematical value, even if they\ndo so using different exponents.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_5.3\"\u003e5.3 Sequence values\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"sequence-type-descriptor\"\u003esequence-type-descriptor\u003c/span\u003e :=\n   \u003ca href=\"#string-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003estring-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#xml-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003exml-type-descriptor\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA sequence value belongs to one of the following two basic types:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003estring\u003c/li\u003e\n\u003cli\u003exml\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nA sequence value consists of an ordered sequence of zero or more constituent\nitems, where the constituent items belong to the same basic type as the sequence\nvalue itself. The \u003cem\u003elength\u003c/em\u003e of a sequence value is the number of its\nconstituent items. Each constituent of a sequence value has an integer index\nâ¥ 0 and \u0026lt; length. A sequence value is a \u003cem\u003esingleton\u003c/em\u003e if its\nlength is 1. For each sequence basic type, there is an \u003cem\u003eempty\u003c/em\u003e value,\nwhich has length 0. As with other basic types, the sequence basic types are\ndisjoint with themselves and with other basic types. Thus the empty value for\nstring is distinct from the empty value for xml, and these are both distinct\nfrom nil.\n\u003c/p\u003e\n\u003cp\u003e\nThe values belonging to a sequence basic type B can be defined in terms of its\nsingleton values and a concatenation operation, by the following rules:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\nthe singleton values of B belong to B;\n\u003c/li\u003e\n\u003cli\u003e\nthe empty value of B belongs to B;\n\u003c/li\u003e\n\u003cli\u003e\nif v\u003csub\u003e1\u003c/sub\u003e and v\u003csub\u003e2\u003c/sub\u003e belong to B, then the concatenation of\nv\u003csub\u003e1\u003c/sub\u003e and v\u003csub\u003e2\u003c/sub\u003e belongs to B.\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe concatenation of any value v belonging to B with the empty sequence of B in\neither order is v.\n\u003c/p\u003e\n\u003cp\u003e\nNote that for a sequence consisting of a single item v is the same thing as v. A\nsingle item \u003cem\u003eis a\u003c/em\u003e sequence. The type of the constituent items of a\nsequence of basic type B is thus a subtype of B. This is a fundamental\ndifference between sequences and lists.\n\u003c/p\u003e\n\u003cp\u003e\nOnly singleton values of a sequence type can have storage identity. When a\nconstituent of a sequence value has storage identity, what is stored in the\nsequence value is a reference to the location where the constituent value is\nstored rather than the constituent value itself.\n\u003c/p\u003e\n\u003cp\u003e\nA sequence value is iterable: the iteration sequence consists of the singleton\nitems of the sequence value in order and the iteration completion value is\nalways nil.\n\u003c/p\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_5.3.1\"\u003e5.3.1 Strings\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"string-type-descriptor\"\u003estring-type-descriptor\u003c/span\u003e := \u003ccode\u003estring\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"string-literal\"\u003estring-literal\u003c/span\u003e := \u003ca href=\"#DoubleQuotedStringLiteral\"\u003e\u003cspan class=\"ntref\"\u003eDoubleQuotedStringLiteral\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"DoubleQuotedStringLiteral\"\u003eDoubleQuotedStringLiteral\u003c/span\u003e := \u003ccode\u003e\"\u003c/code\u003e (\u003ca href=\"#StringChar\"\u003e\u003cspan class=\"ntref\"\u003eStringChar\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#StringEscape\"\u003e\u003cspan class=\"ntref\"\u003eStringEscape\u003c/span\u003e\u003c/a\u003e)* \u003ccode\u003e\"\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"StringChar\"\u003eStringChar\u003c/span\u003e := ^ ( 0xA | 0xD | \u003ccode\u003e\\\u003c/code\u003e | \u003ccode\u003e\"\u003c/code\u003e )\n\u003cspan class=\"ntdfn\" id=\"StringEscape\"\u003eStringEscape\u003c/span\u003e := \u003ca href=\"#StringSingleEscape\"\u003e\u003cspan class=\"ntref\"\u003eStringSingleEscape\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#NumericEscape\"\u003e\u003cspan class=\"ntref\"\u003eNumericEscape\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"StringSingleEscape\"\u003eStringSingleEscape\u003c/span\u003e := \u003ccode\u003e\\t\u003c/code\u003e | \u003ccode\u003e\\n\u003c/code\u003e | \u003ccode\u003e\\r\u003c/code\u003e | \u003ccode\u003e\\\\\u003c/code\u003e | \u003ccode\u003e\\\"\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA string is an sequence of zero or more Unicode characters. More precisely, it\nis a sequence whose singleton values represent Unicode scalar values, where a\nUnicode scalar value is any code point in the Unicode range of 0x0 to 0x10FFFF\ninclusive, other than surrogate code points, which are 0xD800 to 0xDFFF\ninclusive. Note that a string may include Unicode noncharacters, such as 0xFFFE\nand 0xFFFF.\n\u003c/p\u003e\n\u003cp\u003e\nString values do not have storage identity and so the string basic type is\ninherently immutable.\n\u003c/p\u003e\n\u003cp\u003e\nThere is a \u003ca href=\"#built-in_subtypes\"\u003ebuilt-in subtype\u003c/a\u003e\n\u003ccode\u003estring:Char\u003c/code\u003e for single character strings.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"XML\"\u003e5.3.2 XML\u003c/h4\u003e\n\n\u003cp\u003e\nAn xml value is a sequence representing parsed XML, such as occurs in the\ncontent of an XML element. The singleton values are of the following types:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eelement\u003c/li\u003e\n\u003cli\u003eprocessing instruction\u003c/li\u003e\n\u003cli\u003ecomment\u003c/li\u003e\n\u003cli\u003etext\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe element, processing instruction and comment singletons correspond directly\nto information items in the XML Information Set. A text singleton corresponds to\none or more character information items. When an xml value is constructed,\nconsecutive text singletons are merged, so that an xml value never contains\nconsecutive text singletons. There are \u003ca href=\"#built-in_subtypes\"\u003ebuilt-in\nsubtypes\u003c/a\u003e \u003ccode\u003exml:Element\u003c/code\u003e, \u003ccode\u003exml:ProcessingInstruction\u003c/code\u003e,\n\u003ccode\u003exml:Comment\u003c/code\u003e and \u003ccode\u003exml:Text\u003c/code\u003e corresponding to the above\nsingletons; \u003ccode\u003exml:Text\u003c/code\u003e also allows the empty xml value.\n\u003c/p\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"xml-type-descriptor\"\u003exml-type-descriptor\u003c/span\u003e := \u003ccode\u003exml\u003c/code\u003e [\u003ca href=\"#type-parameter\"\u003e\u003cspan class=\"ntref\"\u003etype-parameter\u003c/span\u003e\u003c/a\u003e]\n\u003cspan class=\"ntdfn\" id=\"type-parameter\"\u003etype-parameter\u003c/span\u003e := \u003ccode\u003e\u0026lt;\u003c/code\u003e \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e\u0026gt;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA shape belongs to type \u003ccode\u003exml\u003c/code\u003e if its basic type is \u003ccode\u003exml\u003c/code\u003e.\nA type parameter of an xml-type-descriptor must be a subtype of\n\u003ccode\u003exml\u003c/code\u003e. A shape belongs to type \u003ccode\u003exml\u0026lt;T\u0026gt;\u003c/code\u003e if all of\nits constituent items belong to \u003ccode\u003eT\u003c/code\u003e. So, for example,\n\u003ccode\u003exml\u0026lt;xml:Element\u0026gt;\u003c/code\u003e is the type for xml values containing\nonly elements. Note that \u003ccode\u003exml\u0026lt;xml\u0026lt;\u003cvar\u003eT\u003c/var\u003e\u0026gt;\u0026gt;\u003c/code\u003e is the\nsame as \u003ccode\u003exml\u0026lt;\u003cvar\u003eT\u003c/var\u003e\u0026gt;\u003c/code\u003e and that\n\u003ccode\u003exml\u0026lt;xml:Text\u0026gt;\u003c/code\u003e is the same as \u003ccode\u003exml:Text\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThe name of an element is represented by a string. The attributes of an element\nare represented by a value of type \u003ccode\u003emap\u0026lt;string\u0026gt;\u003c/code\u003e. The children\nof an element is represented by a value of type \u003ccode\u003exml\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nSingleton element, processing instruction and comment values have storage\nidentity. Other xml values do not.\n\u003c/p\u003e\n\u003cp\u003e\nThe \u003ccode\u003exml:Text\u003c/code\u003e type is inherently immutable. This implies that both\ntext singletons and empty xml values always have their read-only bits on. The\n\u003ccode\u003exml:Element\u003c/code\u003e, \u003ccode\u003exml:ProcessingInstruction\u003c/code\u003e and\n\u003ccode\u003exml:Comment\u003c/code\u003e types are selectively immutable. The read-only bit of a\nxml value with length greater than one is on if and only if the read-only bit of\nall its constituent items is on. The attributes and children of an element are\nreachable from the element. Thus, if the read-only bit of an\n\u003ccode\u003exml:Element\u003c/code\u003e is on, then the read-only bits of the mapping\nrepresenting its attributes and of the xml value representing its children are\nalso on.\n\u003c/p\u003e\n\u003cp\u003e\nNote that although the mutable constituents of mutable xml value can be mutated,\nthe number and the storage identity of the constituents of a xml value are fixed\nwhen the value is constructed. The storage identity of the attributes map of an\nelement are also fixed when the element is constructed.\n\u003c/p\u003e\n\u003csection\u003e\n\u003ch5 id=\"section_5.3.2.1\"\u003e5.3.2.1 XML namespaces\u003c/h5\u003e\n\u003cp\u003e\nThe name of an element or attribute, which in the XML Information Set is\nrepresented by a combination of the [namespace name] and [local name] properties\nof an element information item (EII) or attribute information item (AII), is\nrepresented by a single \u003cem\u003eexpanded name\u003c/em\u003e string. If the [namespace name]\nproperty has no value, then the expanded name consists of just the value of the\n[local name] property; otherwise, the expanded name is of the form:\n\u003c/p\u003e\n\u003cpre\u003e\n   {\u003cvar\u003enamespace-uri\u003c/var\u003e}\u003cvar\u003elocal-name\u003c/var\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nwhere \u003ccode\u003e\u003cvar\u003enamespace-uri\u003c/var\u003e\u003c/code\u003e and\n\u003ccode\u003e\u003cvar\u003elocal-name\u003c/var\u003e\u003c/code\u003e are the values of the [namespace name] and\n[local name] properties respectively.\n\u003c/p\u003e\n\u003cp\u003e\nThe attributes map for an element includes not only an entry for each AII in the\n[attributes] property of the EII, but also an entry for each attribute in the\n[namespace attributes] property. The key of the entry is the string representing\nthe name of the attribute, constructed from the AII item as described in the\nprevious paragraph. The name of every namespace attribute will thus start with\nthe string \u003ccode\u003e{http://www.w3.org/2000/xmlns/}\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThe attributes map can also contain entries representing namespace attributes\nsynthesized from the [in-scope namespaces] property. There will be a synthesized\nnamespace attribute for every prefix other than \u003ccode\u003exml\u003c/code\u003e that occurs as\na prefix of the EII or of an AII in the element's [attributes] property and for\nwhich there is no declaration in the [namespace attributes] property. No\nnamespace attribute will be synthesized for the default namespace. (The\nsynthesized namespace attributes ensure that namespace prefixes will not be lost\nif the element is extracted into a new context.)\n\u003c/p\u003e\n\u003cp\u003e\nAn xml value can be converted to an XML information set for serialization. This\nis done in the context of a set of namespace declarations that are in-scope from\nthe xml value's parent element, if any. The process of converting an xml element\nsingleton into an EII has the following stages.\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe [namespace name] and [local name] properties of the EII are determined\nfrom the element's expanded name.\u003c/li\u003e\n\u003cli\u003eAn AII is constructed for each entry in the element's attribute map, with\nthe [namespace name] and [local name] properties of the AII determined from the\nentry's key, which is the attribute's expanded name. Each AII is added to either\nthe [attributes] or [namespace attributes] property of the EII depending on the\nAII's [namespace name] property. The [prefix] property of each AII in the\n[namespace attributes] property can also be set at this point.\u003c/li\u003e\n\u003cli\u003eThe [namespace attributes] property of the EII is pruned by removing an\nAII with [normalized value] N if the AII is not a default namespace declaration,\nand the in-scope namespace declarations include a declaration with namespace\nname N, and either the EII or one of the AIIs has a [namespace name] property\nequal to N. (In this case, the entry for the namespace attribute would get\nsynthesized when the information set is converted to an xml value.)\u003c/li\u003e\n\u003cli\u003eFor each AII in the EII's [attributes] property that has a [namespace name]\nproperty, a [prefix] property is assigned. If the namespace name is\n\u003ccode\u003ehttp://www.w3.org/XML/1998/namespace\u003c/code\u003e, then use a prefix of\n\u003ccode\u003exml\u003c/code\u003e. If there is already a namespace declaration in the [namespace\nattributes] that declares a prefix with that namespace name, then that prefix is\nused. Otherwise if there is a namespace declaration in the in-scope namespaces\nthat declares a prefix with that namespace and it is not redeclared or\nundeclared by the [namespace attributes], then that prefix is used. Otherwise\ngenerate a prefix and add an AII to the [namespace attributes] to declare\nit.\u003c/li\u003e\n\u003cli\u003eIf the EII has no [namespace name] property, but a default namespace\ndeclaration is in scope, then an \u003ccode\u003exmlns=\"\"\u003c/code\u003e AII is added to the\n[namespace attributes] property to undeclare the default namespace.\u003c/li\u003e\n\u003cli\u003eIf the EII has a [namespace name] property N, then we need\nto ensure that there is an applicable namespace declaration:\n\u003col\u003e\n\u003cli\u003eif one of the [namespace attributes] declares N as the default namespace,\nthen nothing needs to be done;\u003c/li\u003e\n\u003cli\u003esimilarly, if an in-scope namespace declaration declares N as the default\nnamespace, and the [namespace attributes] do not undeclare it, then nothing\nneeds to be done;\u003c/li\u003e\n\u003cli\u003eotherwise, try to find, in the same way as for an AII, a prefix P which is\nalready declared as N; if there is one, set the [prefix] property of the EII to\nP;\u003c/li\u003e\n\u003cli\u003eotherwise, if the [namespace attributes] property does not contain a default\nnamespace declaration or undeclaration, generate a default namespace declaration\nfor N and add it to the [namespace attributes] property;\u003c/li\u003e\n\u003cli\u003eotherwise, generate a new prefix P, set the [prefix] property of the EII to\nP, and add an AII to the [namespace attributes] to declare it.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eGenerate the [in-scope namespaces] property for this EII, using the parent's\nin-scope namespaces and the [namespace attributes].\u003c/li\u003e\n\u003cli\u003eConvert the children of the xml element, including the element children, to\na list of information items, in the context of this EII's in-scope\nnamespaces.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003c/section\u003e\n\n\u003c/section\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_5.4\"\u003e5.4 Structured values\u003c/h3\u003e\n\u003cp\u003e\nStructured values are containers for other values, which are called their\nmembers. There are three basic types of structured value: list, mapping and\ntable.\n\u003c/p\u003e\n\u003cp\u003e\nStructured values are usually mutable. Mutating a structured value changes which\nvalues it contains. Structured values can also be constructed as immutable.\nImmutability is deep: immutable structured values cannot contain mutable\nstructured values; if the read-only bit of a structured value is on, then the\nread-only bit of each of its members is on.\n\u003c/p\u003e\n\u003cp\u003e\nThe shape of the members of a structured value contributes to the shape of the\nstructured value. A structured type descriptor describe the shape of the\nstructured value in terms of the shapes of its members. Mutating a member of a\nstructured value can cause the shape of the structured value to change. A\nstructured value has an inherent type, which is a type descriptor which is part\nof the structured value's runtime value. At runtime, the structured value\nprevents any mutation that might lead to the structured value having a shape\nthat is not a member of its inherent type. Thus a structured value belongs to a\ntype if and only if its inherent type is a subtype of that type.\n\u003c/p\u003e\n\u003cp\u003e\nThe inherent type of an immutable structured value is a singleton type with the\nstructured value's shape as its single member. Thus, an immutable structured\nvalue belongs to a type if and only if the type contains the shape of the value.\n\u003c/p\u003e\n\u003cp\u003e\nEvery structured value has a length, which is the number of its members.\nAll structured values are iterable: the iteration sequence consists of the\nmembers of the structure and the completion type is always nil.\n\u003c/p\u003e\n\u003cp\u003e\nA structured value provides random access to its members using a key that\nuniquely identifies each member within the structure. A key can be out-of-line,\nmeaning it is independent of the member, or in-line, meaning it is part of the\nmember. The \u003cem\u003emember type\u003c/em\u003e for a key type K in a structured type T\nconsists of all shapes v such that there is a shape in T with key in K and shape\nv. A type K is an \u003cem\u003eoptional key type\u003c/em\u003e for T if there is a shape v in T\nand a key k in K such that v does not have a member k; a type that is not an\noptional key type is a required key type.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"structured-type-descriptor\"\u003estructured-type-descriptor\u003c/span\u003e :=\n   \u003ca href=\"#list-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003elist-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#mapping-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003emapping-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#table-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etable-type-descriptor\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe following table summarizes the type descriptors for structured types.\n\u003c/p\u003e\n\u003ctable\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eStructured type\u003c/td\u003e\n   \u003ctd\u003elist\u003c/td\u003e\n   \u003ctd\u003emapping\u003c/td\u003e\n   \u003ctd\u003etable\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eKey source\u003c/td\u003e\n   \u003ctd\u003eout-of-line\u003c/td\u003e\n   \u003ctd\u003eout-of-line\u003c/td\u003e\n   \u003ctd\u003ein-line\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eKey type\u003c/td\u003e\n   \u003ctd\u003einteger\u003c/td\u003e\n   \u003ctd\u003estring\u003c/td\u003e\n   \u003ctd\u003eanydata\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eType descriptor with uniform member type\u003c/td\u003e\n   \u003ctd\u003earray\u003c/td\u003e\n   \u003ctd\u003emap\u003c/td\u003e\n   \u003ctd\u003etable\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eType descriptor with separate member types\u003c/td\u003e\n   \u003ctd\u003etuple\u003c/td\u003e\n   \u003ctd\u003erecord\u003c/td\u003e\n   \u003ctd\u003e-\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_5.4.1\"\u003e5.4.1 Lists\u003c/h4\u003e\n\u003cp\u003e\nA list value is a container that keeps its members in an ordered list. The\nnumber of members of the list is called the \u003cem\u003elength\u003c/em\u003e of the list. The key\nfor a member of a list is the integer index representing its position in the\nlist, with the index of the first member being 0. For a list of length\n\u003cem\u003en\u003c/em\u003e, the indices of the members of the list, from first to last, are\n0,1,...,\u003cem\u003en\u003c/em\u003e - 1. The shape of a list value is an ordered list of the\nshapes of its members.\n\u003c/p\u003e\n\u003cp\u003e\nA list is iterable: the iteration sequence consists of the members of the\nlist in order and the iteration completion value is always nil.\n\u003c/p\u003e\n\u003cp\u003e\nThe type of list values can be described by two kinds of type descriptors.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"list-type-descriptor\"\u003elist-type-descriptor\u003c/span\u003e :=\n   \u003ca href=\"#array-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003earray-type-descriptor\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#tuple-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etuple-type-descriptor\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe inherent type of a list value must be a \u003ccode\u003elist-type-descriptor\u003c/code\u003e.\nThe inherent type of a list value determines a type T\u003csub\u003e\u003cem\u003ei\u003c/em\u003e\u003c/sub\u003e for a\nmember with index \u003cem\u003ei\u003c/em\u003e. The runtime system will enforce a constraint that\na value written to index \u003cem\u003ei\u003c/em\u003e will belong to type T\u003csub\u003e\u003cem\u003ei\u003c/em\u003e\u003c/sub\u003e.\nNote that the constraint is not merely that the value looks like\nT\u003csub\u003e\u003cem\u003ei\u003c/em\u003e\u003c/sub\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nBoth kinds of type descriptor are covariant in the types of their members.\n\u003c/p\u003e\n\u003csection\u003e\n\u003ch5 id=\"section_5.4.1.1\"\u003e5.4.1.1 Array types\u003c/h5\u003e\n\u003cp\u003e\nAn array type-descriptor describes a type of list value by specifying the type\nthat the value for all members must belong to, and optionally, a length.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"array-type-descriptor\"\u003earray-type-descriptor\u003c/span\u003e := \u003ca href=\"#member-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003emember-type-descriptor\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e[\u003c/code\u003e [ \u003ca href=\"#array-length\"\u003e\u003cspan class=\"ntref\"\u003earray-length\u003c/span\u003e\u003c/a\u003e ] \u003ccode\u003e]\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"member-type-descriptor\"\u003emember-type-descriptor\u003c/span\u003e := \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"array-length\"\u003earray-length\u003c/span\u003e :=\n   \u003ca href=\"#int-literal\"\u003e\u003cspan class=\"ntref\"\u003eint-literal\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#constant-reference-expr\"\u003e\u003cspan class=\"ntref\"\u003econstant-reference-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#inferred-array-length\"\u003e\u003cspan class=\"ntref\"\u003einferred-array-length\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"inferred-array-length\"\u003einferred-array-length\u003c/span\u003e := \u003ccode\u003e*\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA type \u003ccode\u003eT[]\u003c/code\u003e contains a list shape if all members of the list shape\nare in \u003ccode\u003eT\u003c/code\u003e. A type \u003ccode\u003eT[n]\u003c/code\u003e contains a list shape if in\naddition the length of the list shape is n.\n\u003c/p\u003e\n\u003cp\u003e\nA \u003ccode\u003econstant-reference-expr\u003c/code\u003e in an \u003ccode\u003earray-length\u003c/code\u003e must\nevaluate to a non-negative integer. An array length of \u003ccode\u003e*\u003c/code\u003e means that\nthe length of the array is to be inferred from the context; this is allowed only\nwithin a type descriptor occurring in a context that is specified to be\ninferable; its meaning is the same as if the length was specified explicitly.\n\u003c/p\u003e\n\u003cp\u003e\nNote also that \u003ccode\u003eT[n]\u003c/code\u003e is a subtype of \u003ccode\u003eT[]\u003c/code\u003e, and that if\n\u003ccode\u003eS\u003c/code\u003e is a subtype of \u003ccode\u003eT\u003c/code\u003e, then \u003ccode\u003eS[]\u003c/code\u003e is a\nsubtype of \u003ccode\u003eT[]\u003c/code\u003e; this is a consequence of the definition of\nsubtyping in terms of subset inclusion of the corresponding sets of shapes.\n\u003c/p\u003e\n\u003cp\u003e\nThe type of the values in the iteration sequence of a value belonging\n\u003ccode\u003eT[]\u003c/code\u003e is \u003ccode\u003eT\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch5 id=\"section_5.4.1.2\"\u003e5.4.1.2 Tuple types\u003c/h5\u003e\n\u003cp\u003e\nA tuple type descriptor describes a type of list value by specifying a separate\ntype for each member of the list.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"tuple-type-descriptor\"\u003etuple-type-descriptor\u003c/span\u003e :=\n   \u003ccode\u003e[\u003c/code\u003e \u003ca href=\"#tuple-member-type-descriptors\"\u003e\u003cspan class=\"ntref\"\u003etuple-member-type-descriptors\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e]\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"tuple-member-type-descriptors\"\u003etuple-member-type-descriptors\u003c/span\u003e :=\n   \u003ca href=\"#member-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003emember-type-descriptor\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#member-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003emember-type-descriptor\u003c/span\u003e\u003c/a\u003e)* [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#tuple-rest-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etuple-rest-descriptor\u003c/span\u003e\u003c/a\u003e]\n   | [ \u003ca href=\"#tuple-rest-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etuple-rest-descriptor\u003c/span\u003e\u003c/a\u003e ]\n\u003cspan class=\"ntdfn\" id=\"tuple-rest-descriptor\"\u003etuple-rest-descriptor\u003c/span\u003e := \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e...\u003c/code\u003e\n\n\u003c/pre\u003e\n\u003cp\u003e\nA tuple type descriptor T with m member type descriptors contains a list shape L\nof length n if and only if:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003em is less than or equal to n\u003c/li\u003e\n\u003cli\u003ethe i-th member type descriptor of T contains the i-th member of L for each\ni from 1 to m;\u003c/li\u003e\n\u003cli\u003eif n is greater than m, then T has a tuple-rest-descriptor\nR\u003ccode\u003e...\u003c/code\u003e, and R contains the j-th member of L for each j from m + 1 to\nn.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nNote that a tuple type where all the \u003ccode\u003emember-type-descriptor\u003c/code\u003es are\nthe same and there is no tuple-rest-descriptor is equivalent to an\narray-type-descriptor with a length.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.4.2\"\u003e5.4.2 Mappings\u003c/h4\u003e\n\u003cp\u003e\nA mapping value is a container where each member has a key, which is a string,\nthat uniquely identifies within the mapping. We use the term \u003cem\u003efield\u003c/em\u003e to\nmean the member together its key; the name of the field is the key, and the\nvalue of the field is that value of the member; no two fields in a mapping value\ncan have the same name.\n\u003c/p\u003e\n\u003cp\u003e\nThe shape of a mapping value is an unordered collection of field shapes one for\neach field. The field shape for a field f has a name, which is the same as the\nname of f, and a shape, which is the shape of the value of f.\n\u003c/p\u003e\n\u003cp\u003e\nEach field also has a read-only bit. This is in addition to the read-only bit of\nthe mapping value. If a mapping value's field has its read-only bit on, then\nthat field cannot be assigned to nor removed. If the mapping value's read-only\nbit is on, then the read-only bit of every field is also on. A field's read-only\nbit is fixed when the mapping value is constructed, and cannot be changed\nthereafter. If a field's read-only bit is on, the read-only bit of the value of\nthe field is also on. The read-only bit of a field is part of the read-only\naspect of the mapping value's shape.\n\u003c/p\u003e\n\u003cp\u003e\nA mapping is iterable: the iteration sequence consists of the members of the\nmapping and the iteration completion value is always nil. The order of the iteration\nsequence is implementation-dependent, but implementations are encouraged to\npreserve and use the order in which the fields were added.\n\u003c/p\u003e\n\u003cp\u003e\nThe type of mapping values can be described by two kinds of type descriptors.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"mapping-type-descriptor\"\u003emapping-type-descriptor\u003c/span\u003e :=\n   \u003ca href=\"#map-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003emap-type-descriptor\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#record-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003erecord-type-descriptor\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe inherent type of a mapping value must be a\n\u003ccode\u003emapping-type-descriptor\u003c/code\u003e. The inherent type of a mapping value\ndetermines a type T\u003csub\u003e\u003cem\u003ef\u003c/em\u003e\u003c/sub\u003e for the value of the field with name\n\u003cem\u003ef\u003c/em\u003e. The runtime system will enforce a constraint that a value written to\nfield \u003cem\u003ef\u003c/em\u003e will belong to type T\u003csub\u003e\u003cem\u003ef\u003c/em\u003e\u003c/sub\u003e. Note that the\nconstraint is not merely that the value looks like T\u003csub\u003e\u003cem\u003ef\u003c/em\u003e\u003c/sub\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nBoth kinds of type descriptor are covariant in the types of their members.\n\u003c/p\u003e\n\u003csection\u003e\n\u003ch5 id=\"section_5.4.2.1\"\u003e5.4.2.1 Map types\u003c/h5\u003e\n\u003cp\u003e\nA map type-descriptor describes a type of mapping value by specifying the type\nthat the value for all fields must belong to.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"map-type-descriptor\"\u003emap-type-descriptor\u003c/span\u003e := \u003ccode\u003emap\u003c/code\u003e \u003ca href=\"#type-parameter\"\u003e\u003cspan class=\"ntref\"\u003etype-parameter\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA type \u003ccode\u003emap\u0026lt;T\u0026gt;\u003c/code\u003e contains a mapping shape \u003cem\u003em\u003c/em\u003e if every field\nshape in \u003cem\u003em\u003c/em\u003e has a value shape that is in \u003ccode\u003eT\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThe type of the values in the iteration sequence of a value belonging\n\u003ccode\u003emap\u0026lt;T\u0026gt;\u003c/code\u003e is \u003ccode\u003eT\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nIf a type descriptor T has \u003ca href=\"#lax_static_typing\"\u003elax static typing\u003c/a\u003e,\nthen the type \u003ccode\u003emap\u0026lt;T\u0026gt;\u003c/code\u003e also has lax static typing.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch5 id=\"section_5.4.2.2\"\u003e5.4.2.2 Record types\u003c/h5\u003e\n\u003cp\u003e\nA record type descriptor describes a type of mapping value by specifying a type\nseparately for the value of each field.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"record-type-descriptor\"\u003erecord-type-descriptor\u003c/span\u003e :=\n   \u003ca href=\"#inclusive-record-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003einclusive-record-type-descriptor\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#exclusive-record-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003eexclusive-record-type-descriptor\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"inclusive-record-type-descriptor\"\u003einclusive-record-type-descriptor\u003c/span\u003e :=\n   \u003ccode\u003erecord\u003c/code\u003e \u003ccode\u003e{\u003c/code\u003e \u003ca href=\"#field-descriptor\"\u003e\u003cspan class=\"ntref\"\u003efield-descriptor\u003c/span\u003e\u003c/a\u003e* \u003ccode\u003e}\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"exclusive-record-type-descriptor\"\u003eexclusive-record-type-descriptor\u003c/span\u003e :=\n   \u003ccode\u003erecord\u003c/code\u003e \u003ccode\u003e{|\u003c/code\u003e \u003ca href=\"#field-descriptor\"\u003e\u003cspan class=\"ntref\"\u003efield-descriptor\u003c/span\u003e\u003c/a\u003e* [\u003ca href=\"#record-rest-descriptor\"\u003e\u003cspan class=\"ntref\"\u003erecord-rest-descriptor\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003e|}\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"field-descriptor\"\u003efield-descriptor\u003c/span\u003e :=\n   \u003ca href=\"#individual-field-descriptor\"\u003e\u003cspan class=\"ntref\"\u003eindividual-field-descriptor\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#record-type-inclusion\"\u003e\u003cspan class=\"ntref\"\u003erecord-type-inclusion\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"individual-field-descriptor\"\u003eindividual-field-descriptor\u003c/span\u003e :=\n   \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003ereadonly\u003c/code\u003e] \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#field-name\"\u003e\u003cspan class=\"ntref\"\u003efield-name\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003e?\u003c/code\u003e | (\u003ccode\u003e=\u003c/code\u003e \u003ca href=\"#default-expression\"\u003e\u003cspan class=\"ntref\"\u003edefault-expression\u003c/span\u003e\u003c/a\u003e)] \u003ccode\u003e;\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"field-name\"\u003efield-name\u003c/span\u003e := \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"default-expression\"\u003edefault-expression\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"record-type-inclusion\"\u003erecord-type-inclusion\u003c/span\u003e := \u003ccode\u003e*\u003c/code\u003e \u003ca href=\"#type-reference\"\u003e\u003cspan class=\"ntref\"\u003etype-reference\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"record-rest-descriptor\"\u003erecord-rest-descriptor\u003c/span\u003e := \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e...\u003c/code\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nEach \u003ccode\u003eindividual-field-descriptor\u003c/code\u003e specifies an additional constraint\nthat a mapping value shape must satisfy for it to be a member of the described\ntype. The constraint depends on whether \u003ccode\u003e?\u003c/code\u003e is present:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eif \u003ccode\u003e?\u003c/code\u003e is not present, then the constraint is that the mapping\nvalue shape must have a field shape with the specified field-name and with a\nvalue shape that is a member of the specified type-descriptor; this is called a\nrequired field;\u003c/li\u003e\n\u003cli\u003eif \u003ccode\u003e?\u003c/code\u003e is present, then the constraint is that if the mapping\nvalue shape has a field shape with the specified field-name, then its value\nshape must be a member of the specified type-descriptor; this is called an\noptional field.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIf an \u003ccode\u003eindividual-field-descriptor\u003c/code\u003e specifies \u003ccode\u003ereadonly\u003c/code\u003e,\nthen there is also a constraint that the field has its read-only bit set.\nFurthermore, the type of the field is the intersection of \u003ccode\u003ereadonly\u003c/code\u003e\nand the type specified by the type-descriptor.\n\u003c/p\u003e\n\u003cp\u003e\nThe order of the \u003ccode\u003eindividual-field-descriptor\u003c/code\u003es within a\n\u003ccode\u003erecord-type-descriptor\u003c/code\u003e is not significant. Note that the delimited\nidentifier syntax allows the field name to be any non-empty string.\n\u003c/p\u003e\n\u003cp\u003e\nAn exclusive-record-type-descriptor, which uses the \u003ccode\u003e{|\u003c/code\u003e and\n\u003ccode\u003e|}\u003c/code\u003e delimiters, allows exclusively the fields described. More\nprecisely, for a mapping value shape and a record-type-descriptor, let the extra\nfield shapes be the field shapes of the mapping value shapes whose names are not\nthe same as field-name of any individual-field-descriptor; a mapping value shape\nis a member of the type described by an exclusive-record-type-descriptor only if\neither:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethere are no extra fields shapes, or\u003c/li\u003e\n\u003cli\u003ethere is a record-rest-descriptor \u003ccode\u003eT...\u003c/code\u003e, and the value shape of\nevery extra field shape is a member of \u003ccode\u003eT\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nAn inclusive-record-type-descriptor, which uses the \u003ccode\u003e{\u003c/code\u003e and\n\u003ccode\u003e}\u003c/code\u003e delimiters, allows any mapping value that includes the fields\ndescribed, provided that the values of all other fields are plain data. A type\ndescriptor \u003ccode\u003erecord { F };\u003c/code\u003e is thus equivalent to \u003ccode\u003erecord {| F;\nanydata...; |}\u003c/code\u003e, where \u003ccode\u003eanydata\u003c/code\u003e is defined \u003ca href=\"#anydata\"\u003ebelow\u003c/a\u003e as the type descriptor for plain data.\n\u003c/p\u003e\n\u003cp\u003e\nA record type descriptor that either is an inclusive-record-type-descriptor or\nis an exclusive-record-type-descriptor with a record-rest-descriptor is called\n\u003cem\u003eopen\u003c/em\u003e; a record type descriptor that is not open is called\n\u003cem\u003eclosed\u003c/em\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nIf a record type descriptor is closed and every individual-field-descriptor\nspecifies \u003ccode\u003ereadonly\u003c/code\u003e, then it describes a type that is a subtype of\n\u003ccode\u003ereadonly\u003c/code\u003e: a shape belongs to the type only if its read-only bit is\nset.\n\u003c/p\u003e\n\u003cp\u003e\nA \u003ccode\u003edefault-expression\u003c/code\u003e is an expression that specifies a default\nvalue for the field, which is used when the record type descriptor is used to\nconstruct a mapping value but no value is specified explicitly for the field.\nThe type descriptor contains a 0-argument function closure for each default\nvalue. The closure is created from the expression when the type descriptor is\nresolved. The expression must meet the requirements for an \u003ca href=\"#isolated_functions\"\u003eisolated function\u003c/a\u003e. The closure is evaluated to\ncreate a field value each time the default is used in the construction of a\nmapping value. The default value does not affect the type described by the type\ndescriptor.\n\u003c/p\u003e\n\u003cp\u003e\nA \u003ccode\u003erecord-type-inclusion\u003c/code\u003e includes fields from a named record type.\nThe \u003ccode\u003etype-reference\u003c/code\u003e must reference a type described by a\n\u003ccode\u003erecord-type-descriptor\u003c/code\u003e. The \u003ccode\u003efield-descriptor\u003c/code\u003es and any\n\u003ccode\u003erecord-rest-descriptor\u003c/code\u003e are included the type being defined; the\nmeaning is the same as if they had been specified explicitly. For default\nvalues, the closure rather than the expression is copied in.\nIt is an error for an \u003ccode\u003erecord-type-descriptor\u003c/code\u003e to directly or\nindirectly include itself. An \u003ccode\u003eindividual-field-descriptor\u003c/code\u003e in a\n\u003ccode\u003erecord-type-descriptor\u003c/code\u003e can override an\n\u003ccode\u003eindividual-field-descriptor\u003c/code\u003e of the same name in an included\n\u003ccode\u003erecord-type-descriptor\u003c/code\u003e, provided the type declared for the field in\nthe overriding field descriptor is a subtype of the type declared in the\noverridden field descriptor. It is an error if a\n\u003ccode\u003erecord-type-descriptor\u003c/code\u003e has two or more\n\u003ccode\u003erecord-type-inclusion\u003c/code\u003es that include an\n\u003ccode\u003eindividual-field-descriptor\u003c/code\u003e with the same name, unless those\n\u003ccode\u003eindividual-field-descriptor\u003c/code\u003es are overridden by an\n\u003ccode\u003eindividual-field-descriptor\u003c/code\u003e in the including\n\u003ccode\u003erecord-type-descriptor\u003c/code\u003e. A \u003ccode\u003erecord-rest-descriptor\u003c/code\u003e in\nthe including type overrides any \u003ccode\u003erecord-rest-descriptor\u003c/code\u003e in the\nincluded type. It is an error if a \u003ccode\u003erecord-type-descriptor\u003c/code\u003e has two\nor more \u003ccode\u003erecord-type-inclusion\u003c/code\u003es that include different\n\u003ccode\u003erecord-rest-descriptor\u003c/code\u003es, unless those\n\u003ccode\u003erecord-rest-descriptor\u003c/code\u003es are overridden by an\n\u003ccode\u003erecord-rest-descriptor\u003c/code\u003e in the including\n\u003ccode\u003erecord-type-descriptor\u003c/code\u003e. For the purposes of\nresolving a \u003ccode\u003erecord-type-inclusion\u003c/code\u003e, an including or included type\nthat is an \u003ccode\u003einclusive-record-type-descriptor\u003c/code\u003e is treated as if it\nwere the equivalent \u003ccode\u003eexclusive-record-type-descriptor\u003c/code\u003e with an\nexplicit \u003ccode\u003erecord-rest-descriptor\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"tables\"\u003e5.4.3 Tables\u003c/h4\u003e\n\u003cp\u003e\nA table is a structural value, whose members are mapping values. A table\nprovides access to its members using a key that comes from the read-only fields\nof the member. It keeps its members in order, but does not provide random access\nto a member using its position in this order.\n\u003c/p\u003e\n\u003cp\u003e\nEvery table value has, in addition to its members, a key sequence, which is used\nto provide keyed access to its members. The key sequence is an ordered sequence\nof field names. The key sequence of a table is fixed when a table is\nconstructed and cannot be changed thereafter. For each field name in the key\nsequence, every member of the table must have a read-only field with that name\nand the value of the field must be acyclic plain data. A table's key sequence\ndetermines a key value for each member of the table: if the key sequence\nconsists of a single field name f, then the key value of a member is that value\nof field f of that member. If the key sequence consists of multiple field names\nf\u003csub\u003e1\u003c/sub\u003e,f\u003csub\u003e2\u003c/sub\u003e,...,f\u003csub\u003en\u003c/sub\u003e where n is â¥ 2, then the\nkey value for a member r is a tuple with members\nv\u003csub\u003e1\u003c/sub\u003e,v\u003csub\u003e2\u003c/sub\u003e,...,v\u003csub\u003en\u003c/sub\u003e where v\u003csub\u003ei\u003c/sub\u003e is the value\nof field f\u003csub\u003ei\u003c/sub\u003e of r. A table constrains its membership so that a key\nvalue uniquely identifies a member within the table. More precisely, for every\ntwo rows r\u003csub\u003ei\u003c/sub\u003e and r\u003csub\u003ej\u003c/sub\u003e in a table with i not equal to j, the\nkey value for r\u003csub\u003ei\u003c/sub\u003e must not be equal to the key value for\nr\u003csub\u003ej\u003c/sub\u003e. Key values are compared for equality using the \u003ca href=\"#DeepEquals\"\u003eDeepEquals\u003c/a\u003e abstract operation. This constraint is\nenforced by the table both when the table is constructed and when the table is\nmutated. As a special case, a table's key sequence may be empty; this represents\na keyless table, whose members are not uniquely identified by a key.\n\u003c/p\u003e\n\u003cp\u003e\nThe shape of a table value is a triple consisting of\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ean ordered list containing for each table member, the shape of that member\u003c/li\u003e\n\u003cli\u003ethe table's key sequence, and\u003c/li\u003e\n\u003cli\u003ea set containing for each table member, the shape of the key value of that\nmember (derived from the table members and the key sequence)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"table-type-descriptor\"\u003etable-type-descriptor\u003c/span\u003e := \u003ccode\u003etable\u003c/code\u003e \u003ca href=\"#row-type-parameter\"\u003e\u003cspan class=\"ntref\"\u003erow-type-parameter\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#key-constraint\"\u003e\u003cspan class=\"ntref\"\u003ekey-constraint\u003c/span\u003e\u003c/a\u003e]\n\u003cspan class=\"ntdfn\" id=\"row-type-parameter\"\u003erow-type-parameter\u003c/span\u003e := \u003ca href=\"#type-parameter\"\u003e\u003cspan class=\"ntref\"\u003etype-parameter\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"key-constraint\"\u003ekey-constraint\u003c/span\u003e := \u003ca href=\"#key-specifier\"\u003e\u003cspan class=\"ntref\"\u003ekey-specifier\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#key-type-constraint\"\u003e\u003cspan class=\"ntref\"\u003ekey-type-constraint\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"key-specifier\"\u003ekey-specifier\u003c/span\u003e := \u003ccode\u003ekey\u003c/code\u003e \u003ccode\u003e(\u003c/code\u003e [ \u003ca href=\"#field-name\"\u003e\u003cspan class=\"ntref\"\u003efield-name\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#field-name\"\u003e\u003cspan class=\"ntref\"\u003efield-name\u003c/span\u003e\u003c/a\u003e)* ] \u003ccode\u003e)\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"key-type-constraint\"\u003ekey-type-constraint\u003c/span\u003e := \u003ccode\u003ekey\u003c/code\u003e \u003ca href=\"#type-parameter\"\u003e\u003cspan class=\"ntref\"\u003etype-parameter\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe row-type-parameter specifies the shape of the table's members. A table type\n\u003ccode\u003etable\u0026lt;\u003cvar\u003eR\u003c/var\u003e\u0026gt; \u003cvar\u003eKC\u003c/var\u003e \u003c/code\u003e contains a table shape if\nand only if every table member shape belongs to \u003ccode\u003e\u003cvar\u003eR\u003c/var\u003e\u003c/code\u003e and\nthe table shape satisfies the key constraint \u003ccode\u003e\u003cvar\u003eKC\u003c/var\u003e\u003c/code\u003e. The\ntype specified by a row-type-parameter must be a subtype of\n\u003ccode\u003emap\u0026lt;any|error\u0026gt;\u003c/code\u003e\n\u003c/p\u003e\n\u003cp\u003e\nIn a table-type-descriptor \u003ccode\u003etable\u0026lt;\u003cvar\u003eR\u003c/var\u003e\u0026gt;\nkey(\u003cvar\u003eks\u003c/var\u003e)\u003c/code\u003e, \u003ccode\u003e\u003cvar\u003eR\u003c/var\u003e\u003c/code\u003e and\n\u003ccode\u003e\u003cvar\u003eks\u003c/var\u003e\u003c/code\u003e must be consistent in the following sense: for each\nfield name f\u003csub\u003ei\u003c/sub\u003e in \u003ccode\u003e\u003cvar\u003eks\u003c/var\u003e\u003c/code\u003e, f\u003csub\u003ei\u003c/sub\u003e must be a\nrequired, read-only field of \u003ccode\u003e\u003cvar\u003eR\u003c/var\u003e\u003c/code\u003e with a type that is a\nsubtype of \u003ccode\u003eanydata\u003c/code\u003e. A table shape satisfies a key-constraint\n\u003ccode\u003ekey(\u003cvar\u003eks\u003c/var\u003e)\u003c/code\u003e if and only if its key sequence is\n\u003ccode\u003e\u003cvar\u003eks\u003c/var\u003e\u003c/code\u003e. A table shape satisfies a key-constraint\n\u003ccode\u003ekey\u0026lt;K\u0026gt;\u003c/code\u003e if and and only if its set of key value shapes are a\nsubset of \u003ccode\u003e\u003cvar\u003eK\u003c/var\u003e\u003c/code\u003e. The shape of a keyless table satisfies the\nkey-constraint \u003ccode\u003ekey\u0026lt;never\u0026gt;\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nAs with other structured values, a table value has an inherent type. The\ninherent type of a table value must be a table-type-descriptor with a\nkey-constraint that is a key-specifier.\n\u003c/p\u003e\n\u003cp\u003e\nA table is iterable: the iteration sequence consists of the members of the\ntable in order and the iteration completion value is always nil.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_5.5\"\u003e5.5 Behavioral values\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"behavioral-type-descriptor\"\u003ebehavioral-type-descriptor\u003c/span\u003e :=\n   \u003ca href=\"#error-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003eerror-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#function-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003efunction-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#object-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003eobject-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#future-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003efuture-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#typedesc-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etypedesc-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#handle-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003ehandle-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#stream-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003estream-type-descriptor\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_5.5.1\"\u003e5.5.1 Errors\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"error-type-descriptor\"\u003eerror-type-descriptor\u003c/span\u003e := \u003ccode\u003eerror\u003c/code\u003e [\u003ca href=\"#type-parameter\"\u003e\u003cspan class=\"ntref\"\u003etype-parameter\u003c/span\u003e\u003c/a\u003e]\n\u003c/pre\u003e\n\u003cp\u003e\nAn error value provides information about an error that has occurred. Error\nvalues belong to a separate basic type; this makes it possible for language\nconstructs to handle errors differently from other values.\n\u003c/p\u003e\n\u003cp\u003e\nThe error type is inherently immutable. An error value contains the following\ninformation:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ea message, which is a string containing a human-readable message describing\nthe error\u003c/li\u003e\n\u003cli\u003ea cause, which is either nil or another error value that was the cause of\nthis error\u003c/li\u003e\n\u003cli\u003ea detail, which is an immutable mapping providing additional information about\nthe error\u003c/li\u003e\n\u003cli\u003ea stack trace, which is an immutable snapshot of the state of the execution\nstack\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe detail mapping must be a subtype of \u003ccode\u003emap\u0026lt;Cloneable\u0026gt;\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThe shapes of the message, cause and detail record are part of the shape of the\nerror; the stack trace is not part of the shape. A type descriptor\n\u003ccode\u003eerror\u0026lt;\u003cvar\u003eT\u003c/var\u003e\u0026gt;\u003c/code\u003e contains an error shape if\n\u003ccode\u003e\u003cvar\u003eT\u003c/var\u003e\u003c/code\u003e contains the shape of its detail. The type\n\u003ccode\u003eerror\u003c/code\u003e contains a shape if its basic type is error.\n\u003c/p\u003e\n\u003cp\u003e\nAn error-type-descriptor is always definite and induces an empty set of\ntype-ids. An intersection type can be used to describe an error type that induces\na non-empty set of type-ids.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"functions\"\u003e5.5.2 Functions\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"function-type-descriptor\"\u003efunction-type-descriptor\u003c/span\u003e :=\n   \u003ca href=\"#function-quals\"\u003e\u003cspan class=\"ntref\"\u003efunction-quals\u003c/span\u003e\u003c/a\u003e \u003ccode\u003efunction\u003c/code\u003e \u003ca href=\"#function-signature\"\u003e\u003cspan class=\"ntref\"\u003efunction-signature\u003c/span\u003e\u003c/a\u003e\n   | [\u003ca href=\"#isolated-qual\"\u003e\u003cspan class=\"ntref\"\u003eisolated-qual\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003efunction\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"function-quals\"\u003efunction-quals\u003c/span\u003e :=\n   \u003ca href=\"#transactional-qual\"\u003e\u003cspan class=\"ntref\"\u003etransactional-qual\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#isolated-qual\"\u003e\u003cspan class=\"ntref\"\u003eisolated-qual\u003c/span\u003e\u003c/a\u003e]\n   | [\u003ca href=\"#isolated-qual\"\u003e\u003cspan class=\"ntref\"\u003eisolated-qual\u003c/span\u003e\u003c/a\u003e] [\u003ca href=\"#transactional-qual\"\u003e\u003cspan class=\"ntref\"\u003etransactional-qual\u003c/span\u003e\u003c/a\u003e]\n\u003cspan class=\"ntdfn\" id=\"isolated-qual\"\u003eisolated-qual\u003c/span\u003e := \u003ccode\u003eisolated\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"transactional-qual\"\u003etransactional-qual\u003c/span\u003e := \u003ccode\u003etransactional\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"function-signature\"\u003efunction-signature\u003c/span\u003e := \u003ccode\u003e(\u003c/code\u003e \u003ca href=\"#param-list\"\u003e\u003cspan class=\"ntref\"\u003eparam-list\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e)\u003c/code\u003e \u003ca href=\"#return-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003ereturn-type-descriptor\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA function is a part of a program that can be explicitly executed. In Ballerina,\na function is also a value, implying that it can be stored in variables, and\npassed to or returned from functions. When a function is executed, it is passed\nan argument list as input and returns a value as output.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"param-list\"\u003eparam-list\u003c/span\u003e :=\n   \u003ca href=\"#required-params\"\u003e\u003cspan class=\"ntref\"\u003erequired-params\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#defaultable-params\"\u003e\u003cspan class=\"ntref\"\u003edefaultable-params\u003c/span\u003e\u003c/a\u003e] [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#included-record-params\"\u003e\u003cspan class=\"ntref\"\u003eincluded-record-params\u003c/span\u003e\u003c/a\u003e] [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#rest-param\"\u003e\u003cspan class=\"ntref\"\u003erest-param\u003c/span\u003e\u003c/a\u003e]\n   | \u003ca href=\"#defaultable-params\"\u003e\u003cspan class=\"ntref\"\u003edefaultable-params\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#included-record-params\"\u003e\u003cspan class=\"ntref\"\u003eincluded-record-params\u003c/span\u003e\u003c/a\u003e] [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#rest-param\"\u003e\u003cspan class=\"ntref\"\u003erest-param\u003c/span\u003e\u003c/a\u003e]\n   | \u003ca href=\"#included-record-params\"\u003e\u003cspan class=\"ntref\"\u003eincluded-record-params\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#rest-param\"\u003e\u003cspan class=\"ntref\"\u003erest-param\u003c/span\u003e\u003c/a\u003e]\n   | [\u003ca href=\"#rest-param\"\u003e\u003cspan class=\"ntref\"\u003erest-param\u003c/span\u003e\u003c/a\u003e]\n\u003cspan class=\"ntdfn\" id=\"required-params\"\u003erequired-params\u003c/span\u003e := \u003ca href=\"#required-param\"\u003e\u003cspan class=\"ntref\"\u003erequired-param\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#required-param\"\u003e\u003cspan class=\"ntref\"\u003erequired-param\u003c/span\u003e\u003c/a\u003e)*\n\u003cspan class=\"ntdfn\" id=\"required-param\"\u003erequired-param\u003c/span\u003e := [\u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#param-name\"\u003e\u003cspan class=\"ntref\"\u003eparam-name\u003c/span\u003e\u003c/a\u003e]\n\u003cspan class=\"ntdfn\" id=\"defaultable-params\"\u003edefaultable-params\u003c/span\u003e := \u003ca href=\"#defaultable-param\"\u003e\u003cspan class=\"ntref\"\u003edefaultable-param\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#defaultable-param\"\u003e\u003cspan class=\"ntref\"\u003edefaultable-param\u003c/span\u003e\u003c/a\u003e)*\n\u003cspan class=\"ntdfn\" id=\"defaultable-param\"\u003edefaultable-param\u003c/span\u003e := [\u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#param-name\"\u003e\u003cspan class=\"ntref\"\u003eparam-name\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003e=\u003c/code\u003e (\u003ca href=\"#default-expression\"\u003e\u003cspan class=\"ntref\"\u003edefault-expression\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#inferred-typedesc-default\"\u003e\u003cspan class=\"ntref\"\u003einferred-typedesc-default\u003c/span\u003e\u003c/a\u003e) \n\u003cspan class=\"ntdfn\" id=\"included-record-params\"\u003eincluded-record-params\u003c/span\u003e := \u003ca href=\"#included-record-param\"\u003e\u003cspan class=\"ntref\"\u003eincluded-record-param\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#included-record-param\"\u003e\u003cspan class=\"ntref\"\u003eincluded-record-param\u003c/span\u003e\u003c/a\u003e)*\n\u003cspan class=\"ntdfn\" id=\"included-record-param\"\u003eincluded-record-param\u003c/span\u003e := [\u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003e*\u003c/code\u003e \u003ca href=\"#type-reference\"\u003e\u003cspan class=\"ntref\"\u003etype-reference\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#param-name\"\u003e\u003cspan class=\"ntref\"\u003eparam-name\u003c/span\u003e\u003c/a\u003e]\n\u003cspan class=\"ntdfn\" id=\"rest-param\"\u003erest-param\u003c/span\u003e := [\u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e...\u003c/code\u003e [\u003ca href=\"#param-name\"\u003e\u003cspan class=\"ntref\"\u003eparam-name\u003c/span\u003e\u003c/a\u003e]\n\u003cspan class=\"ntdfn\" id=\"param-name\"\u003eparam-name\u003c/span\u003e := \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"inferred-typedesc-default\"\u003einferred-typedesc-default\u003c/span\u003e := \u003ccode\u003e\u0026lt;\u003c/code\u003e \u003ccode\u003e\u0026gt;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA param-name can be omitted from a required-param, defaultable-param,\nincluded-record-param or rest-param only when occuring in the function-signature\nof a function-type-descriptor. The type-descriptor in a required-param or\ndefaultable-param must not be \u003ccode\u003enever\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThe argument list passed to a function consists of zero or more arguments in order;\neach argument is a value, but the argument list itself is not passed as a value.\nThe argument list must conform to the param-list as described in this section.\nUsually, the compiler's type checking will ensure that this is the case; if not,\nthe function will panic.\n\u003c/p\u003e\n\u003cp\u003e\nIt is convenient to consider the complete param-list as having a type. This type\nis described by a tuple-type-descriptor that has a member-type-descriptor for\neach required-param, defaultable-param and included-record-param, and has a\ntuple-rest-descriptor if and only if there is a rest-param. The i-th\nmember-type-descriptor of the tuple type descriptor is the same as the\ntype-descriptor of the i-th member of the param-list; for an\nincluded-record-param, the type-descriptor is the type-reference; the\ntype-descriptor of the tuple-rest-descriptor, if present, is the same as the\ntype-descriptor of the rest-param.\n\u003c/p\u003e\n\u003cp\u003e\nAn argument list consisting of values v\u003csub\u003e1\u003c/sub\u003e,..., v\u003csub\u003en\u003c/sub\u003e conforms\nto a param-list that has type P, if and only if for each i with 1 â¤ i â¤\nn, v\u003csub\u003ei\u003c/sub\u003e belongs to T\u003csub\u003ei\u003c/sub\u003e, where T\u003csub\u003ei\u003c/sub\u003e is defined to be the type\nthat contains a shape s if and only if P contains a list shape whose i-th member\nis s.\n\u003c/p\u003e\n\u003cp\u003e\nA defaultable-param is a parameter for which a default value is specified. An\nexpression can be used to specify the default value; this expression may refer\nto previous parameters. Each such expression is turned into a closure that\ncomputes the default value for the parameter using the values of previous\nparameters, and this closure is part of the type descriptor for the function. It\nis also possible for the default to be specified as \u003ccode\u003e\u0026lt;\u0026gt;\u003c/code\u003e; this\nmeans that the default value is a \u003ccode\u003etypedesc\u003c/code\u003e value that is to be\ninferred by the caller from the contextually expected type of the function call.\nIt is allowed only when the parameter name to which the default value applies is\nreferenced in the return-type-descriptor, as described below, and is allowed for\nat most one parameter in a function. The caller of the function uses the\nfunction's type descriptor to compute default values for any defaultable\narguments that were not specified explicitly. These default values are included\nin the argument list passed to the function. Whether a parameter is defaultable,\nand what its default is, do not affect the shape of the function and thus do not\naffect typing. The closures computing the defaultable parameters are created\nwhen the type descriptor is resolved; the default value is computed by calling\nthe closure each time the function is called and the corresponding parameter is\nnot specified. Whether a parameter is defaultable is used at compile time, but\nthe closure that computes the default value is only used at runtime. If the\nfunction-type-descriptor includes an isolated-qual, then an expression used as a\ndefault-expression must meet the requirements for an \u003ca href=\"#isolated_functions\"\u003eisolated function\u003c/a\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThe name of each parameter is included in the function's type descriptor. A\ncaller of the function may specify the name of the parameter that an argument is\nsupplying. In this case, the caller uses the parameter name at compile time in\nconjunction with the type descriptor to create the argument list. The\nparameter names do not affect the shape of the function and thus do not affect\ntyping.\n\u003c/p\u003e\n\u003cp\u003e\nThe type-reference in an included-record-param must refer to a type defined by a\nrecord-type-descriptor. Specifying an included-record-param \u003ccode\u003e*\u003cvar\u003eT\u003c/var\u003e\n\u003cvar\u003ep\u003c/var\u003e\u003c/code\u003e is similar to specifying a required-param \u003ccode\u003e\u003cvar\u003eT\u003c/var\u003e\n\u003cvar\u003ep\u003c/var\u003e\u003c/code\u003e. The difference is that the caller of the function may\nspecify the value for a field of an included-record-param using the field's name\nas if it had been declared as a parameter. Any field of the\nincluded-record-param not so specified is defaulted using the\nrecord-type-descriptor. A field-descriptor is a \u003ccode\u003eparameter field\ndescriptor\u003c/code\u003e of a function if it is a field descriptor of a\nrecord-type-descriptor referenced by an included-record-param of the function.\nThe field names of all the parameter field descriptors whose type is not\n\u003ccode\u003enever\u003c/code\u003e must be distinct from each other and from the names of the\nparameters. Whether a parameter is an included-record-param is part of the\nfunction's type-descriptor, but does not affect the shape of the function and\nthus does not affect whether a function value belongs to a function type.\n\u003c/p\u003e\n\u003cp\u003e\nThe process by which the function caller creates an argument list, which may\nmake use of arguments specified both by position and by name, is described in\nmore detail in the \u003ca href=\"#function_call\"\u003esection on function calls\u003c/a\u003e.\n\u003c/p\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"return-type-descriptor\"\u003ereturn-type-descriptor\u003c/span\u003e := [ \u003ccode\u003ereturns\u003c/code\u003e [\u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e ]\n\u003c/pre\u003e\n\u003cp\u003e\nWhen the execution of a function returns to its caller, it returns exactly one\nvalue. A function that would in other programming languages not return a value\nis represented in Ballerina by a function returning \u003ccode\u003e()\u003c/code\u003e. Note that\nthe function definition does not have to explicitly return \u003ccode\u003e()\u003c/code\u003e; a\nreturn statement or falling off the end of the function body will implicitly\nreturn \u003ccode\u003e()\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThe value returned by a function will belong to the type specified in the\nreturn-type-descriptor. An empty return-type-descriptor is equivalent to\n\u003ccode\u003ereturns ()\u003c/code\u003e. The type-descriptor in a return-type-descriptor may be\n\u003ccode\u003enever\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nA return-type-descriptor may be depend on the param-list in the following way. A\ntype-reference occurring in a return-type-descriptor can refer to a parameter\nname if the type of the parameter is a subtype of \u003ccode\u003etypedesc\u003c/code\u003e. If p is\nsuch a parameter, then a reference to p in the return-type-descriptor denotes\nthe type that is the value of p. If the default value for p is\n\u003ccode\u003e\u0026lt;\u0026gt;\u003c/code\u003e and p occurs in the return-type-descriptor in a union p|T,\nthen for every basic type B, either the intersection of B and T must be empty,\nor the intersection of typedesc\u0026lt;B\u0026gt; and the declared type of p must be\nempty, or both. The return-type-descriptor thus denotes a\ndistinct set of shapes for each invocation of the function. A function-signature\nwith a return-type-descriptor that uses a type-reference to refer to a parameter\nname in this way is said to be \u003cem\u003edependently-typed\u003c/em\u003e. Functions with\ndependently-types signatures can be declared and used within Ballerina, but\nBallerina does not yet provide a mechanism to define such functions.\n\u003c/p\u003e\n\u003cp\u003e\nFunction types are covariant in their return types and contravariant in the type\nof their parameter lists. More precisely, a function type with return type R and\nparameter list type P is a subtype of a function type with return type R' and\nparameter list type P' if and only if R is a subtype of R' and P' is a subtype\nof P. A function value f belongs to a function type T if the declared type of f\nis a subtype of T.\n\u003c/p\u003e\n\u003cp\u003e\nIf a function-type-descriptor includes an \u003ccode\u003eisolated-qual\u003c/code\u003e, then a\nfunction value belongs to the type only if the value's isolated bit is set; if\nthe function type does not include an \u003ccode\u003eisolated-qual\u003c/code\u003e, then whether a\nfunction value belongs to the type is not affected by the value's isolated bit.\n\u003c/p\u003e\n\u003cp\u003e\nAll function values belongs to a function-type-descriptor \u003ccode\u003efunction\u003c/code\u003e;\na function value belongs to the function-type-descriptor \u003ccode\u003eisolated\nfunction\u003c/code\u003e if and only if it is an isolated function.\n\u003c/p\u003e\n\u003cp\u003e\nIn addition to a readonly bit and an isolated bit, a function value also has a\ntransactional bit. A function value with its transactional bit set can only be\ncalled in a \u003ca href=\"#transactions\"\u003etransactional scope\u003c/a\u003e; this is enforced by\nthe type system. A function value with its transactional bit not set belongs to\nthe type described by a function-type-descriptor with a function-signature only\nif the function-type-descriptor does not include a \u003ccode\u003etransactional\u003c/code\u003e\nqualifier. This means that a function-type-descriptor with a function-signature\nbut without a \u003ccode\u003etransactional\u003c/code\u003e qualifier is a subtype of the\ncorresponding function-type-descriptor with a \u003ccode\u003etransactional\u003c/code\u003e\nqualifier. Note that the subtyping relationship for \u003ccode\u003etransactional\u003c/code\u003e\nis in the opposite direction from \u003ccode\u003eisolated\u003c/code\u003e. A function value's\ntransactional bit does not affect whether it belongs to the type described by a\nfunction-type-descriptor without a function-signature.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.5.3\"\u003e5.5.3 Objects\u003c/h4\u003e\n\u003cp\u003e\nAn object value encapsulates data with functions that operate on the data. An\nobject consists of named members, where each member is either a field or a\nmethod. A field of an object stores a value. A method of an object is a function\nthat can be invoked on the object using a \u003ccode\u003emethod-call-expr\u003c/code\u003e; when a\nmethod is invoked on an object, the function can access the object using the\n\u003ccode\u003eself\u003c/code\u003e variable. An object's methods are associated with the object\nwhen the object is constructed and cannot be changed thereafter. Fields and\nmethods have names that uniquely identify them within their object; fields and\nmethods share a single symbol space; it is not possible for an object to have a\nfield and a method with the same name.\n\u003c/p\u003e\n\u003cp\u003e\nThe type of object values can be described using an\n\u003ccode\u003eobject-type-descriptor\u003c/code\u003e, as specified in this section. It can also\nbe described using a \u003cem\u003eclass\u003c/em\u003e. A class both describes an object type and\nprovides a way to construct an object belonging to the type; in particular, it\nprovides the method definitions that are associated with the object when it is\nconstructed. A class is defined using a module-level class definition.\n\u003c/p\u003e\n\u003cp\u003e\nThe object basic type is selectively immutable. An object value has a read-only\nbit, which is fixed when the object is constructed. An\n\u003ccode\u003eobject-type-descriptor\u003c/code\u003e does not describe whether the object's\nread-only bit is set: whether a value belongs to the type described by an\n\u003ccode\u003eobject-type-descriptor\u003c/code\u003e is not affected by the object's read-only\nbit. Whether an object is read-only can be described separately using a\n\u003ccode\u003ereadonly\u003c/code\u003e type descriptor, which can be combined with an\n\u003ccode\u003eobject-type-descriptor\u003c/code\u003e using the type intersection operator.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"object-type-descriptor\"\u003eobject-type-descriptor\u003c/span\u003e :=\n   \u003ca href=\"#object-type-quals\"\u003e\u003cspan class=\"ntref\"\u003eobject-type-quals\u003c/span\u003e\u003c/a\u003e \u003ccode\u003eobject\u003c/code\u003e \u003ccode\u003e{\u003c/code\u003e\n      \u003ca href=\"#object-member-descriptor\"\u003e\u003cspan class=\"ntref\"\u003eobject-member-descriptor\u003c/span\u003e\u003c/a\u003e*\n   \u003ccode\u003e}\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"object-type-quals\"\u003eobject-type-quals\u003c/span\u003e :=\n   \u003ca href=\"#isolated-qual\"\u003e\u003cspan class=\"ntref\"\u003eisolated-qual\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#object-network-qual\"\u003e\u003cspan class=\"ntref\"\u003eobject-network-qual\u003c/span\u003e\u003c/a\u003e]\n   | [\u003ca href=\"#object-network-qual\"\u003e\u003cspan class=\"ntref\"\u003eobject-network-qual\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#isolated-qual\"\u003e\u003cspan class=\"ntref\"\u003eisolated-qual\u003c/span\u003e\u003c/a\u003e]]\n\u003cspan class=\"ntdfn\" id=\"object-member-descriptor\"\u003eobject-member-descriptor\u003c/span\u003e :=\n   \u003ca href=\"#object-field-descriptor\"\u003e\u003cspan class=\"ntref\"\u003eobject-field-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#method-decl\"\u003e\u003cspan class=\"ntref\"\u003emethod-decl\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#remote-method-decl\"\u003e\u003cspan class=\"ntref\"\u003eremote-method-decl\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#object-type-inclusion\"\u003e\u003cspan class=\"ntref\"\u003eobject-type-inclusion\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nIf an isolated-qual is specified, then an object belongs to the described type\nonly if the object's isolated bit is set. If an isolated-qual is not specified,\nthen an object's isolated bit does not affect whether it belongs to the\ndescribed type.\n\u003c/p\u003e\n\n\u003csection\u003e\n\u003ch5 id=\"section_5.5.3.1\"\u003e5.5.3.1 Network interaction\u003c/h5\u003e\n\u003cp\u003e\nObjects are the basis for Ballerina's network interaction primitives. There are\ntwo special kinds of object for network interaction: client objects and service\nobjects. A client object supports network interaction with a remote system that\nis originated by the Ballerina program. A service object supports network\ninteraction with a remote system that is originated by the remote system. An\nobject may be a client object or a service object or neither; it cannot be both\na client object and a service object. An object that is a client object or a\nservice object is a network interaction object.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"object-network-qual\"\u003eobject-network-qual\u003c/span\u003e := \u003ccode\u003eclient\u003c/code\u003e | \u003ccode\u003eservice\u003c/code\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nIf the \u003ccode\u003eobject-network-qual\u003c/code\u003e is \u003ccode\u003eclient\u003c/code\u003e, then an object\nbelongs to the type only if it is a client object. If the\n\u003ccode\u003eobject-network-qual\u003c/code\u003e is \u003ccode\u003eservice\u003c/code\u003e, then an object belongs\nto the type only if it is a service object. If \u003ccode\u003eobject-network-qual\u003c/code\u003e\nis not present, then an object belongs to the type regardless of whether it is a\nclient object or service object or neither. A \u003ccode\u003eobject-network-qual\u003c/code\u003e\nis not allowed in conjunction with \u003ccode\u003epublic\u003c/code\u003e.\n\u003c/p\u003e\n\n\u003cp\u003e\nNetwork interaction objects provide two additional features: remote methods and\nresources. Remote methods are supported by both client and service objects. The\nremote methods of an object are in a separate symbol space from the other\nmethods of the object. Resources are supported only by service objects. Object\ntype descriptors do not provide a way to describe the resources of a service\nobject: whether a service object belongs to an object type is not affected by\nthe service object's resources. Resources are described in detail in the \u003ca href=\"#resources\"\u003esection\u003c/a\u003e on object constructors.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch5 id=\"section_5.5.3.2\"\u003e5.5.3.2 Fields\u003c/h5\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"object-field-descriptor\"\u003eobject-field-descriptor\u003c/span\u003e :=\n   \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003epublic\u003c/code\u003e] \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#field-name\"\u003e\u003cspan class=\"ntref\"\u003efield-name\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nAn \u003ccode\u003eobject-field-descriptor\u003c/code\u003e describes a field of the object. The\n\u003ccode\u003efield-name\u003c/code\u003e of an \u003ccode\u003eobject-field-descriptor\u003c/code\u003e must be\ndistinct from the \u003ccode\u003efield-name\u003c/code\u003e of every other\n\u003ccode\u003eobject-field-descriptor\u003c/code\u003e in the \u003ccode\u003eobject-type-descriptor\u003c/code\u003e\nand from the \u003ccode\u003emethod-name\u003c/code\u003e of every \u003ccode\u003emethod-decl\u003c/code\u003e in the\n\u003ccode\u003eobject-type-descriptor\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nIf an object's read-only bit is set, then the read-only bit of the value of\nevery field must also be set and the value of a field cannot be changed after\nthe object has been constructed.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch5 id=\"section_5.5.3.3\"\u003e5.5.3.3 Methods\u003c/h5\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"method-decl\"\u003emethod-decl\u003c/span\u003e :=\n   \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003epublic\u003c/code\u003e] \u003ca href=\"#method-quals\"\u003e\u003cspan class=\"ntref\"\u003emethod-quals\u003c/span\u003e\u003c/a\u003e\n   \u003ccode\u003efunction\u003c/code\u003e \u003ca href=\"#method-name\"\u003e\u003cspan class=\"ntref\"\u003emethod-name\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#function-signature\"\u003e\u003cspan class=\"ntref\"\u003efunction-signature\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"method-quals\"\u003emethod-quals\u003c/span\u003e := \u003ca href=\"#function-quals\"\u003e\u003cspan class=\"ntref\"\u003efunction-quals\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"method-name\"\u003emethod-name\u003c/span\u003e := \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003emethod-decl\u003c/code\u003e describes a method of the object. The\n\u003ccode\u003emethod-name\u003c/code\u003e of a \u003ccode\u003emethod-decl\u003c/code\u003e must be distinct from the\n\u003ccode\u003emethod-name\u003c/code\u003e of every other \u003ccode\u003emethod-decl\u003c/code\u003e in the\n\u003ccode\u003eobject-type-descriptor\u003c/code\u003e and from the \u003ccode\u003efield-name\u003c/code\u003e of\nevery \u003ccode\u003eobject-field-descriptor\u003c/code\u003e in the\n\u003ccode\u003eobject-type-descriptor\u003c/code\u003e. Note that here is no method overloading.\nThe \u003ccode\u003emethod-name\u003c/code\u003e in a \u003ccode\u003emethod-decl\u003c/code\u003e must not be\n\u003ccode\u003einit\u003c/code\u003e.\n\u003c/p\u003e\n\n\u003cp\u003e\nThe \u003ccode\u003eisolated-qual\u003c/code\u003e together with the \u003ccode\u003efunction-signature\u003c/code\u003e\ngive the function type of the method. An isolated method has the same access to\nthe object on which the method is invoked that it has to parameters.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"remote-method-decl\"\u003eremote-method-decl\u003c/span\u003e :=\n   \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#remote-method-quals\"\u003e\u003cspan class=\"ntref\"\u003eremote-method-quals\u003c/span\u003e\u003c/a\u003e \n   \u003ccode\u003efunction\u003c/code\u003e \u003ca href=\"#method-name\"\u003e\u003cspan class=\"ntref\"\u003emethod-name\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#function-signature\"\u003e\u003cspan class=\"ntref\"\u003efunction-signature\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"remote-method-quals\"\u003eremote-method-quals\u003c/span\u003e :=\n   \u003ca href=\"#remote-qual\"\u003e\u003cspan class=\"ntref\"\u003eremote-qual\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#function-quals\"\u003e\u003cspan class=\"ntref\"\u003efunction-quals\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#isolated-qual\"\u003e\u003cspan class=\"ntref\"\u003eisolated-qual\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#transactional-qual\"\u003e\u003cspan class=\"ntref\"\u003etransactional-qual\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#remote-qual\"\u003e\u003cspan class=\"ntref\"\u003eremote-qual\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#transactional-qual\"\u003e\u003cspan class=\"ntref\"\u003etransactional-qual\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#isolated-qual\"\u003e\u003cspan class=\"ntref\"\u003eisolated-qual\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#remote-qual\"\u003e\u003cspan class=\"ntref\"\u003eremote-qual\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#isolated-qual\"\u003e\u003cspan class=\"ntref\"\u003eisolated-qual\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#remote-qual\"\u003e\u003cspan class=\"ntref\"\u003eremote-qual\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#transactional-qual\"\u003e\u003cspan class=\"ntref\"\u003etransactional-qual\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#transactional-qual\"\u003e\u003cspan class=\"ntref\"\u003etransactional-qual\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#remote-qual\"\u003e\u003cspan class=\"ntref\"\u003eremote-qual\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#isolated-qual\"\u003e\u003cspan class=\"ntref\"\u003eisolated-qual\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"remote-qual\"\u003eremote-qual\u003c/span\u003e := \u003ccode\u003eremote\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003eremote-method-decl\u003c/code\u003e declares a remote method. An object can\ninclude a \u003ccode\u003eremote-method-decl\u003c/code\u003e only if it is a network interaction\nobject. A remote method is a method for network interaction: a remote method of\na client object is for outbound network interaction; a remote method of a\nservice object is for inbound network interaction. The \u003ccode\u003emethod-name\u003c/code\u003e\nof a \u003ccode\u003eremote-method-decl\u003c/code\u003e must be distinct from the\n\u003ccode\u003emethod-name\u003c/code\u003e of every other \u003ccode\u003eremote-method-decl\u003c/code\u003e in the\n\u003ccode\u003eobject-type-descriptor\u003c/code\u003e. However, a \u003ccode\u003emethod-decl\u003c/code\u003e and a\n\u003ccode\u003eremote-method-decl\u003c/code\u003e can have the same name. A remote method cannot\nbe called using the normal method call syntax. A remote method of a client\nobject can only be invoked by a \u003ccode\u003eclient-remote-method-call-action\u003c/code\u003e.\nThe return type of the remote method of a client object must not be\n\u003ccode\u003enever\u003c/code\u003e. A remote method of a service object is invoked by a listener\nobject provided by a library module; Ballerina does not yet define a mechanism\nto allow such a library module to be implemented completely in Ballerina.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch5 id=\"section_5.5.3.4\"\u003e5.5.3.4 Visibility\u003c/h5\u003e\n\u003cp\u003e\nEach field and method of an object has a \u003cem\u003evisibility region\u003c/em\u003e, which is\nthe region of code within which the field or method is visible and can be\naccessed. The visibility region of a \u003ccode\u003eremote-method-decl\u003c/code\u003e or of\n\u003ccode\u003eobject-field-descriptor\u003c/code\u003e or \u003ccode\u003emethod-decl\u003c/code\u003e that includes\n\u003ccode\u003epublic\u003c/code\u003e consists of all the modules of the program. Otherwise the\nvisibility region is the module containing this object type descriptor; this is\ncalled module-level visibility.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch5 id=\"section_5.5.3.5\"\u003e5.5.3.5 Typing\u003c/h5\u003e\n\n\u003cp\u003e\nThe shape of an object consists of a read-only bit, an isolated bit, a network\ninteraction kind and an unordered collection of object field shapes and object\nmethod shapes. A network interaction kind has one of three values: service,\nclient or empty. An object field shape or object method shape is a 4-tuple\nconsisting of the name of the field or method, the visibility region, a remote\nflag and a shape for the value of the field or for the method's function.\n\u003c/p\u003e\n\u003cp\u003e\nAn object type is inclusive, in a similar way to an\ninclusive-record-type-descriptor: an object shape belongs to an object type if\nit has at least the fields and methods described in the object-type-descriptor.\nThus all object values belong to the type \u003ccode\u003eobject { }\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nAn object-type-descriptor that has a field with name f, visibility region R and\ntype T contains an object shape only if the object shape contains an object\nfield shape that has name f, visibility region R and a value shape that is\ncontained in T. An object-type-descriptor that has a method with name m,\nvisibility region R, remote qualifier r and function type T contains an object\nshape only if the object shape contains an object method shape that has name m,\nvisibility region R, a remote flag that matches r and a function value that\nbelongs to type T.\n\u003c/p\u003e\n\u003cp\u003e\nThus an object type T' is a subtype of an object type T only if for each field\nor method f of T there is a corresponding field or method f' of T such that the\ntype of f' in T' is a subtype of the type of f in T and the visibility region of\nf' in T' is the same as the visibility region of f in T. This implies that if an\nobject type descriptor T has fields or methods with module-level visibility,\nthen it is possible to define another object type descriptor that is a subtype\nof T only within the same module as T.\n\u003c/p\u003e\n \n\u003c/section\u003e\n\u003csection\u003e\n\u003ch5 id=\"section_5.5.3.6\"\u003e5.5.3.6 Inclusion and type-ids\u003c/h5\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"object-type-inclusion\"\u003eobject-type-inclusion\u003c/span\u003e := \u003ccode\u003e*\u003c/code\u003e \u003ca href=\"#type-reference\"\u003e\u003cspan class=\"ntref\"\u003etype-reference\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nEvery type descriptor referenced directly or indirectly by a\n\u003ccode\u003etype-reference\u003c/code\u003e in an \u003ccode\u003eobject-type-inclusion\u003c/code\u003e must be an\n\u003ccode\u003eobject-type-descriptor\u003c/code\u003e, \u003ccode\u003edistinct-type-descriptor\u003c/code\u003e,\n\u003ccode\u003eintersection-type-descriptor\u003c/code\u003e or\na class without a \u003ccode\u003ereadonly\u003c/code\u003e qualifier; the\nreferenced type descriptor will thus necessarily be definite and a subtype of\nobject. If a referenced object-type-descriptor or class has an\n\u003ccode\u003eisolated\u003c/code\u003e, \u003ccode\u003eservice\u003c/code\u003e or \u003ccode\u003eclient\u003c/code\u003e qualifier\n\u003cvar\u003eQ\u003c/var\u003e, then the referencing object-type-descriptor must also have the\nqualifier \u003cvar\u003eQ\u003c/var\u003e. The \u003ccode\u003eobject-field-descriptor\u003c/code\u003es and\n\u003ccode\u003emethod-decl\u003c/code\u003es from the referenced type are included in the type\nbeing defined. A type-reference to a class is treated as a reference to the\nclass's type; only the types of the methods and fields are copied from the\nreferenced type. An \u003ccode\u003eobject-field-descriptor\u003c/code\u003e or\n\u003ccode\u003emethod-decl\u003c/code\u003e in a \u003ccode\u003eobject-type-descriptor\u003c/code\u003e can override\nrespectively an \u003ccode\u003eobject-field-descriptor\u003c/code\u003e or \u003ccode\u003emethod-decl\u003c/code\u003e\nof the same name in an included \u003ccode\u003eobject-type-descriptor\u003c/code\u003e, provided\nthe type declared for the field or method in the overriding descriptor is a\nsubtype of the type declared in the overridden descriptor. An\n\u003ccode\u003eobject-field-descriptor\u003c/code\u003e cannot override a \u003ccode\u003emethod-decl\u003c/code\u003e,\nnor can a \u003ccode\u003emethod-decl\u003c/code\u003e override an\n\u003ccode\u003eobject-field-descriptor\u003c/code\u003e. It is an error if an\n\u003ccode\u003eobject-type-descriptor\u003c/code\u003e has two or more\n\u003ccode\u003eobject-type-inclusion\u003c/code\u003es that include an\n\u003ccode\u003eobject-field-descriptor\u003c/code\u003e with the same name, unless those\n\u003ccode\u003eobject-field-descriptor\u003c/code\u003es are overridden by an\n\u003ccode\u003eobject-field-descriptor\u003c/code\u003e in the including\n\u003ccode\u003eobject-type-descriptor\u003c/code\u003e. It is an error if an\n\u003ccode\u003eobject-type-descriptor\u003c/code\u003e has two or more\n\u003ccode\u003eobject-type-inclusion\u003c/code\u003es that include \u003ccode\u003emethod-decl\u003c/code\u003es with\nthe same name but different \u003ccode\u003efunction-signature\u003c/code\u003es, unless those\n\u003ccode\u003emethod-decl\u003c/code\u003es are overridden by a \u003ccode\u003emethod-decl\u003c/code\u003e in the\nincluding \u003ccode\u003eobject-type-descriptor\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nAn object-type-descriptor is always definite. The set of type-ids induced by an\nobject-type-descriptor is the union of the set of type-ids induced by the type\ndescriptors that it includes. An induced type-id is primary in an\nobject-type-descriptor if and only if it is primary in any of the included type\ndescriptors. It is an error if the induced set of type-ids includes a non-public\ntype-id from another module.\n\u003c/p\u003e\n\u003cp\u003e\nIt is an error for an \u003ccode\u003eobject-type-descriptor\u003c/code\u003e to directly or\nindirectly include itself.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.5.4\"\u003e5.5.4 Futures\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"future-type-descriptor\"\u003efuture-type-descriptor\u003c/span\u003e := \u003ccode\u003efuture\u003c/code\u003e [\u003ca href=\"#type-parameter\"\u003e\u003cspan class=\"ntref\"\u003etype-parameter\u003c/span\u003e\u003c/a\u003e]\n\u003c/pre\u003e\n\u003cp\u003e\nA future value refers to a named worker, which will return a value. A future\nvalue belongs to a type \u003ccode\u003efuture\u0026lt;T\u0026gt;\u003c/code\u003e if the return type of the\nnamed worker is a subtype of T.\n\u003c/p\u003e\n\u003cp\u003e\nA value belongs to a type \u003ccode\u003efuture\u003c/code\u003e (without the type-parameter)\nif it has basic type future.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.5.5\"\u003e5.5.5 Type descriptors\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"typedesc-type-descriptor\"\u003etypedesc-type-descriptor\u003c/span\u003e := \u003ccode\u003etypedesc\u003c/code\u003e [\u003ca href=\"#type-parameter\"\u003e\u003cspan class=\"ntref\"\u003etype-parameter\u003c/span\u003e\u003c/a\u003e]\n\u003c/pre\u003e\n\u003cp\u003e\nA type descriptor value is an immutable value representing a resolved type\ndescriptor. The type typedesc contains all values with basic type typedesc. A\ntypedesc value \u003cvar\u003et\u003c/var\u003e belongs to a type typedesc\u0026lt;\u003cvar\u003eT\u003c/var\u003e\u0026gt; if\nand only if the type described by \u003ccode\u003et\u003c/code\u003e is a subtype of \u003cvar\u003eT\u003c/var\u003e.\nThe typedesc type is thus covariant with its type parameter.\n\u003c/p\u003e\n\u003cp\u003e\nReferencing an identifier defined by a type definition in an expression context\nwill result in a type descriptor value.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.5.6\"\u003e5.5.6 Handles\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"handle-type-descriptor\"\u003ehandle-type-descriptor\u003c/span\u003e := \u003ccode\u003ehandle\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA handle value is a reference to storage managed externally to a Ballerina\nprogram. Handle values are useful only in conjunction with functions that have\nexternal function bodies; in particular, a new handle value can be created only\nby a function with an external function body. Handle values are inherently\nimmutable.\n\u003c/p\u003e\n\u003cp\u003e\nA value belongs to a type \u003ccode\u003ehandle\u003c/code\u003e if it has a basic type of handle.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_5.5.7\"\u003e5.5.7 Streams\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"stream-type-descriptor\"\u003estream-type-descriptor\u003c/span\u003e := \u003ccode\u003estream\u003c/code\u003e [\u003ca href=\"#stream-type-parameters\"\u003e\u003cspan class=\"ntref\"\u003estream-type-parameters\u003c/span\u003e\u003c/a\u003e]\n\u003cspan class=\"ntdfn\" id=\"stream-type-parameters\"\u003estream-type-parameters\u003c/span\u003e := \u003ccode\u003e\u0026lt;\u003c/code\u003e \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e]\u003ccode\u003e\u0026gt;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA stream is an object-like value that can generate a sequence of values. There\nis also a value associated with the completion of the generation of the\nsequence, which is either nil, indicating the generation of the sequence completed\nsuccessfully, or an error. A stream belongs to type\n\u003ccode\u003estream\u0026lt;T,C\u0026gt;\u003c/code\u003e if the values in the generated sequence all\nbelong to T and if the completion value belongs to C. The type\n\u003ccode\u003estream\u0026lt;T\u0026gt;\u003c/code\u003e is equivalent to \u003ccode\u003estream\u0026lt;T,()\u0026gt;\u003c/code\u003e. A\nvalue belongs to a type \u003ccode\u003estream\u003c/code\u003e (without the type-parameter) if it\nhas basic type stream. A type \u003ccode\u003estream\u0026lt;T,C\u0026gt;\u003c/code\u003e where C does not\ninclude nil describes an unbounded stream.\n\u003c/p\u003e\n\u003cp\u003e\nA stream supports two primitive operations: a next operation and a close\noperation. The next operation has the same semantics as the next method on the\nIterator object type. The close operation informs the stream that there will be\nno more next operations and thus allows the stream to release resources used by\nthe stream; the close operation on a \u003ccode\u003estream\u0026lt;T,C\u0026gt;\u003c/code\u003e has a result\nof type \u003ccode\u003eC?\u003c/code\u003e, where nil means that the close operation was\nsuccessful. The close operation is idempotent: performing the close operation on\na stream on which the close operation has already been performed has no effect.\nWhen the generation of the sequence is complete, the stream automatically\nperforms the close operation to release resources used by the stream.\n\u003c/p\u003e\n\u003cp\u003e\nThe type descriptor \u003ccode\u003estream\u0026lt;T,C\u0026gt;\u003c/code\u003e works like a class, in that\nit can be used with \u003ccode\u003enew\u003c/code\u003e to construct stream values that belong to\nthe type. The normal implementation of a \u003ccode\u003estream\u0026lt;T,C\u0026gt;\u003c/code\u003e is a\nwrapper around an object belonging to \u003ca href=\"#StreamImplementor\"\u003eobject type\n\u003ccode\u003eStreamImplementor\u0026lt;T,C\u0026gt;\u003c/code\u003e\u003c/a\u003e. The next and close operations on\nthe stream delegate to the next and close methods on the StreamImplementor.\n\u003c/p\u003e\n\u003cp\u003e\nThe stream module of the \u003ca href=\"#lang_library\"\u003elang library\u003c/a\u003e provides\nadditional operations on stream that can be implemented in terms of the\nprimitive next and close operations.\n\u003c/p\u003e\n\u003cp\u003e\nA stream is iterable. A stream of type \u003ccode\u003estream\u0026lt;T,C\u0026gt;\u003c/code\u003e has value\ntype \u003ccode\u003eT\u003c/code\u003e and completion type \u003ccode\u003eC\u003c/code\u003e. Calling the next method\non the iterator created for an iteration has the same effect as performing the\nnext operation on the stream. The stream does not keep a copy of the sequence of\nvalues returned by the next operation. Any subsequent iteration operation on the\nsame stream will not generate further values, so the iteration sequence for\niterations other than the first will be the empty sequence.\n\u003c/p\u003e\n\u003cp\u003e\nNote that in this version of Ballerina the stream type is not a class because\nBallerina does not yet support parameterized classes.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_5.6\"\u003e5.6 Other type descriptors\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"other-type-descriptor\"\u003eother-type-descriptor\u003c/span\u003e :=\n   | \u003ca href=\"#type-reference\"\u003e\u003cspan class=\"ntref\"\u003etype-reference\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#singleton-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003esingleton-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#any-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003eany-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#never-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003enever-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#readonly-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003ereadonly-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#distinct-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003edistinct-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#union-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003eunion-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#intersection-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003eintersection-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#optional-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003eoptional-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#anydata-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003eanydata-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#json-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003ejson-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#byte-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003ebyte-type-descriptor\u003c/span\u003e\u003c/a\u003e\n   | \u003ccode\u003e(\u003c/code\u003e \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e)\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nIt is important to understand that the type descriptors specified in this\nsection do not add to the universe of values. They are just adding new ways to\ndescribe subsets of this universe.\n\u003c/p\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.6.1\"\u003e5.6.1 Type reference\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"type-reference\"\u003etype-reference\u003c/span\u003e := \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#qualified-identifier\"\u003e\u003cspan class=\"ntref\"\u003equalified-identifier\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nA type descriptor can use a type-reference to refer to a type definition in the\nsame module or another module.\n\u003c/p\u003e\n\u003cp\u003e\nA type-reference referring to a type descriptor \u003cvar\u003eT\u003c/var\u003e is definite if and\nonly if \u003cvar\u003eT\u003c/var\u003e. If it is, the type-ids induced by are the same as those\ninduced by \u003cvar\u003eT\u003c/var\u003e and a type-id is primary in \u003cvar\u003et\u003c/var\u003e if and only if\nit is primary in \u003cvar\u003eT\u003c/var\u003e. It is an error if the induced set of type-ids\nincludes a non-public type-id from another module.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.6.2\"\u003e5.6.2 Singleton types\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"singleton-type-descriptor\"\u003esingleton-type-descriptor\u003c/span\u003e := \u003ca href=\"#simple-const-expr\"\u003e\u003cspan class=\"ntref\"\u003esimple-const-expr\u003c/span\u003e\u003c/a\u003e\n\n\u003c/pre\u003e\n\u003cp\u003e\nA singleton type is a type containing a single shape. A singleton type is\ndescribed using an compile-time constant expression for a single value: the type\ncontains the shape of that value. Note that it is possible for the\nvariable-reference within the simple-const-expr to reference a structured value;\nin this case, the value will have its read-only bit set; a value without its\nread-only bit set will thus not belong to any singleton type.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.6.3\"\u003e5.6.3 Any type\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"any-type-descriptor\"\u003eany-type-descriptor\u003c/span\u003e := \u003ccode\u003eany\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe type descriptor \u003ccode\u003eany\u003c/code\u003e describes the type consisting of all values\nother than errors. A value belongs to the any type if and only if its basic type\nis not error. Thus all values belong to the type \u003ccode\u003eany|error\u003c/code\u003e. Note\nthat a structure with members that are errors belongs to the \u003ccode\u003eany\u003c/code\u003e\ntype.\n\u003c/p\u003e\n\u003cp\u003e\nThe any-type-descriptor is not definite.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.6.4\"\u003e5.6.4 Never type\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"never-type-descriptor\"\u003enever-type-descriptor\u003c/span\u003e := \u003ccode\u003enever\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe type descriptor \u003ccode\u003enever\u003c/code\u003e describes the type that does not contain\nany shapes. No value ever belongs to the \u003ccode\u003enever\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThis can be useful to describe for the return type of a function, if the\nfunction never returns. It can also be useful as a type parameter. For example,\n\u003ccode\u003exml\u0026lt;never\u0026gt;\u003c/code\u003e describes the an xml type that has no\nconstituents, i.e. the empty xml value.\n\u003c/p\u003e\n\u003cp\u003e\nNote that for any type \u003ccode\u003eT\u003c/code\u003e, the type \u003ccode\u003eT|never\u003c/code\u003e is the same\nas \u003ccode\u003eT\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.6.5\"\u003e5.6.5 Readonly type\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"readonly-type-descriptor\"\u003ereadonly-type-descriptor\u003c/span\u003e := \u003ccode\u003ereadonly\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA shape belongs to the type \u003ccode\u003ereadonly\u003c/code\u003e if its read-only bit is on.\n\u003c/p\u003e\n\u003cp\u003e\nA value belonging to an inherently immutable basic type will always have its\nread-only bit on. These basic types are:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eall simple types\n\u003cul\u003e\n\u003cli\u003enil\u003c/li\u003e\n\u003cli\u003eboolean\u003c/li\u003e\n\u003cli\u003eint\u003c/li\u003e\n\u003cli\u003efloat\u003c/li\u003e\n\u003cli\u003edecimal\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003estring\u003c/li\u003e\n\u003cli\u003eerror\u003c/li\u003e\n\u003cli\u003efunction\u003c/li\u003e\n\u003cli\u003etypedesc\u003c/li\u003e\n\u003cli\u003ehandle\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nA value belonging to a selectively immutable basic type may have its read-only\nbit on. These basic types are:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003exml\u003c/li\u003e\n\u003cli\u003elist\u003c/li\u003e\n\u003cli\u003emapping\u003c/li\u003e\n\u003cli\u003etable\u003c/li\u003e\n\u003cli\u003eobject\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"distinct_types\"\u003e5.6.6 Distinct types\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"distinct-type-descriptor\"\u003edistinct-type-descriptor\u003c/span\u003e := \u003ccode\u003edistinct\u003c/code\u003e \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nEach occurrence of a distinct-type-descriptor describes a type that is distinct\nfrom any other occurrence of a distinct-type-descriptor. Only object and error\nvalues can belong to a type described by a distinct-type-descriptor.\n\u003c/p\u003e\n\u003cp\u003e\nThe type denoted by a distinct-type-descriptor \u003ccode\u003e\u003cvar\u003eD\u003c/var\u003e\u003c/code\u003e, where\n\u003ccode\u003e\u003cvar\u003eD\u003c/var\u003e\u003c/code\u003e is \u003ccode\u003edistinct \u003cvar\u003eT\u003c/var\u003e\u003c/code\u003e, and\n\u003cvar\u003ed\u003c/var\u003e is the type-id of this occurrence of \u003ccode\u003e\u003cvar\u003eD\u003c/var\u003e\u003c/code\u003e,\ncontains a shape \u003cvar\u003es\u003c/var\u003e of an object or error value if and only if both\n\u003ccode\u003e\u003cvar\u003eT\u003c/var\u003e\u003c/code\u003e contains \u003cvar\u003es\u003c/var\u003e and the set of type-ids of\n\u003cvar\u003es\u003c/var\u003e contains \u003cvar\u003ed\u003c/var\u003e. The set of type-ids induced by\n\u003ccode\u003e\u003cvar\u003eD\u003c/var\u003e\u003c/code\u003e consists of \u003cvar\u003ed\u003c/var\u003e as the primary type-id and\nthe type-ids induced by \u003ccode\u003e\u003cvar\u003eT\u003c/var\u003e\u003c/code\u003e as the secondary type-ids. The\ntype \u003ccode\u003e\u003cvar\u003eT\u003c/var\u003e\u003c/code\u003e must be definite and must be a subtype of object\nor a subtype of error. The type \u003ccode\u003e\u003cvar\u003eD\u003c/var\u003e\u003c/code\u003e is always definite.\nNote that \u003ccode\u003e\u003cvar\u003eD\u003c/var\u003e\u003c/code\u003e is always a proper subtype of\n\u003ccode\u003e\u003cvar\u003eT\u003c/var\u003e\u003c/code\u003e.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.6.7\"\u003e5.6.7 Union types\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"union-type-descriptor\"\u003eunion-type-descriptor\u003c/span\u003e := \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e|\u003c/code\u003e \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe set of shapes denoted by an union type \u003ccode\u003eT1|T2\u003c/code\u003e is the union of\nthe set of shapes denoted by \u003ccode\u003eT1\u003c/code\u003e and the set of shapes denoted by\n\u003ccode\u003eT2\u003c/code\u003e. Thus, the type \u003ccode\u003eT1|T2\u003c/code\u003e contains a shape if and only\nif either the type denoted by \u003ccode\u003eT1\u003c/code\u003e contains the shape or the type\ndenoted by \u003ccode\u003eT2\u003c/code\u003e contains the shape. A type descriptor\n\u003ccode\u003eT1|T2\u003c/code\u003e is not a class and cannot be used with \u003ccode\u003enew\u003c/code\u003e,\neven if one or both of T1 and T2 are classes.\n\u003c/p\u003e\n\u003cp\u003e\nA union type \u003ccode\u003eT1|T2\u003c/code\u003e is definite if and only if both \u003ccode\u003eT1\u003c/code\u003e\nand \u003ccode\u003eT2\u003c/code\u003e are definite and the set of type-ids induced by\n\u003ccode\u003eT1\u003c/code\u003e and \u003ccode\u003eT2\u003c/code\u003e are the same. If it is definite, then it\ninduces the same set of type-ids as \u003ccode\u003eT1\u003c/code\u003e and \u003ccode\u003eT2\u003c/code\u003e, and a\ntype-id is primary if it is primary in either \u003ccode\u003eT1\u003c/code\u003e or\n\u003ccode\u003eT2\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.6.8\"\u003e5.6.8 Intersection types\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"intersection-type-descriptor\"\u003eintersection-type-descriptor\u003c/span\u003e := \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e\u0026amp;\u003c/code\u003e \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe set of shapes denoted by an intersection type  is the\nintersection of the set of shapes denoted by \u003ccode\u003eT1\u003c/code\u003e and the set of\nshapes denoted by \u003ccode\u003eT2\u003c/code\u003e. Thus, the type \u003ccode\u003eT1\u0026amp;T2\u003c/code\u003e\ncontains a shape if and only if the types denoted by \u003ccode\u003eT1\u003c/code\u003e and\n\u003ccode\u003eT2\u003c/code\u003e both contain the shape. It is a error to have an intersection\ntype that denotes an empty set of shapes. In an intersection type\n\u003ccode\u003eT1\u0026amp;T2\u003c/code\u003e, it is an error if \u003ccode\u003eT1\u003c/code\u003e and \u003ccode\u003eT2\u003c/code\u003e\nare both function types unless there is a single function-type-descriptor that\ndenotes a type that is a subtype of both \u003ccode\u003eT1\u003c/code\u003e and \u003ccode\u003eT2\u003c/code\u003e.\nA type descriptor \u003ccode\u003eT1\u0026amp;T2\u003c/code\u003e is not a class and cannot be used\nwith \u003ccode\u003enew\u003c/code\u003e, even if one or both of T1 and T2 are classes.\n\u003c/p\u003e\n\u003cp\u003e\nAn intersection type \u003ccode\u003eT1\u0026amp;T2\u003c/code\u003e is definite if and only if both\n\u003ccode\u003eT1\u003c/code\u003e and \u003ccode\u003eT2\u003c/code\u003e are definite. If it is definite, then it\ninduces the union of the set of type-ids induced by \u003ccode\u003eT1\u003c/code\u003e and\n\u003ccode\u003eT2\u003c/code\u003e, and a type-id is primary if it is primary in either\n\u003ccode\u003eT1\u003c/code\u003e or \u003ccode\u003eT2\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nIntersection types are particularly useful in conjunction with\n\u003ccode\u003ereadonly\u003c/code\u003e. A set of readonly shapes can be described by\n\u003ccode\u003ereadonly\u0026amp;T\u003c/code\u003e, where \u003ccode\u003eT\u003c/code\u003e describes the primary aspect\nof the shape.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_5.6.9\"\u003e5.6.9 Optional types\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"optional-type-descriptor\"\u003eoptional-type-descriptor\u003c/span\u003e := \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e?\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA type \u003ccode\u003e\u003cvar\u003eT\u003c/var\u003e?\u003c/code\u003e means the union of \u003ccode\u003e\u003cvar\u003eT\u003c/var\u003e\u003c/code\u003e\nand \u003ccode\u003e()\u003c/code\u003e. It is completely equivalent to\n\u003ccode\u003e\u003cvar\u003eT\u003c/var\u003e|()\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"anydata\"\u003e5.6.10 Anydata type\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"anydata-type-descriptor\"\u003eanydata-type-descriptor\u003c/span\u003e := \u003ccode\u003eanydata\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe type descriptor \u003ccode\u003eanydata\u003c/code\u003e describes the type of plain data. The\ntype \u003ccode\u003eanydata\u003c/code\u003e contains a shape if and only if it is the shape of a\nvalue that is plain data. The \u003ccode\u003eanydata\u003c/code\u003e type can thus be defined as:\n\u003c/p\u003e\n\n\u003cpre\u003e  () | boolean | int | float | decimal\n    | string | xml\n    | anydata[] | map\u0026lt;anydata\u0026gt; | table\u0026lt;map\u0026lt;anydata\u0026gt;\u0026gt;\n\u003c/pre\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.6.11\"\u003e5.6.11 JSON types\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"json-type-descriptor\"\u003ejson-type-descriptor\u003c/span\u003e := \u003ccode\u003ejson\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe \u003ccode\u003ejson\u003c/code\u003e type is designed for processing data expression in JSON\nformat. It is a built-in name for a union defined as follows:\n\u003c/p\u003e\n\u003cpre\u003etype json = () | boolean | int | float | decimal | string | json[] | map\u0026lt;json\u0026gt;;\n\u003c/pre\u003e\n\u003cp\u003e\nIn addition, the \u003ccode\u003ejson\u003c/code\u003e type is defined to have \u003ca href=\"#lax_static_typing\"\u003elax static typing\u003c/a\u003e.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"byte_type\"\u003e5.6.12 Byte type\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"byte-type-descriptor\"\u003ebyte-type-descriptor\u003c/span\u003e := \u003ccode\u003ebyte\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe byte type is a predefined name for a union of the int values in the range 0\nto 255 inclusive. It is equivalent to the \u003ca href=\"#built-in_subtypes\"\u003ebuilt-in\nsubtype\u003c/a\u003e \u003ccode\u003eint:Unsigned8\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"built-in_object_types\"\u003e5.7 Built-in object types\u003c/h3\u003e\n\u003cp\u003e\nThere are several object types that are built-in in the sense that the\nlanguage treats objects with these types specially. There are two kinds of\nobject type:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003epurely structural types; the name of the type is internal to this\nspecification and not exposed to the language;\u003c/li\u003e\n\u003cli\u003edistinct types; the name of the type is defined in a lang library\nmodule.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_5.7.1\"\u003e5.7.1 Iterator\u003c/h4\u003e\n\u003cp\u003e\nA value of iterable type with iteration value type T and iteration completion\ntype C provides a way of creating an iterator object that belongs to the object\ntype\n\u003c/p\u003e\n\n\u003cpre\u003e    object {\n       public function next() returns record {| T value; |}|C;\n    }\n\u003c/pre\u003e\n\u003cp\u003e\nIn this specification, we refer to this type as Iterator\u0026lt;T,C\u0026gt;.\n\u003c/p\u003e\n\u003cp\u003e\nConceptually an iterator is at a position between members of the iteration sequence. \nPossible positions are at the beginning (immediately before the first member if\nany), between members and at the end (immediately after the last member if any).\nA newly created iterator is at the beginning position. For an empty sequence,\nthere is only one possible position which is both at the beginning and at the\nend.\n\u003c/p\u003e\n\u003cp\u003e\nThe \u003ccode\u003enext()\u003c/code\u003e method behaves as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eif the iteration has encountered an error, return an error value\u003c/li\u003e\n\u003cli\u003eotherwise, if the iterator has completed successfully by reaching the end\nposition without an error, return nil\u003c/li\u003e\n\u003cli\u003eotherwise\n\u003cul\u003e\n\u003cli\u003emove the iterator to next position, and\u003c/li\u003e\n\u003cli\u003ereturn a record \u003ccode\u003e{ value: v }\u003c/code\u003e where v is the member of the\nsequence between the previous position and the new position\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nMutation of a structured value during iteration is handled as follows. A call to\n\u003ccode\u003enext()\u003c/code\u003e must panic if there has been any mutation to the structured\nvalue since the iterator was created other than the following:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eremoving a member of the structured value that a preceding call to the\niterator has already returned;\u003c/li\u003e\n\u003cli\u003echanging the member associated with an existing key.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIn the latter case, \u003ccode\u003enext()\u003c/code\u003e must return the value associated with\nthe key at the point when \u003ccode\u003enext()\u003c/code\u003e is called.\n\u003c/p\u003e\n\u003cp\u003e\nNote that it is not possible for the \u003ccode\u003enext()\u003c/code\u003e method simply to return\nthe values in the iteration sequence, since there would be no way to distinguish\na nil or error value that is part of the iteration sequence from a nil or error\nvalue that represents the result of the iteration.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.7.2\"\u003e5.7.2 Iterable\u003c/h4\u003e\n\u003cp\u003e\nAn object belongs to the object type Iterable\u0026lt;T,C\u0026gt; if it has a\nmethod named \u003ccode\u003eiterator\u003c/code\u003e with no arguments and a return type that is\nsubtype of Iterator\u0026lt;T,C\u0026gt; and it belongs to the distinct type\n\u003ccode\u003eIterable\u003c/code\u003e defined in \u003ccode\u003elang.object\u003c/code\u003e. An object that\nbelongs to Iterable\u0026lt;T,C\u0026gt; is iterable: the object returned by the\n\u003ccode\u003eiterator\u003c/code\u003e method determines the iteration sequence and iteration\ncompletion value.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"StreamImplementor\"\u003e5.7.3 StreamImplementor\u003c/h4\u003e\n\u003cp\u003e\nAn object belongs to the object type StreamImplementor\u0026lt;T,C\u0026gt; if it\nbelongs to Iterator\u0026lt;T,C\u0026gt; and also optionally has a method\n\u003ccode\u003eclose()\u003c/code\u003e with return value \u003ccode\u003eC?\u003c/code\u003e. This is equivalent to\nbelonging to the following type.\n\u003c/p\u003e\n\n\u003cpre\u003e    object {\n       public isolated function next() returns record {| T value; |}|C;\n    }\n    | object {\n       public isolated function next() returns record {| T value; |}|C;\n       public isolated function close() returns C?;\n    }\n\u003c/pre\u003e\n\n\u003cp\u003e\nThe close method says that there will be no more calls to the next method. Any\ncall to a next method after the close method has been called must result in a\npanic. A missing close method behaves like a close method that puts the object\ninto a closed state, in which calls to next will result in a panic, and then\nimmediately returns \u003ccode\u003e()\u003c/code\u003e.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.7.4\"\u003e5.7.4 Listener\u003c/h4\u003e\n\u003cp\u003e\nThe object type Listener\u0026lt;T,A\u0026gt;, where T is a a subtype of \u003ccode\u003eservice\nobject {}\u003c/code\u003e and A is a subtype of \u003ccode\u003estring[]|string|()\u003c/code\u003e, is\ndescribed by the following object type descriptor:\n\u003c/p\u003e\n\n\u003cpre\u003eobject {\n   public function attach(T svc, A attachPoint) returns error?;\n   public function detach(T svc) returns error?;\n   public function 'start() returns error?;\n   public function gracefulStop() returns error?;\n   public function immediateStop() returns error?;\n}\n\u003c/pre\u003e\n\u003cp\u003e\nThe role of a Listener is to handle incoming network messages by making\ncalls on service objects as described in \u003ca href=\"#listeners_and_services\"\u003eListeners and services\u003c/a\u003e. Each method is used\nas follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethe \u003ccode\u003eattach\u003c/code\u003e method is used to provide the Listener with a\nservice object that it can use to handle incoming network messages; the\n\u003ccode\u003eattachPoint\u003c/code\u003e argument is used to identify which network messages the\nservice object should be used for;\u003c/li\u003e\n\u003cli\u003ethe \u003ccode\u003edetach\u003c/code\u003e method tells the Listener to stop using a service\nobject that was previously provided using the \u003ccode\u003eattach\u003c/code\u003e method;\u003c/li\u003e\n\u003cli\u003ethe \u003ccode\u003estart\u003c/code\u003e method tells the Listener to start handling incoming\nnetwork messages;\u003c/li\u003e\n\u003cli\u003ethe \u003ccode\u003egracefulStop\u003c/code\u003e and \u003ccode\u003eimmediateStop\u003c/code\u003e messages tell\nthe Listener to stop handling incoming network messages;\n\u003cul\u003e\n\u003cli\u003ein the case of \u003ccode\u003egracefulStop\u003c/code\u003e, the listener should complete the\nhandling of any incoming messages that it has started to handle; in particular,\nit should wait for the completion of any strands that it created to execute\nservice object methods;\u003c/li\u003e\n\u003cli\u003ein the case of \u003ccode\u003eimmediateStop\u003c/code\u003e, the listener should not try to\ncomplete the hanlding of any incoming messages that is has started to handle; in\nparticular, it should cancel any strands that it created to execute service\nobject methods.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e \nEach method returns an error value if an error occurred, and return nil\notherwise. The listener object is responsible for creating and keeping track of\nany strands that it needs.\n\u003c/p\u003e\n\u003cp\u003e\nA type is a \u003cem\u003elistener object type\u003c/em\u003e if it is a subtype of the object type\nListener\u0026lt;T,A\u0026gt;, for some type T that is a subtype of \u003ccode\u003eservice object\n{}\u003c/code\u003e and some type A that is a subtype of \u003ccode\u003estring[]|string|()\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.7.5\"\u003e5.7.5 RawTemplate\u003c/h4\u003e\n\u003cp\u003e\nThe RawTemplate type describes the type of object constructed by a raw template\nexpression. The type is defined in \u003ccode\u003elang.object\u003c/code\u003e as follows.\n\u003c/p\u003e\n\u003cpre\u003edistinct object {\n    public (readonly \u0026amp; string[]) strings;\n    public (any|error)[] insertions;\n}\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.7.6\"\u003e5.7.6 RetryManager\u003c/h4\u003e\n\n\u003cp\u003e\nClasses of type RetryManager are defined by the application to allow control\nover retries performed by the retry statement and retry transaction statement\nThe object type RetryManager\u0026lt;E\u0026gt;, where E is a a subtype of\n\u003ccode\u003eerror\u003c/code\u003e, is described by the following object type descriptor:\n\u003c/p\u003e\n\n\u003cpre\u003eobject {\n   public function shouldRetry(E e) returns boolean;\n}\n\u003c/pre\u003e\n\u003cp\u003e\nNote that RetryManager\u0026lt;E\u0026gt; is contravariant in E i.e. RetryManager\u0026lt;E\u0026gt;\nis a subtype of RetryManager\u0026lt;E'\u0026gt; if and only if E' is a subtype of E.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_5.8\"\u003e5.8 Abstract operations\u003c/h3\u003e\n\u003cp\u003e\nThese section specifies a number of operations that can be performed on values.\nThese operations are for internal use by the specification. These operations are\nnamed in CamelCase with an initial upper-case letter to distinguish them from\nfunctions in the lang library.\n\u003c/p\u003e\n\u003csection\u003e\n\u003ch4 id=\"FillMember\"\u003e5.8.1 FillMember\u003c/h4\u003e\n\u003cp\u003e\nThe FillMember(s, k) operation is defined for a structured value s and an\nout-of-line key value k. It can be performed when s does not have a member with\nkey k; if it succeeds, it will result in a member with key k being added to s.\nIt will succeed if the inherent type of s allows the addition of a member with\nkey k and there is a way to construct a filler value for the type descriptor\nthat the inherent type of s requires for member k. The following table specifies\nwhen and how a filler value can be constructed for a type descriptor.\n\u003c/p\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003cth\u003eType descriptor\u003c/th\u003e\n\u003cth\u003eFiller value\u003c/th\u003e\n\u003cth\u003eWhen available\u003c/th\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e()\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e()\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eboolean\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003efalse\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eint\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e0\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003efloat\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e+0.0f\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003edecimal\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e+0d\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003estring\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e\"\"\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003earray or tuple type descriptor\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e[]\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eif that is a valid constructor for the type\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003emap or record type descriptor\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e{ }\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eif that is a valid constructor for the type\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ereadonly \u0026amp; T\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003ethe filler value for T constructed as read-only\u003c/td\u003e\n\u003ctd\u003eif that belongs to the type\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003etable\u003c/td\u003e\n\u003ctd\u003eempty table (with no rows)\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eobject\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003enew T()\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eif T is a class, where T is the type descriptor for the object, and the\nstatic type of T's init method allows no arguments and does not include error\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003estream\u003c/td\u003e\n\u003ctd\u003eempty stream\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003exml\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003exml``\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ebuilt-in subtype of \u003ccode\u003exml\u003c/code\u003e\n\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003exml``\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eif this belongs to the subtype, i.e. if the subtype is\n\u003ccode\u003exml:Text\u003c/code\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003esingleton\u003c/td\u003e\n\u003ctd\u003ethe single value used to specify the type\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd rowspan=\"2\"\u003eunion\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e()\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eif \u003ccode\u003e()\u003c/code\u003e is a member of the union\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ethe filler value for basic type B\u003c/td\u003e\n\u003ctd\u003eif all members of the union belong to a single basic type B,\nand the filler value for B also belongs to the union\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eT?\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e()\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eany\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e()\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eanydata\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e()\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ebyte\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e0\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ebuilt-in subtype of \u003ccode\u003eint\u003c/code\u003e\n\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e0\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ejson\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e()\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"Cloning\"\u003e5.8.2 Cloning\u003c/h4\u003e\n\u003cp\u003e\nThere are two cloning operations. Both of these operate on values belonging to the\nCloneable type defined as follows:\n\u003c/p\u003e\n\u003cpre\u003e\npublic type Cloneable readonly|xml|Cloneable[]|map\u0026lt;Cloneable\u0026gt;|table\u0026lt;map\u0026lt;Cloneable\u0026gt;\u0026gt;;\n\u003c/pre\u003e\n\u003cp\u003e\nThis type is defined in the lang.value module of the lang library. In this document,\nthe type will be referred to as \u003ccode\u003evalue:Cloneable\u003c/code\u003e.\n\u003c/p\u003e\n\n\u003csection\u003e\n\u003ch5 id=\"Clone\"\u003e5.8.2.1 Clone\u003c/h5\u003e\n\u003cp\u003e\nClone(v) is defined for any value v that belongs to the type\n\u003ccode\u003evalue:Cloneable\u003c/code\u003e. It performs a deep copy, recursively copying all\nstructural values and their members and recursively copying all sequence values\nand their constituents. Clone(v) for an immutable value v returns v. If v is of\na basic type that has an inherent type, Clone(v) has the same inherent type as\nv. The graph of references of Clone(v) must have the same structure as that of\nv. This implies that the number of distinct references reachable from Clone(v)\nmust be the same as the number of distinct references reachable from v. Clone(v)\nmust terminate even if v has cycles.\n\u003c/p\u003e\n\u003cp\u003e\nClone(v) cannot be implemented simply by recursively calling Clone on all\nmembers of v. Rather Clone must maintain a map that records the result of\ncloning each reference value. When a Clone operation starts, this map as empty.\nWhen cloning a reference value, it must use the result recorded in the map if\nthere is one.\n\u003c/p\u003e\n\u003cp\u003e\nThe Clone operation is exposed by the \u003ccode\u003eclone\u003c/code\u003e function in the\nlang.value module of the lang library.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch5 id=\"ImmutableClone\"\u003e5.8.2.2 ImmutableClone\u003c/h5\u003e\n\u003cp\u003e\nImmutableClone(v) is defined for any value v that belongs to the type\n\u003ccode\u003evalue:Cloneable\u003c/code\u003e. It performs a deep copy of v similar to Clone(v),\nexcept that newly constructed values will be constructed as immutable and so\nhave their read-only bit on. Any immutable value is not copied. So the result\nof Immutable always has its read-only bit on.\n\u003c/p\u003e\n\u003cp\u003e\nLike Clone, ImmutableClone must preserve graph structure, including cycles.\nConceptually the whole graph is constructed before being made immutable.\n\u003c/p\u003e\n\u003cp\u003e\nThe ImmutableClone operation is exposed by the \u003ccode\u003ecloneReadOnly\u003c/code\u003e\nfunction in the lang.value module of the lang library.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"DeepEquals\"\u003e5.8.3 DeepEquals\u003c/h4\u003e\n\u003cp\u003e\nDeepEquals(v1, v2) is defined for any values v1, v2 that belong to type anydata.\nIt returns true or false depending of whether the primary aspect of the shape v1\nand of v2 are the same. In other words, DeepEquals returns true if and only if\nthe values are the same ignoring whether read-only bits are on or off.\nDeepEquals(v1, v2) must terminate for any values v1 and v2 of type anydata, even\nif v1 or v2 have cycles. DeepEquals(v1, v2) returns true if v1 and v2 have the\nsame shape, even if the graphs of references of v1 and v2 have different\nstructures. If two values v1 and v2 have different basic types, then\nDeepEquals(v1, v2) will be false.\n\u003c/p\u003e\n\u003cp\u003e\nThe possibility of cycles means that DeepEquals cannot be implemented simply by\ncalling DeepEquals recursively on members. Rather DeepEquals must maintain a\nmapping that records for each pair of references whether it is already in\nprocess of comparing those references. When a DeepEquals operation starts, this\nmap is empty. Whenever it starts to compare two references, it should see\nwhether it has already recorded that pair (in either order), and, if it has,\nproceed on the assumption that they compare equal.\n\u003c/p\u003e\n\u003cp\u003e\nDeepEquals(Clone(x), x) is guaranteed to be true for any value of type anydata.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.8.4\"\u003e5.8.4 NumericConvert\u003c/h4\u003e\n\u003cp\u003e\nNumericConvert(t, v) is defined if t is the typedesc for float, decimal or int,\nand v is a numeric value. It converts v to a value in t, or returns an error,\naccording to the following table.\n\u003c/p\u003e\n\u003ctable\u003e\n  \u003ctr\u003e\n   \u003ctd\u003efrom \\ to\u003c/td\u003e\n   \u003ctd\u003efloat\u003c/td\u003e\n   \u003ctd\u003edecimal\u003c/td\u003e\n   \u003ctd\u003eint\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003efloat\u003c/td\u003e\n   \u003ctd\u003eunchanged\u003c/td\u003e\n   \u003ctd\u003eclosest math value\u003c/td\u003e\n   \u003ctd rowspan=\"2\"\u003eround, error for NaN or out of int range\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003edecimal\u003c/td\u003e\n   \u003ctd\u003eclosest math value\u003c/td\u003e\n   \u003ctd\u003eunchanged\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eint\u003c/td\u003e\n   \u003ctd\u003esame math value\u003c/td\u003e\n   \u003ctd\u003esame math value\u003c/td\u003e\n   \u003ctd\u003eunchanged\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"ToString\"\u003e5.8.5 ToString\u003c/h4\u003e\n\u003cp\u003e\nToString(v,style) converts a value to a string in one of three styles. The\nconversion can be performed in one of three styles, specified by the style\nparameter, which are as follows.\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eexpression style: produces a string that looks like a Ballerina expression; there are\ntwo cases\n\u003cul\u003e\n\u003cli\u003ewhen v belongs to anydata and does not have cycles, it will produce a string that\nis a valid Ballerina expression, such that evaluating that string will result in a value v'\nfor which DeepEquals(v, v') is true\u003c/li\u003e\n\u003cli\u003eotherwise, it will produce a string that is either not a valid Ballerina expression\nor is a valid Ballerina expression that evaluates to a value that does not belong type type anydata\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003einformal style: similar to expression style, but does not preserve all the distinctions that\nexpression style does, and avoids syntax that requires a knowledge of Ballerina\u003c/li\u003e\n\u003cli\u003edirect style: this does a direct conversion of the value to a string rather than producing\na string that describes the value\n\u003cul\u003e\n\u003cli\u003eif v is a string, then the result of ToString(v,direct) is v\u003c/li\u003e\n\u003cli\u003eif v is XML, then the result of ToString(v,direct) is v in XML syntax\u003c/li\u003e\n\u003cli\u003edirect style falls back to informal style for basic types where there is no\nother natural more direct conversion\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe following table summarizes the result of ToString(v,style) for each basic type.\n\u003c/p\u003e\n\u003ctable\u003e\n  \u003ctr\u003e\n   \u003ctd rowspan=\"2\"\u003eBasic type of v\n   \u003c/td\u003e\n   \u003ctd colspan=\"3\"\u003estyle\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eexpression\n   \u003c/td\u003e\n   \u003ctd\u003einformal\n   \u003c/td\u003e\n   \u003ctd\u003edirect\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003enil\n   \u003c/td\u003e\n   \u003ctd\u003e\n\u003ccode\u003e()\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd\u003e\n\u003ccode\u003enull\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd\u003e\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003etrue\n   \u003c/td\u003e\n   \u003ctd colspan=\"3\"\u003e\n\u003ccode\u003etrue\u003c/code\u003e\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eint\n   \u003c/td\u003e\n   \u003ctd colspan=\"3\"\u003e\n\u003ccode\u003e2\u003c/code\u003e\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd rowspan=\"3\"\u003efloat\n   \u003c/td\u003e\n   \u003ctd colspan=\"3\"\u003e\n\u003ccode\u003e1.0\u003c/code\u003e\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\n\u003ccode\u003efloat:NaN\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd colspan=\"2\"\u003e\n\u003ccode\u003eNaN\u003c/code\u003e\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\n\u003ccode\u003efloat:Infinity\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd colspan=\"2\"\u003e\n\u003ccode\u003eInfinity\u003c/code\u003e\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd rowspan=\"2\"\u003edecimal\n   \u003c/td\u003e\n   \u003ctd\u003e\n\u003ccode\u003e1d\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd colspan=\"2\"\u003e\n\u003ccode\u003e1\u003c/code\u003e\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\n\u003ccode\u003e1.20d\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd colspan=\"2\"\u003e\n\u003ccode\u003e1.20\u003c/code\u003e\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003estring\n   \u003c/td\u003e\n   \u003ctd colspan=\"2\"\u003e\n\u003ccode\u003e\"xyz\"\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd\u003e\n\u003ccode\u003exyz\u003c/code\u003e\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003exml\n   \u003c/td\u003e\n   \u003ctd\u003e\n\u003ccode\u003exml`\u0026lt;d\u0026gt;t\u0026lt;/d\u0026gt;`\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd\u003e\n\u003ccode\u003e`\u0026lt;d\u0026gt;t\u0026lt;/d\u0026gt;`\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd\u003e\n\u003ccode\u003e\u0026lt;d\u0026gt;t\u0026lt;/d\u0026gt;\u003c/code\u003e\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd rowspan=\"2\"\u003earray\n   \u003c/td\u003e\n   \u003ctd colspan=\"3\"\u003e\n\u003ccode\u003e[\u003cvar\u003eX\u003c/var\u003e,\u003cvar\u003eY\u003c/var\u003e]\u003c/code\u003e\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\n\u003cvar\u003eX\u003c/var\u003e, \u003cvar\u003eY\u003c/var\u003e expression style\n   \u003c/td\u003e\n   \u003ctd colspan=\"2\"\u003e\n\u003cvar\u003eX\u003c/var\u003e,\u003cvar\u003eY\u003c/var\u003e informal style\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd rowspan=\"2\"\u003emap\n   \u003c/td\u003e\n   \u003ctd colspan=\"3\"\u003e\n\u003ccode\u003e{\"x\":\u003cvar\u003eX\u003c/var\u003e,\"y\":\u003cvar\u003eY\u003c/var\u003e}\u003c/code\u003e\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\n\u003cvar\u003eX\u003c/var\u003e, \u003cvar\u003eY\u003c/var\u003e expression style\n   \u003c/td\u003e\n   \u003ctd colspan=\"2\"\u003e\n\u003cvar\u003eX\u003c/var\u003e,\u003cvar\u003eY\u003c/var\u003e informal style\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd rowspan=\"2\"\u003etable\n   \u003c/td\u003e\n   \u003ctd\u003e\n\u003ccode\u003etable key(k) [\u003cvar\u003eR\u003csub\u003e1\u003c/sub\u003e\u003c/var\u003e,\u003cvar\u003eR\u003csub\u003e2\u003c/sub\u003e\u003c/var\u003e]\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd colspan=\"2\"\u003e\n\u003ccode\u003e[\u003cvar\u003eR\u003csub\u003e1\u003c/sub\u003e\u003c/var\u003e,\u003cvar\u003eR\u003csub\u003e2\u003c/sub\u003e\u003c/var\u003e]\u003c/code\u003e\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\n\u003cvar\u003eR\u003csub\u003e1\u003c/sub\u003e\u003c/var\u003e,\u003cvar\u003eR\u003csub\u003e2\u003c/sub\u003e\u003c/var\u003e expression style\n   \u003c/td\u003e\n   \u003ctd colspan=\"2\"\u003e\n\u003cvar\u003eR\u003csub\u003e1\u003c/sub\u003e\u003c/var\u003e,\u003cvar\u003eR\u003csub\u003e2\u003c/sub\u003e\u003c/var\u003e informal style\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd rowspan=\"3\"\u003eerror\n   \u003c/td\u003e\n   \u003ctd colspan=\"3\"\u003e\n\u003ccode\u003eerror D\u003csub\u003e1\u003c/sub\u003e\u0026amp;D\u003csub\u003e2\u003c/sub\u003e (M,C,F\u003csub\u003e1\u003c/sub\u003e=V\u003csub\u003e1\u003c/sub\u003e,F\u003csub\u003e2\u003c/sub\u003e=V\u003csub\u003e2\u003c/sub\u003e)\u003c/code\u003e\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eV\u003csub\u003e1\u003c/sub\u003e, V\u003csub\u003e2\u003c/sub\u003e expression style, D\u003csub\u003e1\u003c/sub\u003e,D\u003csub\u003e2\u003c/sub\u003e  in the form \u003ccode\u003e{\u003cvar\u003emodule-id\u003c/var\u003e}\u003cvar\u003elocal-id\u003c/var\u003e\u003c/code\u003e, M expression style, C expression style\n   \u003c/td\u003e\n   \u003ctd colspan=\"2\"\u003eV\u003csub\u003e1\u003c/sub\u003e, V\u003csub\u003e2\u003c/sub\u003e informal style, just local id of D\u003csub\u003e1\u003c/sub\u003e,D\u003csub\u003e2\u003c/sub\u003e, M informal style, C informal style\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd colspan=\"3\"\u003eD\u003csub\u003e1\u003c/sub\u003e,D\u003csub\u003e2\u003c/sub\u003e are type-ids, M is the error message, C is the error cause, F\u003csub\u003e1\u003c/sub\u003e=V\u003csub\u003e1\u003c/sub\u003e,F\u003csub\u003e2\u003c/sub\u003e=V\u003csub\u003e2\u003c/sub\u003e are field names and values of the error detail\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eobject w/o toString method\n   \u003c/td\u003e\n   \u003ctd colspan=\"3\"\u003e\n\u003ccode\u003eobject D1\u0026amp;D2 U\u003c/code\u003e where U is an identifier that uniquely identifies the object (objects will have the same identifier only if they are \u003ccode\u003e===\u003c/code\u003e)\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd rowspan=\"2\"\u003eobject with toString method\n   \u003c/td\u003e\n   \u003ctd\u003e\n\u003ccode\u003eobject S\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd colspan=\"2\"\u003e\n\u003ccode\u003eS\u003c/code\u003e\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd colspan=\"3\"\u003e\n\u003ccode\u003eS\u003c/code\u003e in direct style where S is the result of calling the toString method\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd rowspan=\"2\"\u003e\n\u003cem\u003ecycle detected\u003c/em\u003e\n   \u003c/td\u003e\n   \u003ctd\u003e\n\u003ccode\u003e...[N]\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd colspan=\"2\"\u003e\n\u003ccode\u003e...\u003c/code\u003e\n   \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eN is 0-based index down path from root object to object where cycle is detected\n   \u003c/td\u003e\n   \u003ctd colspan=\"2\"\u003e\n   \u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"ordering\"\u003e5.8.6 Ordering\u003c/h4\u003e\n\u003cp\u003e\nThere are three abstract operations related to ordering: Compare(x, y),\nCompareA(x, y), CompareD(x, y). CompareA(x, y) and CompareD(x, y), which are\nused to define sorting, return one of the values LT, EQ, GT representing the\ncases where x is less than, equal to or greater than y. Compare(x, y), which is\nused to define the relational operators, can also return the value UN to\nrepresent the case where x is unordered with respect to y; this is used to deal\nwith NaN.\n\u003c/p\u003e\n\u003cp\u003e\nThe three operations are related as follows: Compare(x, y) is the same as\nCompareA(x, y) and CompareD(x, y) unless Compare(x, y) is UN.\n\u003c/p\u003e\n\u003cp\u003e\nA type is ordered if all the values that belong to the type can be compared to\neach other using the above three abstract operations. Thus each of the abstract\noperations are defined when there is an ordered type to which both arguments\nbelong.\n\u003c/p\u003e\n\u003cp\u003e\nIf C is any of the three abstract operations, and there is an ordered type to\nwhich both x and y belong, then:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eC(x, y) is LT if and only if C(y, x) is GT\u003c/li\u003e\n\u003cli\u003eC(x, y) is EQ if and only if C(y, x) is EQ\u003c/li\u003e\n\u003cli\u003eC(x, y) is UN if and only if C(y, x) is UN\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe most straightforward ordered types are basic types where all the values of\nthe type can be put into an order. These types are boolean, int, string. For\neach of these three types, for any pair of values x, y belonging to the type\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCompare(x, y) is EQ if x and y are the same value\u003c/li\u003e\n\n\u003cli\u003eCompare(x, y) is LT in the following cases: \n\u003cul\u003e\n\u003cli\u003efor int, if x is mathematically less than y\u003c/li\u003e\n\u003cli\u003efor boolean, if x is false and y is true\u003c/li\u003e\n\u003cli\u003efor string, if x is lexicographically less than y in Unicode code point\norder, more precisely, if\n\u003cul\u003e\n\u003cli\u003ex is an proper initial substring of y, or\u003c/li\u003e\n\u003cli\u003efor the first index at which x and y differ, the code point at that index in\nx is less than the code point at that index in y\u003c/li\u003e  \n\u003c/ul\u003e\n\u003c/li\u003e  \n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eCompareA(x,y), and CompareD(x,y) have the same value as Compare(x, y)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe basic type decimal is ordered. The abstract operations are defined the same\nas for int, except that Compare(x, y) is EQ if x and y have the same shape. In\nother words, the compare operations ignore precision.\n\u003c/p\u003e\n\u003cp\u003e\nThe basic type float is also ordered. Compare(x,y) is as defined by IEEE\n754-2008 clause 5.11. In particular:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethe Compare operation does not distinguish +0 from -0 i.e.\nCompare(-0.0,+0.0) is EQ\u003c/li\u003e\n\u003cli\u003eCompare(x, y) is UN if x or y or both is NaN\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nWhen x and y belong to type float, CompareA(x, y) and CompareD(x, y) differ from\nCompare(x, y) as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCompareA(NaN,NaN) and CompareD(NaN, NaN) are EQ\u003c/li\u003e\n\u003cli\u003eCompareA(x, NaN) is LT if x is not NaN\u003c/li\u003e\n\u003cli\u003eCompareD(NaN, x) is LT if x is not NaN\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIf type T is ordered, then type T? Is also ordered. Comparison operations\ninvolving nil are defined as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCompare((),()), CompareA((),()) and CompareD((),()) are all EQ\u003c/li\u003e\n\u003cli\u003eCompare(x,()) is UN if x is not ()\u003c/li\u003e\n\u003cli\u003eCompareA(x,()) is LT if x is not ()\u003c/li\u003e\n\u003cli\u003eCompareA((), x) is LT if x is not ()\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe CompareA operation is used for sorting in ascending order; the CompareD\noperation is used in reverse for sorting in descending order. The net effect of\nthe above rules is thus that both () and NaN will appear at the end of a sorted\nlist, with NaN before (), in both ascending and descending order.\n\u003c/p\u003e\n\u003cp\u003e\nThe following rules determine when a subtype of list is ordered:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e[T...]  is ordered, if T is ordered;\u003c/li\u003e\n\u003cli\u003e[] is ordered;\u003c/li\u003e\n\u003cli\u003e[T, rest] is ordered if T is ordered and [rest] is ordered.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nEach of the three abstract operations C are extended to apply to lists as\nfollows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eC([], []) is EQ;\u003c/li\u003e\n\u003cli\u003eC([], [y1,...]) is LT;\u003c/li\u003e\n\u003cli\u003eC([x1,x2,...],[y1, y2...]) is r unless r is EQ and otherwise C([x2,...],[y2,...]), where r is C(x1, y1).\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_5.9\"\u003e5.9 Binding patterns and variables\u003c/h3\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.9.1\"\u003e5.9.1 Binding patterns\u003c/h4\u003e\n\u003cp\u003e\nBinding patterns are used to support destructuring, which allows different parts\nof a single structured value each to be assigned to separate variables at the\nsame time.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"binding-pattern\"\u003ebinding-pattern\u003c/span\u003e :=\n   \u003ca href=\"#capture-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003ecapture-binding-pattern\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#wildcard-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003ewildcard-binding-pattern\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#list-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003elist-binding-pattern\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#mapping-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003emapping-binding-pattern\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#error-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003eerror-binding-pattern\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"capture-binding-pattern\"\u003ecapture-binding-pattern\u003c/span\u003e := \u003ca href=\"#variable-name\"\u003e\u003cspan class=\"ntref\"\u003evariable-name\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"variable-name\"\u003evariable-name\u003c/span\u003e := \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"wildcard-binding-pattern\"\u003ewildcard-binding-pattern\u003c/span\u003e := \u003ccode\u003e_\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"list-binding-pattern\"\u003elist-binding-pattern\u003c/span\u003e := \u003ccode\u003e[\u003c/code\u003e \u003ca href=\"#list-member-binding-patterns\"\u003e\u003cspan class=\"ntref\"\u003elist-member-binding-patterns\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e]\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"list-member-binding-patterns\"\u003elist-member-binding-patterns\u003c/span\u003e :=\n   \u003ca href=\"#binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003ebinding-pattern\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003ebinding-pattern\u003c/span\u003e\u003c/a\u003e)* [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#rest-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003erest-binding-pattern\u003c/span\u003e\u003c/a\u003e]\n   | [ \u003ca href=\"#rest-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003erest-binding-pattern\u003c/span\u003e\u003c/a\u003e ]\n\u003cspan class=\"ntdfn\" id=\"mapping-binding-pattern\"\u003emapping-binding-pattern\u003c/span\u003e := \u003ccode\u003e{\u003c/code\u003e \u003ca href=\"#field-binding-patterns\"\u003e\u003cspan class=\"ntref\"\u003efield-binding-patterns\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e}\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"field-binding-patterns\"\u003efield-binding-patterns\u003c/span\u003e :=\n   \u003ca href=\"#field-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003efield-binding-pattern\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#field-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003efield-binding-pattern\u003c/span\u003e\u003c/a\u003e)* [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#rest-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003erest-binding-pattern\u003c/span\u003e\u003c/a\u003e]\n   | [ \u003ca href=\"#rest-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003erest-binding-pattern\u003c/span\u003e\u003c/a\u003e ] \n\u003cspan class=\"ntdfn\" id=\"field-binding-pattern\"\u003efield-binding-pattern\u003c/span\u003e :=\n   \u003ca href=\"#field-name\"\u003e\u003cspan class=\"ntref\"\u003efield-name\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e:\u003c/code\u003e \u003ca href=\"#binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003ebinding-pattern\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#variable-name\"\u003e\u003cspan class=\"ntref\"\u003evariable-name\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"rest-binding-pattern\"\u003erest-binding-pattern\u003c/span\u003e := \u003ccode\u003e...\u003c/code\u003e \u003ca href=\"#variable-name\"\u003e\u003cspan class=\"ntref\"\u003evariable-name\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"error-binding-pattern\"\u003eerror-binding-pattern\u003c/span\u003e := \u003ccode\u003eerror\u003c/code\u003e [\u003ca href=\"#error-type-reference\"\u003e\u003cspan class=\"ntref\"\u003eerror-type-reference\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003e(\u003c/code\u003e \u003ca href=\"#error-arg-list-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003eerror-arg-list-binding-pattern\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e)\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"error-type-reference\"\u003eerror-type-reference\u003c/span\u003e := \u003ca href=\"#type-reference\"\u003e\u003cspan class=\"ntref\"\u003etype-reference\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"error-arg-list-binding-pattern\"\u003eerror-arg-list-binding-pattern\u003c/span\u003e :=\n   \u003ca href=\"#error-message-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003eerror-message-binding-pattern\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#error-cause-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003eerror-cause-binding-pattern\u003c/span\u003e\u003c/a\u003e] [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#error-field-binding-patterns\"\u003e\u003cspan class=\"ntref\"\u003eerror-field-binding-patterns\u003c/span\u003e\u003c/a\u003e]\n   | [\u003ca href=\"#error-field-binding-patterns\"\u003e\u003cspan class=\"ntref\"\u003eerror-field-binding-patterns\u003c/span\u003e\u003c/a\u003e]\n\u003cspan class=\"ntdfn\" id=\"error-message-binding-pattern\"\u003eerror-message-binding-pattern\u003c/span\u003e := \u003ca href=\"#simple-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003esimple-binding-pattern\u003c/span\u003e\u003c/a\u003e \n\u003cspan class=\"ntdfn\" id=\"error-cause-binding-pattern\"\u003eerror-cause-binding-pattern\u003c/span\u003e := \u003ca href=\"#simple-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003esimple-binding-pattern\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#error-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003eerror-binding-pattern\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"simple-binding-pattern\"\u003esimple-binding-pattern\u003c/span\u003e := \u003ca href=\"#capture-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003ecapture-binding-pattern\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#wildcard-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003ewildcard-binding-pattern\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"error-field-binding-patterns\"\u003eerror-field-binding-patterns\u003c/span\u003e :=\n   \u003ca href=\"#named-arg-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003enamed-arg-binding-pattern\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#named-arg-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003enamed-arg-binding-pattern\u003c/span\u003e\u003c/a\u003e)* [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#rest-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003erest-binding-pattern\u003c/span\u003e\u003c/a\u003e]\n   | \u003ca href=\"#rest-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003erest-binding-pattern\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"named-arg-binding-pattern\"\u003enamed-arg-binding-pattern\u003c/span\u003e := \u003ca href=\"#arg-name\"\u003e\u003cspan class=\"ntref\"\u003earg-name\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e=\u003c/code\u003e \u003ca href=\"#binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003ebinding-pattern\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA binding pattern may succeed or fail in matching a value. A successful match\ncauses values to be assigned to all the variables occurring the binding-pattern.\n\u003c/p\u003e\n\u003cp\u003e\nA binding pattern matches a value in any of the following cases.\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ea capture-binding-pattern always matches a value and causes the matched\nvalue to be assigned to named variable;\u003c/li\u003e\n\u003cli\u003ea wildcard-binding-pattern matches a value if the value belongs to type any,\nin other words if the basic type of the value is not error; it does not cause\nany assignments to be made;\u003c/li\u003e\n\u003cli\u003ea list-binding-pattern with m binding patterns matches a list with n\nmembers if m is less than or equal to n, and the i-th binding pattern matches\nthe i-th member of the list for each i in 1 to m, and either m is equal to n or\nthe list-binding-pattern includes a rest-binding-pattern; if there is a\nrest-binding-pattern \u003ccode\u003e...v\u003c/code\u003e, then a successful match causes a new\nlist value consisting of all members of the matched list except for the the\nfirst m values to be assigned to \u003ccode\u003ev\u003c/code\u003e;\u003c/li\u003e\n\u003cli\u003ea mapping-binding-pattern { f\u003csub\u003e1\u003c/sub\u003e: p\u003csub\u003e1\u003c/sub\u003e, f\u003csub\u003e2\u003c/sub\u003e:\np\u003csub\u003e2\u003c/sub\u003e, ..., f\u003csub\u003en\u003c/sub\u003e: p\u003csub\u003en\u003c/sub\u003e, r } matches a mapping value m\nthat includes fields f\u003csub\u003e1\u003c/sub\u003e, f\u003csub\u003e2\u003c/sub\u003e, ... , f\u003csub\u003en\u003c/sub\u003e if\np\u003csub\u003ei\u003c/sub\u003e matches the value of field f\u003csub\u003ei\u003c/sub\u003e for each i in 1 to n; if\nr is \u003ccode\u003e...v\u003c/code\u003e then a successful match causes a new mapping value\nconsisting of all the other fields to be assigned to \u003ccode\u003ev\u003c/code\u003e; a\nfield-binding-pattern consisting of just a variable-name \u003ccode\u003ex\u003c/code\u003e is\nequivalent to a field-binding-pattern \u003ccode\u003ex: x\u003c/code\u003e;\n\u003c/li\u003e\n\u003cli\u003ean error-binding-pattern error ET(p\u003csub\u003em\u003c/sub\u003e, p\u003csub\u003ec\u003c/sub\u003e,\nf\u003csub\u003e1\u003c/sub\u003e = p\u003csub\u003e1\u003c/sub\u003e, f\u003csub\u003e2\u003c/sub\u003e = p\u003csub\u003e2\u003c/sub\u003e, ..., f\u003csub\u003en\u003c/sub\u003e\n= p\u003csub\u003en\u003c/sub\u003e, r) matches an error value e if\n\u003cul\u003e\n\u003cli\u003ee has a message that matches p\u003csub\u003em\u003c/sub\u003e,\u003c/li\u003e\n\u003cli\u003eif p\u003csub\u003ec\u003c/sub\u003e is present, e has a cause that matches p\u003csub\u003ec\u003c/sub\u003e,\u003c/li\u003e\n\u003cli\u003ee has a detail record that has fields f\u003csub\u003e1\u003c/sub\u003e, f\u003csub\u003e2\u003c/sub\u003e, ... ,\nf\u003csub\u003en\u003c/sub\u003e such that p\u003csub\u003ei\u003c/sub\u003e matches the value of field f\u003csub\u003ei\u003c/sub\u003e\nfor each i in 1 to n,\u003c/li\u003e\n\u003cli\u003eif ET is present, the shape of e is in ET,\u003c/li\u003e\n\u003cli\u003eif r is \u003ccode\u003e...v\u003c/code\u003e, then a successful match causes a new mapping\nvalue consisting of all fields of the detail record other than f\u003csub\u003e1\u003c/sub\u003e,\nf\u003csub\u003e2\u003c/sub\u003e, ... , f\u003csub\u003en\u003c/sub\u003e to be assigned to \u003ccode\u003ev\u003c/code\u003e;\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nAll the variables in a binding-pattern must be distinct e.g. [x, x] is not\nallowed.\n\u003c/p\u003e\n\u003cp\u003e\nGiven a type descriptor for every variable in a binding-pattern, there is a type\ndescriptor for the binding-pattern that will contain a value just in case that\nthe binding pattern successfully matches the value causing each variable to be\nassigned a value belonging to the type descriptor for that variable.\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efor a capture-binding-pattern, the type descriptor is the type descriptor\nfor that variable;\u003c/li\u003e\n\u003cli\u003efor a wildcard-binding-pattern, the type descriptor is any\u003c/li\u003e\n\u003cli\u003efor a list-binding-pattern, the type descriptor is a tuple type descriptor;\u003c/li\u003e\n\u003cli\u003efor a mapping-binding-pattern, the type descriptor is a record type\ndescriptor;\u003c/li\u003e\n\u003cli\u003efor an error-binding-pattern, the type descriptor is an error type\ndescriptor.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.9.2\"\u003e5.9.2 Typed binding patterns\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"typed-binding-pattern\"\u003etyped-binding-pattern\u003c/span\u003e := \u003ca href=\"#inferable-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003einferable-type-descriptor\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003ebinding-pattern\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"inferable-type-descriptor\"\u003einferable-type-descriptor\u003c/span\u003e := \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e | \u003ccode\u003evar\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA typed-binding-pattern combines a type-descriptor and a binding-pattern, and is\nused to create the variables occurring in the binding-pattern. If\n\u003ccode\u003evar\u003c/code\u003e is used instead of a type-descriptor, it means the type is\ninferred.\n\u003c/p\u003e\n\u003cp\u003e\nThere are two ways in which a typed-binding-pattern can be used.\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cem\u003eSingle use\u003c/em\u003e. In the language syntax, this kind of use of a\ntyped-binding-pattern is usually followed by \u003ccode\u003e=\u003c/code\u003e (the only case where\nit is not followed by \u003ccode\u003e=\u003c/code\u003e is when it follows \u003ccode\u003eon fail\u003c/code\u003e).\nThe typed-binding-pattern is matched once against the result of evaluating an\nexpression. When \u003ccode\u003evar\u003c/code\u003e is used, the type is inferred from the static\ntype of the expression (in the \u003ccode\u003eon fail\u003c/code\u003e case there can be multiple\nexpressions from which it is inferred); in this case, it is an error if the\nintersection of \u003ccode\u003eerror\u003c/code\u003e and the inferred type is non-empty, the\nbinding-pattern of the typed-binding-pattern is a capture-binding-pattern, and\nthe variable referenced in the capture-binding-pattern is not used. It is an\nerror if the type-descriptor in the typed-binding-pattern is\n\u003ccode\u003enever\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\n\u003cem\u003eIterative use\u003c/em\u003e. In the language syntax, this kind of use of a\ntyped-binding-pattern is followed by the \u003ccode\u003ein\u003c/code\u003e keyword. An iterator is\ncreated from the result of evaluating an expression, and the\ntyped-binding-pattern is matched against each value returned by the iterator.\nWhen \u003ccode\u003evar\u003c/code\u003e is used, the type is inferred to be T, where the static\ntype of the expression is an iterable type with value type T.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe simplest and most common form of a typed-binding-pattern is for the binding\npattern to consist of just a variable name. In this case, the variable is\nconstrained to contain only values matching the type descriptor.\n\u003c/p\u003e\n\u003cp\u003e\nWhen the binding pattern is more complicated, the binding pattern must be\nconsistent with the type-descriptor, so that the type-descriptor unambiguously\ndetermines a type for each variable occurring in the binding pattern. A binding\npattern occurring in a typed-binding-pattern must also be irrefutable with\nrespect to the type of value against which it is to be matched. In other words,\nthe compiler will ensure that matching such a binding pattern against a value\nwill never fail at runtime.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_5.9.3\"\u003e5.9.3 Variable and identifier scoping\u003c/h4\u003e\n\u003cp\u003e\nFor every variable, there is place in the program that declares it. Variables\nare lexically scoped: every variable declaration has a scope which determines\nthe region of the program within which the variable can be referenced.\n\u003c/p\u003e\n\u003cp\u003e\nThere are two kinds of scope: module-scope and block-scope. A variable with\nmodule-scope can be referenced anywhere within a module; if declared\n\u003ccode\u003epublic\u003c/code\u003e, it can also be referenced from outside the module.\n\u003c/p\u003e\n\u003cp\u003e\nIdentifiers with module-scope are used to identify not only variables but other\nmodule-level entities such as functions. Within module-scope, identifiers are\nseparated into three symbol spaces:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethe \u003cem\u003emain\u003c/em\u003e symbol space includes identifiers for variables,\nconstants, types, functions and other identifiers that do not belong to any of\nthe other two symbol spaces;\u003c/li\u003e\n\u003cli\u003ethe \u003cem\u003eprefix\u003c/em\u003e symbol space contains prefixes declared by import\ndeclarations and XML namespace declaration statements;\u003c/li\u003e\n\u003cli\u003ethe \u003cem\u003eannotation tag\u003c/em\u003e symbol space contains annotation tags declared\nby annotation declarations.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe prefix symbol space is special in that it is associated with a source part\nrather than a module.\n\u003c/p\u003e\n\u003cp\u003e\nBlock-scope is divided into symbol spaces in the same way as module-scope,\nexcept that block-scope does not have a symbol space for annotation tags, since\nannotation tags cannot be declared with block-scope.\n\u003c/p\u003e\n\u003cp\u003e\nAn identifier declared with block-scope can be referenced only within a\nparticular block (always delimited with curly braces). Block-scope variables are\ncreated by a variety of different constructs, many of which use a\ntyped-binding-pattern. Parameters are treated as read-only variables with\nblock-scope.\n\u003c/p\u003e\n\u003cp\u003e\nIt is not an error if an identifier is declared with block-scope and there is\nalready a declaration of the same identifier in the same symbol space with\nmodule-scope. In this case, the block-scope declaration will hide the\nmodule-scope declaration for the region where the block-scope declaration is in\nscope. However, it is a compile error if an identifier is declared with\nblock-scope and its scope overlaps with the scope of another declaration of the\nsame identifier in the same symbol space also with block-scope.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch2 id=\"expressions\"\u003e6. Expressions\u003c/h2\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"expression\"\u003eexpression\u003c/span\u003e := \n   \u003ca href=\"#literal\"\u003e\u003cspan class=\"ntref\"\u003eliteral\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#string-template-expr\"\u003e\u003cspan class=\"ntref\"\u003estring-template-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#xml-template-expr\"\u003e\u003cspan class=\"ntref\"\u003exml-template-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#raw-template-expr\"\u003e\u003cspan class=\"ntref\"\u003eraw-template-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#structural-constructor-expr\"\u003e\u003cspan class=\"ntref\"\u003estructural-constructor-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#object-constructor-expr\"\u003e\u003cspan class=\"ntref\"\u003eobject-constructor-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#new-expr\"\u003e\u003cspan class=\"ntref\"\u003enew-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#variable-reference-expr\"\u003e\u003cspan class=\"ntref\"\u003evariable-reference-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#field-access-expr\"\u003e\u003cspan class=\"ntref\"\u003efield-access-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#optional-field-access-expr\"\u003e\u003cspan class=\"ntref\"\u003eoptional-field-access-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#xml-attribute-access-expr\"\u003e\u003cspan class=\"ntref\"\u003exml-attribute-access-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#annot-access-expr\"\u003e\u003cspan class=\"ntref\"\u003eannot-access-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#member-access-expr\"\u003e\u003cspan class=\"ntref\"\u003emember-access-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#function-call-expr\"\u003e\u003cspan class=\"ntref\"\u003efunction-call-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#method-call-expr\"\u003e\u003cspan class=\"ntref\"\u003emethod-call-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#error-constructor-expr\"\u003e\u003cspan class=\"ntref\"\u003eerror-constructor-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#anonymous-function-expr\"\u003e\u003cspan class=\"ntref\"\u003eanonymous-function-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#let-expr\"\u003e\u003cspan class=\"ntref\"\u003elet-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#type-cast-expr\"\u003e\u003cspan class=\"ntref\"\u003etype-cast-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#typeof-expr\"\u003e\u003cspan class=\"ntref\"\u003etypeof-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#unary-expr\"\u003e\u003cspan class=\"ntref\"\u003eunary-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#multiplicative-expr\"\u003e\u003cspan class=\"ntref\"\u003emultiplicative-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#additive-expr\"\u003e\u003cspan class=\"ntref\"\u003eadditive-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#shift-expr\"\u003e\u003cspan class=\"ntref\"\u003eshift-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#range-expr\"\u003e\u003cspan class=\"ntref\"\u003erange-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#relational-expr\"\u003e\u003cspan class=\"ntref\"\u003erelational-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#is-expr\"\u003e\u003cspan class=\"ntref\"\u003eis-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#equality-expr\"\u003e\u003cspan class=\"ntref\"\u003eequality-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#binary-bitwise-expr\"\u003e\u003cspan class=\"ntref\"\u003ebinary-bitwise-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#logical-expr\"\u003e\u003cspan class=\"ntref\"\u003elogical-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#conditional-expr\"\u003e\u003cspan class=\"ntref\"\u003econditional-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#checking-expr\"\u003e\u003cspan class=\"ntref\"\u003echecking-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#trap-expr\"\u003e\u003cspan class=\"ntref\"\u003etrap-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#query-expr\"\u003e\u003cspan class=\"ntref\"\u003equery-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#xml-navigate-expr\"\u003e\u003cspan class=\"ntref\"\u003exml-navigate-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#transactional-expr\"\u003e\u003cspan class=\"ntref\"\u003etransactional-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ccode\u003e(\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e)\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nFor simplicity, the expression grammar is ambiguous. The following table shows\nthe various types of expression in decreasing order of precedence, together with\nassociativity.\n\u003c/p\u003e\n\u003ctable\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\u003cstrong\u003eOperator\u003c/strong\u003e\u003c/td\u003e\n   \u003ctd\u003e\u003cstrong\u003eAssociativity\u003c/strong\u003e\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\n\u003ccode\u003em:x\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ex.k\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ex.@a\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ef(x)\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ex.f(y)\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ex[y]\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003enew T(x)\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd\u003e\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\n\u003ccode\u003e+x\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003e-x\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003e~x\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003e!x\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003e\u0026lt;T\u0026gt; x\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003etypeof x\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003echeck x\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003echeckpanic x\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd\u003e\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\n\u003ccode\u003ex * y\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ex / y\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ex % y\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd\u003eleft\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\n\u003ccode\u003ex + y\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ex - y\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd\u003eleft\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\n\u003ccode\u003ex \u0026lt;\u0026lt; y\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ex \u0026gt;\u0026gt; y\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ex \u0026gt;\u0026gt;\u0026gt; y\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd\u003eleft\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\n\u003ccode\u003ex ... y\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ex ..\u0026lt; y\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd\u003enon\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\n\u003ccode\u003ex \u0026lt; y\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ex \u0026gt; y\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ex \u0026lt;= y\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ex \u0026gt;= y\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ex is y\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd\u003enon\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\n\u003ccode\u003ex == y\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ex != y\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ex === y\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003ex !== y\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd\u003eleft\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\u003ccode\u003ex \u0026amp; y\u003c/code\u003e\u003c/td\u003e\n   \u003ctd\u003eleft\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\u003ccode\u003ex ^ y\u003c/code\u003e\u003c/td\u003e\n   \u003ctd\u003eleft\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\n\u003ccode\u003ex | y\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd\u003eleft\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\u003ccode\u003ex \u0026amp;\u0026amp; y\u003c/code\u003e\u003c/td\u003e\n   \u003ctd\u003eleft\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\u003ccode\u003ex || y\u003c/code\u003e\u003c/td\u003e\n   \u003ctd\u003eleft\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\u003ccode\u003ex ?: y\u003c/code\u003e\u003c/td\u003e\n   \u003ctd\u003eright\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\u003ccode\u003ex ? y : z\u003c/code\u003e\u003c/td\u003e\n   \u003ctd\u003eright\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\n\u003ccode\u003e(x) =\u0026gt; y\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003elet x = y in z\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003efrom x in y select z\u003c/code\u003e\n\u003cbr\u003e\n\u003ccode\u003etrap x\u003c/code\u003e\n   \u003c/td\u003e\n   \u003ctd\u003eright\u003c/td\u003e\n  \u003c/tr\u003e\n\n\u003c/table\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.1\"\u003e6.1 Expression evaluation\u003c/h3\u003e\n\u003cp\u003e\nWhen the evaluation of an expression completes normally, it produces a result,\nwhich is a value. The evaluation of an expression may also complete abruptly.\nThere are two kinds of abrupt completion: check-fail and panic. With both kinds\nof abrupt completion there is an associated value, which always has basic type\nerror.\n\u003c/p\u003e\n\u003cp\u003e\nThe following sections describes how each kind expression is evaluated, assuming\nthat evaluation of subexpressions complete normally. Except where explicitly\nstated to the contrary, expressions handle abrupt completion of subexpressions\nas follows. If in the course of evaluating an expression E, the evaluation of\nsome subexpression E1 completes abruptly, then then evaluation of E also\ncompletes abruptly in the same way as E1.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.2\"\u003e6.2 Static typing of expressions\u003c/h3\u003e\n\u003cp\u003e\nA type is computed for every expression at compile time; this is called the\nstatic type of the expression. The compiler and runtime together guarantee that\nif the evaluation of an expression at runtime completes normally, then the\nresulting value will belong to the static type. A type is also computed for\ncheck-fail abrupt completion, which will be a (possibly empty) subtype of error;\nhowever, for panic abrupt completion, no type is computed.\n\u003c/p\u003e\n\u003cp\u003e\nIt is an error if the static type of an expression is \u003ccode\u003enever\u003c/code\u003e, except\nin cases where the expression is one that this specification explicitly permits\nto have static type \u003ccode\u003enever\u003c/code\u003e and the expression occurs in a context\nwhere this specification explicitly permits an expression with static type\n\u003ccode\u003enever\u003c/code\u003e to occur.\n\u003c/p\u003e\n\u003cp\u003e\nThe detailed rules for the static typing of expressions are quite elaborate and\nare not yet specified completely in this document.\n\u003c/p\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lax_static_typing\"\u003e6.2.1 Lax static typing\u003c/h4\u003e\n\u003cp\u003e\nIn some situations it is convenient for static typing to be less strict than\nnormal. One such situation is when processing data in Ballerina using a static\ntype that is less precise than the type that the data is in fact expected to\nbelong to. For example, when the Ballerina \u003ccode\u003ejson\u003c/code\u003e type is used for\nthe processing of data in JSON format, the Ballerina static type will not\ncapture the constraints of the particular JSON format that is been processed.\n\u003c/p\u003e\n\u003cp\u003e\nBallerina supports this situation through the concept of lax static typing,\nwhich has two parts: the first part is that a type descriptor can be classified\nas lax; the second part is that particular kinds of expression can have less\nstrict static typing rules when the static type of a subexpression is described\nby a lax type descriptor. With these less strict rules, a potential type error\nthat would have been a compile-time error according to the normal strict static\ntyping rules would instead be allowed at compile-time and result in an error\nvalue at runtime; the effect is thus that some static type-checking is instead\ndone dynamically.\n\u003c/p\u003e\n\u003cp\u003e\nIn this version of Ballerina, only the first step has been taken towards\nsupporting this concept. There is a fixed set of type descriptors that are\nclassified as lax: specifically \u003ccode\u003ejson\u003c/code\u003e is lax, and\n\u003ccode\u003emap\u0026lt;T\u0026gt;\u003c/code\u003e is lax if T is lax. The only kinds of expression for\nwhich lax typing rules are specified are field-access-expr,\noptional-field-access-expr and checking-expr.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_6.2.2\"\u003e6.2.2 Contextually expected type\u003c/h4\u003e\n\u003cp\u003e\nFor a context in which an expression occurs, there may be a type descriptor that\ndescribes the static type that the expression is expected to have. This is\ncalled the \u003cem\u003econtextually expected type\u003c/em\u003e. For example, if a variable is\ndeclared by a type descriptor TD, then TD will be the contextually expected type\nfor the expression initializing the variable. A type descriptor must be\nresolved before it can be used to provide a contextually expected type.\u003c/p\u003e\n\u003cp\u003e\nMany kinds of expression that construct values use the contextually expected\ntype to determine the type of value constructed, rather than requiring the type\nto be specified explicitly. For each such kind of expression, there is a set of\nbasic types (most often consisting of a single basic type) that the value\nconstructed by that kind of expression will always belong to. In this case, the\ncontextually expected type is narrowed by intersecting it with this set of basic\ntypes; this narrowed type is called the \u003cem\u003eapplicable\u003c/em\u003e contextually\nexpected type. The narrowing is performed on the type descriptor by first\nnormalizing the type descriptor into a union, where each member of the union is\nnot a union and describes shapes from a single basic type, and then eliminating\nany members of the union with the wrong basic type; if this leaves no members,\nthen it is a compile-time error; if it leaves a single member of the union, then\nthe the applicable contextually expected type is this single member, otherwise\nit is a union of the remaining members.\n\u003c/p\u003e\n\u003cp\u003e\nNote the language provides a way to say that the type of a variable is to be\ninferred from the static type of the expression used to initialize the variable.\nIn this case, there is no contextually expected type for the evaluation of the\nexpression. Not having a contextually expected type is different from having a\ncontextually expected type that allows all values.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_6.2.3\"\u003e6.2.3 Precise and broad types\u003c/h4\u003e\n\u003cp\u003e\nThere is an additional complexity relating to inferring types. Expressions in\nfact have two static types, a precise type and a broad type. Usually, the\nprecise type is used. However, in a few situations, using the precise type would\nbe inconvenient, and so Ballerina uses the broad type. In particular, the broad\ntype is used for inferring the type of an implicitly typed non-final variable.\nSimilarly, the broad type is used when it is necessary to infer the member type\nof the inherent type of a structured value.\n\u003c/p\u003e\n\u003cp\u003e\nIn most cases, the precise type and the broad type of an expression are the\nsame. For a compound expression, the broad type of an expression is computed\nfrom the broad type of the sub-expressions in the same way as the precise type\nof the expression is computed from the precise type of sub-expressions.\nTherefore in most cases, there is no need to mention the distinction between\nprecise and broad types.\n\u003c/p\u003e\n\u003cp\u003e\nThe most important case where the precise type and the broad type are different\nis literals. The precise type is a singleton type containing just the shape of\nthe value that the literal represents, whereas the broad type is the precise\ntype widened to contain the entire basic type of which it is a subtype. For\nexample, the precise type of the string literal \u003ccode\u003e\"X\"\u003c/code\u003e is the\nsingleton type \u003ccode\u003e\"X\"\u003c/code\u003e, but the broad type is \u003ccode\u003estring\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_6.2.4\"\u003e6.2.4 Isolated expressions\u003c/h4\u003e\n\u003cp\u003e\nBallerina defines requirements for when an expression is \u003cem\u003eisolated\u003c/em\u003e. If\nan expression meets the requirements, then it is compile-time guaranteed that\nthe value of the expression will be an isolated root and will not be aliased.\n\u003c/p\u003e\n\u003cp\u003e\nIf the static type of an expression is immutable, i.e. a subtype of\n\u003ccode\u003ereadonly\u003c/code\u003e, or an isolated object, i.e. a subtype of \u003ccode\u003eisolated\nobject {}\u003c/code\u003e, then the expression is isolated.\n\u003c/p\u003e\n\u003cp\u003e\nAlso, an expression of one of the following syntactic kinds is isolated if all\nits subexpressions are isolated (regardless of its static type):\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003elist-constructor-expr\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etable-constructor-expr\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emapping-constructor-expr\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003exml-template-expr\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eraw-template-expr\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etype-cast-expr\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003echecking-expr\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etrap-expr\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003econditional-expr\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe section for each kind of expression will describe any alternative conditions\nunder which that kind of expression is also isolated.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.3\"\u003e6.3 Casting and conversion\u003c/h3\u003e\n\u003cp\u003e\nBallerina makes a sharp distinction between type conversion and type casting.\n\u003c/p\u003e\n\u003cp\u003e\nCasting a value does not change the value. Any value always belongs to multiple\ntypes. Casting means taking a value that is statically known to be of one type,\nand using it in a context that requires another type; casting checks that the\nvalue is of that other type, but does not change the value.\n\u003c/p\u003e\n\u003cp\u003e\nConversion is a process that takes as input a value of one type and produces as\noutput a possibly distinct value of another type. Note that conversion does not\nmutate the input value.\n\u003c/p\u003e\n\u003cp\u003e\nBallerina always requires programmers to make conversions explicit, even between\ndifferent types of number; there are no implicit conversions.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.4\"\u003e6.4 Constant expressions\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"const-expr\"\u003econst-expr\u003c/span\u003e := \n   \u003ca href=\"#literal\"\u003e\u003cspan class=\"ntref\"\u003eliteral\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#string-template-expr\"\u003e\u003cspan class=\"ntref\"\u003estring-template-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#xml-template-expr\"\u003e\u003cspan class=\"ntref\"\u003exml-template-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#raw-template-expr\"\u003e\u003cspan class=\"ntref\"\u003eraw-template-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#structural-constructor-expr\"\u003e\u003cspan class=\"ntref\"\u003estructural-constructor-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#constant-reference-expr\"\u003e\u003cspan class=\"ntref\"\u003econstant-reference-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#type-cast-expr\"\u003e\u003cspan class=\"ntref\"\u003etype-cast-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#unary-expr\"\u003e\u003cspan class=\"ntref\"\u003eunary-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#multiplicative-expr\"\u003e\u003cspan class=\"ntref\"\u003emultiplicative-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#additive-expr\"\u003e\u003cspan class=\"ntref\"\u003eadditive-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#shift-expr\"\u003e\u003cspan class=\"ntref\"\u003eshift-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#range-expr\"\u003e\u003cspan class=\"ntref\"\u003erange-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#relational-expr\"\u003e\u003cspan class=\"ntref\"\u003erelational-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#is-expr\"\u003e\u003cspan class=\"ntref\"\u003eis-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#equality-expr\"\u003e\u003cspan class=\"ntref\"\u003eequality-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#binary-bitwise-expr\"\u003e\u003cspan class=\"ntref\"\u003ebinary-bitwise-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#logical-expr\"\u003e\u003cspan class=\"ntref\"\u003elogical-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#conditional-expr\"\u003e\u003cspan class=\"ntref\"\u003econditional-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ccode\u003e(\u003c/code\u003e \u003ca href=\"#const-expr\"\u003e\u003cspan class=\"ntref\"\u003econst-expr\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e)\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA value resulting from the evaluation of a \u003ccode\u003econst-expr\u003c/code\u003e always has\nits read-only bit on.\n\u003c/p\u003e\n\u003cp\u003e\nWithin a \u003ccode\u003econst-expr\u003c/code\u003e, any nested expression must also be a\nconst-expr.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"constant-reference-expr\"\u003econstant-reference-expr\u003c/span\u003e := \u003ca href=\"#variable-reference-expr\"\u003e\u003cspan class=\"ntref\"\u003evariable-reference-expr\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003econstant-reference-expr\u003c/code\u003e must reference a constant defined with\n\u003ccode\u003emodule-const-decl\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nA \u003ccode\u003econst-expr\u003c/code\u003e is evaluated at compile-time. Constructors called\nwithin a \u003ccode\u003econst-expr\u003c/code\u003e construct their values as immutable. Note that\nthe syntax of const-expr does not allow for the construction of error values.\nThe result of a \u003ccode\u003econst-expr\u003c/code\u003e is always immutable.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"simple-const-expr\"\u003esimple-const-expr\u003c/span\u003e :=\n  \u003ca href=\"#nil-literal\"\u003e\u003cspan class=\"ntref\"\u003enil-literal\u003c/span\u003e\u003c/a\u003e\n  | \u003ca href=\"#boolean-literal\"\u003e\u003cspan class=\"ntref\"\u003eboolean-literal\u003c/span\u003e\u003c/a\u003e\n  | [\u003ca href=\"#Sign\"\u003e\u003cspan class=\"ntref\"\u003eSign\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#int-literal\"\u003e\u003cspan class=\"ntref\"\u003eint-literal\u003c/span\u003e\u003c/a\u003e\n  | [\u003ca href=\"#Sign\"\u003e\u003cspan class=\"ntref\"\u003eSign\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#floating-point-literal\"\u003e\u003cspan class=\"ntref\"\u003efloating-point-literal\u003c/span\u003e\u003c/a\u003e\n  | \u003ca href=\"#string-literal\"\u003e\u003cspan class=\"ntref\"\u003estring-literal\u003c/span\u003e\u003c/a\u003e\n  | \u003ca href=\"#constant-reference-expr\"\u003e\u003cspan class=\"ntref\"\u003econstant-reference-expr\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA simple-const-expr is a restricted form of const-expr used in contexts where\nvarious forms of constructor expression would not make sense. Its semantics are\nthe same as a const-expr.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.5\"\u003e6.5 Literals\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"literal\"\u003eliteral\u003c/span\u003e :=\n   \u003ca href=\"#nil-literal\"\u003e\u003cspan class=\"ntref\"\u003enil-literal\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#boolean-literal\"\u003e\u003cspan class=\"ntref\"\u003eboolean-literal\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#numeric-literal\"\u003e\u003cspan class=\"ntref\"\u003enumeric-literal\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#string-literal\"\u003e\u003cspan class=\"ntref\"\u003estring-literal\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#byte-array-literal\"\u003e\u003cspan class=\"ntref\"\u003ebyte-array-literal\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"numeric-literal\"\u003enumeric-literal\u003c/span\u003e := \u003ca href=\"#int-literal\"\u003e\u003cspan class=\"ntref\"\u003eint-literal\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#floating-point-literal\"\u003e\u003cspan class=\"ntref\"\u003efloating-point-literal\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA numeric-literal represents a value belonging to one of the basic types\nint, float or decimal. The basic type to which the value belongs is determined\nas follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eif the numeric-literal includes a \u003ccode\u003eFloatTypeSuffix\u003c/code\u003e, then the\nbasic type is float;\u003c/li\u003e\n\u003cli\u003eif the numeric-literal includes a \u003ccode\u003eDecimalTypeSuffix\u003c/code\u003e, then the\nbasic type is decimal;\u003c/li\u003e\n\u003cli\u003eif the numeric-literal is a \u003ccode\u003eHexFloatingPointLiteral\u003c/code\u003e, then the\nbasic type is float;\u003c/li\u003e\n\u003cli\u003eotherwise, the basic type depends on the applicable expected numeric type\n(where the possible basic types are int, float and decimal):\n\u003cul\u003e\n\u003cli\u003eif the applicable contextually expected type is a subtype of decimal, then\nthe basic type is decimal;\u003c/li\u003e\n\u003cli\u003eif the applicable contextually expected type is a subtype of float, then the\nbasic type is float;\u003c/li\u003e\n\u003cli\u003eotherwise, if the numeric literal is an int-literal, then the basic type is\nint;\u003c/li\u003e\n\u003cli\u003eotherwise, the basic type is float.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe precise type of a numeric-literal is the singleton type containing just the\nshape of the value that the numeric-literal represents. The broad type is\nthe basic type of which the precise type is a subset.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"byte-array-literal\"\u003ebyte-array-literal\u003c/span\u003e := \u003ca href=\"#Base16Literal\"\u003e\u003cspan class=\"ntref\"\u003eBase16Literal\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#Base64Literal\"\u003e\u003cspan class=\"ntref\"\u003eBase64Literal\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"Base16Literal\"\u003eBase16Literal\u003c/span\u003e := \u003ccode\u003ebase16\u003c/code\u003e \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e`\u003c/code\u003e \u003ca href=\"#HexGroup\"\u003e\u003cspan class=\"ntref\"\u003eHexGroup\u003c/span\u003e\u003c/a\u003e* \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e`\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"HexGroup\"\u003eHexGroup\u003c/span\u003e := \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#HexDigit\"\u003e\u003cspan class=\"ntref\"\u003eHexDigit\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#HexDigit\"\u003e\u003cspan class=\"ntref\"\u003eHexDigit\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"Base64Literal\"\u003eBase64Literal\u003c/span\u003e := \u003ccode\u003ebase64\u003c/code\u003e \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e`\u003c/code\u003e \u003ca href=\"#Base64Group\"\u003e\u003cspan class=\"ntref\"\u003eBase64Group\u003c/span\u003e\u003c/a\u003e* [\u003ca href=\"#PaddedBase64Group\"\u003e\u003cspan class=\"ntref\"\u003ePaddedBase64Group\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e`\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"Base64Group\"\u003eBase64Group\u003c/span\u003e :=\n   \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#Base64Char\"\u003e\u003cspan class=\"ntref\"\u003eBase64Char\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#Base64Char\"\u003e\u003cspan class=\"ntref\"\u003eBase64Char\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#Base64Char\"\u003e\u003cspan class=\"ntref\"\u003eBase64Char\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#Base64Char\"\u003e\u003cspan class=\"ntref\"\u003eBase64Char\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"PaddedBase64Group\"\u003ePaddedBase64Group\u003c/span\u003e :=\n   \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#Base64Char\"\u003e\u003cspan class=\"ntref\"\u003eBase64Char\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#Base64Char\"\u003e\u003cspan class=\"ntref\"\u003eBase64Char\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#Base64Char\"\u003e\u003cspan class=\"ntref\"\u003eBase64Char\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#PaddingChar\"\u003e\u003cspan class=\"ntref\"\u003ePaddingChar\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#Base64Char\"\u003e\u003cspan class=\"ntref\"\u003eBase64Char\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#Base64Char\"\u003e\u003cspan class=\"ntref\"\u003eBase64Char\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#PaddingChar\"\u003e\u003cspan class=\"ntref\"\u003ePaddingChar\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#WS\"\u003e\u003cspan class=\"ntref\"\u003eWS\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#PaddingChar\"\u003e\u003cspan class=\"ntref\"\u003ePaddingChar\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"Base64Char\"\u003eBase64Char\u003c/span\u003e := \u003ccode\u003eA\u003c/code\u003e .. \u003ccode\u003eZ\u003c/code\u003e | \u003ccode\u003ea\u003c/code\u003e .. \u003ccode\u003ez\u003c/code\u003e | \u003ccode\u003e0\u003c/code\u003e .. \u003ccode\u003e9\u003c/code\u003e | \u003ccode\u003e+\u003c/code\u003e | \u003ccode\u003e/\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"PaddingChar\"\u003ePaddingChar\u003c/span\u003e := \u003ccode\u003e=\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"WS\"\u003eWS\u003c/span\u003e := \u003ca href=\"#WhiteSpaceChar\"\u003e\u003cspan class=\"ntref\"\u003eWhiteSpaceChar\u003c/span\u003e\u003c/a\u003e*\n\u003c/pre\u003e\n\u003cp\u003e\nThe static type of byte-array-literal is \u003ccode\u003ebyte[N]\u003c/code\u003e, where N is the\nnumber of bytes encoded by the Base16Literal or Base64Literal. The inherent type\nof the array value created is also \u003ccode\u003ebyte[N]\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.6\"\u003e6.6 Template expressions\u003c/h3\u003e\n\u003cp\u003e\nTemplate expressions make use of strings enclosed in backticks with interpolated\nexpressions.\n\u003c/p\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"BacktickString\"\u003eBacktickString\u003c/span\u003e :=\n  \u003ccode\u003e`\u003c/code\u003e \u003ca href=\"#BacktickItem\"\u003e\u003cspan class=\"ntref\"\u003eBacktickItem\u003c/span\u003e\u003c/a\u003e* \u003ca href=\"#Dollar\"\u003e\u003cspan class=\"ntref\"\u003eDollar\u003c/span\u003e\u003c/a\u003e* \u003ccode\u003e`\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"BacktickItem\"\u003eBacktickItem\u003c/span\u003e :=\n   \u003ca href=\"#BacktickSafeChar\"\u003e\u003cspan class=\"ntref\"\u003eBacktickSafeChar\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#BacktickDollarsSafeChar\"\u003e\u003cspan class=\"ntref\"\u003eBacktickDollarsSafeChar\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#Dollar\"\u003e\u003cspan class=\"ntref\"\u003eDollar\u003c/span\u003e\u003c/a\u003e* \u003ca href=\"#interpolation\"\u003e\u003cspan class=\"ntref\"\u003einterpolation\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"interpolation\"\u003einterpolation\u003c/span\u003e := \u003ccode\u003e${\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e}\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"BacktickSafeChar\"\u003eBacktickSafeChar\u003c/span\u003e := ^ ( \u003ccode\u003e`\u003c/code\u003e | \u003ccode\u003e$\u003c/code\u003e )\n\u003cspan class=\"ntdfn\" id=\"BacktickDollarsSafeChar\"\u003eBacktickDollarsSafeChar\u003c/span\u003e :=  \u003ccode\u003e$\u003c/code\u003e+ ^ ( \u003ccode\u003e{\u003c/code\u003e | \u003ccode\u003e`\u003c/code\u003e | \u003ccode\u003e$\u003c/code\u003e)\n\u003cspan class=\"ntdfn\" id=\"Dollar\"\u003eDollar\u003c/span\u003e := \u003ccode\u003e$\u003c/code\u003e\n\u003c/pre\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_6.6.1\"\u003e6.6.1 String template expression\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"string-template-expr\"\u003estring-template-expr\u003c/span\u003e := \u003ccode\u003estring\u003c/code\u003e \u003ca href=\"#BacktickString\"\u003e\u003cspan class=\"ntref\"\u003eBacktickString\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003estring-template-expr\u003c/code\u003e interpolates the results of evaluating\nexpressions into a literal string. The static type of the expression in each\ninterpolation must be a subtype of\n\u003ccode\u003eboolean|int|float|decimal|string\u003c/code\u003e. Within a\n\u003ccode\u003eBacktickString\u003c/code\u003e, every character that is not part of an\n\u003ccode\u003einterpolation\u003c/code\u003e is interpreted as a literal character. A\nstring-template-expr is evaluated by evaluating the expression in each\ninterpolation in the order in which they occur, and converting the result of the\neach evaluation to a string using the \u003ca href=\"#ToString\"\u003eToString\u003c/a\u003e abstract\noperation with the direct style. The result of evaluating the\n\u003ccode\u003estring-template-expr\u003c/code\u003e is a string comprising the literal characters\nand the results of evaluating and converting the interpolations, in the order in\nwhich they occur in the \u003ccode\u003eBacktickString\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nA literal \u003ccode\u003e`\u003c/code\u003e can be included in string template by using an\ninterpolation \u003ccode\u003e${\"`\"}\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_6.6.2\"\u003e6.6.2 XML template expression\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"xml-template-expr\"\u003exml-template-expr\u003c/span\u003e := \u003ccode\u003exml\u003c/code\u003e \u003ca href=\"#BacktickString\"\u003e\u003cspan class=\"ntref\"\u003eBacktickString\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nAn XML template expression constructs an xml value as follows:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe backtick string is parsed to produce a string of literal characters with\ninterpolated expressions\u003c/li\u003e\n\u003cli\u003eThe result of the previous step is parsed as XML content. More precisely, it\nis parsed using the production \u003ccode\u003econtent\u003c/code\u003e in the W3C XML\nRecommendation. For the purposes of parsing as XML, each interpolated expression\nis interpreted as if it were an additional character allowed by the CharData and\nAttValue productions but no other. The result of this step is an XML Infoset\nconsisting of an ordered list of information items such as could occur as the\n[children] property of an element information item, except that interpolated\nexpressions may occur as Character Information Item or in the [normalized value]\nof an Attribute Information Item. Interpolated expressions are not allowed in\nthe value of a namespace attribute.\u003c/li\u003e\n\u003cli\u003eThis infoset is then converted to an xml value, as described in the \u003ca href=\"#XML\"\u003eXML type\u003c/a\u003e section, together with an ordered list of interpolated\nexpressions, and for each interpolated expression a position within the XML\nvalue at which the value of the expression is to be inserted.\u003c/li\u003e\n\u003cli\u003eThe static type of an expression occurring in an attribute value must be a\nsimple type and must not be nil. The static type type of an expression occurring\nin content can either be xml or a non-nil simple type.\u003c/li\u003e\n\u003cli\u003eWhen the xml-template-expr is evaluated, the interpolated expressions are evaluated\nin the order in which they occur in the \u003ccode\u003eBacktickString\u003c/code\u003e, and\nconverted to strings if necessary. A new copy is made of the xml value and the\nresult of the expression evaluations are inserted into the corresponding\nposition in the newly created xml value. This xml value is the result of the\nevaluation.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\nAn xml-template-expr occurring within a const-expr will construct an xml value\nthat has its read-only bit on.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_6.6.3\"\u003e6.6.3 Raw template expression\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"raw-template-expr\"\u003eraw-template-expr\u003c/span\u003e := \u003ca href=\"#BacktickString\"\u003e\u003cspan class=\"ntref\"\u003eBacktickString\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA raw-template-expr constructs an object belonging to the abstract RawTemplate\nobject type.\n\u003c/p\u003e\n\u003cp\u003e\nA raw-template-expr is evaluated by\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003econstructing an array \u003cvar\u003ev\u003c/var\u003e whose members are the result of\nevaluating each interpolation's expression in the order in which they occur in\nthe BacktickString;\u003c/li\u003e\n\u003cli\u003econstructing an object with two fields\n\u003cul\u003e\n\u003cli\u003ean \u003ccode\u003einsertions\u003c/code\u003e field with value \u003cvar\u003ev\u003c/var\u003e\n\u003c/li\u003e\n\u003cli\u003ea \u003ccode\u003estrings\u003c/code\u003e field consisting of a read-only array of strings\ncontaining the characters in BacktickString outside of interpolations, split at\nthe interpolation points; the length of the this array is one more than the\nlength of \u003cvar\u003ev\u003c/var\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe result of the raw-template-expr is the newly constructed object.\n\u003c/p\u003e\n\u003cp\u003e\nFor each raw-template-expr there is a separate class, which\nis a subtype of the RawTemplate type. The objects constructed by a\nraw-template-expr belong to this class. The type of the\n\u003ccode\u003einsertions\u003c/code\u003e field is determined from the contextually expected type\nor the static type of the expressions in the BacktickString in the same way as\nwith a list-constructor-expr. The \u003ccode\u003estrings\u003c/code\u003e and\n\u003ccode\u003einsertions\u003c/code\u003e fields will be read-only if required by the contextually\nexpected type. The value of the \u003ccode\u003estrings\u003c/code\u003e field is constructed once\nby the class. The value of the \u003ccode\u003einsertions\u003c/code\u003e is\nconstructed once for each evaluation of the raw-template-expr.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_6.7\"\u003e6.7 Structural constructors\u003c/h3\u003e\n\u003cp\u003e\nEach basic type of structure has its own expression syntax for constructing a\nvalue of the type.\n\u003c/p\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"structural-constructor-expr\"\u003estructural-constructor-expr\u003c/span\u003e := \u003ca href=\"#list-constructor-expr\"\u003e\u003cspan class=\"ntref\"\u003elist-constructor-expr\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#table-constructor-expr\"\u003e\u003cspan class=\"ntref\"\u003etable-constructor-expr\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#mapping-constructor-expr\"\u003e\u003cspan class=\"ntref\"\u003emapping-constructor-expr\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nAn structural-constructor-expr occurring within a const-expr will construct a\nstructural value that has its read-only bit on.\n\u003c/p\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_6.7.1\"\u003e6.7.1 List constructor\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"list-constructor-expr\"\u003elist-constructor-expr\u003c/span\u003e := \u003ccode\u003e[\u003c/code\u003e [ \u003ca href=\"#expr-list\"\u003e\u003cspan class=\"ntref\"\u003eexpr-list\u003c/span\u003e\u003c/a\u003e ] \u003ccode\u003e]\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"expr-list\"\u003eexpr-list\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e)*\n\u003c/pre\u003e\n\u003cp\u003e\nA list-constructor-expr creates a new list value. The members of the list come from evaluating each\nexpression in the expr-list in order.\n\u003c/p\u003e\n\u003cp\u003e\nIf there is a contextually expected type, then the inherent type of the newly\ncreated list is derived from the applicable contextually expected type. If the\napplicable contextually expected type is a list type descriptor, then that used\nas the inherent type. If the applicable contextually expected type is a union\ntype descriptor, then any members of the union that do not contain list shapes\nof length N will be ignored, where N is the number of expressions in the\n\u003ccode\u003eexpr-list\u003c/code\u003e; it is a compile-time error if this does not leave a\nsingle list type descriptor, which is then used as the inherent type. The static\ntype of the list-constructor-expr will be the same as the inherent type.\n\u003c/p\u003e\n\u003cp\u003e\nIf there is no contextually expected type, then the inherent type will be a\ntuple-type-descriptor with a member-type-descriptor for each expression in the\nexpr-list; the type of each member-type-descriptor will be the broad type of the\ncorresponding expression in the expr-list.\n\u003c/p\u003e\n\u003cp\u003e\nIf there is a contextually expected type, then the type that the inherent type\nrequires for each list member provides the contextually expected type for the\nexpression for the member; otherwise there is no contextually expected type for\nthe expressions for members.\n\u003c/p\u003e\n\u003cp\u003e\nA member of a list can be filled in automatically if the \u003ca href=\"#FillMember\"\u003eFillMember\u003c/a\u003e abstract operation would succeed on it. The\ninherent type of a list establishes either a fixed length for the list or just a\nminimum length for the list, which may be zero. In either case, a list\nconstructor may specify only the first \u003cvar\u003ek\u003c/var\u003e members, provided that for\neach \u003cvar\u003ei\u003c/var\u003e from \u003cvar\u003ek\u003c/var\u003e + 1 up to the fixed length of the list, the\n\u003cvar\u003ei\u003c/var\u003e-th member can be filled in automatically.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_6.7.2\"\u003e6.7.2 Mapping constructor\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"mapping-constructor-expr\"\u003emapping-constructor-expr\u003c/span\u003e := \u003ccode\u003e{\u003c/code\u003e [\u003ca href=\"#field\"\u003e\u003cspan class=\"ntref\"\u003efield\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#field\"\u003e\u003cspan class=\"ntref\"\u003efield\u003c/span\u003e\u003c/a\u003e)*] \u003ccode\u003e}\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"field\"\u003efield\u003c/span\u003e := \n  \u003ca href=\"#specific-field\"\u003e\u003cspan class=\"ntref\"\u003especific-field\u003c/span\u003e\u003c/a\u003e\n  | \u003ca href=\"#computed-name-field\"\u003e\u003cspan class=\"ntref\"\u003ecomputed-name-field\u003c/span\u003e\u003c/a\u003e\n  | \u003ca href=\"#spread-field\"\u003e\u003cspan class=\"ntref\"\u003espread-field\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"specific-field\"\u003especific-field\u003c/span\u003e :=\n   [\u003ccode\u003ereadonly\u003c/code\u003e] (\u003ca href=\"#field-name\"\u003e\u003cspan class=\"ntref\"\u003efield-name\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#string-literal\"\u003e\u003cspan class=\"ntref\"\u003estring-literal\u003c/span\u003e\u003c/a\u003e) \u003ccode\u003e:\u003c/code\u003e \u003ca href=\"#value-expr\"\u003e\u003cspan class=\"ntref\"\u003evalue-expr\u003c/span\u003e\u003c/a\u003e\n   | [\u003ccode\u003ereadonly\u003c/code\u003e] [\u003ca href=\"#variable-name\"\u003e\u003cspan class=\"ntref\"\u003evariable-name\u003c/span\u003e\u003c/a\u003e]\n\u003cspan class=\"ntdfn\" id=\"value-expr\"\u003evalue-expr\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"computed-name-field\"\u003ecomputed-name-field\u003c/span\u003e := \u003ccode\u003e[\u003c/code\u003e \u003ca href=\"#field-name-expr\"\u003e\u003cspan class=\"ntref\"\u003efield-name-expr\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e]\u003c/code\u003e \u003ccode\u003e:\u003c/code\u003e \u003ca href=\"#value-expr\"\u003e\u003cspan class=\"ntref\"\u003evalue-expr\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"field-name-expr\"\u003efield-name-expr\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"spread-field\"\u003espread-field\u003c/span\u003e := \u003ccode\u003e...\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA mapping-constructor-expr creates a new mapping value. \n\u003c/p\u003e\n\u003cp\u003e\nA specific-field specifies a single field, where the field name is known at\ncompile-time. A specific-field that consists of just a variable name\n\u003ccode\u003e\u003cvar\u003ex\u003c/var\u003e\u003c/code\u003e is equivalent to a field \u003ccode\u003e\u003cvar\u003ex\u003c/var\u003e:\n\u003cvar\u003ex\u003c/var\u003e\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThe static type of the expression in a spread-field must allow only mapping\nvalues, i.e. must be a subtype of \u003ccode\u003emap\u0026lt;any|error\u0026gt;\u003c/code\u003e. All the\nfields of the mapping value that results from evaluating that expression are\nincluded in the mapping value being constructed. It is a compile-time error if\nthe static type of the expression in a spread-field allows a field that\nduplicates a specific-field or that could also occur in another spread-field.\nNote that a spread-field with an inclusive record type of \u003ccode\u003erecord { never\nx?; }\u003c/code\u003e cannot duplicate a specific field for \u003ccode\u003ex\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nIf there is a contextually expected type, then the inherent type of the newly\ncreated mapping is derived from the applicable contextually expected type. If\nthe applicable contextually expected type is a mapping type descriptor, then\nthat used as the inherent type. If the applicable contextually expected type is\na union type descriptor, then any members of the union that are inconsistent\nwith the field names specified in a specific-field in the\nmapping-constructor-expr will be ignored; it is a compile-time error if this\ndoes not leave a single mapping type descriptor, which is then used as the\ninherent type. The static type of the mapping-constructor-expr will be the same\nas the inherent type.\n\u003c/p\u003e\n\u003cp\u003e\nIf there is no contextually expected type, then the inherent type will be an\nexclusive-record-type-descriptor with an individual-field-descriptor for each\nspecific-field; the type of each field-descriptor will be the broad type of the\nvalue-expr in the field, unless the field is read-only in which case the type of\nthe field-descriptor will be the precise type. The static type of the expression\nin every spread-field will also be added to the inherent type. If there are\nfields specified as a computed-name-field, then there will also be a\nrecord-rest-descriptor \u003ccode\u003eT...\u003c/code\u003e, where \u003ccode\u003eT\u003c/code\u003e is the union of\nthe broad types of the value-expr in all such fields.\n\u003c/p\u003e\n\u003cp\u003e\nIf a specific-field does not use a string-literal for the name of the field and\nthe inherent type descriptor is a record type descriptor, then the record type\ndescriptor must include an individual-field-descriptor for that field.\n\u003c/p\u003e\n\u003cp\u003e\nIf the inherent type descriptor is a record type descriptor, a field will be\nadded to the constructed value using the default value from the type descriptor\nfor any field that is not specified explicitly in the mapping constructor and\nthat has a default value.\n\u003c/p\u003e\n\u003cp\u003e\nIf there is a contextually expected type, then the type that the inherent type\nrequires for each field provides the contextually expected type for the\nvalue-expr in a field; otherwise there is no contextually expected type for the\nvalue-expr for fields. If there is a contextually expected type, the\ncontextually expected type for the expression in a spread-field is map\u0026lt;T\u0026gt;,\nwhere the T is the smallest type such that the inherent type is a subtype of\nmap\u0026lt;T\u0026gt;. The contextually expected type for a field-name-expr is string.\n\u003c/p\u003e\n\u003cp\u003e\nA computed-name-field specifies a single field, where the name of the field is\nspecified by an expression enclosed in square brackets. A\nmapping-constructor-expr first constructs a mapping value without considering\nany computed-name-field. The effect of a computed-name-field is to modify the\nmember of the mapping with the specified name after the mapping has been\nconstructed. If the modification is incompatible with the inherent type, then\nthe mapping-constructor-expr will panic. The modifications are performed in the\norder in which the computed-name-fields occur in the mapping-constructor-expr.\n\u003c/p\u003e\n\u003cp\u003e\nIf the applicable contextually expected type is a subtype of readonly, then the\nmapping will be constructed with its read-only bit on. If the inherent type\nmakes a specific field readonly, then that field will be constructed with its\nread-only bit on. A specific-field that starts with \u003ccode\u003ereadonly\u003c/code\u003e will\nalso be constructed with its read-only bit on.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_6.7.3\"\u003e6.7.3 Table constructor\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"table-constructor-expr\"\u003etable-constructor-expr\u003c/span\u003e := \u003ccode\u003etable\u003c/code\u003e [\u003ca href=\"#key-specifier\"\u003e\u003cspan class=\"ntref\"\u003ekey-specifier\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003e[\u003c/code\u003e [\u003ca href=\"#row-list\"\u003e\u003cspan class=\"ntref\"\u003erow-list\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003e]\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"row-list\"\u003erow-list\u003c/span\u003e := \u003ca href=\"#mapping-constructor-expr\"\u003e\u003cspan class=\"ntref\"\u003emapping-constructor-expr\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#mapping-constructor-expr\"\u003e\u003cspan class=\"ntref\"\u003emapping-constructor-expr\u003c/span\u003e\u003c/a\u003e)*\n\u003c/pre\u003e\n\u003cp\u003e\nA table-constructor-expr creates a new table value. The members of the table\ncome from evaluating each mapping-constructor-expr in the row-list in order.\n\u003c/p\u003e\n\u003cp\u003e\nFor example,\n\u003c/p\u003e\n\n\u003cpre\u003etable key(email) [\n   { email: \"sanjiva@weerawarana.org\", firstName: \"Sanjiva\", lastName: \"Weerawarana\" },\n   { email: \"jjc@jclark.com\", firstName: \"James\", lastName: \"Clark\" }\n]\n\u003c/pre\u003e\n\u003cp\u003e\nThe inherent type of the constructed table is a table type descriptor including\na key-specifier \u003ccode\u003etable\u0026lt;\u003cvar\u003eT\u003c/var\u003e\u0026gt; key(\u003cvar\u003eks\u003c/var\u003e)\u003c/code\u003e, where\n\u003ccode\u003e\u003cvar\u003eT\u003c/var\u003e\u003c/code\u003e is the member type and \u003ccode\u003e\u003cvar\u003eks\u003c/var\u003e\u003c/code\u003e is\nthe key sequence. The inherent type is determined from the contextually expected\ntype togther with the table-constructor-expr. The static type of the\ntable-constructor-expr will be the same as this inherent type.\n\u003c/p\u003e\n\u003cp\u003e\nIf there is a contextually expected type, then the member type of inherent type\nof the newly created table is derived from the applicable contextually expected\ntype, which must be a table-type-descriptor. If there is no contextually\nexpected type, then the member type of the inherent type is derived from the the\nstatic type of the expressions for the members: the member type will be the\nsmallest record type that is a supertype of the static types of all the\nexpressions in the row-list. It is an error if there is no contextually expected\ntype and the row-list is empty.\n\u003c/p\u003e\n\u003cp\u003e\nThe key sequence of the inherent type comes from the key-specifier of applicable\ncontextually expected type or the key-specifier in the table-constructor-expr.\nIf both of these are present, then they must be the same. If neither of them are\npresent, then the key sequence is empty. The key sequence of the table value is\nthe same as that of its inherent type. The key sequence and member type must\nmeet the same consistency requirements as if they were specified together in a\n\u003ca href=\"#tables\"\u003etable type descriptor\u003c/a\u003e. For every field-name in the key\nsequence of the inherent type every mapping-constructor-expr in the row-list\nmust include a specific-field that has a value-expr that is a const-expr. It is\na compile-time error if two or more rows of the table have the same key value.\n\u003c/p\u003e\n\u003cp\u003e\nIf there is a contextually expected type, then the type that the inherent type\nrequires for each table member provides the contextually expected type for the\nexpressions in the expr-list; otherwise there is no contextually expected type\nfor these expressions.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_6.8\"\u003e6.8 Object construction\u003c/h3\u003e\n\u003cp\u003e\nThere are two kinds of expression that can be used to construct an object: with\nan object constructor expression, the methods and fields of the constructed\nobject are defined within the expression; with a new expression, the methods and\nfields come from a separate, named class definition.\n\u003c/p\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_6.8.1\"\u003e6.8.1 Object constructor\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"object-constructor-expr\"\u003eobject-constructor-expr\u003c/span\u003e :=\n   [\u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#object-type-quals\"\u003e\u003cspan class=\"ntref\"\u003eobject-type-quals\u003c/span\u003e\u003c/a\u003e \u003ccode\u003eobject\u003c/code\u003e [\u003ca href=\"#type-reference\"\u003e\u003cspan class=\"ntref\"\u003etype-reference\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#object-constructor-block\"\u003e\u003cspan class=\"ntref\"\u003eobject-constructor-block\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"object-constructor-block\"\u003eobject-constructor-block\u003c/span\u003e := \u003ccode\u003e{\u003c/code\u003e \u003ca href=\"#object-member\"\u003e\u003cspan class=\"ntref\"\u003eobject-member\u003c/span\u003e\u003c/a\u003e* \u003ccode\u003e}\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"object-member\"\u003eobject-member\u003c/span\u003e := \u003ca href=\"#object-field\"\u003e\u003cspan class=\"ntref\"\u003eobject-field\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#method-defn\"\u003e\u003cspan class=\"ntref\"\u003emethod-defn\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#remote-method-defn\"\u003e\u003cspan class=\"ntref\"\u003eremote-method-defn\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#resource-method-defn\"\u003e\u003cspan class=\"ntref\"\u003eresource-method-defn\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe resulting of evaluating an \u003ccode\u003eobject-constructor-expr\u003c/code\u003e is an\nobject. The \u003ccode\u003eobject-constructor-expr\u003c/code\u003e must specify\n\u003ccode\u003eclient\u003c/code\u003e if any \u003ccode\u003emethod-defn\u003c/code\u003e includes a\n\u003ccode\u003eremote-qual\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThe annotations applying to the \u003ccode\u003eobject-constructor-expr\u003c/code\u003e and its\nmembers are evaluated when the \u003ccode\u003eobject-constructor-expr\u003c/code\u003e is\nevaluated. This means that every object resulting from the evaluation of an\n\u003ccode\u003eobject-constructor-expr\u003c/code\u003e has its own type descriptor.\n\u003c/p\u003e\n\u003cp\u003e\nIf there is a \u003ccode\u003etype-reference\u003c/code\u003e, then the referenced type is included\nin the object's type in the same was as an \u003ccode\u003eobject-type-inclusion\u003c/code\u003e,\nand the type-ids of the constructed object are type-ids of the referenced type.\nIf there is no \u003ccode\u003etype-reference\u003c/code\u003e, then the applicable contextually\nexpected type T, if any, must be definite, and the type-ids of the constructed\nobject are the type-ids, if any, induced by T.\n\u003c/p\u003e\n\u003cp\u003e\nThe \u003ccode\u003eobject-constructor-expr\u003c/code\u003e is \u003cem\u003eimplicitly read-only\u003c/em\u003e if the\napplicable contextually expected type is a subtype of readonly or if the\n\u003ccode\u003etype-reference\u003c/code\u003e is present and references a type that is a subtype\nof readonly. If the \u003ccode\u003eobject-constructor-expr\u003c/code\u003e is \u003cem\u003eimplicitly\nread-only\u003c/em\u003e, then the object will be constructed with its read-only bit on;\nfurthermore, in this case an \u003ccode\u003eobject-type-inclusion\u003c/code\u003e is allowed to\ndirectly or indirectly reference a readonly class.\n\u003c/p\u003e\n\u003cp\u003e\nThe \u003ccode\u003eobject-constructor-expr\u003c/code\u003e is \u003cem\u003eexplicitly isolated\u003c/em\u003e if\n\u003ccode\u003eobject-type-quals\u003c/code\u003e includes \u003ccode\u003eisolated\u003c/code\u003e or if the\ntype-reference is present and references an isolated object type. An\n\u003ccode\u003eobject-constructor-expr\u003c/code\u003e that is explicitly isolated will construct\nan object with its isolated bit set.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"object-visibility-qual\"\u003eobject-visibility-qual\u003c/span\u003e := \u003ccode\u003epublic\u003c/code\u003e|\u003ccode\u003eprivate\u003c/code\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nA visibility qualifier of \u003ccode\u003eprivate\u003c/code\u003e can be used within an\n\u003ccode\u003eobject-constructor-expr\u003c/code\u003e expression; this means that the visibility\nregion consists of every method-defn-body in the object-constructor-expr.\n\u003c/p\u003e\n\n\u003csection\u003e\n\u003ch5 id=\"section_6.8.1.1\"\u003e6.8.1.1 Fields\u003c/h5\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"object-field\"\u003eobject-field\u003c/span\u003e :=\n   \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#object-visibility-qual\"\u003e\u003cspan class=\"ntref\"\u003eobject-visibility-qual\u003c/span\u003e\u003c/a\u003e] [\u003ccode\u003efinal\u003c/code\u003e]\n   \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#field-name\"\u003e\u003cspan class=\"ntref\"\u003efield-name\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003e=\u003c/code\u003e \u003ca href=\"#field-initializer\"\u003e\u003cspan class=\"ntref\"\u003efield-initializer\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003e;\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"field-initializer\"\u003efield-initializer\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nAn \u003ccode\u003eobject-field\u003c/code\u003e declares and initializes a field of the object.\n\u003c/p\u003e\n\u003cp\u003e\nIf a field does not specify a field-initializer, then there must be an\n\u003ccode\u003einit\u003c/code\u003e method and the \u003ccode\u003einit\u003c/code\u003e method must initialize the\nfield. The field-initializer must meet the requirements for an isolated function\nunless the \u003ccode\u003einit\u003c/code\u003e method is present and not declared as\n\u003ccode\u003eisolated\u003c/code\u003e. If the \u003ccode\u003eobject-constructor-expr\u003c/code\u003e is implicitly\nread-only, then the contextually expected type for a field-initializer will be\nthe intersection of readonly and the type specified in the type-descriptor of\nthe object-field.\n\u003c/p\u003e\n\u003cp\u003e\nIf \u003ccode\u003efinal\u003c/code\u003e is present, then the field must be assigned to exactly\nonce, either by its initializer or in the \u003ccode\u003einit\u003c/code\u003e method.\n\u003c/p\u003e\n\u003cp\u003e\nAn \u003ccode\u003eobject-constructor-expr\u003c/code\u003e will construct an object with its\nread-only bit set if every object-field is declared as \u003ccode\u003efinal\u003c/code\u003e and\nhas a type-descriptor that is a subtype of \u003ccode\u003ereadonly\u003c/code\u003e. In this case,\nthe static type of the \u003ccode\u003eobject-constructor-expr\u003c/code\u003e will be intersected\nwith \u003ccode\u003ereadonly\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nAn object field is \u003cem\u003eisolated\u003c/em\u003e if it is declared as \u003ccode\u003efinal\u003c/code\u003e and\nhas a type-descriptor that is a subtype of \u003ccode\u003ereadonly\u003c/code\u003e or\n\u003ccode\u003eisolated object {}\u003c/code\u003e, or if the \u003ccode\u003eobject-constructor-expr\u003c/code\u003e\nis implicitly read-only. An \u003ccode\u003eobject-constructor-expr\u003c/code\u003e is\n\u003cem\u003eimplicitly isolated\u003c/em\u003e if it is implicitly readonly or if every object\nfield is isolated. An \u003ccode\u003eobject-constructor-expr\u003c/code\u003e that is implicitly\nisolated will construct an object with its isolated bit set. In this case, the\nstatic type of the \u003ccode\u003eobject-constructor-expr\u003c/code\u003e will be intersected with\n\u003ccode\u003eisolated object {}\u003c/code\u003e. If the \u003ccode\u003eobject-constructor-expr\u003c/code\u003e is\nexplicitly isolated, then every \u003ccode\u003efield-initializer\u003c/code\u003e must be an\nisolated expression and any field that is not isolated must be declared as\nprivate.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch5 id=\"section_6.8.1.2\"\u003e6.8.1.2 Methods\u003c/h5\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"method-defn\"\u003emethod-defn\u003c/span\u003e :=\n   \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#object-visibility-qual\"\u003e\u003cspan class=\"ntref\"\u003eobject-visibility-qual\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#method-quals\"\u003e\u003cspan class=\"ntref\"\u003emethod-quals\u003c/span\u003e\u003c/a\u003e\n   \u003ccode\u003efunction\u003c/code\u003e \u003ca href=\"#method-name\"\u003e\u003cspan class=\"ntref\"\u003emethod-name\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#function-signature\"\u003e\u003cspan class=\"ntref\"\u003efunction-signature\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#method-defn-body\"\u003e\u003cspan class=\"ntref\"\u003emethod-defn-body\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nA \u003ccode\u003emethod-defn\u003c/code\u003e defines a method of an object. \n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"remote-method-defn\"\u003eremote-method-defn\u003c/span\u003e :=\n   \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#remote-method-quals\"\u003e\u003cspan class=\"ntref\"\u003eremote-method-quals\u003c/span\u003e\u003c/a\u003e\n   \u003ccode\u003efunction\u003c/code\u003e \u003ca href=\"#method-name\"\u003e\u003cspan class=\"ntref\"\u003emethod-name\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#function-signature\"\u003e\u003cspan class=\"ntref\"\u003efunction-signature\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#method-defn-body\"\u003e\u003cspan class=\"ntref\"\u003emethod-defn-body\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003eremote-method-defn\u003c/code\u003e defines a remote method. This is allowed only\nwhen an \u003ccode\u003eobject-network-qual\u003c/code\u003e is present in the\n\u003ccode\u003eobject-constructor-expr\u003c/code\u003e.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"method-defn-body\"\u003emethod-defn-body\u003c/span\u003e := \u003ca href=\"#function-defn-body\"\u003e\u003cspan class=\"ntref\"\u003efunction-defn-body\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nWithin a \u003ccode\u003emethod-defn-body\u003c/code\u003e, the fields and methods of the object are\nnot implicitly in-scope; instead the variable \u003ccode\u003eself\u003c/code\u003e is bound to the\nobject and can be used to access fields and methods of the object. If the\n\u003ccode\u003eobject-constructor-expr\u003c/code\u003e is explicitly isolated, then the\n\u003ccode\u003eself\u003c/code\u003e variable must be accessed only within the scope of a lock\nstatement, except when \u003ccode\u003eself\u003c/code\u003e is part of a\n\u003ccode\u003efield-access-expr\u003c/code\u003e of the form \u003ccode\u003eself.\u003cvar\u003ef\u003c/var\u003e\u003c/code\u003e, where\n\u003ccode\u003e\u003cvar\u003ef\u003c/var\u003e\u003c/code\u003e is the name of an isolated field.\n\u003c/p\u003e\n\u003cp\u003e\nIf \u003ccode\u003eisolated-qual\u003c/code\u003e is present, then the method has its isolated bit\nset and its \u003ccode\u003emethod-defn-body\u003c/code\u003e must satisfy the requirements for an\n\u003ca href=\"#isolated_functions\"\u003eisolated function\u003c/a\u003e.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch5 id=\"resources\"\u003e6.8.1.3 Resources\u003c/h5\u003e\n\n\u003cp\u003e\nIn addition to remote methods, a service object can use \u003cem\u003eresources\u003c/em\u003e to\nsupport network interaction. Resources support a more data-oriented style of\nnetwork interaction, which complements the RPC style supported by remote\nmethods. A service object's resources are arranged in a tree. Each resource\nexposes one or more named methods; by convention the method name\n\u003ccode\u003eget\u003c/code\u003e is used for retrieving the resource. A listener thus identifies\na resource method to be called using the combination of a hierarchical path,\nwhich identifies the resource, and the resource method name. A resource method\ncan also specify that a segment of the path provided by the listener should be\ntreated as a parameter. A resource method can only be invoked by a listener\nobject.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"resource-method-defn\"\u003eresource-method-defn\u003c/span\u003e :=\n   \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#resource-method-quals\"\u003e\u003cspan class=\"ntref\"\u003eresource-method-quals\u003c/span\u003e\u003c/a\u003e\n   \u003ccode\u003efunction\u003c/code\u003e \u003ca href=\"#resource-method-name\"\u003e\u003cspan class=\"ntref\"\u003eresource-method-name\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#resource-path\"\u003e\u003cspan class=\"ntref\"\u003eresource-path\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#function-signature\"\u003e\u003cspan class=\"ntref\"\u003efunction-signature\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#method-defn-body\"\u003e\u003cspan class=\"ntref\"\u003emethod-defn-body\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"resource-method-quals\"\u003eresource-method-quals\u003c/span\u003e :=\n   \u003ca href=\"#resource-qual\"\u003e\u003cspan class=\"ntref\"\u003eresource-qual\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#function-quals\"\u003e\u003cspan class=\"ntref\"\u003efunction-quals\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#isolated-qual\"\u003e\u003cspan class=\"ntref\"\u003eisolated-qual\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#transactional-qual\"\u003e\u003cspan class=\"ntref\"\u003etransactional-qual\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#resource-qual\"\u003e\u003cspan class=\"ntref\"\u003eresource-qual\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#transactional-qual\"\u003e\u003cspan class=\"ntref\"\u003etransactional-qual\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#isolated-qual\"\u003e\u003cspan class=\"ntref\"\u003eisolated-qual\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#resource-qual\"\u003e\u003cspan class=\"ntref\"\u003eresource-qual\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#isolated-qual\"\u003e\u003cspan class=\"ntref\"\u003eisolated-qual\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#resource-qual\"\u003e\u003cspan class=\"ntref\"\u003eresource-qual\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#transactional-qual\"\u003e\u003cspan class=\"ntref\"\u003etransactional-qual\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#transactional-qual\"\u003e\u003cspan class=\"ntref\"\u003etransactional-qual\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#resource-qual\"\u003e\u003cspan class=\"ntref\"\u003eresource-qual\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#isolated-qual\"\u003e\u003cspan class=\"ntref\"\u003eisolated-qual\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"resource-qual\"\u003eresource-qual\u003c/span\u003e := \u003ccode\u003eresource\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"resource-method-name\"\u003eresource-method-name\u003c/span\u003e := \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"resource-path\"\u003eresource-path\u003c/span\u003e :=\n   \u003ca href=\"#dot-resource-path\"\u003e\u003cspan class=\"ntref\"\u003edot-resource-path\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#resource-path-segment\"\u003e\u003cspan class=\"ntref\"\u003eresource-path-segment\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e/\u003c/code\u003e \u003ca href=\"#resource-path-segment\"\u003e\u003cspan class=\"ntref\"\u003eresource-path-segment\u003c/span\u003e\u003c/a\u003e)* [\u003ccode\u003e/\u003c/code\u003e \u003ca href=\"#resource-path-rest-param\"\u003e\u003cspan class=\"ntref\"\u003eresource-path-rest-param\u003c/span\u003e\u003c/a\u003e]\n   | \u003ca href=\"#resource-path-rest-param\"\u003e\u003cspan class=\"ntref\"\u003eresource-path-rest-param\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"dot-resource-path\"\u003edot-resource-path\u003c/span\u003e := \u003ccode\u003e.\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"resource-path-segment\"\u003eresource-path-segment\u003c/span\u003e := \u003ca href=\"#resource-path-segment-name\"\u003e\u003cspan class=\"ntref\"\u003eresource-path-segment-name\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#resource-path-segment-param\"\u003e\u003cspan class=\"ntref\"\u003eresource-path-segment-param\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"resource-path-segment-name\"\u003eresource-path-segment-name\u003c/span\u003e := \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"resource-path-segment-param\"\u003eresource-path-segment-param\u003c/span\u003e := \u003ccode\u003e[\u003c/code\u003e[\u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#param-name\"\u003e\u003cspan class=\"ntref\"\u003eparam-name\u003c/span\u003e\u003c/a\u003e\u003ccode\u003e]\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"resource-path-rest-param\"\u003eresource-path-rest-param\u003c/span\u003e := \u003ccode\u003e[\u003c/code\u003e[\u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e...\u003c/code\u003e \u003ca href=\"#param-name\"\u003e\u003cspan class=\"ntref\"\u003eparam-name\u003c/span\u003e\u003c/a\u003e\u003ccode\u003e]\u003c/code\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nA \u003ccode\u003eresource-method-defn\u003c/code\u003e defines a resource method. This is allowed\nonly when an \u003ccode\u003eobject-network-qual\u003c/code\u003e of \u003ccode\u003eservice\u003c/code\u003e is present\nin the \u003ccode\u003eobject-constructor-expr\u003c/code\u003e. The \u003ccode\u003eresource-path\u003c/code\u003e\nspecifies the node in the service object's resource tree to which the method is\nattached and the \u003ccode\u003eresource-method-name\u003c/code\u003e specifies the method name. It\nis an error to have two \u003ccode\u003eresource-method-defn\u003c/code\u003es that both have the\nsame name and have a path that refers to the same node. A\n\u003ccode\u003edot-resource-path\u003c/code\u003e specifies the root of the service object's\nresource tree. In a service object's resource tree, each edge from a parent node\nto a child node has a label, which uniquely identifies the child relative to its\nsiblings. A label is either a string or one of two special values that indicate\nthat the corresponding path segment should be treated as a parameter. It is an\nerror for a parent node to have more than one edge to a child node labelled with\none of the two special values. A \u003ccode\u003eresource-path-segment-name\u003c/code\u003e\nspecifies a label that is a string. The two special label values come from a\n\u003ccode\u003eresource-path-segment-param\u003c/code\u003e and a\n\u003ccode\u003eresource-path-rest-param\u003c/code\u003e respectively. A parameter in a\n\u003ccode\u003eresource-path-segment-param\u003c/code\u003e will be bound to a value representing a\nsingle path segment; a parameter in a \u003ccode\u003eresource-path-rest-param\u003c/code\u003e will\nbe bound to a list representing zero or more path segments, with each member\nrepresenting a single path segment. The type of a path segment depends on the\nlistener, but the listener must be able to convert it into a string. For\nexample, in HTTP a path segment is natively a sequence of bytes, and an HTTP\nlistener could convert it into a string by decoding with UTF-8. It also depends\non the listener which types other than string it is able to convert a path\nsegment to.\n\u003c/p\u003e\n\u003cp\u003e\nThe return type of a resource method must not allow values belonging to the\nfunction basic type. A resource method with a name of \u003ccode\u003eget\u003c/code\u003e that can\nreturn a service object represents a subservice. It is subject to the following\nrestrictions:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethe return type must not allow anything other that service\nobjects and errors;\u003c/li\u003e\n\u003cli\u003ethe resource path must not end with a \u003ccode\u003eresource-path-rest-param\u003c/code\u003e;\u003c/li\u003e\n\u003cli\u003ethe method's node must not have any child nodes.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe semantics of hierarchical resources are defined by a lookup function, which\ntakes four parameters:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cvar\u003em\u003c/var\u003e is the name of the method;\u003c/li\u003e\n\u003cli\u003e\n\u003cvar\u003ep\u003c/var\u003e is the resource path;\u003c/li\u003e\n\u003cli\u003e\n\u003cvar\u003er\u003c/var\u003e refers to a node in the resource tree of a service object;\u003c/li\u003e\n\u003cli\u003e\n\u003cvar\u003ev\u003c/var\u003e is the list path segments bound so far.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIt returns an error or a tuple [\u003cvar\u003er\u003c/var\u003e, \u003cvar\u003ev\u003c/var\u003e], where\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cvar\u003er\u003c/var\u003e is a node in the resource tree with an m method, which is the\nmethod to be called;\u003c/li\u003e\n\u003cli\u003e\n\u003cvar\u003ev\u003c/var\u003e is a list of path segments to be bound to the methodâs variable\nresource path parameters.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe function lookup(\u003cvar\u003em\u003c/var\u003e, \u003cvar\u003ep\u003c/var\u003e, \u003cvar\u003er\u003c/var\u003e, \u003cvar\u003ev\u003c/var\u003e) is\ndefined as follows:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eIf \u003cvar\u003er\u003c/var\u003e has a \u003ccode\u003eget\u003c/code\u003e method that can return a service\nobject, then call the \u003ccode\u003eget\u003c/code\u003e method of \u003cvar\u003er\u003c/var\u003e using \u003cvar\u003ev\u003c/var\u003e\nto bind the path parameters; if the result is an error, then return that error;\notherwise, the result must be a service object. Let \u003cvar\u003er\u003c/var\u003e' be the root of\nits resource tree. Return lookup(\u003cvar\u003em\u003c/var\u003e, \u003cvar\u003ep\u003c/var\u003e, \u003cvar\u003er\u003c/var\u003e',\n[]).\u003c/li\u003e\n\u003cli\u003eIf \u003cvar\u003ep\u003c/var\u003e is empty: \n\u003col\u003e\n\u003cli\u003eif \u003cvar\u003er\u003c/var\u003e has a method \u003cvar\u003em\u003c/var\u003e, then return\n[\u003cvar\u003er\u003c/var\u003e,\u003cvar\u003ev\u003c/var\u003e];\u003c/li\u003e\n\u003cli\u003eotherwise, if \u003cvar\u003er\u003c/var\u003e has a child labelled as repeated variable path\nsegment and that child has a method \u003cvar\u003em\u003c/var\u003e, then let \u003cvar\u003er\u003c/var\u003e' be\nchild with that label and return [\u003cvar\u003er\u003c/var\u003e',\u003cvar\u003ev\u003c/var\u003e];\u003c/li\u003e\n\u003cli\u003eotherwise, return an error.\u003c/li\u003e \n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eLet the first segment in \u003cvar\u003ep\u003c/var\u003e be \u003cvar\u003es\u003c/var\u003e and let \u003cvar\u003ep\u003c/var\u003e'\nbe a list of the 2nd and subsequent members of \u003cvar\u003ep\u003c/var\u003e.\u003c/li\u003e\n\u003cli\u003eIf \u003cvar\u003er\u003c/var\u003e has a child labelled with the string that results from\nconverting \u003cvar\u003es\u003c/var\u003e to a string, then let \u003cvar\u003er\u003c/var\u003e' be the child with\nthat label. Return lookup(\u003cvar\u003em\u003c/var\u003e, \u003cvar\u003ep\u003c/var\u003e', \u003cvar\u003er\u003c/var\u003e',\n\u003cvar\u003ev\u003c/var\u003e).\u003c/li\u003e\n\u003cli\u003eIf \u003cvar\u003er\u003c/var\u003e has an edge to a child labelled as a single path segment\nparameter, then let \u003cvar\u003er\u003c/var\u003e' be that child and let \u003cvar\u003ev\u003c/var\u003e' be the\nresult of adding \u003cvar\u003es\u003c/var\u003e to the end of \u003cvar\u003ev\u003c/var\u003e. Return\nlookup(\u003cvar\u003em\u003c/var\u003e, \u003cvar\u003ep\u003c/var\u003e', \u003cvar\u003er\u003c/var\u003e', \u003cvar\u003ev\u003c/var\u003e').\u003c/li\u003e\n\u003cli\u003eIf \u003cvar\u003er\u003c/var\u003e has an edge to a child labelled as a rest parameter and that\nchild has a method \u003cvar\u003em\u003c/var\u003e, then let \u003cvar\u003er\u003c/var\u003e' be that child, and let\n\u003cvar\u003ev\u003c/var\u003e' be the result of concatenating \u003cvar\u003ev\u003c/var\u003e and \u003cvar\u003ep\u003c/var\u003e.\nReturn [\u003cvar\u003er\u003c/var\u003e',\u003cvar\u003ev\u003c/var\u003e'].\u003c/li\u003e\n\u003cli\u003eOtherwise, return an error.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\nThe syntax allows only the last of a resource method's path parameters to be a\nrest parameter. When a list of path segments is bound to the path parameters of\na resource method, one path segment is bound to each path parameter that is not\na rest parameter and a list of the remaining path segments is bound to the rest\nparameter, if any.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch5 id=\"section_6.8.1.4\"\u003e6.8.1.4 Initialization\u003c/h5\u003e\n\u003cp\u003e\nA \u003ccode\u003emethod-defn\u003c/code\u003e with a \u003ccode\u003emethod-name\u003c/code\u003e of \u003ccode\u003einit\u003c/code\u003e\nis used to initialize the object and is treated specially. The return type of\nthe \u003ccode\u003einit\u003c/code\u003e method must be a subtype of the union of error and nil,\nand must contain nil; if \u003ccode\u003einit\u003c/code\u003e returns an error, it means that\ninitialization of the object failed.\n\u003c/p\u003e\n\u003cp\u003e\nThe parameter list of an \u003ccode\u003einit\u003c/code\u003e method within an\n\u003ccode\u003eobject-constructor-expr\u003c/code\u003e must be empty.\n\u003c/p\u003e\n\u003cp\u003e\nAt any point in the body of a \u003ccode\u003einit\u003c/code\u003e method, the compiler\ndetermines which fields are potentially uninitialized. A field is potentially\nuninitialized at some point if that field does not have an initializer and it\nis not definitely assigned at that point. It is a compile error if a\n\u003ccode\u003einit\u003c/code\u003e method:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eaccesses a field at a point where it is potentially initialized, or\u003c/li\u003e\n\u003cli\u003eat a point where there is any potentially uninitialized field\n\u003cul\u003e\n\u003cli\u003ereturns nil, or\u003c/li\u003e\n\u003cli\u003euses the \u003ccode\u003eself\u003c/code\u003e variable other than to access or modify the value of a field.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIf the \u003ccode\u003eobject-constructor-expr\u003c/code\u003e is explicitly isolated, then a field\ncan only be assigned to by an \u003ccode\u003eassignment-stmt\u003c/code\u003e with a right hand\nside that is an isolated expression. The requirement to access \u003ccode\u003eself\u003c/code\u003e\nwithin a lock statement does not apply to the \u003ccode\u003einit\u003c/code\u003e method.\n\u003c/p\u003e\n\u003cp\u003e\nThe visibility of the \u003ccode\u003einit\u003c/code\u003e method cannot be \u003ccode\u003eprivate\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nAny \u003ccode\u003einit\u003c/code\u003e method is not part of the shape of an object, and so does\nnot affect when an object value belongs to a type. The \u003ccode\u003einit\u003c/code\u003e method\ncan be called in a \u003ccode\u003emethod-call-expr\u003c/code\u003e only when the expression\npreceding the \u003ccode\u003e.\u003c/code\u003e is \u003ccode\u003eself\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nA missing \u003ccode\u003einit\u003c/code\u003e method is equivalent to an isolated\n\u003ccode\u003einit\u003c/code\u003e method with no parameters and an empty body (which will always\nreturn nil).\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_6.8.2\"\u003e6.8.2 New expression\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"new-expr\"\u003enew-expr\u003c/span\u003e := \u003ca href=\"#explicit-new-expr\"\u003e\u003cspan class=\"ntref\"\u003eexplicit-new-expr\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#implicit-new-expr\"\u003e\u003cspan class=\"ntref\"\u003eimplicit-new-expr\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"explicit-new-expr\"\u003eexplicit-new-expr\u003c/span\u003e := \u003ccode\u003enew\u003c/code\u003e \u003ca href=\"#class-descriptor\"\u003e\u003cspan class=\"ntref\"\u003eclass-descriptor\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e(\u003c/code\u003e \u003ca href=\"#arg-list\"\u003e\u003cspan class=\"ntref\"\u003earg-list\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e)\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"class-descriptor\"\u003eclass-descriptor\u003c/span\u003e := \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#qualified-identifier\"\u003e\u003cspan class=\"ntref\"\u003equalified-identifier\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#stream-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003estream-type-descriptor\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA new-expr constructs a new object or stream. The class-descriptor in an\nexplicit-new-expr must refer to a class or a stream type.\n\u003c/p\u003e\n\u003cp\u003e\nWhen the class-descriptor refers to a class, the explicit-new-expr allocates\nstorage for an object of the type defined by the class and initializes it by\npassing the supplied arg-list to the \u003ccode\u003einit\u003c/code\u003e method defined by the\nclass. It is a compile error if the type-descriptor if the arg-list does not\nmatch the signature of the class's \u003ccode\u003einit\u003c/code\u003e method. If the result of\ncalling the \u003ccode\u003einit\u003c/code\u003e method is an error value e, then the result of\nevaluating the explicit-new-expr is e; otherwise the result is the newly\ninitialized object. The explicit-new-expr is isolated if the type of the\n\u003ccode\u003einit\u003c/code\u003e is isolated and the expression for every argument in the\narg-list is isolated.\n\u003c/p\u003e\n\u003cp\u003e\nWhen the class-reference refers to a stream type \u003ccode\u003estream\u0026lt;T,E\u0026gt;\u003c/code\u003e,\nthe arg-list must either be empty or be a single argument belonging to object\ntype StreamImplementor\u0026lt;T,E?\u0026gt;. When the arg-list is empty, the result will\nbe an empty stream (i.e. a stream whose next method returns nil). When the\narg-list evaluates to a StreamImplementor object, the result will be a stream\nthat wraps that object. The explicit-new-expr is isolated if the the arg-list is\nempty or if the expression for the single argument is isolated.\n\u003c/p\u003e\n\u003cp\u003e\nAn explicit-type-expr specifying a class-descriptor T has static type T, except\nthat if T is an class type and the type of the \u003ccode\u003einit\u003c/code\u003e method is\nE?, where E is a subtype of error, then it has static type T|E.\n\u003c/p\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"implicit-new-expr\"\u003eimplicit-new-expr\u003c/span\u003e := \u003ccode\u003enew\u003c/code\u003e [\u003ccode\u003e(\u003c/code\u003e \u003ca href=\"#arg-list\"\u003e\u003cspan class=\"ntref\"\u003earg-list\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e)\u003c/code\u003e]\n\u003c/pre\u003e\n\u003cp\u003e\nAn implicit-new-expr is equivalent to an explicit-new-expr that specifies the\napplicable contextually expected type as the class-descriptor. An\nimplicit-new-expr consisting of just \u003ccode\u003enew\u003c/code\u003e is equivalent to\n\u003ccode\u003enew()\u003c/code\u003e. It is an error if the applicable contextually expected type\nis not a class or stream type.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.9\"\u003e6.9 Variable reference expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"variable-reference-expr\"\u003evariable-reference-expr\u003c/span\u003e := \u003ca href=\"#variable-reference\"\u003e\u003cspan class=\"ntref\"\u003evariable-reference\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"variable-reference\"\u003evariable-reference\u003c/span\u003e := \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#qualified-identifier\"\u003e\u003cspan class=\"ntref\"\u003equalified-identifier\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#xml-qualified-name\"\u003e\u003cspan class=\"ntref\"\u003exml-qualified-name\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"xml-qualified-name\"\u003exml-qualified-name\u003c/span\u003e := \u003ca href=\"#xml-namespace-prefix\"\u003e\u003cspan class=\"ntref\"\u003exml-namespace-prefix\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e:\u003c/code\u003e \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA variable-reference can refer to a variable, a parameter, a constant (defined\nwith a module constant declaration), a function, a type (defined with a module\ntype definition) or a class (defined with a module class definition).\n\u003c/p\u003e\n\u003cp\u003e\nWhen the variable reference has a prefix and the prefix has been declared using\nan xmlns-decl rather than an import-decl, then the result of evaluating the\nvariable-reference-expr is a string of the form:\n\u003c/p\u003e\n\u003cpre\u003e\n   {\u003cvar\u003enamespace-uri\u003c/var\u003e}\u003cvar\u003elocal-name\u003c/var\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nwhere the namespace-uri comes from xml-namespace-uri specified in the\nxmlns-decl, and the local-name comes from the identifier following the colon.\n\u003c/p\u003e\n\u003cp\u003e\nIf the variable-reference references a type defined with a module type\ndefinition or a class defined with a module class definition, then the result of\nevaluating the variable-reference-expr is a typedesc value for that type or\nclass.\n\u003c/p\u003e\n\u003cp\u003e\nA variable-reference-expr is isolated if it refers to an identifier bound by a\nlet-expr to an expression that is isolated.\n\u003c/p\u003e\n\u003cp\u003e\nA variable-reference-expr that refers to a variable declared by a\nmodule-var-decl that includes \u003ccode\u003eisolated\u003c/code\u003e is only allowed within a\nlock-stmt.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.10\"\u003e6.10 Field access expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"field-access-expr\"\u003efield-access-expr\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e.\u003c/code\u003e \u003ca href=\"#field-name\"\u003e\u003cspan class=\"ntref\"\u003efield-name\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA field-access-expr is typically used to access a field of an object or a field\nof a record. More generally, it can be used to access a member of an object or a\nmember of a mapping. The semantics depends on the static type T of expression. A\nfield-access-expr where T is a subtype of xml is interpreted as an\nxml-required-attribute-access-expr.\n\u003c/p\u003e\n\u003cp\u003e\nIf T is a subtype of the object basic type, then T must have a member with name\nfield-name. The field-access-expr is evaluated by first evaluating the\nexpression to get a value \u003cvar\u003eobj\u003c/var\u003e. If the member is a field, then the\nresult of the expression if the value of that field of \u003cvar\u003eobj\u003c/var\u003e and the\nstatic type of the field-access-expr is the type of that field of T. If that\nmember is a method, then the result of the expression is a new function value\nthat when called will call the method with \u003ccode\u003eself\u003c/code\u003e bound to\n\u003cvar\u003eobj\u003c/var\u003e; the isolated bit of the new function value is set if and only if\nthe isolated bits of both \u003cvar\u003eobj\u003c/var\u003e and the method are set; the type\ndescriptor of the new function value will have the same annotations as the type\ndescriptor of the method. The rest of this subsection applies when T is not a\nsubtype of the object basic type.\n\u003c/p\u003e\n\u003cp\u003e\nLet T' be the intersection of T and basic type mapping, let K be the singleton type\ncontaining just the string field-name, and let M be the member type for K in T'.\nThe compile-time requirements on the field-access-expr depend on whether the\ntype descriptor describing T is lax:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eif it is lax, then the only compile-time requirement is M is non-empty;\u003c/li\u003e\n\u003cli\u003eif it is not lax, then T must be a subtype of the mapping basic type and K\nmust be a required key type for T.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe static type of field-access-expr is M|E, where E is empty if K is a required\nkey type and T' is a subtype of T, and error otherwise (E can only be error in\nthe lax case.) In the lax case, if M is lax, then the static type of the\nfield-access-expr is lax even if E is an error.\n\u003c/p\u003e\n\u003cp\u003e\nA field-access-expr is evaluated as follows:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eexpression is evaluated resulting in a value \u003cvar\u003ev\u003c/var\u003e\n\u003c/li\u003e\n\u003cli\u003eif \u003cvar\u003ev\u003c/var\u003e has basic type error, the result is \u003cvar\u003ev\u003c/var\u003e (this can\nonly happen in the lax case)\u003c/li\u003e\n\u003cli\u003eotherwise, if \u003cvar\u003ev\u003c/var\u003e does not have basic type mapping, the result is a\nnew error value (this can only happen in the lax case)\u003c/li\u003e\n\u003cli\u003eotherwise, if \u003cvar\u003ev\u003c/var\u003e does not have a member whose key is field-name,\nthe result is a new error value (this can only happen in the lax case)\u003c/li\u003e\n\u003cli\u003eotherwise, the result is the member of \u003cvar\u003ev\u003c/var\u003e whose key is\nfield-name.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.11\"\u003e6.11 Optional field access expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"optional-field-access-expr\"\u003eoptional-field-access-expr\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e?.\u003c/code\u003e \u003ca href=\"#field-name\"\u003e\u003cspan class=\"ntref\"\u003efield-name\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nAn optional-field-access-expr accesses a possibly undefined mapping member,\nreturning \u003ccode\u003e()\u003c/code\u003e if the member does not exist.\n\u003c/p\u003e\n\u003cp\u003e\nAn optional-field-access-expr where the static type of \u003ccode\u003eexpression\u003c/code\u003e is\na subtype of xml is interpreted as an xml-optional-attribute-access-expr.\n\u003c/p\u003e\n\u003cp\u003e\nLet T be the static type of expression, let T' be the intersection of T and\nbasic type mapping, let K be the singleton type containing just the string\nfield-name and let M be the member type of K in T'. The compile-time\nrequirements on the optional-field-access-expr depend on whether the type\ndescriptor describing T is lax:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eif it is lax, then the only compile-time requirement is that M is\nnon-empty;\u003c/li\u003e\n\u003cli\u003eif it is not lax, then, in addition, T must be a subtype of the union of\n\u003ccode\u003e()\u003c/code\u003e and the mapping basic type, and the type descriptor for T must\ninclude \u003ccode\u003efield-name\u003c/code\u003e as an individual-field-descriptor (if the type\ndescriptor is a union, then this requirement must be satisfied by at least one\nmember of the union).\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe static type of the optional-field-access-expr is M|N|E where\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eN is \u003ccode\u003e()\u003c/code\u003e if \u003ccode\u003e()\u003c/code\u003e is a subtype of T or K is not a\nrequired key type for T', and empty otherwise;\u003c/li\u003e\n\u003cli\u003eE is \u003ccode\u003eerror\u003c/code\u003e if T' is not a subtype of T?, and empty otherwise (E\ncan only be error in the lax case).\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\nAn optional-field-access-expr is evaluated as follows:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eexpression is evaluated resulting in a value \u003cvar\u003ev\u003c/var\u003e\n\u003c/li\u003e\n\u003cli\u003eif \u003cvar\u003ev\u003c/var\u003e is \u003ccode\u003e()\u003c/code\u003e, the result is \u003ccode\u003e()\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eotherwise, if \u003cvar\u003ev\u003c/var\u003e has basic type error, the result is \u003cvar\u003ev\u003c/var\u003e\n(this can only happen in the lax case)\u003c/li\u003e\n\u003cli\u003eotherwise, if \u003cvar\u003ev\u003c/var\u003e does not have basic type mapping, the result is a\nnew error value (this can only happen in the lax case)\u003c/li\u003e\n\u003cli\u003eotherwise, if \u003cvar\u003ev\u003c/var\u003e does not have a member whose key is field-name,\nthe result is \u003ccode\u003e()\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eotherwise, the result is the member of \u003cvar\u003ev\u003c/var\u003e whose key is\nfield-name.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_6.12\"\u003e6.12 XML attribute access expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"xml-attribute-access-expr\"\u003exml-attribute-access-expr\u003c/span\u003e := \u003ca href=\"#xml-required-attribute-access-expr\"\u003e\u003cspan class=\"ntref\"\u003exml-required-attribute-access-expr\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#xml-optional-attribute-access-expr\"\u003e\u003cspan class=\"ntref\"\u003exml-optional-attribute-access-expr\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"xml-required-attribute-access-expr\"\u003exml-required-attribute-access-expr\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e.\u003c/code\u003e \u003ca href=\"#xml-attribute-name\"\u003e\u003cspan class=\"ntref\"\u003exml-attribute-name\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"xml-optional-attribute-access-expr\"\u003exml-optional-attribute-access-expr\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e?.\u003c/code\u003e \u003ca href=\"#xml-attribute-name\"\u003e\u003cspan class=\"ntref\"\u003exml-attribute-name\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"xml-attribute-name\"\u003exml-attribute-name\u003c/span\u003e := \u003ca href=\"#xml-qualified-name\"\u003e\u003cspan class=\"ntref\"\u003exml-qualified-name\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#qualified-identifier\"\u003e\u003cspan class=\"ntref\"\u003equalified-identifier\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nAn XML attribute access expression provides convenient access to an attribute of\nan XML element. It is a compile-time requirement that the static type of the\nexpression is a subtype of xml.\n\u003c/p\u003e\n\u003cp\u003e\nA string representing the name of the attribute is computed at compile-time from\nthe xml-attribute-name. When the xml-attribute-name is an identifier without a\nprefix, the attribute name string is the identifier. When the xml-attribute-name\nhas a prefix, normally the xml-attribute-name is an xml-qualified-name, in which\nthe prefix is an xml-namespace-prefix declared using an xmlns-decl. In this\ncase, the xml-qualified-name is expanded at compile-time into an attribute name\nstring of the form\n\u003c/p\u003e\n\u003cpre\u003e\n   {\u003cvar\u003enamespace-uri\u003c/var\u003e}\u003cvar\u003elocal-name\u003c/var\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nwhere the namespace-uri comes from xml-namespace-uri specified in the\nxmlns-decl, and the local-name comes from the identifier following the colon.\n\u003c/p\u003e\n\u003cp\u003e\nIt is also allowed for the xml-attribute-name to be specified as a\nqualified-identifier, in which the prefix is a module-prefix declared using an\nimport-decl. In this case the qualified-identifier must refer to a\nmodule-const-decl of type string, and the attribute name string is the value of\nthe referenced constant. This allows e.g. \u003ccode\u003exml:lang\u003c/code\u003e to work.\n\u003c/p\u003e\n\u003cp\u003e\nAn xml-optional-attribute-access-expr is evaluated as follows. The expression is\nevaluated resulting in an xml value \u003cvar\u003ev\u003c/var\u003e. If \u003cvar\u003ev\u003c/var\u003e is an empty\nxml value, the result is \u003ccode\u003e()\u003c/code\u003e. Otherwise, if \u003cvar\u003ev\u003c/var\u003e is not a\nsingleton element, the result is an error. Otherwise, let \u003cvar\u003em\u003c/var\u003e be that\nelement's attribute map and let \u003cvar\u003ek\u003c/var\u003e be the attribute name string\ncomputed at compile-time from the xml-attribute-name. If \u003cvar\u003em\u003c/var\u003e has a\nmember \u003cvar\u003es\u003c/var\u003e with key \u003cvar\u003ek\u003c/var\u003e, the the result is \u003cvar\u003es\u003c/var\u003e.\nOtherwise, the result is \u003ccode\u003e()\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nAn xml-required-attribute-access-expr is evaluated the same as an\nxml-optional-attribute-expr, except that for cases where the result of the\nxml-optional-attribute-expr would be \u003ccode\u003e()\u003c/code\u003e, the result of the\nxml-required-attribute-access-expr is an error.\n\u003c/p\u003e\n\u003cp\u003e\nThe static type of an xml-required-attribute-access-expr is\n\u003ccode\u003estring|error\u003c/code\u003e The static type of an\nxml-optional-attribute-access-expr is \u003ccode\u003estring|error|()\u003c/code\u003e.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.13\"\u003e6.13 Annotation access expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"annot-access-expr\"\u003eannot-access-expr\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e.@\u003c/code\u003e \u003ca href=\"#annot-tag-reference\"\u003e\u003cspan class=\"ntref\"\u003eannot-tag-reference\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe annot-tag-reference must refer to an annotation tag declared with an\nannotation declaration. The static type of expression must be a subtype of\n\u003ccode\u003etypedesc\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nAn \u003ccode\u003eannot-access-expr\u003c/code\u003e is evaluated by first evaluating\n\u003ccode\u003eexpression\u003c/code\u003e resulting in a typedesc value \u003cem\u003et\u003c/em\u003e. If \u003cem\u003et\u003c/em\u003e\nhas an annotation with the tag referenced by \u003ccode\u003eannot-tag-reference\u003c/code\u003e,\nthen the result of the \u003ccode\u003eannot-access-expr\u003c/code\u003e is the value of that\nannotation; otherwise, the result is nil.\n\u003c/p\u003e\n\u003cp\u003e\nThe static type of the \u003ccode\u003eannot-access-expr\u003c/code\u003e is T? where T is the type\nof the annotation tag.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.14\"\u003e6.14 Member access expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"member-access-expr\"\u003emember-access-expr\u003c/span\u003e := \u003ca href=\"#container-expression\"\u003e\u003cspan class=\"ntref\"\u003econtainer-expression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e[\u003c/code\u003e (\u003ca href=\"#key-expression\"\u003e\u003cspan class=\"ntref\"\u003ekey-expression\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#multi-key-expression\"\u003e\u003cspan class=\"ntref\"\u003emulti-key-expression\u003c/span\u003e\u003c/a\u003e) \u003ccode\u003e]\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"container-expression\"\u003econtainer-expression\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"key-expression\"\u003ekey-expression\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"multi-key-expression\"\u003emulti-key-expression\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e)+\n\u003c/pre\u003e\n\u003cp\u003e\nA member-access-expr accesses a member of a structured value using its key,\nor a constituent of a sequence value using its index.\n\u003c/p\u003e\n\u003cp\u003e\nThe requirements on the static type of container-expression and key-expression are as\nfollows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eif the static type of container-expression is a subtype of string or of xml\nor of basic type list, then the contextually expected type for key-expression is\nint and the static type of key-expression must be a subtype of int;\u003c/li\u003e\n\u003cli\u003eif the static type of container-expression is a subtype of table, then the\ncontextually expected type for key-expression is \u003ccode\u003e\u003cvar\u003eK\u003c/var\u003e\u003c/code\u003e and\nthe static type of key-expression must be a subtype of\n\u003ccode\u003e\u003cvar\u003eK\u003c/var\u003e\u003c/code\u003e, where the static type of container-expression is\n\u003ccode\u003etable\u0026lt;\u003cvar\u003eR\u003c/var\u003e\u0026gt; key\u0026lt;\u003cvar\u003eK\u003c/var\u003e\u0026gt;\u003c/code\u003e;\u003c/li\u003e\n\u003cli\u003eotherwise the static type of container-expression must be a subtype of the\nunion of nil and basic type map; in this case the contextually expected type for\nkey-expression is string and the static type of key-expression must be a subtype\nof string.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nA multi-key-expression is allowed only when the static type of a\ncontainer-expression is a subtype of table. A multi-key-expression\n\u003ccode\u003eE\u003csub\u003e1\u003c/sub\u003e, E\u003csub\u003e2\u003c/sub\u003e,..., E\u003csub\u003en\u003c/sub\u003e\u003c/code\u003e is equivalent to a\nlist-constructor-expr \u003ccode\u003e[E\u003csub\u003e1\u003c/sub\u003e, E\u003csub\u003e2\u003c/sub\u003e,...,\nE\u003csub\u003en\u003c/sub\u003e]\u003c/code\u003e.\n\u003c/p\u003e\n\n\u003cp\u003e\nA member-access-expr is evaluated as follows:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003ethe container-expression is evaluated to get a value \u003cvar\u003ec\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003ethe key-expression is evaluated to get a value \u003cvar\u003ek\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003edepending on the basic type of \u003cvar\u003ec\u003c/var\u003e\n\u003cul\u003e\n\u003cli\u003eif it is string, and \u003cvar\u003ek\u003c/var\u003e is \u0026lt; 0 or â¥ the length of\n\u003cvar\u003ec\u003c/var\u003e, then the evaluation completes abruptly with a panic; otherwise,\nthe result is a string of length 1 containing the character with index\n\u003cvar\u003ek\u003c/var\u003e in \u003cvar\u003ec\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eif it is xml, and \u003cvar\u003ek\u003c/var\u003e is \u0026lt; 0, then the evaluation completes\nabruptly with a panic; if \u003cvar\u003ek\u003c/var\u003e is â¥ the length of \u003cvar\u003ec\u003c/var\u003e, then\nthe result is an empty xml value; otherwise, the result is a singleton xml\nvalue containing the item with index \u003cvar\u003ek\u003c/var\u003e in \u003cvar\u003ec\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eif it is list, and \u003cvar\u003ek\u003c/var\u003e is \u0026lt; 0 or â¥ the length of\n\u003cvar\u003ec\u003c/var\u003e, then the evaluation completes abruptly with a panic; otherwise,\nthe result is the member of \u003cvar\u003ec\u003c/var\u003e with index \u003cvar\u003ek\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eif it is table, then if \u003cvar\u003ec\u003c/var\u003e does not contain a member with key\n\u003cvar\u003ek\u003c/var\u003e, the result is \u003ccode\u003e()\u003c/code\u003e; otherwise, the result is the member\nof \u003cvar\u003ec\u003c/var\u003e with key \u003cvar\u003ek\u003c/var\u003e.\u003c/li\u003e\n\u003cli\u003eif it is mapping, then if \u003cvar\u003ec\u003c/var\u003e is \u003ccode\u003e()\u003c/code\u003e or \u003cvar\u003ec\u003c/var\u003e\ndoes not contain a member with key \u003cvar\u003ek\u003c/var\u003e, the result is \u003ccode\u003e()\u003c/code\u003e;\notherwise, the result is the member of \u003cvar\u003ec\u003c/var\u003e with key \u003cvar\u003ek\u003c/var\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\nLet T the static type of container-expression. If T is a subtype of string, then\nthe static type of the member-access-expr is \u003ca href=\"#built-in_subtypes\"\u003e\u003ccode\u003estring:Char\u003c/code\u003e\u003c/a\u003e, that is the subtype of\nstrings containing strings of length 1. If T is a subtype of xml\u0026lt;M\u0026gt;, then\nthe static type of the member-access-expr is M|E, where E is the type of the\nempty xml value. If T is a subtype of table\u0026lt;R\u0026gt;, then the static type of\nmember-access-expr is R?. Otherwise, let K be the static type of key-expression\nand let M be the member type of K in T; if T contains nil, or T is a subtype of\nmapping and K is an optional key type for T, then the static type of the\nmember-access-expr is M?, otherwise the static type is M.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"function_call\"\u003e6.15 Function call expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"function-call-expr\"\u003efunction-call-expr\u003c/span\u003e := \u003ca href=\"#function-reference\"\u003e\u003cspan class=\"ntref\"\u003efunction-reference\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e(\u003c/code\u003e \u003ca href=\"#arg-list\"\u003e\u003cspan class=\"ntref\"\u003earg-list\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e)\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"function-reference\"\u003efunction-reference\u003c/span\u003e := \u003ca href=\"#variable-reference\"\u003e\u003cspan class=\"ntref\"\u003evariable-reference\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"arg-list\"\u003earg-list\u003c/span\u003e :=\n   \u003ca href=\"#positional-args\"\u003e\u003cspan class=\"ntref\"\u003epositional-args\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#other-args\"\u003e\u003cspan class=\"ntref\"\u003eother-args\u003c/span\u003e\u003c/a\u003e]\n   | [\u003ca href=\"#other-args\"\u003e\u003cspan class=\"ntref\"\u003eother-args\u003c/span\u003e\u003c/a\u003e]\n\u003cspan class=\"ntdfn\" id=\"other-args\"\u003eother-args\u003c/span\u003e := \u003ca href=\"#named-args\"\u003e\u003cspan class=\"ntref\"\u003enamed-args\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#rest-arg\"\u003e\u003cspan class=\"ntref\"\u003erest-arg\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA function-call-expr is evaluated by constructing an argument list and passing\nthe argument list to the function referred to by the variable-name. The argument\nlist will be used to bind the parameters of the function before the body of the\nfunction is executed. If the function terminates normally, then the result of\nthe function-call-expr is the return value of the function; otherwise the\nfunction-call-expr completes abruptly with a panic. The static type of the\nfunction-call-expr is the return type of the function type; this type is\npermitted to be \u003ccode\u003enever\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThe function-reference must refer to a variable with function type. The type\ndescriptor of that function type is used to construct an argument list from the\nspecified arg-list. Note that it is the type descriptor of the declared type of\nthe variable that is used for this purpose, rather than the runtime type\ndescriptor of the referenced function value. The expressions occurring in the\narg-list are evaluated in the order in which they occur in the arg-list; the\ncontextually expected type for the expression comes from the static type\nrequired for the expression as specified below.\n\u003c/p\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"positional-args\"\u003epositional-args\u003c/span\u003e := \u003ca href=\"#positional-arg\"\u003e\u003cspan class=\"ntref\"\u003epositional-arg\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#positional-arg\"\u003e\u003cspan class=\"ntref\"\u003epositional-arg\u003c/span\u003e\u003c/a\u003e)*\n\u003cspan class=\"ntdfn\" id=\"positional-arg\"\u003epositional-arg\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe result of evaluating the \u003cvar\u003ei\u003c/var\u003e-th positional-arg becomes the\n\u003cvar\u003ei\u003c/var\u003e-th member of the argument list. The static type of the expression\nfor the \u003cvar\u003ei\u003c/var\u003e-th positional-arg must be a subtype of the type declared\nfor the \u003cvar\u003ei\u003c/var\u003e-th parameter that is not a rest-param, if there is such a\nparameter; otherwise, there must be a rest-param and the static type must be a\nsubtype of the type declared for the rest-param.\n\u003c/p\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"named-args\"\u003enamed-args\u003c/span\u003e := \u003ca href=\"#named-arg\"\u003e\u003cspan class=\"ntref\"\u003enamed-arg\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#named-arg\"\u003e\u003cspan class=\"ntref\"\u003enamed-arg\u003c/span\u003e\u003c/a\u003e)*\n\u003cspan class=\"ntdfn\" id=\"named-arg\"\u003enamed-arg\u003c/span\u003e := \u003ca href=\"#arg-name\"\u003e\u003cspan class=\"ntref\"\u003earg-name\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e=\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"arg-name\"\u003earg-name\u003c/span\u003e := \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe arg-name of every named-arg must be distinct. Each named-arg must correspond\nto either a parameter that is not a rest-param or to a field of an\nincluded-record-param. In the latter case, there are two possibilities.\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe field is described by an individual-field-descriptor with a type that is not\n\u003ccode\u003enever\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eThe field is described by a record-rest-descriptor, either explicitly as\npart of an exclusive-record-type-descriptor or implicitly as part of an\ninclusive-record-type-descriptor. In this case:\n\u003cul\u003e\n\u003cli\u003efor every parameter name and every individual-field-descriptor of an\nincluded-record-param with a type that is not \u003ccode\u003enever\u003c/code\u003e, the\nrecord-type-descriptor must include an individual-field-descriptor that has type\n\u003ccode\u003enever\u003c/code\u003e and is optional, and so disallows a field with that\nname;\u003c/li\u003e\n\u003cli\u003ethe record-type-descriptor must not include any other\nindividual-field-descriptor; and\u003c/li\u003e\n\u003cli\u003ethere must be no other included-record-param with a\nrecord-rest-descriptor.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIt is an error if there is a named-arg and a positional-arg that correspond to\nthe same parameter. If there is a named-arg or positional-arg corresponding to\nan included-record-param, it is an error for a named-arg to specify a field of\nthat included-record-param. The static type of the expression of the named-arg\nmust be a subtype of the type declared for the corresponding parameter or\nfield-descriptor.\n\u003c/p\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"rest-arg\"\u003erest-arg\u003c/span\u003e := \u003ccode\u003e...\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe static type of the expression in a rest-arg must be either a list type or a\nmapping type. If it is a list type, then the rest-arg is equivalent to\nspecifying each member of the list as a positional-arg. If it is a mapping type,\nthen the rest-arg is equivalent to specifying each field of the mapping as a\nnamed-arg, with the name and value of the named-arg coming from the name and\nvalue of the field. In either case, the static type of the expression must be\nsuch as to ensure that the equivalent named-args or positional-args would be\nvalid.\n\u003c/p\u003e\n\u003cp\u003e\nIf there is neither a named-arg nor a positional-arg for a parameter that is not\na rest-param, then a default value is computed for the parameter, if possible;\notherwise, it is an error. Default values are computed in parameter declaration\norder.\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIf the parameter is a required-param, it is an error.\u003c/li\u003e\n\u003cli\u003eIf the parameter is a defaultable-param, then the value for the parameter is\ncomputed from the default value in the function's type descriptor.\n\u003cul\u003e\n\u003cli\u003eIf the default value for a defaultable-param was specifed\nusing an expression, then it is computed by calling the closure stored in the\ntype descriptor, passing it the previous arguments in the argument list.\u003c/li\u003e\n\u003cli\u003eIf the default value for a defaultable-param was specified as\n\u003ccode\u003e\u0026lt;\u0026gt;\u003c/code\u003e, then the value for the parameter will be a typedesc value\ndetermined at compile-time from the contextually expected type of the\nfunction-call-expr as follows. Let the name of the parameter for which a default\nof \u003ccode\u003e\u0026lt;\u0026gt;\u003c/code\u003e was specified be \u003cvar\u003et\u003c/var\u003e. Let the type of\n\u003cvar\u003et\u003c/var\u003e be typedesc\u0026lt;\u003cvar\u003eT\u003c/var\u003e\u0026gt;. Let the return type descriptor for\nthe function be \u003cvar\u003eR\u003c/var\u003e, which will have references to \u003cvar\u003et\u003c/var\u003e. Let\nthe contextually expected type for the function-call-expr be \u003cvar\u003eC\u003c/var\u003e. Then\nthe default value is found by unifying \u003cvar\u003eC\u003c/var\u003e and \u003cvar\u003eR\u003c/var\u003e: the\ndefault value is a typedesc value that describes the maximal type \u003cvar\u003eS\u003c/var\u003e,\nsuch that \u003cvar\u003eS\u003c/var\u003e is a subtype of \u003cvar\u003eT\u003c/var\u003e, and \u003cvar\u003eR\u003c/var\u003e with\n\u003cvar\u003eS\u003c/var\u003e substituted for \u003cvar\u003et\u003c/var\u003e is a subtype of \u003cvar\u003eC\u003c/var\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eIf the parameter is an included-record-param, then a new mapping value is\nconstructed for it using its record-type-descriptor. The mapping value will have\na field for each named-arg that corresponds to a field of this\nincluded-record-param, with the name and value of the field coming from the name\nand value of the named-arg. The mapping value will also have a field for each\nindividual-field-descriptor with a default-expr for which there was no\ncorresponding named-arg. It is an error if the record-type-descriptor has an\nindividual-field-descriptor that is not optional and has no default and there is\nnot corresponding named-arg.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nA function-call-expr is isolated if the type of the function being called is\nisolated and the expression for every argument is isolated. In addition, a call\nto the \u003ccode\u003eclone\u003c/code\u003e or \u003ccode\u003ecloneReadOnly\u003c/code\u003e functions defined by the\nlang.value module of the lang library is always isolated.\n\u003c/p\u003e\n\u003cp\u003e\nWhen there is a need to call a function value resulting from the evaluation of\nan expression, the result of the expression evaluation can be assigned to a\nvariable and then the function called by using a reference to the variable.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.16\"\u003e6.16 Method call expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"method-call-expr\"\u003emethod-call-expr\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e.\u003c/code\u003e \u003ca href=\"#method-name\"\u003e\u003cspan class=\"ntref\"\u003emethod-name\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e(\u003c/code\u003e \u003ca href=\"#arg-list\"\u003e\u003cspan class=\"ntref\"\u003earg-list\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e)\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003emethod-call-expr\u003c/code\u003e either calls an object's method, calls an\nobject's field where the type of the field is a function or calls a function in\nthe lang library. The static type of the method-call-expr is the return type of\nthe function type of the function that is called; this type is permitted to be\n\u003ccode\u003enever\u003c/code\u003e. The evaluation of the method-call-expr starts by evaluating\n\u003ccode\u003eexpression\u003c/code\u003e resulting in some value \u003cvar\u003ev\u003c/var\u003e. There is no\ncontextually expected type for \u003ccode\u003eexpression\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nIf the static type of \u003ccode\u003eexpression\u003c/code\u003e is a subtype of object, and the\nobject type includes a method named \u003ccode\u003emethod-name\u003c/code\u003e, then the\n\u003ccode\u003emethod-call-expr\u003c/code\u003e is executed by calling that method on\n\u003cvar\u003ev\u003c/var\u003e. The \u003ccode\u003earg-list\u003c/code\u003e is used to construct an argument list\nthat is passed to the method in the same way as with a\n\u003ccode\u003efunction-call-expr\u003c/code\u003e. A \u003ccode\u003emethod-call-expr\u003c/code\u003e cannot be used\nto call a remote method. A remote method of a client object can be called by a\n\u003ccode\u003eclient-remote-method-call-action\u003c/code\u003e. In this case, a method-call-expr\nis isolated if the expression preceding \u003ccode\u003e.\u003c/code\u003e is isolated, the\nexpression for each argument in the arg-list is isolated and the type of the\nmethod being called is isolated.\n\u003c/p\u003e\n\u003cp\u003e\nOtherwise, if the static type of \u003ccode\u003eexpression\u003c/code\u003e is a subtype of object,\nand the object type includes a field named \u003ccode\u003emethod-name\u003c/code\u003e with a\nfunction type, then the \u003ccode\u003emethod-call-expr\u003c/code\u003e is executed by calling the\nvalue of that field. The \u003ccode\u003earg-list\u003c/code\u003e is used to construct an argument\nlist that is passed to the method in the same way as with a\n\u003ccode\u003efunction-call-expr\u003c/code\u003e. In this case, a method-call-expr is isolated if\nthe type of the function is isolated and the expression for each argument in the\narg-list is isolated.\n\u003c/p\u003e\n\u003cp\u003e\nOtherwise, the \u003ccode\u003emethod-call-expr\u003c/code\u003e will be turned into a call to a\nfunction in the lang library \u003ccode\u003em:method-name(expression, arg-list)\u003c/code\u003e,\nwhere m is an automatically created module prefix for a module lang.M of the lang\nlibrary, where M is selected as follows.\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIf the static type of \u003ccode\u003eexpression\u003c/code\u003e is a subtype of some basic\ntype with identifier B, and the module lang.B contains a function\n\u003ccode\u003emethod-name\u003c/code\u003e then M is B. The identifier for a basic type is the\nreserved identifier used in type descriptors for subtypes of that basic type, as\nlisted in the \u003ca href=\"#lang_library\"\u003eLang library\u003c/a\u003e section.\u003c/li\u003e\n\u003cli\u003eOtherwise, M is \u003ccode\u003evalue\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIt is a compile-time error if the resulting function call does not satisfy all\nthe constraints that would apply if it has been written explicitly as a\n\u003ccode\u003efunction-call-expr\u003c/code\u003e. The \u003ccode\u003emethod-call-expr\u003c/code\u003e expression is\nisolated under the same conditions that the corresponding\n\u003ccode\u003efunction-call-expr\u003c/code\u003e would be isolated.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.17\"\u003e6.17 Error constructor\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"error-constructor-expr\"\u003eerror-constructor-expr\u003c/span\u003e := \u003ccode\u003eerror\u003c/code\u003e [\u003ca href=\"#error-type-reference\"\u003e\u003cspan class=\"ntref\"\u003eerror-type-reference\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003e(\u003c/code\u003e \u003ca href=\"#error-arg-list\"\u003e\u003cspan class=\"ntref\"\u003eerror-arg-list\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e)\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"error-arg-list\"\u003eerror-arg-list\u003c/span\u003e := \u003ca href=\"#positional-arg\"\u003e\u003cspan class=\"ntref\"\u003epositional-arg\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#positional-arg\"\u003e\u003cspan class=\"ntref\"\u003epositional-arg\u003c/span\u003e\u003c/a\u003e] (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#named-arg\"\u003e\u003cspan class=\"ntref\"\u003enamed-arg\u003c/span\u003e\u003c/a\u003e)*\n\u003c/pre\u003e\n\u003cp\u003e\nAn error constructor constructs a new error value. If an error-type-reference is\nspecified, it must denote a type that is a subtype of error; the effect is the\nsame as making the contextually expected type be that specified by the\nerror-type-reference. If there is no applicable contextually expected type, then\nit is the same as if there were a contextually expected type of\n\u003ccode\u003eerror\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThe applicable contextually expected type E must be definite. The type-ids of\nthe constructed error value are those induced by E. Note that it is allowed for\nE to refer to an intersection-type-descriptor.\n\u003c/p\u003e\n\u003cp\u003e\nThe first positional-arg is of type string and specifies the error message; the\nsecond positional-arg, if present, is of type \u003ccode\u003eerror?\u003c/code\u003e, with a\ndefault of nil, and specifies the cause.\n\u003c/p\u003e\n\u003cp\u003e\nEvaluating the error-constructor-expr constructs a new detail mapping. Each\nnamed-arg specifies a field of the error detail mapping; the static type of each\nnamed-arg must be a subtype of \u003ccode\u003evalue:Cloneable\u003c/code\u003e. The type descriptor\nE implies a type descriptor D for the detail mapping. The arg-name of every\nnamed-arg must be specified as the field-name of an individual-field-descriptor\noccurring in D, unless there are no such field names. Fields with default\nvalues will also be added to the detail record based on D in the same way as the\nmapping-constructor-expr adds fields with default values based on the\ncontextually expected type. The contextually expected type for each named-arg is\ndetermined from D in the same way as for a mapping-constructor-expr. The detail\nmapping is constructed as immutable, with its members being the result of\napplying the ImmutableClone abstract operation to the result of evaluating each\nnamed-arg and every defaultable arg.\n\u003c/p\u003e\n\u003cp\u003e\nThe stack trace in the constructed error value describes the execution stack at\nthe point where the error constructor was evaluated.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.18\"\u003e6.18 Anonymous function expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"anonymous-function-expr\"\u003eanonymous-function-expr\u003c/span\u003e := \u003ca href=\"#explicit-anonymous-function-expr\"\u003e\u003cspan class=\"ntref\"\u003eexplicit-anonymous-function-expr\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#infer-anonymous-function-expr\"\u003e\u003cspan class=\"ntref\"\u003einfer-anonymous-function-expr\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"explicit-anonymous-function-expr\"\u003eexplicit-anonymous-function-expr\u003c/span\u003e := [\u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#function-quals\"\u003e\u003cspan class=\"ntref\"\u003efunction-quals\u003c/span\u003e\u003c/a\u003e \u003ccode\u003efunction\u003c/code\u003e \u003ca href=\"#function-signature\"\u003e\u003cspan class=\"ntref\"\u003efunction-signature\u003c/span\u003e\u003c/a\u003e (\u003ca href=\"#block-function-body\"\u003e\u003cspan class=\"ntref\"\u003eblock-function-body\u003c/span\u003e\u003c/a\u003e|\u003ca href=\"#expr-function-body\"\u003e\u003cspan class=\"ntref\"\u003eexpr-function-body\u003c/span\u003e\u003c/a\u003e)\n\u003c/pre\u003e\n\u003cp\u003e\nEvaluating an anonymous-function-expr creates a closure, whose basic type is\nfunction. With an explicit-anonymous-function-expr, the type of the function is\nspecified explicitly as usual with a function-signature. With an\ninfer-anonymous-function-expr, the type of the function is inferred.\n\u003c/p\u003e\n\u003cp\u003e\nIf block-function-body refers to a block-scope variable defined\noutside of the block-function-body, the closure will capture a reference to that\nvariable; the captured reference will refer to the same storage as the original\nreference not a copy.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"infer-anonymous-function-expr\"\u003einfer-anonymous-function-expr\u003c/span\u003e := \u003ca href=\"#infer-param-list\"\u003e\u003cspan class=\"ntref\"\u003einfer-param-list\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#expr-function-body\"\u003e\u003cspan class=\"ntref\"\u003eexpr-function-body\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"infer-param-list\"\u003einfer-param-list\u003c/span\u003e :=\n   \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n   | \u003ccode\u003e(\u003c/code\u003e[\u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e)*]\u003ccode\u003e)\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nAn infer-anonymous-function-expr can only be used in a context where a function\ntype is expected. Both the types of the parameters and whether the function type\nis \u003ccode\u003eisolated\u003c/code\u003e are inferred from the expected function type. The\nfunction type will be inferred to be \u003ccode\u003etransactional\u003c/code\u003e if the\nexpr-function-body calls any functions with a transactional type.\nThe scope of the parameters is \u003ccode\u003eexpr-function-body\u003c/code\u003e.\nThe static type of the infer-anonymous-function-expr will be a function type\nwhose return type is the static type of the \u003ccode\u003eexpression\u003c/code\u003e in\n\u003ccode\u003eexpr-function-body\u003c/code\u003e. If the contextually expected type for the\n\u003ccode\u003eanonymous-function-expr\u003c/code\u003e is a function type with return type T, then\nthe contextually expected type for \u003ccode\u003eexpression\u003c/code\u003e in\n\u003ccode\u003eexpr-function-body\u003c/code\u003e is T.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_6.19\"\u003e6.19 Let expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"let-expr\"\u003elet-expr\u003c/span\u003e := \u003ccode\u003elet\u003c/code\u003e \u003ca href=\"#let-var-decl\"\u003e\u003cspan class=\"ntref\"\u003elet-var-decl\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#let-var-decl\"\u003e\u003cspan class=\"ntref\"\u003elet-var-decl\u003c/span\u003e\u003c/a\u003e]* \u003ccode\u003ein\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"let-var-decl\"\u003elet-var-decl\u003c/span\u003e := [\u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#typed-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003etyped-binding-pattern\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e=\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nA let-expr binds variables and then evaluates an expression with those variables in scope.\n\u003c/p\u003e\n\u003cp\u003e\nA let-expr \u003ccode\u003elet T B = E\u003csub\u003e1\u003c/sub\u003e in E\u003csub\u003e2\u003c/sub\u003e\u003c/code\u003e is evaluated as\nfollows. E\u003csub\u003e1\u003c/sub\u003e is evaluated resulting in a value v. The typed binding\npattern T B is matched to v, causing assignments to the variables occuring in B.\nThen E\u003csub\u003e2\u003c/sub\u003e is evaluated with those variables in scope; the resulting\nvalue is the result of the let-expr.\n\u003c/p\u003e\n\u003cp\u003e\nA let-expr \u003ccode\u003elet D\u003csub\u003e1\u003c/sub\u003e, D\u003csub\u003e2\u003c/sub\u003e,...,D\u003csub\u003en\u003c/sub\u003e in E\u003c/code\u003e\nis transformed into \u003ccode\u003elet D\u003csub\u003e1\u003c/sub\u003e in let D\u003csub\u003e2\u003c/sub\u003e in ... let\nD\u003csub\u003en\u003c/sub\u003e in E\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThe typed-binding-pattern is used unconditionally, meaning that it is a compile\nerror if the static types do not guarantee the success of the match. If the\ntyped-binding-pattern uses \u003ccode\u003evar\u003c/code\u003e, then the type of the variable is\ninferred from the precise static type of the expression following\n\u003ccode\u003e=\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nSince expressions cannot modify variables, the variables bound in a let-var-decl\nare implicitly final. A let-expr is isolated if the expression following\n\u003ccode\u003ein\u003c/code\u003e is isolated; a reference in that expression to a variable bound\nby a let-var-decl will be treated as isolated if the expression initializing the\nvariable in the let-var-decl is isolated.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_6.20\"\u003e6.20 Type cast expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"type-cast-expr\"\u003etype-cast-expr\u003c/span\u003e := \u003ccode\u003e\u0026lt;\u003c/code\u003e \u003ca href=\"#type-cast-param\"\u003e\u003cspan class=\"ntref\"\u003etype-cast-param\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e\u0026gt;\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"type-cast-param\"\u003etype-cast-param\u003c/span\u003e := [\u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003etype-cast-expr\u003c/code\u003e casts the value resulting from evaluating\n\u003ccode\u003eexpression\u003c/code\u003e to the type described by the type-descriptor, performing\na numeric conversion if required.\n\u003c/p\u003e\n\u003cp\u003e\nNormally, the parameter for a type-cast-expr includes a type-descriptor.\nHowever, it is also allowed for the parameter to consist only of annotations; in\nthis case, the only effect of the type cast is for the contextually expected\ntype for expression to be augmented with the specified annotations. The rest of\nthis subsection describes the normal case, where the type-cast-expr includes a\ntype-descriptor.\n\u003c/p\u003e\n\u003cp\u003e\nA type-cast-expr is evaluated by first evaluating \u003ccode\u003eexpression\u003c/code\u003e\nresulting in a value v. Let T be the type described by\n\u003ccode\u003etype-descriptor\u003c/code\u003e. If v belongs T, then the result of the\ntype-cast-expr is v. Otherwise, if T includes shapes from exactly one basic\nnumeric type N and v belongs to another basic numeric type, then let n be\nNumericConvert(N, v); if n is not an error and n belongs to T, then the result\nof the type-cast-expr is n. Otherwise, the evaluation of the type-cast-expr\ncompletes abruptly with a panic.\n\u003c/p\u003e\n\u003cp\u003e\nLet T be the static type described by \u003ccode\u003etype-descriptor\u003c/code\u003e, and let TE\nbe the static type of \u003ccode\u003eexpression\u003c/code\u003e. Then the static type of the\n\u003ccode\u003etype-cast-expr\u003c/code\u003e is the intersection of T and TE', where TE' is TE\nwith its numeric shapes transformed to take account of the possibility of the\nnumeric conversion specified in the previous paragraph.\nIt is a compile-time error to attempt to use a type cast to\n\u003cem\u003ecast away\u003c/em\u003e an error: if the intersection of TE and \u003ccode\u003eerror\u003c/code\u003e is\nnon-empty, then the intersection of T and \u003ccode\u003eerror\u003c/code\u003e must also be\nnon-empty. A \u003ccode\u003echeckpanic\u003c/code\u003e expression can be used instead to assert\nthat the result of an expression will never be an error.\n\u003c/p\u003e\n\u003cp\u003e\nThe contextually expected type for \u003ccode\u003eexpression\u003c/code\u003e is the intersection\nof the contextually expected type of the \u003ccode\u003etype-cast-expr\u003c/code\u003e and the\ntype described by the \u003ccode\u003etype-descriptor\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nNote that a \u003ccode\u003etype-cast-expr\u003c/code\u003e of \u003ccode\u003e\u0026lt;readonly\u0026gt;\u003c/code\u003e can be\nused both to cause constructors withing the \u003ccode\u003eexpression\u003c/code\u003e to construct\nvalues with the read-only bit on and to verify that the value resulting from\nthe evaluation of \u003ccode\u003eexpression\u003c/code\u003e has its read-only bit on.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.21\"\u003e6.21 Typeof expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"typeof-expr\"\u003etypeof-expr\u003c/span\u003e := \u003ccode\u003etypeof\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe result of a \u003ccode\u003etypeof-expr\u003c/code\u003e is a typedesc value for the runtime\ntype of v, where v is the result of evaluating \u003ccode\u003eexpression\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThe runtime type of v is the narrowest type to which v belongs.\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eWhen v is a simple value, the resulting typedesc will describe a type\nconsisting of a single shape, which is the shape of the value. The typedesc will\nnot have any annotations. Each evaluation of \u003ccode\u003etypeof\u003c/code\u003e with a simple\nvalue produces a new typedesc value.\u003c/li\u003e\n\u003cli\u003eWhen v is a reference value, each evaluation of \u003ccode\u003etypeof\u003c/code\u003e with an\nidentical reference value produces an identical typedesc value. The type\ndescriptor resulting from \u003ccode\u003etypeof\u003c/code\u003e will be the same as the type\ndescriptor used to construct the value. For containers, this is the same as the\ninherent type; when the container is immutable, it will be a singleton type. For\nan object, this is the same as the type descriptor used with new. For an error,\nthis is the same as the type descriptor used in the functional-constructor-expr.\nAny annotations that were attached to the type descriptor used to construct the\nvalue will this be available on the constructed value.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe static type of \u003ccode\u003etypeof-expr\u003c/code\u003e is typedesc\u0026lt;T\u0026gt;, where T is the\nstatic type of \u003ccode\u003eexpression\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.22\"\u003e6.22 Unary expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"unary-expr\"\u003eunary-expr\u003c/span\u003e :=\n   \u003ccode\u003e+\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n   | \u003ccode\u003e-\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n   | \u003ccode\u003e~\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n   | \u003ccode\u003e!\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\n\u003c/pre\u003e\n\u003cp\u003e\nThe unary \u003ccode\u003e-\u003c/code\u003e operator performs negation. The static type of the\noperand must be a number; the static type of the result is the same basic type\nas the static type of the operand. The semantics for each basic type are as\nfollows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eint: negation for int is the same as subtraction from zero; a panic will\noccur on overflow, which happens when the operand is -2\u003csup\u003e63\u003c/sup\u003e)\u003c/li\u003e\n\u003cli\u003efloat, decimal: negation for floating point types corresponds to the negate\noperation as defined by IEEE 754-2008 (this is not the same as subtraction from\nzero);\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIf the contextually expected type for a \u003ccode\u003e-\u003c/code\u003e expression is T, then the\ncontextualy expected type for the operand expressions is T', where a value v is\nin T' if it belongs to int, decimal or float, and T contains a value with the\nsame basic type as v.\n\u003c/p\u003e\n\u003cp\u003e\nThe unary + operator returns the value of its operand expression. The static\ntype of the operand must be a number, and the static type of the result is the\nsame as the static type of the operand expression.\n\u003c/p\u003e\n\u003cp\u003e\nThe ~ operator inverts the bits of its operand expression. The static type of\nthe operand must be int, and the static type of the result is an int.\n\u003c/p\u003e\n\u003cp\u003e\nThe \u003ccode\u003e!\u003c/code\u003e operator performs logical negation. The static type of the\noperand expression must be boolean. The \u003ccode\u003e!\u003c/code\u003e operator returns true if\nits operand is false and false if its operand is true.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.23\"\u003e6.23 Multiplicative expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"multiplicative-expr\"\u003emultiplicative-expr\u003c/span\u003e :=\n   \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e*\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e/\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e%\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe \u003ccode\u003e*\u003c/code\u003e operator performs multiplication; the \u003ccode\u003e/\u003c/code\u003e operator\nperforms division; the \u003ccode\u003e%\u003c/code\u003e operator performs remainder.\n\u003c/p\u003e\n\u003cp\u003e\nThe static type of both operand expressions is required to be a subtype of the\nsame basic type; this basic type will be the static type of the result. The\nfollowing basic types are allowed:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eint\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e*\u003c/code\u003e performs integer multiplication; a panic will occur on overflow\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e/\u003c/code\u003e performs integer division, with any fractional part discarded\nie with truncation towards zero; a panic will occur on division by zero or\noverflow, which happens if the first operand is -2\u003csup\u003e63\u003c/sup\u003e and the second\noperand is -1\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e%\u003c/code\u003e performs integer remainder consistent with integer division,\nso that if \u003ccode\u003e\u003cvar\u003ex\u003c/var\u003e/\u003cvar\u003ey\u003c/var\u003e\u003c/code\u003e does not result in a panic,\nthen \u003ccode\u003e(\u003cvar\u003ex\u003c/var\u003e/\u003cvar\u003ey\u003c/var\u003e)*\u003cvar\u003ey\u003c/var\u003e +\n(\u003cvar\u003ex\u003c/var\u003e%\u003cvar\u003ey\u003c/var\u003e)\u003c/code\u003e is equal to \u003ccode\u003e\u003cvar\u003ex\u003c/var\u003e\u003c/code\u003e; a\npanic will occur if the second operand is zero; if the first operand is\n-2\u003csup\u003e63\u003c/sup\u003e and the second operand is -1, then the result is 0\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003efloat, decimal\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e*\u003c/code\u003e performs the multiplication operation with the destination\nformat being the same as the source format, as defined by IEEE 754-2008; this\nnever causes a panic to occur\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e/\u003c/code\u003e performs the division operation with the destination format\nbeing the same as the source format, as defined by IEEE 754-2008; this never\ncauses a panic to occur\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e%\u003c/code\u003e performs a remainder operation; the remainder is not the\nIEEE-defined remainder operation but is instead a remainder operation analogous\nto integer remainder; more precisely,\n\u003cul\u003e\n\u003cli\u003eif \u003ccode\u003e\u003cvar\u003ex\u003c/var\u003e\u003c/code\u003e is NaN or \u003ccode\u003e\u003cvar\u003ey\u003c/var\u003e\u003c/code\u003e is NaN or\n\u003ccode\u003e\u003cvar\u003ex\u003c/var\u003e\u003c/code\u003e is an infinity or \u003ccode\u003e\u003cvar\u003ey\u003c/var\u003e\u003c/code\u003e is a zero,\nthen \u003ccode\u003e\u003cvar\u003ex\u003c/var\u003e % \u003cvar\u003ey\u003c/var\u003e\u003c/code\u003e is NaN\u003c/li\u003e\n\u003cli\u003efor finite \u003ccode\u003ex\u003c/code\u003e, and infinite \u003ccode\u003ey\u003c/code\u003e, \u003ccode\u003e\u003cvar\u003ex\u003c/var\u003e %\n\u003cvar\u003ey\u003c/var\u003e\u003c/code\u003e is \u003ccode\u003e\u003cvar\u003ex\u003c/var\u003e\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003efor finite \u003ccode\u003e\u003cvar\u003ex\u003c/var\u003e\u003c/code\u003e and finite non-zero\n\u003ccode\u003e\u003cvar\u003ey\u003c/var\u003e\u003c/code\u003e, \u003ccode\u003e\u003cvar\u003ex\u003c/var\u003e % \u003cvar\u003ey\u003c/var\u003e\u003c/code\u003e is equal to\nthe result of rounding \u003ccode\u003e\u003cvar\u003ex\u003c/var\u003e - (\u003cvar\u003ey\u003c/var\u003e Ã \u003cvar\u003en\u003c/var\u003e)\u003c/code\u003e\nto the nearest representable value using the roundTiesToEven rounding mode,\nwhere \u003ccode\u003e\u003cvar\u003en\u003c/var\u003e\u003c/code\u003e is the integer that is nearest to the\nmathematical quotient of \u003ccode\u003e\u003cvar\u003ex\u003c/var\u003e\u003c/code\u003e and \u003ccode\u003e\u003cvar\u003ey\u003c/var\u003e\u003c/code\u003e\nwithout exceeding it in magnitude; if the result is zero, then its sign is that\nof \u003ccode\u003e\u003cvar\u003ex\u003c/var\u003e\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eno exceptions are thrown\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIf the contextually expected type for a multiplicative-expr is T, then the\ncontextualy expected type for both operand expressions is T', where a value v is\nin T' if it belongs to int, decimal or float, and T contains a value with the\nsame basic type as v.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.24\"\u003e6.24 Additive expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"additive-expr\"\u003eadditive-expr\u003c/span\u003e :=\n   \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e+\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e-\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe \u003ccode\u003e+\u003c/code\u003e operator is used for both addition and concatenation; the\n\u003ccode\u003e-\u003c/code\u003e operator is used for subtraction.\n\u003c/p\u003e\n\u003cp\u003e\nIt is required that either\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethe static type of both operand expressions is a subtype of the same basic\ntype, in which case this basic type will be the static type of the result,\nor\u003c/li\u003e\n\u003cli\u003ethe static type of one operand expression must be a subtype of xml and of\nthe other operand expression must be a subtype of string, in which case the\nstatic type of the result is xml\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe semantics for each basic type is as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eint\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e+\u003c/code\u003e performs integer addition; a panic will occur on\noverflow\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e-\u003c/code\u003e performs integer subtraction; a panic will occur on\noverflow\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003efloat, decimal\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e+\u003c/code\u003e performs the addition operation with the destination format\nbeing the same as the source format, as defined by IEEE 754-2008; this never\ncauses a panic to occur\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e-\u003c/code\u003e performs the subtraction operation with the destination\nformat being the same as the source format, as defined by IEEE 754-2008; this\nnever causes a panic to occur\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003estring, xml\n\u003cul\u003e\n\u003cli\u003eif both operands are a string, then the result is a string that is the\nconcatenation of the operands\u003c/li\u003e\n\u003cli\u003eif both operands are xml, then the result is a new xml value that is the\nconcatenation of the operands; this does not perform a copy on\nthe constituents of the operand values\u003c/li\u003e\n\u003cli\u003eif one operand is an empty string and one is xml, then\nthe result is the xml value operand\u003c/li\u003e\n\u003cli\u003eif one operand is a non-empty string and one is xml, then the string is\ntreated as if it were an xml singleton text value whose characters are the same\nas the characters of the string;\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIf the contextually expected type for a multiplicative-expr is T, then the\ncontextualy expected type for both operand expressions is T', where a value v is\nin T' if it belongs to int, decimal, float, string or xml and T contains a value\nwith the same basic type as v.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.25\"\u003e6.25 Shift expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"shift-expr\"\u003eshift-expr\u003c/span\u003e :=\n   \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e\u0026lt;\u0026lt;\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n   \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e\u0026gt;\u0026gt;\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n   \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e\u0026gt;\u0026gt;\u0026gt;\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA shift-expr performs a bitwise shift. Both operand expressions must have static\ntype that is a subtype of int. The left hand operand is the value to be shifted;\nthe right hand value is the shift amount; all except the bottom 6 bits of the\nshift amount are masked out (as if by x \u0026amp; 0x3F). Then a bitwise shift is\nperformed depending on the operator:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e\u0026lt;\u0026lt;\u003c/code\u003e performs a left shift, the bits shifted in on the\nright are zero\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e\u0026gt;\u0026gt;\u003c/code\u003e performs a signed right shift; the bits shifted in on the\nleft are the same as the most significant bit\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e\u0026gt;\u0026gt;\u0026gt;\u003c/code\u003e performs a unsigned right shift, the bits shifted in on the\nleft are zero\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIf the operator is \u0026gt;\u0026gt; or \u0026gt;\u0026gt;\u0026gt; and the left hand operand is a\nsubtype of \u003ccode\u003eint:Unsigned\u003cvar\u003eK\u003c/var\u003e\u003c/code\u003e when \u003ccode\u003e\u003cvar\u003eK\u003c/var\u003e\u003c/code\u003e\nis 8, 16 or 32, then the static type of the result is\n\u003ccode\u003eint:Unsigned\u003cvar\u003eN\u003c/var\u003e\u003c/code\u003e where \u003ccode\u003e\u003cvar\u003eN\u003c/var\u003e\u003c/code\u003e is the\nsmallest such \u003ccode\u003e\u003cvar\u003eK\u003c/var\u003e\u003c/code\u003e; otherwise, the static type of the\nresult is \u003ccode\u003eint\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.26\"\u003e6.26 Range expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"range-expr\"\u003erange-expr\u003c/span\u003e :=\n   \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e...\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e..\u0026lt;\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe result of a range-expr is a new object belonging to the object type\nIterable\u0026lt;int,()\u0026gt; that will iterate over a sequence of integers in increasing\norder, where the sequence includes all integers n such that\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethe value of the first expression is less than or equal to n, and\u003c/li\u003e\n\u003cli\u003en is\n\u003cul\u003e\n\u003cli\u003eif the operator is \u003ccode\u003e...\u003c/code\u003e, less than or equal to the value of the\nsecond expression\u003c/li\u003e\n\u003cli\u003eif the operator is \u003ccode\u003e..\u0026lt;\u003c/code\u003e, less than the value of the second\nexpression\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIt is a compile error if the static type of either expression is not a subtype\nof int.\n\u003c/p\u003e\n\u003cp\u003e\nA range-expr is designed to be used in a foreach statement, but it can be used\nelsewhere.\n\u003c/p\u003e\n\u003cp\u003e\nA range-expr is always isolated.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.27\"\u003e6.27 Relational expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"relational-expr\"\u003erelational-expr\u003c/span\u003e :=\n   \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e\u0026lt;\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e\u0026gt;\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e\u0026lt;=\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e\u0026gt;=\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA relational-expr tests the relative order of two values. There must be an \u003ca href=\"#ordering\"\u003eordered\u003c/a\u003e type to which the static type of both operands\nbelong. The static type of the result is boolean.\n\u003c/p\u003e\n\u003cp\u003e\nA relational-expr is evaluated by first evaluating the two expressions,\nresulting in values x and y. The result of relational-expr is true if and only\nif the result of the Compare(x,y) operation is\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eLT, if the operator is \u003ccode\u003e\u0026lt;\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eGT, if the operator is \u003ccode\u003e\u0026gt;\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eLT or EQ, if the operator is \u003ccode\u003e\u0026lt;=\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eGT or EQ, if the operator is \u003ccode\u003e\u0026gt;=\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nand otherwise false.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.28\"\u003e6.28 Type test expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"is-expr\"\u003eis-expr\u003c/span\u003e :=\n   \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003eis\u003c/code\u003e \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nAn is-expr tests where a value belongs to a type.\n\u003c/p\u003e\n\u003cp\u003e\nAn is-expr is evaluated by evaluating the expression yielding a result v. If v\nbelongs to the type denoted by type-descriptor, then the result of the is-expr\nis true; otherwise the result of the is-expr is false.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.29\"\u003e6.29 Equality expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"equality-expr\"\u003eequality-expr\u003c/span\u003e :=\n   \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e==\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e!=\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e===\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e!==\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nAn equality-expr tests whether two values are equal. For all four operators, it\nis a compile time error if the intersection of the static types of the operands\nis empty.\n\u003c/p\u003e\n\u003cp\u003e\nThe === operator tests for exact equality. The !== operator results in the\nnegation of the result of the === operator. Two values v\u003csub\u003e1\u003c/sub\u003e and\nv\u003csub\u003e2\u003c/sub\u003e are exactly equal if they have the same basic type T and\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eT is simple type, and  v\u003csub\u003e1\u003c/sub\u003e and v\u003csub\u003e2\u003c/sub\u003e are identical values\nwithin the possible of values allowed for T;\u003c/li\u003e\n\u003cli\u003eT is a sequence type, and the length of v\u003csub\u003e1\u003c/sub\u003e is the same as the length of v\u003csub\u003e2\u003c/sub\u003e and\n\u003cul\u003e\n\u003cli\u003ethe length is 1, and either\n\u003cul\u003e\n\u003cli\u003ev\u003csub\u003e1\u003c/sub\u003e and v\u003csub\u003e2\u003c/sub\u003e both have storage identity and that storage\nidentity is the same, or\u003c/li\u003e\n\u003cli\u003ev\u003csub\u003e1\u003c/sub\u003e and v\u003csub\u003e2\u003c/sub\u003e both do not have storage identity and the\nshape of v\u003csub\u003e1\u003c/sub\u003e is the same as the shape of v\u003csub\u003e2\u003c/sub\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003ethe length is not 1, and every constituent of v\u003csub\u003e1\u003c/sub\u003e is exactly equal\nas the corresponding constituent of v\u003csub\u003e2\u003c/sub\u003e;\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eT is a structural or behavioural type, and the storage identity of\nv\u003csub\u003e1\u003c/sub\u003e is the same as the storage identity of v\u003csub\u003e2\u003c/sub\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe == operator tests for deep equality. The != operator results in the negation\nof the result of the == operator. For both == and !=, both operands must have a\nstatic type that is a subtype of anydata. Two values v1, v2 are deeply equal if\nDeepEquals(v1, v2) is true.\n\u003c/p\u003e\n\u003cp\u003e\nNote that === and == are the same for simple values except for floating point types.\n\u003c/p\u003e\n\u003cp\u003e\nFor the float type, the operators differ as regards floating point zero: ==\ntreats positive and negative zero from the same basic type as equal whereas ===\ntreats them as unequal. Both == and === treat two NaN values from the same basic\ntype as equal. This means that neither of these operators correspond to\noperations defined by IEEE 754-2008, because they do not treat NaN in the\nspecial way defined for those operations.\n\u003c/p\u003e\n\u003cp\u003e\nFor the decimal type, the operators differ in whether they consider the\nprecision of the value. For example, \u003ccode\u003e1.0 == 1.00\u003c/code\u003e is true but\n\u003ccode\u003e1.0 === 1.00\u003c/code\u003e is false.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.30\"\u003e6.30 Binary bitwise expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"binary-bitwise-expr\"\u003ebinary-bitwise-expr\u003c/span\u003e :=\n   \u003ca href=\"#bitwise-and-expr\"\u003e\u003cspan class=\"ntref\"\u003ebitwise-and-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#bitwise-xor-expr\"\u003e\u003cspan class=\"ntref\"\u003ebitwise-xor-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#bitwise-or-expr\"\u003e\u003cspan class=\"ntref\"\u003ebitwise-or-expr\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"bitwise-and-expr\"\u003ebitwise-and-expr\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e\u0026amp;\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"bitwise-xor-expr\"\u003ebitwise-xor-expr\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e^\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"bitwise-or-expr\"\u003ebitwise-or-expr\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e|\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA binary-bitwise-expr does a bitwise AND, XOR, or OR operation on its operands.\n\u003c/p\u003e\n\u003cp\u003e\nThe static type of both operands must be a subtype of int. The static type of\nthe result is as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efor AND, if the type of either operand is a subtype of\n\u003ccode\u003eint:Unsigned\u003cvar\u003eK\u003c/var\u003e\u003c/code\u003e when \u003ccode\u003e\u003cvar\u003eK\u003c/var\u003e\u003c/code\u003e is 8, 16 or\n32, then the static type of the result is \u003ccode\u003eint:Unsigned\u003cvar\u003eN\u003c/var\u003e\u003c/code\u003e\nwhere \u003ccode\u003e\u003cvar\u003eN\u003c/var\u003e\u003c/code\u003e is the smallest such \u003ccode\u003e\u003cvar\u003eK\u003c/var\u003e\u003c/code\u003e;\notherwise, the static type of the result is \u003ccode\u003eint\u003c/code\u003e;\u003c/li\u003e\n\u003cli\u003efor XOR or OR, if the type of both operands is a\nsubtype of \u003ccode\u003eint:Unsigned\u003cvar\u003eK\u003c/var\u003e\u003c/code\u003e when \u003ccode\u003e\u003cvar\u003eK\u003c/var\u003e\u003c/code\u003e\nis 8, 16 or 32, then the static type of the result is\n\u003ccode\u003eint:Unsigned\u003cvar\u003eN\u003c/var\u003e\u003c/code\u003e where \u003ccode\u003e\u003cvar\u003eN\u003c/var\u003e\u003c/code\u003e is the\nsmallest such \u003ccode\u003e\u003cvar\u003eK\u003c/var\u003e\u003c/code\u003e; otherwise, the static type of the result\nis \u003ccode\u003eint\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_6.31\"\u003e6.31 Logical expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"logical-expr\"\u003elogical-expr\u003c/span\u003e := \u003ca href=\"#logical-and-expr\"\u003e\u003cspan class=\"ntref\"\u003elogical-and-expr\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#logical-or-expr\"\u003e\u003cspan class=\"ntref\"\u003elogical-or-expr\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"logical-and-expr\"\u003elogical-and-expr\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e\u0026amp;\u0026amp;\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"logical-or-expr\"\u003elogical-or-expr\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e||\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nThe static type of each expression in a logical-expr must be a subtype of\nboolean.\n\u003c/p\u003e\n\u003cp\u003e\nA logical-and-expr is evaluated as follows:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003ethe left-hand expression is evaluated, resulting in a value \u003cvar\u003ex\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eif \u003cvar\u003ex\u003c/var\u003e is \u003ccode\u003efalse\u003c/code\u003e, then the result of the\nlogical-and-expr is \u003cvar\u003ex\u003c/var\u003e, and the right-hand expression is not\nevaluated;\u003c/li\u003e\n\u003cli\u003eotherwise, the result of the logical-and-expr is the result of evaluating\nthe right-hand expression.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\nA logical-or-expr is evaluated as follows:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003ethe left-hand expression is evaluated, resulting in a value \u003cvar\u003ex\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eif \u003cvar\u003ex\u003c/var\u003e is \u003ccode\u003etrue\u003c/code\u003e, then the result of the\nlogical-or-expr is \u003cvar\u003ex\u003c/var\u003e, and the right-hand expression is not\nevaluated;\u003c/li\u003e\n\u003cli\u003eotherwise, the result of the logical-or-expr is the result of evaluating\nthe right-hand expression.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_6.32\"\u003e6.32 Conditional expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"conditional-expr\"\u003econditional-expr\u003c/span\u003e :=\n   \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e?\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e:\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e?:\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nL \u003ccode\u003e?:\u003c/code\u003e R is evaluated as follows:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eEvaluate L to get a value x\u003c/li\u003e\n\u003cli\u003eIf x is not nil, then return x.\u003c/li\u003e\n\u003cli\u003eOtherwise, return the result of evaluating R.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.33\"\u003e6.33 Checking expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"checking-expr\"\u003echecking-expr\u003c/span\u003e := \u003ca href=\"#checking-keyword\"\u003e\u003cspan class=\"ntref\"\u003echecking-keyword\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"checking-keyword\"\u003echecking-keyword\u003c/span\u003e := \u003ccode\u003echeck\u003c/code\u003e | \u003ccode\u003echeckpanic\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nEvaluates expression resulting in value v. If v has basic type error, then\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eif the checking-keyword is \u003ccode\u003echeck\u003c/code\u003e, then the check-expression\ncompletes abruptly with a check-fail with associated value v;\u003c/li\u003e\n\u003cli\u003eif the checking-keyword is \u003ccode\u003echeckpanic\u003c/code\u003e, then the check-expression\ncompletes abruptly with a panic with associated value v.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIf the static type of expression \u003ccode\u003e\u003cvar\u003eExpr\u003c/var\u003e\u003c/code\u003e is T|E, where E is\na subtype of error, then the static type of \u003ccode\u003echeck \u003cvar\u003eExpr\u003c/var\u003e\u003c/code\u003e\nor \u003ccode\u003echeckpanic \u003cvar\u003eExpr\u003c/var\u003e\u003c/code\u003e is T. However, if:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethe checking-keyword is \u003ccode\u003echeck\u003c/code\u003e,\u003c/li\u003e\n\u003cli\u003ethe above rules would result in a compile-time error,\u003c/li\u003e\n\u003cli\u003ethe static type of \u003ccode\u003e\u003cvar\u003eExpr\u003c/var\u003e\u003c/code\u003e is lax,\u003c/li\u003e\n\u003cli\u003eT is a subtype of \u003ccode\u003ejson\u003c/code\u003e, and\u003c/li\u003e\n\u003cli\u003ethere is a contextually expected type S, where S is a subtype of\n\u003ccode\u003e()|int|float|decimal|string\u003c/code\u003e,\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nthen instead \u003ccode\u003echeck \u003cvar\u003eExpr\u003c/var\u003e\u003c/code\u003e is treated as \u003ccode\u003echeck\n\u003cvar\u003eval\u003c/var\u003e:ensureType(\u003cvar\u003eExpr\u003c/var\u003e, \u003cvar\u003es\u003c/var\u003e)\u003c/code\u003e, where\n\u003ccode\u003e\u003cvar\u003es\u003c/var\u003e\u003c/code\u003e is a typedesc value representing S and\n\u003ccode\u003e\u003cvar\u003eval\u003c/var\u003e\u003c/code\u003e refers to the \u003ccode\u003evalue\u003c/code\u003e module in langlib.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.34\"\u003e6.34 Trap expression\u003c/h3\u003e\n\u003cp\u003e\nThe trap expression stops a panic and gives access to the error value associated\nwith the panic.\n\u003c/p\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"trap-expr\"\u003etrap-expr\u003c/span\u003e := \u003ccode\u003etrap\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e  \n\u003cp\u003e\nSemantics are:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eEvaluate \u003ccode\u003eexpression\u003c/code\u003e resulting in value v\n\u003cul\u003e\n\u003cli\u003eIf evaluation completes abruptly with panic with associated value e, then\nresult of trap-exp is e\u003c/li\u003e\n\u003cli\u003eOtherwise result of trap-expr is v\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eIf type of \u003ccode\u003eexpr\u003c/code\u003e is T, then type of \u003ccode\u003etrap expr\u003c/code\u003e is\nT|error. It is permitted for T to be \u003ccode\u003enever\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_6.35\"\u003e6.35 Query expression\u003c/h3\u003e\n\u003cp\u003e\nA query expression provides a language-integrated query feature using SQL-like\nsyntax. In this version of Ballerina, the functionality is similar to a list\ncomprehensions; future versions will provided richer functionality.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"query-expr\"\u003equery-expr\u003c/span\u003e := [\u003ca href=\"#query-construct-type\"\u003e\u003cspan class=\"ntref\"\u003equery-construct-type\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#query-pipeline\"\u003e\u003cspan class=\"ntref\"\u003equery-pipeline\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#select-clause\"\u003e\u003cspan class=\"ntref\"\u003eselect-clause\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#on-conflict-clause\"\u003e\u003cspan class=\"ntref\"\u003eon-conflict-clause\u003c/span\u003e\u003c/a\u003e]\n\u003cspan class=\"ntdfn\" id=\"query-construct-type\"\u003equery-construct-type\u003c/span\u003e :=\n  \u003ccode\u003etable\u003c/code\u003e \u003ca href=\"#key-specifier\"\u003e\u003cspan class=\"ntref\"\u003ekey-specifier\u003c/span\u003e\u003c/a\u003e\n  | \u003ccode\u003estream\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"query-pipeline\"\u003equery-pipeline\u003c/span\u003e := \u003ca href=\"#from-clause\"\u003e\u003cspan class=\"ntref\"\u003efrom-clause\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#intermediate-clause\"\u003e\u003cspan class=\"ntref\"\u003eintermediate-clause\u003c/span\u003e\u003c/a\u003e*\n\u003cspan class=\"ntdfn\" id=\"intermediate-clause\"\u003eintermediate-clause\u003c/span\u003e :=\n   \u003ca href=\"#from-clause\"\u003e\u003cspan class=\"ntref\"\u003efrom-clause\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#where-clause\"\u003e\u003cspan class=\"ntref\"\u003ewhere-clause\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#let-clause\"\u003e\u003cspan class=\"ntref\"\u003elet-clause\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#join-clause\"\u003e\u003cspan class=\"ntref\"\u003ejoin-clause\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#order-by-clause\"\u003e\u003cspan class=\"ntref\"\u003eorder-by-clause\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#limit-clause\"\u003e\u003cspan class=\"ntref\"\u003elimit-clause\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA query expression consists of a sequence of clauses. The semantics of clauses\nis specified in terms of transforming a sequence of frames, where a frame is a\nbinding of variables to values. The input to each clause is a sequence of\nframes. As each clause is executed, it iterates over its input frames and emits\noutput: the final clause, which is a \u003ccode\u003eselect\u003c/code\u003e clause, emits output\n\u003cem\u003evalues\u003c/em\u003e; the other clauses emit output \u003cem\u003eframes\u003c/em\u003e. When a\nquery-expr is evaluated, its clauses are executed in a pipeline by making the\nsequence of frames emitted by one clause be the input to the next clause. Each\nclause in the pipeline is executed lazily, pulling input from its preceding\nclause. The input to the first clause is a single empty frame.\n\u003c/p\u003e\n\u003cp\u003e\nThe execution of a clause may complete early with an error value, in which case\nthis error value is the result of the query, except when constructing a stream.\nOtherwise, the result of evaluating a query expression is a single value, which\nis constructed from the sequence of values emitted by the last clause. The\nresult must be one of the following basic types:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003elist - the constructed list has a member for each emitted value; every\nemitted value must beloing to type T, where T[] is the type of the constructed\nvalue\u003c/li\u003e\n\u003cli\u003etable - the constructed table has a member for each emitted value; every\nemitted value must belong to type T, where table\u0026lt;T\u0026gt; is the type of the\nconstructed value\u003c/li\u003e\n\u003cli\u003estring - the constructed string is the concatenation of the emitted values;\nevery emitted value must be of type string\u003c/li\u003e\n\u003cli\u003exml - the constructed xml value is the concatenation of the emitted values;\nevery emitted value must be of type xml\u003c/li\u003e\n\u003cli\u003estream - the stream generates the emitted values\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nA query-expr that constructs a stream must start with the \u003ccode\u003estream\u003c/code\u003e\nkeyword and is evaluated differently from a query-expr that constructs a value\nof other basic types. The clauses in the query-expr are executed lazily: clauses\nin the query-expr becomes closures, which are called as a result of next\noperations being performed on the stream. If a next operation causes the\nexecution of a clause that completes early with an error value, then the error\nvalue is returned by the next operation; the evaluation of the query-expr will\nalready have resulted in a stream value. If the next operation results in the\nevaluation of an expression within the query-expr completing abruptly with a\ncheck-fail, the associated error value will be returned as the result of the\nnext operation. If the next operation results in the evaluation of an expression\nwithin the query-expr completely abruptly with a panic, then the next operation\nwill complete abruptly with a panic.\n\u003c/p\u003e\n\u003cp\u003e\nIf the query-expr starts with \u003ccode\u003etable\u003c/code\u003e, then the query-expr will\nconstruct a table; the key-specifier specifies the key sequence of the\nconstructed table in the same way as with a table-constructor-expr. Otherwise,\nthe applicable contextually expected type determines the basic type of the value\nconstructed. If there is no contextually expected type, then the basic type of\nthe value constructed is the basic type of expression following \u003ccode\u003ein\u003c/code\u003e;\nit is a compile-time error if the static type of this expression is not a\nsubtype of one of the basic types that a query expression can construct.\n\u003c/p\u003e\n\u003cp\u003e\nWhen during the construction of a table, an emitted value is added as a new\nmember, it replaces any existing member with the same key value; when a new\nmember replaces an existing member, it will have the same position in the order\nof members as the existing member. This behavior may be controlled by an\n\u003ccode\u003eon conflict\u003c/code\u003e clause.\n\u003c/p\u003e\n\u003cp\u003e\nVariables bound by the clauses of a query-pipeline are implicitly final, and\ncannot be modified.\n\u003c/p\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_6.35.1\"\u003e6.35.1 From clause\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"from-clause\"\u003efrom-clause\u003c/span\u003e := \u003ccode\u003efrom\u003c/code\u003e \u003ca href=\"#typed-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003etyped-binding-pattern\u003c/span\u003e\u003c/a\u003e \u003ccode\u003ein\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003efrom\u003c/code\u003e clause is executed as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efor each input frame \u003cvar\u003ef\u003c/var\u003e\n\u003cul\u003e\n\u003cli\u003eevaluate the \u003ccode\u003ein\u003c/code\u003e expression with \u003cvar\u003ef\u003c/var\u003e in scope resulting\nin an iterable value \u003cvar\u003ec\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003ecreate an Iterator object \u003cvar\u003ei\u003c/var\u003e from \u003cvar\u003ec\u003c/var\u003e\n\u003c/li\u003e\n\u003cli\u003edo the following in a loop \u003cvar\u003eL\u003c/var\u003e\n\u003cul\u003e\n\u003cli\u003ecall \u003ccode\u003e\u003cvar\u003ei\u003c/var\u003e.next()\u003c/code\u003e resulting in a value \u003cvar\u003er\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eif \u003cvar\u003er\u003c/var\u003e is an error, then complete execution of the from-clause\nearly with error \u003cvar\u003er\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eif \u003cvar\u003er\u003c/var\u003e is \u003ccode\u003e()\u003c/code\u003e, stop loop \u003cvar\u003eL\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003elet \u003cvar\u003ev\u003c/var\u003e be \u003ccode\u003e\u003cvar\u003er\u003c/var\u003e.value\u003c/code\u003e;\u003c/li\u003e\n\u003cli\u003eemit a frame consisting of \u003cvar\u003ef\u003c/var\u003e augmented with the variables\nresulting from binding typed-binding-pattern to \u003cvar\u003ev\u003c/var\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e  \n\u003c/ul\u003e\n\u003c/li\u003e  \n\u003c/ul\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_6.35.2\"\u003e6.35.2 Where clause\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"where-clause\"\u003ewhere-clause\u003c/span\u003e := \u003ccode\u003ewhere\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003ewhere\u003c/code\u003e clause is executed as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efor each input frame \u003cvar\u003ef\u003c/var\u003e \n\u003cul\u003e\n\u003cli\u003eexecute the \u003ccode\u003eexpression\u003c/code\u003e with \u003cvar\u003ef\u003c/var\u003e in scope resulting in\nvalue \u003cvar\u003eb\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eif \u003cvar\u003eb\u003c/var\u003e is true, emit \u003cvar\u003ef\u003c/var\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e \n\u003c/ul\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_6.35.3\"\u003e6.35.3 Let clause\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"let-clause\"\u003elet-clause\u003c/span\u003e := \u003ccode\u003elet\u003c/code\u003e \u003ca href=\"#let-var-decl\"\u003e\u003cspan class=\"ntref\"\u003elet-var-decl\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#let-var-decl\"\u003e\u003cspan class=\"ntref\"\u003elet-var-decl\u003c/span\u003e\u003c/a\u003e]* \n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003elet\u003c/code\u003e clause consisting of a single let-var-decl is executed as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efor each input frame \u003cvar\u003ef\u003c/var\u003e \n\u003cul\u003e\n\u003cli\u003eevaluate the expression with \u003cvar\u003ef\u003c/var\u003e in scope resulting in a value \u003cvar\u003ev\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eemit a frame consisting of \u003cvar\u003ef\u003c/var\u003e augmented with the result of binding\ntype-binding-pattern to \u003cvar\u003ev\u003c/var\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e \n\u003c/ul\u003e\n\u003cp\u003e\nA \u003ccode\u003elet\u003c/code\u003e clause with more than one \u003ccode\u003elet-var-decl\u003c/code\u003e is\ntransformed into multiple \u003ccode\u003elet\u003c/code\u003e clauses: \u003ccode\u003elet x\u003csub\u003e1\u003c/sub\u003e =\nE\u003csub\u003e1\u003c/sub\u003e, x\u003csub\u003e2\u003c/sub\u003e = E\u003csub\u003e2\u003c/sub\u003e\u003c/code\u003e is transformed into\n\u003ccode\u003elet x\u003csub\u003e1\u003c/sub\u003e = E\u003csub\u003e1\u003c/sub\u003e let x\u003csub\u003e2\u003c/sub\u003e =\nE\u003csub\u003e2\u003c/sub\u003e\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_6.35.4\"\u003e6.35.4 Join clause\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"join-clause\"\u003ejoin-clause\u003c/span\u003e := [\u003ccode\u003eouter\u003c/code\u003e] \u003ccode\u003ejoin\u003c/code\u003e \u003ca href=\"#typed-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003etyped-binding-pattern\u003c/span\u003e\u003c/a\u003e \u003ccode\u003ein\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#join-on-condition\"\u003e\u003cspan class=\"ntref\"\u003ejoin-on-condition\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"join-on-condition\"\u003ejoin-on-condition\u003c/span\u003e := \u003ccode\u003eon\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003eequals\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA join clause performs an inner or left outer equijoin.\n\u003c/p\u003e\n\u003cp\u003e\nA \u003ccode\u003ejoin\u003c/code\u003e clause is executed as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ecompute a mapping for the right side of the join; during this computation\nvariable bindings from input frames are not in scope:\n\u003cul\u003e\n\u003cli\u003ecreate an empty mapping \u003cvar\u003em\u003c/var\u003e that maps from keys to lists of frames\n(using \u003ca href=\"#DeepEquals\"\u003eDeepEquals\u003c/a\u003e to compare keys);\u003c/li\u003e\n\u003cli\u003eevaluate the expression following \u003ccode\u003ein\u003c/code\u003e resulting in an iterable\nvalue \u003cvar\u003ec\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003ecreate an Iterator object \u003cvar\u003ei\u003c/var\u003e from \u003cvar\u003ec\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003edo the following in a loop \u003cvar\u003eL\u003c/var\u003e\n\u003cul\u003e\n\u003cli\u003ecall \u003ccode\u003e\u003cvar\u003ei\u003c/var\u003e.next()\u003c/code\u003e resulting in a value \u003cvar\u003er\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eif \u003cvar\u003er\u003c/var\u003e is an error, then complete execution of the join-clause\nearly with error \u003cvar\u003er\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eif \u003cvar\u003er\u003c/var\u003e is \u003ccode\u003e()\u003c/code\u003e, stop loop \u003cvar\u003eL\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003elet \u003cvar\u003ev\u003c/var\u003e be \u003ccode\u003e\u003cvar\u003er\u003c/var\u003e.value\u003c/code\u003e;\u003c/li\u003e\n\u003cli\u003elet \u003cvar\u003ef\u003c/var\u003e be a frame with the result of binding the\ntyped-binding-pattern to \u003cvar\u003ev\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eevaluate the expression to right of \u003ccode\u003eequals\u003c/code\u003e with \u003cvar\u003ef\u003c/var\u003e\nin scope resulting in a value \u003cvar\u003ek\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eadd an entry to \u003cvar\u003em\u003c/var\u003e with key \u003cvar\u003ek\u003c/var\u003e and and frame \u003cvar\u003ef\u003c/var\u003e;\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003efor each input frame \u003cvar\u003ef\u003c/var\u003e\n\u003cul\u003e\n\u003cli\u003eevaluate the expression to the left of \u003ccode\u003eequals\u003c/code\u003e with frame \u003cvar\u003ef\u003c/var\u003e\nin scope resulting in a value \u003cvar\u003ek\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003elet \u003cvar\u003efs\u003c/var\u003e be the list of frames for key \u003cvar\u003ek\u003c/var\u003e in \u003cvar\u003em\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003efor each frame \u003cvar\u003ef'\u003c/var\u003e in \u003cvar\u003efs\u003c/var\u003e\n\u003cul\u003e\n\u003cli\u003eemit a frame consisting of \u003cvar\u003ef\u003c/var\u003e augmented with \u003cvar\u003ef'\u003c/var\u003e;\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eif \u003ccode\u003eouter\u003c/code\u003e was specified and \u003cvar\u003efs\u003c/var\u003e is empty, then emit a\nsingle frame consisting of \u003cvar\u003ef\u003c/var\u003e augmented with a frame that binds every\nvariable occurring in typed-binding-pattern to \u003ccode\u003e()\u003c/code\u003e.\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIn the above, if \u003cvar\u003ec\u003c/var\u003e evaluates to a table, and the result of evaluating\nthe expression to the right of \u003ccode\u003eequals\u003c/code\u003e for a member of the table\nwill always be the key value for that member of the table, then the above can be\noptimized by using the table instead of creating a new mapping.\n\u003c/p\u003e\n\u003cp\u003e\nVariables bound by previous clauses are not in scope for the expression\nfollowing \u003ccode\u003ein\u003c/code\u003e, nor for the expression on the right of\n\u003ccode\u003eequals\u003c/code\u003e. Variables bound by the typed-binding-pattern are not in\nscope for the expression following \u003ccode\u003ein\u003c/code\u003e, nor for the expression on\nthe left of \u003ccode\u003eequals\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nWhen \u003ccode\u003eouter\u003c/code\u003e is specified, the typed-binding-pattern is treated\nspecially: the inferable-type-descriptor in the typed-binding-pattern must be\n\u003ccode\u003evar\u003c/code\u003e, and for each variable occurring in the typed-binding-pattern,\nif the type that would be inferred usually for the variable would be\n\u003cvar\u003eT\u003c/var\u003e, then the type inferred in this case will be\n\u003cvar\u003eT\u003c/var\u003e\u003ccode\u003e?\u003c/code\u003e.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_6.35.5\"\u003e6.35.5 Order by clause\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\n\u003cspan class=\"ntdfn\" id=\"order-by-clause\"\u003eorder-by-clause\u003c/span\u003e := \u003ccode\u003eorder\u003c/code\u003e \u003ccode\u003eby\u003c/code\u003e \u003ca href=\"#order-key\"\u003e\u003cspan class=\"ntref\"\u003eorder-key\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#order-key\"\u003e\u003cspan class=\"ntref\"\u003eorder-key\u003c/span\u003e\u003c/a\u003e]*\n\u003cspan class=\"ntdfn\" id=\"order-key\"\u003eorder-key\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#order-direction\"\u003e\u003cspan class=\"ntref\"\u003eorder-direction\u003c/span\u003e\u003c/a\u003e]\n\u003cspan class=\"ntdfn\" id=\"order-direction\"\u003eorder-direction\u003c/span\u003e := \u003ccode\u003eascending\u003c/code\u003e | \u003ccode\u003edescending\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe static type of the expression in an order-key must be an \u003ca href=\"#ordering\"\u003eordered\u003c/a\u003e type. The order-direction is \u003ccode\u003eascending\u003c/code\u003e\nif not explicitly specified.\n\u003c/p\u003e\n\u003cp\u003e\nAn \u003ccode\u003eorder-by\u003c/code\u003e clause is executed by constructing a list\nof entries, where each entry consists of:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ea frame\u003c/li\u003e\n\u003cli\u003ea list of keys, one for each order-key in the order-by-clause, and\u003c/li\u003e\n\u003cli\u003ean integer index\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIn order to define the correct ordering of the list, we first define a CompareK\noperation that compares two keys with a specified direction: CompareK(x,y,d) is\nCompareA(x,y) if d is ascending and otherwise (d is descending) is\nReverse(CompareD(x,y)), where Reverse applied to LT, EQ, GT is GT, EQ, LT\nrespectively. Now define an operation CompareKL(x,y,d) applying to two lists of\nkeys and a list of directions as follows. Let x be\n[x\u003csub\u003e1\u003c/sub\u003e,x\u003csub\u003e2\u003c/sub\u003e,...,x\u003csub\u003en\u003c/sub\u003e], y be\n[y\u003csub\u003e1\u003c/sub\u003e,y\u003csub\u003e2\u003c/sub\u003e,...,y\u003csub\u003en\u003c/sub\u003e], and d be [d\u003csub\u003e1\u003c/sub\u003e,\nd\u003csub\u003e2\u003c/sub\u003e,...,d\u003csub\u003en\u003c/sub\u003e]. Then let r be\nCompareK(x\u003csub\u003e1\u003c/sub\u003e,y\u003csub\u003e1\u003c/sub\u003e,d\u003csub\u003e1\u003c/sub\u003e). Then the result of\nCompareKL(x,y,d) is:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003er, if r is not EQ\u003c/li\u003e\n\u003cli\u003eotherwise, EQ, if n is 1\u003c/li\u003e\n\u003cli\u003eotherwise,\nCompareKL([x\u003csub\u003e2\u003c/sub\u003e,...,x\u003csub\u003en\u003c/sub\u003e],[y\u003csub\u003e2\u003c/sub\u003e,...,y\u003csub\u003en\u003c/sub\u003e],[d\u003csub\u003e2\u003c/sub\u003e,...,d\u003csub\u003en\u003c/sub\u003e]).\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThen in a correct ordering of the list of entries when the list of directions is\nd, an entry with keys with keys x and index i is before an entry with keys y and\nindex j if CompareKL(x,y,d) is LT or if CompareKL(x,y,d) is EQ and i is less\nthan j.\n\u003c/p\u003e\n\u003cp\u003e\nAn \u003ccode\u003eorder-by\u003c/code\u003e clause is executed as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ecreate an empty list \u003cvar\u003eE\u003c/var\u003e of entries\u003c/li\u003e\n\u003cli\u003efor each input frame \u003cvar\u003ef\u003c/var\u003e add an entry to \u003cvar\u003eE\u003c/var\u003e in which\n\u003cul\u003e\n\u003cli\u003ethe frame is \u003cvar\u003ef\u003c/var\u003e\n\u003c/li\u003e\n\u003cli\u003ethe list of keys is a list of the results of evaluating each order-key's\nexpression with \u003cvar\u003ef\u003c/var\u003e in scope\u003c/li\u003e\n\u003cli\u003ethe index is the length of \u003cvar\u003eE\u003c/var\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003esort \u003cvar\u003eE\u003c/var\u003e so that it is ordered correctly as described above\u003c/li\u003e\n\u003cli\u003efor each entry in \u003cvar\u003eE\u003c/var\u003e, emit the entry's frame\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_6.35.6\"\u003e6.35.6 Limit clause\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\n\u003cspan class=\"ntdfn\" id=\"limit-clause\"\u003elimit-clause\u003c/span\u003e := \u003ccode\u003elimit\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003elimit\u003c/code\u003e clause limits the number of frames emitted by a query pipeline.\n\u003c/p\u003e\n\u003cp\u003e\nA \u003ccode\u003elimit\u003c/code\u003e clause is executed as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eevaluate expression resulting in a value \u003cvar\u003en\u003c/var\u003e; variable bindings\nfrom input frames are not in scope for this evaluation;\u003c/li\u003e\n\u003cli\u003eif \u003cvar\u003en\u003c/var\u003e is less than zero, then panic;\u003c/li\u003e\n\u003cli\u003efor each input frame \u003cvar\u003ef\u003c/var\u003e, while \u003cvar\u003en\u003c/var\u003e is greater than 0\n\u003cul\u003e\n\u003cli\u003edecrement \u003cvar\u003en\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eemit \u003cvar\u003ef\u003c/var\u003e.\u003c/li\u003e \n\u003c/ul\u003e\n\u003c/li\u003e \n\u003c/ul\u003e\n\n\u003cp\u003e\nThe static type of expression must be a subtype of \u003ccode\u003eint\u003c/code\u003e.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_6.35.7\"\u003e6.35.7 Select clause\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\n\u003cspan class=\"ntdfn\" id=\"select-clause\"\u003eselect-clause\u003c/span\u003e := \u003ccode\u003eselect\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003eselect\u003c/code\u003e clause is executed as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efor each input frame \u003cvar\u003ef\u003c/var\u003e \n\u003cul\u003e\n\u003cli\u003eevaluate the expression with \u003cvar\u003ef\u003c/var\u003e in scope resulting in value \u003cvar\u003ev\u003c/var\u003e\n\u003c/li\u003e\n\u003cli\u003eemit \u003cvar\u003ev\u003c/var\u003e\n\u003c/li\u003e \n\u003c/ul\u003e\n\u003c/li\u003e \n\u003c/ul\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_6.35.8\"\u003e6.35.8 On conflict clause\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\n\u003cspan class=\"ntdfn\" id=\"on-conflict-clause\"\u003eon-conflict-clause\u003c/span\u003e := \u003ccode\u003eon\u003c/code\u003e \u003ccode\u003econflict\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nAn \u003ccode\u003eon conflict\u003c/code\u003e clause is allowed only for a query expression that\nconstructs a table with a key sequence. The expression is evaluated when the\n\u003ccode\u003eselect\u003c/code\u003e clause emits a value that conflicts with a previous value,\nin the sense that both values have the same key value in the table. The\nexpression is evaluated with the same frame in scope as the select clause that\nemitted the value that conflicts with the previous value. The static type of the\nexpression must be a subtype of \u003ccode\u003eerror?\u003c/code\u003e. If the result of evaluating\nthe expression is an error \u003cvar\u003ee\u003c/var\u003e, then the result of evaluating the\nquery-expr is \u003cvar\u003ee\u003c/var\u003e. Otherwise, the result must be nil, and the earlier\nnew value replaces the earlier conflicting value, in the same way as if there\nnot been an \u003ccode\u003eon conflict\u003c/code\u003e clause.\n\u003c/p\u003e\n\u003cp\u003e\nNote that the expression may have side-effects; for example, it may call a\nfunction that logs an error.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.36\"\u003e6.36 XML navigation expression\u003c/h3\u003e\n\u003cp\u003e\nXML navigation expressions allow for convenient navigation of XML element structure,\nin a similar way to XPath.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"xml-navigate-expr\"\u003exml-navigate-expr\u003c/span\u003e := \u003ca href=\"#xml-filter-expr\"\u003e\u003cspan class=\"ntref\"\u003exml-filter-expr\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#xml-step-expr\"\u003e\u003cspan class=\"ntref\"\u003exml-step-expr\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_6.36.1\"\u003e6.36.1 XML name pattern\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"xml-name-pattern\"\u003exml-name-pattern\u003c/span\u003e := \u003ca href=\"#xml-atomic-name-pattern\"\u003e\u003cspan class=\"ntref\"\u003exml-atomic-name-pattern\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003e|\u003c/code\u003e \u003ca href=\"#xml-atomic-name-pattern\"\u003e\u003cspan class=\"ntref\"\u003exml-atomic-name-pattern\u003c/span\u003e\u003c/a\u003e]*\n\n\u003cspan class=\"ntdfn\" id=\"xml-atomic-name-pattern\"\u003exml-atomic-name-pattern\u003c/span\u003e :=\n  \u003ccode\u003e*\u003c/code\u003e\n  | \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n  | \u003ca href=\"#xml-namespace-prefix\"\u003e\u003cspan class=\"ntref\"\u003exml-namespace-prefix\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e:\u003c/code\u003e \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n  | \u003ca href=\"#xml-namespace-prefix\"\u003e\u003cspan class=\"ntref\"\u003exml-namespace-prefix\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e:\u003c/code\u003e \u003ccode\u003e*\u003c/code\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nAn XML name pattern matches a string specifying the name of an XML element.\n\u003c/p\u003e\n\u003cp\u003e\nAn xml-atomic-name-pattern that is \u003ccode\u003e*\u003c/code\u003e matches any name.\n\u003c/p\u003e\n\u003cp\u003e\nAn xml-namespace-prefix in an xml-atomic-name-pattern must be declared by an\nxmlns-decl. If there is an in-scope default namespace (declared by an\nxmlns-decl), an xml-atomic-pattern that is just an identifier specifies a\nname in that default namespace.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_6.36.2\"\u003e6.36.2 XML filter expression\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"xml-filter-expr\"\u003exml-filter-expr\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e.\u0026lt;\u003c/code\u003e \u003ca href=\"#xml-name-pattern\"\u003e\u003cspan class=\"ntref\"\u003exml-name-pattern\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e\u0026gt;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nAn xml-filter-expr selects constituents of a sequence that are elements with a\nname matching a specified name pattern. The static type of the expression must\nbe a subtype of xml. The static type of the xml-filter-expr is\n\u003ccode\u003exml\u0026lt;xml:Element\u0026gt;\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_6.36.3\"\u003e6.36.3 XML step expression\u003c/h4\u003e\n\u003cp\u003e\nAn xml-step-expr provides access to the children or descendants of an element,\nsimilar to a location path in XPath.\n\u003c/p\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"xml-step-expr\"\u003exml-step-expr\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#xml-step-start\"\u003e\u003cspan class=\"ntref\"\u003exml-step-start\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#xml-step-extend\"\u003e\u003cspan class=\"ntref\"\u003exml-step-extend\u003c/span\u003e\u003c/a\u003e*\n\n\u003cspan class=\"ntdfn\" id=\"xml-step-start\"\u003exml-step-start\u003c/span\u003e :=\n   \u003ca href=\"#xml-all-children-step\"\u003e\u003cspan class=\"ntref\"\u003exml-all-children-step\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#xml-element-children-step\"\u003e\u003cspan class=\"ntref\"\u003exml-element-children-step\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#xml-element-descendants-step\"\u003e\u003cspan class=\"ntref\"\u003exml-element-descendants-step\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"xml-all-children-step\"\u003exml-all-children-step\u003c/span\u003e := \u003ccode\u003e/*\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"xml-element-children-step\"\u003exml-element-children-step\u003c/span\u003e := \u003ccode\u003e/\u0026lt;\u003c/code\u003e \u003ca href=\"#xml-name-pattern\"\u003e\u003cspan class=\"ntref\"\u003exml-name-pattern\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e\u0026gt;\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"xml-element-descendants-step\"\u003exml-element-descendants-step\u003c/span\u003e := \u003ccode\u003e/**/\u0026lt;\u003c/code\u003e \u003ca href=\"#xml-name-pattern\"\u003e\u003cspan class=\"ntref\"\u003exml-name-pattern\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e\u0026gt;\u003c/code\u003e\n\n\u003cspan class=\"ntdfn\" id=\"xml-step-extend\"\u003exml-step-extend\u003c/span\u003e :=\n   \u003ccode\u003e.\u0026lt;\u003c/code\u003e \u003ca href=\"#xml-name-pattern\"\u003e\u003cspan class=\"ntref\"\u003exml-name-pattern\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e\u0026gt;\u003c/code\u003e\n   | \u003ccode\u003e[\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e]\u003c/code\u003e\n   | \u003ccode\u003e.\u003c/code\u003e \u003ca href=\"#method-name\"\u003e\u003cspan class=\"ntref\"\u003emethod-name\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e(\u003c/code\u003e \u003ca href=\"#arg-list\"\u003e\u003cspan class=\"ntref\"\u003earg-list\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e)\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe production for xml-step-expr is ambiguous with the productions for\nmember-access-expr and method-call-expr: this must be resolved by preferring the\nparse that includes as much as possible in the xml-step-expr.\n\u003c/p\u003e\n\u003cp\u003e\nThe static type of the expression must be a subtype of xml.\n\u003c/p\u003e\n\u003cp\u003e\nAn xml-step-expr that starts with an xml-all-children-step\n\u003c/p\u003e\n\u003cpre\u003e\n   \u003cvar\u003eE\u003c/var\u003e /* \u003cvar\u003eX\u003c/var\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nis equivalent to\n\u003c/p\u003e\n\u003cpre\u003e\n   xml:map(xml:elements(\u003cvar\u003eE\u003c/var\u003e), v =\u0026gt; xml:getChildren(v) \u003cvar\u003eX\u003c/var\u003e)\n\u003c/pre\u003e\n\u003cp\u003e\nwhere \u003ccode\u003ev\u003c/code\u003e is a variable name not used in \u003ccode\u003e\u003cvar\u003eX\u003c/var\u003e\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nAn xml-step-expr that starts with an xml-element-children-step\n\u003c/p\u003e\n\u003cpre\u003e\n   \u003cvar\u003eE\u003c/var\u003e /\u0026lt; \u003cvar\u003eNP\u003c/var\u003e \u0026gt; \u003cvar\u003eX\u003c/var\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nis equivalent to\n\u003c/p\u003e\n\u003cpre\u003e\n   xml:map(xml:elements(\u003cvar\u003eE\u003c/var\u003e), v =\u0026gt; xml:getChildren(v) .\u0026lt;\u003cvar\u003eNP\u003c/var\u003e\u0026gt; \u003cvar\u003eX\u003c/var\u003e)\n\u003c/pre\u003e\n\u003cp\u003e\nwhere \u003ccode\u003ev\u003c/code\u003e is a variable name not used in \u003ccode\u003e\u003cvar\u003eX\u003c/var\u003e\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nAn xml-step-expr that starts with an xml-element-descendants-step\n\u003c/p\u003e\n\u003cpre\u003e\n   \u003cvar\u003eE\u003c/var\u003e /**/\u0026lt; \u003cvar\u003eNP\u003c/var\u003e \u0026gt; \u003cvar\u003eX\u003c/var\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nis equivalent to\n\u003c/p\u003e\n\u003cpre\u003e\n   xml:map(xml:elements(\u003cvar\u003eE\u003c/var\u003e), v =\u0026gt; xml:getDescendants(v) .\u0026lt;\u003cvar\u003eNP\u003c/var\u003e\u0026gt; \u003cvar\u003eX\u003c/var\u003e)\n\u003c/pre\u003e\n\u003cp\u003e\nwhere \u003ccode\u003ev\u003c/code\u003e is a variable name not used in \u003ccode\u003e\u003cvar\u003eX\u003c/var\u003e\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_6.37\"\u003e6.37 Transactional expression\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"transactional-expr\"\u003etransactional-expr\u003c/span\u003e := \u003ccode\u003etransactional\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003etransactional-expr\u003c/code\u003e evaluates to true if the expression is being\nevaluated in transaction mode and false otherwise.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch2 id=\"actions_statements\"\u003e7. Actions and statements\u003c/h2\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_7.1\"\u003e7.1 Actions\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"action\"\u003eaction\u003c/span\u003e :=\n   \u003ca href=\"#start-action\"\u003e\u003cspan class=\"ntref\"\u003estart-action\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#wait-action\"\u003e\u003cspan class=\"ntref\"\u003ewait-action\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#send-action\"\u003e\u003cspan class=\"ntref\"\u003esend-action\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#receive-action\"\u003e\u003cspan class=\"ntref\"\u003ereceive-action\u003c/span\u003e\u003c/a\u003e \n   | \u003ca href=\"#flush-action\"\u003e\u003cspan class=\"ntref\"\u003eflush-action\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#client-remote-method-call-action\"\u003e\u003cspan class=\"ntref\"\u003eclient-remote-method-call-action\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#query-action\"\u003e\u003cspan class=\"ntref\"\u003equery-action\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#type-cast-action\"\u003e\u003cspan class=\"ntref\"\u003etype-cast-action\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#checking-action\"\u003e\u003cspan class=\"ntref\"\u003echecking-action\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#trap-action\"\u003e\u003cspan class=\"ntref\"\u003etrap-action\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#commit-action\"\u003e\u003cspan class=\"ntref\"\u003ecommit-action\u003c/span\u003e\u003c/a\u003e\n   | \u003ccode\u003e(\u003c/code\u003e \u003ca href=\"#action\"\u003e\u003cspan class=\"ntref\"\u003eaction\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e)\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"action-or-expr\"\u003eaction-or-expr\u003c/span\u003e := \u003ca href=\"#action\"\u003e\u003cspan class=\"ntref\"\u003eaction\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"type-cast-action\"\u003etype-cast-action\u003c/span\u003e := \u003ccode\u003e\u0026lt;\u003c/code\u003e \u003ca href=\"#type-cast-param\"\u003e\u003cspan class=\"ntref\"\u003etype-cast-param\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e\u0026gt;\u003c/code\u003e \u003ca href=\"#action\"\u003e\u003cspan class=\"ntref\"\u003eaction\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"checking-action\"\u003echecking-action\u003c/span\u003e := \u003ca href=\"#checking-keyword\"\u003e\u003cspan class=\"ntref\"\u003echecking-keyword\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#action\"\u003e\u003cspan class=\"ntref\"\u003eaction\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"trap-action\"\u003etrap-action\u003c/span\u003e := \u003ccode\u003etrap\u003c/code\u003e \u003ca href=\"#action\"\u003e\u003cspan class=\"ntref\"\u003eaction\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nActions are an intermediate syntactic category between expressions and\nstatements. Actions are similar to expressions, in that they yield a value.\nHowever, an action cannot be nested inside an expression; it can only occur as\npart of a statement or nested inside other actions. This is because actions are\nshown in the sequence diagram in the graphical syntax.\n\u003c/p\u003e\n\u003cp\u003e\nThe syntax for actions is defined by the above grammar and precedence rules. The\nprecedence rules are that a client-remote-method-call-action has higher\nprecedence than a checking-action or a trap-action.\n\u003c/p\u003e\n\u003cp\u003e\nAn action is evaluated in the same way as an expression. Static typing for\nactions is the same as for expressions.\n\u003c/p\u003e\n\u003cp\u003e\nA \u003ccode\u003etype-cast-action\u003c/code\u003e, \u003ccode\u003echecking-action\u003c/code\u003e or\n\u003ccode\u003etrap-action\u003c/code\u003e is evaluated in the same way as a\n\u003ccode\u003etype-cast-expr\u003c/code\u003e, \u003ccode\u003echecking-expr\u003c/code\u003e or\n\u003ccode\u003etrap-expr\u003c/code\u003e respectively.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_7.2\"\u003e7.2 Threads and strands\u003c/h3\u003e\n\n\u003cp\u003e\nBallerina's concurrency model supports both threads and coroutines. A Ballerina\nprogram is executed on one or more threads. A thread may run on a separate core\nsimultaneously with other threads, or may be pre-emptively multitasked with\nother threads onto a single core.\n\u003c/p\u003e\n\u003cp\u003e\nEach thread is divided into one or more \u003cem\u003estrands\u003c/em\u003e. No two strands\nbelonging to the same thread can run simultaneously. Instead, all the strands\nbelonging to a particular thread are cooperatively multitasked. Strands within\nthe same thread thus behave as coroutines relative to each other. A strand\nenables cooperative multitasking by \u003cem\u003eyielding\u003c/em\u003e. When a strand yields,\nthe runtime scheduler may suspend execution of the strand, and switch its thread\nto executing another strand. The following actions cause a strand to yield:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eworker-receive-action\u003c/li\u003e\n\u003cli\u003ewait-action\u003c/li\u003e\n\u003cli\u003eflush-action\u003c/li\u003e\n\u003cli\u003esync-send-action\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIn addition, any function with an external-function-body can potentially yield;\nit should only do so if it performs a system call that would block or calls a\nBallerina function that itself yields. The `sleep` function in\n\u003ccode\u003elang.runtime\u003c/code\u003e will make the strand yield. Other functions in the\nlang library do not themselves yield, although if they call a function passed as\nan argument, that function may result in yielding.\n\u003c/p\u003e\n\u003cp\u003e\nThere are two language constructs whose execution causes the creation of new\nstrands: named-worker-decl and start-action. These constructs may use\nannotations to indicate that the newly created strand should be in a separate\nthread from the current strand. In the absence of such annotations, the new\nstrand must be part of the same thread as the current strand.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_7.3\"\u003e7.3 Function bodies\u003c/h3\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_7.3.1\"\u003e7.3.1 Function parameters\u003c/h4\u003e\n\u003cp\u003e\nBefore the block-function-body of a function-defn is executed, the parameters\ndeclared in the function-signature of the function-defn are initialized from the\nargument list that was constructed by the function-call-expr. The non-rest\nparameters are initialized from the arguments in the argument list in order. The\nconformance of the argument list to the param-list declared for the function\nensures that each parameter will be initialized to a value that belongs to the\ndeclared type of the parameter. If there is a rest-param, then that is a\ninitialized to a newly created list containing the remaining arguments in the\nargument-list; the inherent type of this list will be T[] where T is the type of\nthe rest-param. The conformance of the argument list ensures that the members of\nthis list will belong to type T.\n\u003c/p\u003e\n\u003cp\u003e\nThe parameters are in scope for the block-function-body. They are implicitly\nfinal: they can be read but not modified.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_7.3.2\"\u003e7.3.2 Workers\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"block-function-body\"\u003eblock-function-body\u003c/span\u003e :=\n   \u003ccode\u003e{\u003c/code\u003e [\u003ca href=\"#default-worker-init\"\u003e\u003cspan class=\"ntref\"\u003edefault-worker-init\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#named-worker-decl\"\u003e\u003cspan class=\"ntref\"\u003enamed-worker-decl\u003c/span\u003e\u003c/a\u003e+] \u003ca href=\"#default-worker\"\u003e\u003cspan class=\"ntref\"\u003edefault-worker\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e}\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"default-worker-init\"\u003edefault-worker-init\u003c/span\u003e := \u003ca href=\"#statement\"\u003e\u003cspan class=\"ntref\"\u003estatement\u003c/span\u003e\u003c/a\u003e*\n\u003cspan class=\"ntdfn\" id=\"default-worker\"\u003edefault-worker\u003c/span\u003e := \u003ca href=\"#statement\"\u003e\u003cspan class=\"ntref\"\u003estatement\u003c/span\u003e\u003c/a\u003e*\n\u003cspan class=\"ntdfn\" id=\"named-worker-decl\"\u003enamed-worker-decl\u003c/span\u003e :=\n   [\u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e] [\u003ca href=\"#transactional-qual\"\u003e\u003cspan class=\"ntref\"\u003etransactional-qual\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003eworker\u003c/code\u003e \u003ca href=\"#worker-name\"\u003e\u003cspan class=\"ntref\"\u003eworker-name\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#return-type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003ereturn-type-descriptor\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#statement-block\"\u003e\u003cspan class=\"ntref\"\u003estatement-block\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"worker-name\"\u003eworker-name\u003c/span\u003e := \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA worker represents a single strand of a function invocation. A statement\nis always executed in the context of a current worker. A worker is in one of\nthree states: active, inactive or terminated. When a worker is in the\nterminated state, it has a termination value. A worker terminates either\nnormally or abnormally. An abnormal termination results from a panic, and in\nthis case the termination value is always an error. If the termination value of\na normal termination is an error, then the worker is said to have terminated\nwith failure; otherwise the worker is said to have terminated with success. Note\nthat an error termination value resulting from a normal termination is\ndistinguished from an error termination value resulting from an abnormal\ntermination.\n\u003c/p\u003e\n\u003cp\u003e\nA function always has a single default worker, which is unnamed. The strand for\na function's default worker is the same as the strand of the worker on which\nfunction was called. When a function is called, the current worker becomes\ninactive, and a default worker for the called function is started. When the\ndefault worker terminates, the function returns to its caller, and the caller's\nworker is reactivated. Thus only one worker in each strand is active at any\ngiven time. If a function's default worker terminates normally, then its\ntermination value provides the return value of the function. If a function's\ndefault worker terminates abnormally, then the evaluation of the function call\nexpression completes abruptly with a panic and the worker's termination value\nprovides the associated value for the abrupt completion of the function call.\nThe function's return type is the same as the return type of the function's\ndefault worker.\n\u003c/p\u003e\n\u003cp\u003e\nA function also has zero or more named workers. Each named worker runs on its\nown new strand. The termination of a function is independent of the termination\nof its named workers. The termination of a named worker does not automatically\nresult in the termination of its function. When a function's default worker\nterminates, causing the function to terminate, the function does not\nautomatically wait for the termination of its named workers.\n\u003c/p\u003e\n\u003cp\u003e\nA named worker has a return type. If the worker terminates normally, the\ntermination value will belong to the return type. If the return type of a worker\nis not specified, it defaults to nil as for functions.\n\u003c/p\u003e\n\u003cp\u003e\nA named-worker is a transactional scope only if it is declared as\n\u003ccode\u003etransactional\u003c/code\u003e. This is allowed only if the block-function-body is a\ntransactional scope, i.e. if it is the body of a function declared as\n\u003ccode\u003etransactional\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nWhen a function has named workers, the function's default worker executes in\nthree stages, as follows:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe statements in default-worker-init are executed.\u003c/li\u003e\n\u003cli\u003eAll the named workers are started. Each named worker executes its\nstatement-block on its strand.\u003c/li\u003e\n\u003cli\u003eThe statements in default-worker are executed. This happens without waiting\nfor the termination of the named workers started in stage 2.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\nParameters and variables declared in default-worker-init are in scope within\nnamed workers, whereas variables declared in default-worker are not.\n\u003c/p\u003e\n\u003cp\u003e\nThe execution of a worker's statements may result in the execution of a\nstatement that causes the worker to terminate. For example, a return statement\ncauses the worker to terminate. If this does not happen, then the worker\nterminates as soon as it has finished executing its statements. In this case,\nthe worker terminates normally, and the termination value is nil. In other\nwords, falling off the end of a worker is equivalent to \u003ccode\u003ereturn;\u003c/code\u003e,\nwhich is in turn equivalent to \u003ccode\u003ereturn ();\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThe scope of a worker-name in a named-worker-decl that is part of a\nblock-function-body is the entire block-function-body with the exception of the\ndefault-worker-init. When a worker-name is in scope, it can be used in a\nvariable-reference-expr. The result of evaluating such a variable reference is a\nfuture value that refers to the value to be returned by that named worker. The\nstatic type of the result is future\u0026lt;T\u0026gt;, where T is the return type of the\nworker.\n\u003c/p\u003e\n\u003cp\u003e\nA strand can initiate a wait on another strand by using a wait-action with a\nvalue of type future. Only one wait on a strand can succeed; this wait receives\nthe value returned by the strand. Any other waits on that strand fail. It is a\ncompile-time error if for any named worker it is possible for the name of that\nworker to be evaluated as a variable-reference more than once for any execution\nof that worker. This ensures that wait operations that use just a worker-name to\nidentify the strand to wait on cannot fail at runtime.\n\u003c/p\u003e\n\u003cp\u003e\nIn the above, function includes method, and function call includes method call.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_7.3.3\"\u003e7.3.3 Expression-bodied functions\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"expr-function-body\"\u003eexpr-function-body\u003c/span\u003e := \u003ccode\u003e=\u0026gt;\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nAn expr-function-body is used for an expression-bodied function, that is a\nfunction whose body is specified by an expression. An expr-function-body of the\nform \u003ccode\u003e=\u0026gt; \u003cvar\u003eE\u003c/var\u003e\u003c/code\u003e is short for a block-function-body \u003ccode\u003e{\nreturn \u003cvar\u003eE\u003c/var\u003e}\u003c/code\u003e.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_7.3.4\"\u003e7.3.4 External functions\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"external-function-body\"\u003eexternal-function-body\u003c/span\u003e := \u003ccode\u003e=\u003c/code\u003e [\u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003eexternal\u003c/code\u003e \n\u003c/pre\u003e\n\n\u003cp\u003e\nAn \u003ccode\u003eexternal-function-body\u003c/code\u003e means that the implementation of the\nfunction is not provided in the Ballerina source module. A function-defn-body\nwith a function-signature that is dependently-typed must be an\nexternal-function-body.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"isolated_functions\"\u003e7.3.5 Isolated functions\u003c/h4\u003e\n\u003cp\u003e\nThe body of a function or method declared as \u003ccode\u003eisolated\u003c/code\u003e must meet the\nfollowing requirements.\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eOnly isolated functions can be called:\n\u003cul\u003e\n\u003cli\u003ein a function-call-expr, the function-reference must refer to a function\nwhose static type is isolated;\u003c/li\u003e\n\u003cli\u003ein a method-call-expr, the method-name must refer to a method or\nfunction whose static type is isolated;\u003c/li\u003e\n\u003cli\u003ein a new-expr or object-constructor-expr, the init method that is called\nmust be declared as isolated (a missing init method is equivalent is implicitly\nisolated).\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eNon-isolated module-level state can only be read in two cases, specifically\na variable-reference can refer to an an identifier declared by a\nmodule-var-decl or listener-decl only if:\n\u003cul\u003e\n\u003cli\u003ethe identifier is declared by a module-var-decl that includes\n\u003ccode\u003efinal\u003c/code\u003e or \u003ccode\u003econfigurable\u003c/code\u003e but does not include\n\u003ccode\u003eisolated\u003c/code\u003e, or is declared by a listener-decl or a service-decl,\nand\u003c/li\u003e\n\u003cli\u003ethe static type of the variable is a subtype of \u003ccode\u003eisolated object\n{}\u003c/code\u003e or of \u003ccode\u003ereadonly\u003c/code\u003e (which will always be the case if the\nidentifier is declared as \u003ccode\u003econfigurable\u003c/code\u003e).\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eNon-isolated module-level state cannot be mutated: an identifier in a\nvariable-reference-lvexpr or in a capture-binding-pattern in a\ndestructuring-assignment-stmt must not refer to a variable defined by a\nmodule-var-decl that does not include \u003ccode\u003eisolated\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eCaptured variables are restricted as follows: if the body is part of an\nanonymous-function-expr, then any captured variable references must refer to\nvariables that are both final (either explicitly or implicitly) and have a\nstatic type that is a subtype of \u003ccode\u003ereadonly|isolated object {}\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eNew workers cannot be started: the following constructs are not allowed\n\u003cul\u003e\n\u003cli\u003enamed-worker-decl\u003c/li\u003e\n\u003cli\u003efork-stmt\u003c/li\u003e\n\u003cli\u003estart-action\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIf an isolated function has an \u003ccode\u003eexternal-function-body\u003c/code\u003e, then the\nabove requirements also apply to the external implementation as regards its\naccess to the mutable state of the Ballerina program, in the sense that it must\nonly access the mutable state that is reachable from the parameters passed to\nthe function. In addition, the function should have well-defined behaviour if it\nis called concurrently on multiple strands.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_7.4\"\u003e7.4 Statement execution\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"statement\"\u003estatement\u003c/span\u003e := \n   \u003ca href=\"#action-stmt\"\u003e\u003cspan class=\"ntref\"\u003eaction-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#local-var-decl-stmt\"\u003e\u003cspan class=\"ntref\"\u003elocal-var-decl-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#xmlns-decl-stmt\"\u003e\u003cspan class=\"ntref\"\u003exmlns-decl-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#assignment-stmt\"\u003e\u003cspan class=\"ntref\"\u003eassignment-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#compound-assignment-stmt\"\u003e\u003cspan class=\"ntref\"\u003ecompound-assignment-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#destructuring-assignment-stmt\"\u003e\u003cspan class=\"ntref\"\u003edestructuring-assignment-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#call-stmt\"\u003e\u003cspan class=\"ntref\"\u003ecall-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#if-else-stmt\"\u003e\u003cspan class=\"ntref\"\u003eif-else-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#regular-compound-stmt\"\u003e\u003cspan class=\"ntref\"\u003eregular-compound-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#continue-stmt\"\u003e\u003cspan class=\"ntref\"\u003econtinue-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#break-stmt\"\u003e\u003cspan class=\"ntref\"\u003ebreak-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#stmt-with-on-fail\"\u003e\u003cspan class=\"ntref\"\u003estmt-with-on-fail\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#fail-stmt\"\u003e\u003cspan class=\"ntref\"\u003efail-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#retry-stmt\"\u003e\u003cspan class=\"ntref\"\u003eretry-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#transaction-stmt\"\u003e\u003cspan class=\"ntref\"\u003etransaction-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#retry-transaction-stmt\"\u003e\u003cspan class=\"ntref\"\u003eretry-transaction-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#rollback-stmt\"\u003e\u003cspan class=\"ntref\"\u003erollback-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#panic-stmt\"\u003e\u003cspan class=\"ntref\"\u003epanic-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#return-stmt\"\u003e\u003cspan class=\"ntref\"\u003ereturn-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#fork-stmt\"\u003e\u003cspan class=\"ntref\"\u003efork-stmt\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe execution of any statement may involve the evaluation of actions and\nexpressions, and the execution of substatements. The following sections\ndescribes how each kind of statement is evaluated, assuming that the evaluation\nof those expressions and actions completes normally, and assuming that the\nexecution of any substatements does not cause termination of the current worker.\nExcept where explicitly stated to the contrary, statements handle abrupt\ncompletion of the evaluation of expressions and actions as follows. There are\ntwo possibilities.\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIf the abrupt termination is a check-fail with associated value e, then\ncontrol flow is transferred as if by a \u003ccode\u003efail-stmt\u003c/code\u003e with an expression\nthat evaluates to e.\u003c/li\u003e\n\u003cli\u003eIf the abrupt termination is a panic with associated value, then the current\nworker is terminated as if by a \u003ccode\u003epanic-stmt\u003c/code\u003e with an expression that\nevaluates to e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIf the execution of a substatement causes termination of the current worker,\nthen the execution of the statement terminates at that point.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\n\u003cspan class=\"ntdfn\" id=\"regular-compound-stmt\"\u003eregular-compound-stmt\u003c/span\u003e :=\n  \u003ca href=\"#do-stmt\"\u003e\u003cspan class=\"ntref\"\u003edo-stmt\u003c/span\u003e\u003c/a\u003e\n  | \u003ca href=\"#match-stmt\"\u003e\u003cspan class=\"ntref\"\u003ematch-stmt\u003c/span\u003e\u003c/a\u003e\n  | \u003ca href=\"#foreach-stmt\"\u003e\u003cspan class=\"ntref\"\u003eforeach-stmt\u003c/span\u003e\u003c/a\u003e\n  | \u003ca href=\"#while-stmt\"\u003e\u003cspan class=\"ntref\"\u003ewhile-stmt\u003c/span\u003e\u003c/a\u003e\n  | \u003ca href=\"#lock-stmt\"\u003e\u003cspan class=\"ntref\"\u003elock-stmt\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003eregular-compound-stmt\u003c/code\u003e can be combined with an\n\u003ccode\u003eon-fail-clause\u003c/code\u003e to make a \u003ccode\u003estmt-with-on-fail\u003c/code\u003e.\n\u003c/p\u003e\n\u003cpre class=\"grammar\"\u003e\n\u003cspan class=\"ntdfn\" id=\"statement-block\"\u003estatement-block\u003c/span\u003e := \u003ccode\u003e{\u003c/code\u003e \u003ca href=\"#statement\"\u003e\u003cspan class=\"ntref\"\u003estatement\u003c/span\u003e\u003c/a\u003e* \u003ccode\u003e}\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003estatement-block\u003c/code\u003e is a syntactic grouping of statements, which are\nexecuted sequentially.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\n\u003csection\u003e\n\u003ch3 id=\"section_7.5\"\u003e7.5 Fork statement\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"fork-stmt\"\u003efork-stmt\u003c/span\u003e := \u003ccode\u003efork\u003c/code\u003e \u003ccode\u003e{\u003c/code\u003e \u003ca href=\"#named-worker-decl\"\u003e\u003cspan class=\"ntref\"\u003enamed-worker-decl\u003c/span\u003e\u003c/a\u003e+ \u003ccode\u003e}\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe fork statement starts one or more named workers, which run in parallel with\neach other, each in its own new strand.\n\u003c/p\u003e\n\u003cp\u003e\nVariables and parameters in scope for the fork-stmt remain in scope within the\nworkers (similar to the situation with parameters and workers in a function\nbody).\n\u003c/p\u003e\n\u003cp\u003e\nThe scope of the worker-name in a named-worker-decl that is part of a fork-stmt\nconsists of both other workers in the same fork-stmt and the block containing\nthe fork-stmt starting from the point immediately after the fork-stmt. Within\nits scope, the worker-name can be used in a variable-reference-expr in the same\nway as the worker-name of a named-worker-decl that is part of a\nblock-function-body.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_7.6\"\u003e7.6 Start action\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"start-action\"\u003estart-action\u003c/span\u003e := [\u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003estart\u003c/code\u003e (\u003ca href=\"#function-call-expr\"\u003e\u003cspan class=\"ntref\"\u003efunction-call-expr\u003c/span\u003e\u003c/a\u003e|\u003ca href=\"#method-call-expr\"\u003e\u003cspan class=\"ntref\"\u003emethod-call-expr\u003c/span\u003e\u003c/a\u003e|\u003ca href=\"#client-remote-method-call-action\"\u003e\u003cspan class=\"ntref\"\u003eclient-remote-method-call-action\u003c/span\u003e\u003c/a\u003e)\n\u003c/pre\u003e\n\n\u003cp\u003e\nThe keyword \u003ccode\u003estart\u003c/code\u003e causes the following function or method\ninvocation to be executed on a new strand. The arguments for the function or\nmethod call are evaluation on the current strand. A start-action returns a value\nof basic type future immediately. If the static type of the call expression or\naction \u003ccode\u003e\u003cvar\u003eC\u003c/var\u003e\u003c/code\u003e is T, then the static type of \u003ccode\u003estart\n\u003cvar\u003eC\u003c/var\u003e\u003c/code\u003e is future\u0026lt;T\u0026gt;; it is permitted for T to be\n\u003ccode\u003enever\u003c/code\u003e.\n\u003c/p\u003e\n\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_7.7\"\u003e7.7 Wait action\u003c/h3\u003e\n\u003cp\u003e\nA wait-action waits for one or more strands to terminate, and gives access to\ntheir termination values.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"wait-action\"\u003ewait-action\u003c/span\u003e :=\n   \u003ca href=\"#single-wait-action\"\u003e\u003cspan class=\"ntref\"\u003esingle-wait-action\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#multiple-wait-action\"\u003e\u003cspan class=\"ntref\"\u003emultiple-wait-action\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#alternate-wait-action\"\u003e\u003cspan class=\"ntref\"\u003ealternate-wait-action\u003c/span\u003e\u003c/a\u003e\n\n\u003cspan class=\"ntdfn\" id=\"wait-future-expr\"\u003ewait-future-expr\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003cem\u003ebut not\u003c/em\u003e \u003ca href=\"#mapping-constructor-expr\"\u003e\u003cspan class=\"ntref\"\u003emapping-constructor-expr\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA wait-future-expr is used by a wait-action to refer to the worker to be waited\nfor. Its static type must be future\u0026lt;T\u0026gt; for some T. As elsewhere, a\nwait-future-expr can use an in-scope worker-name in a variable-reference-expr to\nrefer to named worker.\n\u003c/p\u003e\n\u003cp\u003e\nEvaluation of a wait-action performs a wait operation on the future value that\nresults from evaluating a wait-future-expr. This wait operation may complete\nnormally or abruptly. The wait operation initiates a wait for the strand that\nthe future refers to. If the wait fails, then the wait operation completes\nnormally and the result is an error. If the wait succeeds, and the strand\ncompleted normally, then the wait operation completes normally, and the result\nis the termination value of the strand. If the wait succeeds, but the strand\ncompleted abnormally, then the wait operation completes abruptly with a panic\nand the associated value is the termination value of the strand.\n\u003c/p\u003e\n\u003cp\u003e\nIn addition to a static type, a wait-future-expr has a compile-time \u003cem\u003eeventual\ntype\u003c/em\u003e. If a wait-future-expr is a variable-reference-expr referring to the\nworker-name of a named worker with return type T, then the eventual type of the\nwait-future-expr is T. Otherwise, the eventual of a wait-future-expr with static\ntype future\u0026lt;T\u0026gt; is T|error. The result of a wait operation that completes\nnormally will belong to the eventual type of the wait-future-expr, since the\ncompiler ensures that a wait for a wait-future-expr that is a variable reference\nto a named worker cannot fail.\n\u003c/p\u003e\n\u003cp\u003e\nNote that it is only possible to wait for a named worker, which will start its\nown strand. It is not possible to wait for a function's default worker, which\nruns on an existing strand.\n\u003c/p\u003e\n\u003cp\u003e\nA mapping-constructor-expr is not recognized as a wait-future-expr (it would not\ntype-check in any case).\n\u003c/p\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_7.7.1\"\u003e7.7.1 Single wait action\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"single-wait-action\"\u003esingle-wait-action\u003c/span\u003e := \u003ccode\u003ewait\u003c/code\u003e \u003ca href=\"#wait-future-expr\"\u003e\u003cspan class=\"ntref\"\u003ewait-future-expr\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA single-wait-action waits for a single future.\n\u003c/p\u003e\n\u003cp\u003e\nA single-wait-action is evaluated by first evaluating wait-future-expr resulting\nin a value f of basic type future; the single-wait-action then performs a wait\noperation on f.\n\u003c/p\u003e\n\u003cp\u003e\nThe static type of the single-wait-action is the eventual type of the\nwait-future-expr.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_7.7.2\"\u003e7.7.2 Multiple wait action\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"multiple-wait-action\"\u003emultiple-wait-action\u003c/span\u003e := \u003ccode\u003ewait\u003c/code\u003e \u003ccode\u003e{\u003c/code\u003e \u003ca href=\"#wait-field\"\u003e\u003cspan class=\"ntref\"\u003ewait-field\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#wait-field\"\u003e\u003cspan class=\"ntref\"\u003ewait-field\u003c/span\u003e\u003c/a\u003e)* \u003ccode\u003e}\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"wait-field\"\u003ewait-field\u003c/span\u003e :=\n  \u003ca href=\"#variable-name\"\u003e\u003cspan class=\"ntref\"\u003evariable-name\u003c/span\u003e\u003c/a\u003e\n  | \u003ca href=\"#field-name\"\u003e\u003cspan class=\"ntref\"\u003efield-name\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e:\u003c/code\u003e \u003ca href=\"#wait-future-expr\"\u003e\u003cspan class=\"ntref\"\u003ewait-future-expr\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA multiple-wait-action waits for multiple futures, returning the result as a\nrecord.\n\u003c/p\u003e\n\u003cp\u003e\nA wait-field that is a variable-name \u003ccode\u003ev\u003c/code\u003e is equivalent to a\nwait-field \u003ccode\u003ev: v\u003c/code\u003e, where \u003ccode\u003ev\u003c/code\u003e must be the name of an\nin-scope named worker.\n\u003c/p\u003e\n\u003cp\u003e\nA multiple-wait-action is evaluated by evaluating each wait-future-expr\nresulting in a value of type future for each wait-field. The\nmultiple-wait-action then performs a wait operation on all of these futures. If\nall the wait operations complete normally, then it constructs a record with a\nfield for each wait-field, whose name is the field-name and whose value is the\nresult of the wait operation. If any of the wait operations complete abruptly,\nthen the multiple-wait-action completes abruptly.\n\u003c/p\u003e\n\u003cp\u003e\nThe static type of the multiple-wait-action is a record where the static type of\neach field is the eventual type of the corresponding wait-future-expr.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_7.7.3\"\u003e7.7.3 Alternate wait action \u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"alternate-wait-action\"\u003ealternate-wait-action\u003c/span\u003e := \u003ccode\u003ewait\u003c/code\u003e \u003ca href=\"#wait-future-expr\"\u003e\u003cspan class=\"ntref\"\u003ewait-future-expr\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e|\u003c/code\u003e \u003ca href=\"#wait-future-expr\"\u003e\u003cspan class=\"ntref\"\u003ewait-future-expr\u003c/span\u003e\u003c/a\u003e)+\n\u003c/pre\u003e\n\u003cp\u003e\nAn alternate-wait-action waits for one of multiple futures to terminate.\n\u003c/p\u003e\n\u003cp\u003e\nAn alternate-wait-action is evaluated by first evaluating each wait-future-expr,\nresulting in a set of future values. The alternate-wait-action then performs a\nwait operation on all of these members of this set. As soon as one of the wait\noperations completes normally with a non-error value v, the\nalternate-wait-action completes normally with result v. If all of the wait\noperations complete normally with an error, then it completes normally with\nresult e, where e is the result of the last wait operation to complete. If any\nof the wait operations completely abruptly before the alternate-wait-action\ncompletes, then the alternate-wait-action completes abruptly.\n\u003c/p\u003e\n\u003cp\u003e\nThe static type of the alternate-wait-action is the union of the eventual type\nof all of its wait-future-exprs.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_7.8\"\u003e7.8 Worker message passing\u003c/h3\u003e\n\u003cp\u003e\nMessages can be sent between workers.\n\u003c/p\u003e\n\u003cp\u003e\nSends and receives are matched up at compile-time. This allows the connection\nbetween the send and the receive to be shown in the sequence diagram. It is also\nguarantees that any sent message will be received, provided that neither the\nsending nor the receiving worker terminate abnormally or with an error.\n\u003c/p\u003e\n\u003cp\u003e\nMessages can only be sent between workers that are peers of each other. A\nfunction's default worker and its named workers are peers of each other. The\nworkers created in a fork-stmt are also peers of each other. The workers created\nin a fork-stmt are not peers of a function's default worker nor of its named\nworkers.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"peer-worker\"\u003epeer-worker\u003c/span\u003e := \u003ca href=\"#worker-name\"\u003e\u003cspan class=\"ntref\"\u003eworker-name\u003c/span\u003e\u003c/a\u003e | \u003ccode\u003efunction\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA worker-name refers to a worker named in a named-worker-decl, which must be in\nscope; \u003ccode\u003efunction\u003c/code\u003e refers to the function's default worker. The\nreferenced worker must be a peer worker.\n\u003c/p\u003e\n\u003cp\u003e\nEach worker maintains a separate logical queue for each peer worker to which it\nsends messages; a sending worker sends a message by adding it to the queue; a\nreceiving worker receives a message by removing it from the sending worker's\nqueue for that worker; messages are removed in the order in which they were\nadded to the queue.\n\u003c/p\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_7.8.1\"\u003e7.8.1 Send action\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"send-action\"\u003esend-action\u003c/span\u003e := \u003ca href=\"#sync-send-action\"\u003e\u003cspan class=\"ntref\"\u003esync-send-action\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#async-send-action\"\u003e\u003cspan class=\"ntref\"\u003easync-send-action\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"sync-send-action\"\u003esync-send-action\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e-\u0026gt;\u0026gt;\u003c/code\u003e \u003ca href=\"#peer-worker\"\u003e\u003cspan class=\"ntref\"\u003epeer-worker\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"async-send-action\"\u003easync-send-action\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e-\u0026gt;\u003c/code\u003e \u003ca href=\"#peer-worker\"\u003e\u003cspan class=\"ntref\"\u003epeer-worker\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA send-action sends a message to the worker that is identified by peer-worker. A\nsend-action starts by evaluating the expression, resulting in a value\n\u003ccode\u003e\u003cvar\u003ev\u003c/var\u003e\u003c/code\u003e; the Clone abstract operation is then applied to\n\u003ccode\u003e\u003cvar\u003ev\u003c/var\u003e\u003c/code\u003e resulting in value \u003ccode\u003e\u003cvar\u003ec\u003c/var\u003e\u003c/code\u003e. This\nvalue \u003ccode\u003e\u003cvar\u003ec\u003c/var\u003e\u003c/code\u003e is added to the message queue maintained by the\nsending worker for messages to be sent to the sending worker;this queue\ncontinues to exist even if the receiving worker has already terminated.\n\u003c/p\u003e\n\u003cp\u003e\nFor each send-action S, the compiler determines a unique corresponding\nreceive-action R, such that a message sent by S will be received by R, unless\nR's worker has terminated abnormally or with failure. It is a compile-time error\nif this cannot be done. The compiler determines a \u003cem\u003efailure type\u003c/em\u003e for the\ncorresponding receive-action. If the receive-action was not executed and its\nworker terminated normally, then the termination value of the worker will belong\nto the failure type. The failure type will be a (possibly empty) subtype of\nerror.\n\u003c/p\u003e\n\u003cp\u003e\nThe difference between async-send-action and sync-send-action is in what happens\nafter the message is added to the queue. The evaluation of async-send-action\ncompletes immediately after this, and the result is always \u003ccode\u003e()\u003c/code\u003e. A\nsubsequent flush action can be used to check whether the message was received.\nWith sync-send-action, evaluation waits until the receiving worker either\nexecutes a receive action that receives the queued message or terminates. The\nevaluation of sync-send-action completes as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eif the queued message was received, then normally with result nil;\u003c/li\u003e\n\u003cli\u003eotherwise\n\u003cul\u003e\n\u003cli\u003eif the receiving worker terminated with failure, then normally with the\nresult being the the termination value of the receiving worker, which will be an\nerror;\u003c/li\u003e\n\u003cli\u003eif the receiving worker terminated abnormally, then abruptly with a panic,\nwith the associated value being the termination value of the receiving worker.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe static type of the sync-send-action is F|() where F is the failure type of\nthe corresponding receive action. If F is empty, then this static type will be\nequivalent to ().\n\u003c/p\u003e\n\u003cp\u003e\nThe static type of the \u003ccode\u003eexpression\u003c/code\u003e must be a subtype of\n\u003ccode\u003evalue:Cloneable\u003c/code\u003e. The contextually expected type used to interpret\n\u003ccode\u003eexpression\u003c/code\u003e is the contextually expected type from the corresponding\nreceive-action.\n\u003c/p\u003e\n\u003cp\u003e\nIf the receive-action corresponding to an async-send-action has a non-empty\nfailure type, then it is a compile-time error unless it can be determined that a\nsync-send-action or a flush-action will be executed before the sending worker\nterminates with success.\n\u003c/p\u003e\n\u003cp\u003e\nIf a worker W is about to terminate normally and there are messages still to be\nsent in a queue (which must be the result of executing an async-send-action), then\nthe worker waits until the messages have been received or some receiving worker\nterminates. If a receiving worker R terminates without the message being\nreceived, R must have terminated abnormally, because the rule in the preceding\nparagraph. In this case, W terminates abnormally and W will use R's termination\nvalue as its termination value.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_7.8.2\"\u003e7.8.2 Receive action\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"receive-action\"\u003ereceive-action\u003c/span\u003e := \u003ca href=\"#single-receive-action\"\u003e\u003cspan class=\"ntref\"\u003esingle-receive-action\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#multiple-receive-action\"\u003e\u003cspan class=\"ntref\"\u003emultiple-receive-action\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003csection\u003e\n\u003ch5 id=\"section_7.8.2.1\"\u003e7.8.2.1 Single receive action\u003c/h5\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"single-receive-action\"\u003esingle-receive-action\u003c/span\u003e := \u003ccode\u003e\u0026lt;-\u003c/code\u003e \u003ca href=\"#peer-worker\"\u003e\u003cspan class=\"ntref\"\u003epeer-worker\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA single-receive-action receives a message from a single worker.\n\u003c/p\u003e\n\u003cp\u003e\nFor each single-receive-action R receiving from worker W, the compiler\ndetermines a \u003cem\u003ecorresponding send set\u003c/em\u003e. The corresponding send set S is a\nset of send actions in W, such that\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ein any execution of W that terminates successfully, exactly one member of S\nis executed and is executed once only\u003c/li\u003e\n\u003cli\u003eif R is evaluated, it will receive the single message sent by a member of S,\nunless W has terminated abnormally or with failure.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe compiler terminates a failure type for the corresponding send set. If no\nmember of the corresponding send set was evaluated and the sending worker\nterminated normally, then the termination value of the sending worker will\nbelong to the failure type. The failure type will be a (possibly empty) subtype\nof error.\n\u003c/p\u003e\n\u003cp\u003e\nA single-receive-action is evaluated by waiting until there is a message\navailable in the queue or the sending worker terminates.  The evaluation of\nsingle-receive-action completes as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eif a message becomes available in the queue, then the first available\nmessage is removed and the evaluation completes normally with the result being\nthat message;\u003c/li\u003e\n\u003cli\u003eotherwise\n\u003cul\u003e\n\u003cli\u003eif the sending worker terminated with failure, then normally with the result\nbeing the the termination value of the sending worker, which will be an error;\u003c/li\u003e\n\u003cli\u003eif the sending worker terminated abnormally, then abruptly with a panic,\nwith the associated value being the termination value of the sending worker.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe static type of the single-receive-action is T|F where T is the union of the\nstatic type of the expressions in the corresponding send set and F is the\nfailure type of the corresponding send set.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch5 id=\"section_7.8.2.2\"\u003e7.8.2.2 Multiple receive action\u003c/h5\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"multiple-receive-action\"\u003emultiple-receive-action\u003c/span\u003e :=\n   \u003ccode\u003e\u0026lt;-\u003c/code\u003e  \u003ccode\u003e{\u003c/code\u003e \u003ca href=\"#receive-field\"\u003e\u003cspan class=\"ntref\"\u003ereceive-field\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#receive-field\"\u003e\u003cspan class=\"ntref\"\u003ereceive-field\u003c/span\u003e\u003c/a\u003e)* \u003ccode\u003e}\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"receive-field\"\u003ereceive-field\u003c/span\u003e :=\n   \u003ca href=\"#peer-worker\"\u003e\u003cspan class=\"ntref\"\u003epeer-worker\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#field-name\"\u003e\u003cspan class=\"ntref\"\u003efield-name\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e:\u003c/code\u003e \u003ca href=\"#peer-worker\"\u003e\u003cspan class=\"ntref\"\u003epeer-worker\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA multiple-receive-action receives a message from multiple workers.\n\u003c/p\u003e\n\u003cp\u003e\nA peer-worker can occur at most once in a multiple-receive-action.\n\u003c/p\u003e\n\u003cp\u003e\nA receive-field consisting of a peer-worker \u003ccode\u003eW\u003c/code\u003e is equivalent to a\nfield \u003ccode\u003eW:W\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThe compiler determines a corresponding send set for each receive field, in the\nsame way as for a single-receive-action. A multiple-receive-action is evaluated\nby waiting until there is a message available in the queue for every\npeer-worker.  If any of the peer workers W terminate before a message becomes\navailable, then the evaluation of the multiple-receive-action completes as\nfollows\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eif the sending worker terminated with failure, then normally with the result\nbeing the the termination value of the sending worker, which will be an error;\u003c/li\u003e\n\u003cli\u003eif the sending worker terminated abnormally, then abruptly with a panic,\nwith the associated value being the termination value of the sending worker.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nOtherwise, the result of the evaluation of multiple-receive-action completes by\nremoving the first message from each queue and constructing a record with one\nfield for each receive-field, where the value of the record is the message\nreceived.\n\u003c/p\u003e\n\u003cp\u003e\nThe contextually expected typed for the multiple-receive-action determines a\ncontextually expected type for each receive-field, in the same way as for a\nmapping constructor. The contextually expected type for each receive-field\nprovides the contextually expected type for the expression in each member of the\ncorresponding send set.\n\u003c/p\u003e\n\u003cp\u003e\nThe static type of multiple-receive-action is R|F where\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eR is a record type, where R is determined in the same way as for a mapping\nconstructor, where the static type of each field comes from the union of the\nstatic types of the expressions in each member of the corresponding send set and\nthe contextually expected type is the contextually expected type of the\nmultiple-receive-action\u003c/li\u003e\n\u003cli\u003eF is the union of the failure types for the corresponding send set for each\nreceive-field\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_7.8.3\"\u003e7.8.3 Flush action\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"flush-action\"\u003eflush-action\u003c/span\u003e := \u003ccode\u003eflush\u003c/code\u003e [\u003ca href=\"#peer-worker\"\u003e\u003cspan class=\"ntref\"\u003epeer-worker\u003c/span\u003e\u003c/a\u003e]\n\u003c/pre\u003e\n\u003cp\u003e\nIf peer-worker is specified, then flush waits until the queue of messages to be\nreceived by peer-worker is empty or until the peer-worker terminates.\n\u003c/p\u003e\n\u003cp\u003e\nSend-receive correspondence for async-send-action implies that the queue will\neventually become empty, unless the peer-worker terminates abnormally or with\nfailure. The evaluation of flush-action completes as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eif the queue of messages is empty, then normally with result nil;\u003c/li\u003e\n\u003cli\u003eotherwise\n\u003cul\u003e\n\u003cli\u003eif the peer-worker terminated with failure, then normally with the result\nbeing the the termination value of the peer-worker, which will be an error;\u003c/li\u003e\n\u003cli\u003eif the peer-worker terminated abnormally, then abruptly with a panic, with\nthe associated value being the termination value of the peer-worker.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nIf the flush-action has a preceding async-send-action without any intervening\nsync-send-action or other flush-action, then the static type of the flush-action\nis F|(), where F is the failure type of the receive-action corresponding to that\nasync-send-action. Otherwise, the static type of the flush-action is nil.\n\u003c/p\u003e\n\u003cp\u003e\nIf peer-worker is omitted, then the flush-action flushes the queues to all other\nworkers. In this case, the static type will be the union of the static type of\nflush on each worker separately.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_7.8.4\"\u003e7.8.4 Send-receive correspondence\u003c/h4\u003e\n\u003cp\u003e\nThis section provides further details about how compile-time correspondence is\nestablished between sends and receive. This is based on the concept of the index\nof a message in its queue: a message has index n in its queue if it is the nth\nmessage added to the queue during the current execution of the worker.\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eA send action/statement has index i in its queue if the message that it adds\nto the queue is always the i-th message added to the queue during the execution\nof its worker. It is a compile time error if a send statement or action does not\nhave an index in its queue.\u003c/li\u003e\n\u003cli\u003eA receive action has index i in a queue if any message that it removes from\nthe queue is always the i-th message removed from the queue during the execution\nof its worker. It is a compile time error if a receive action does not have an\nindex in each of its queues.\u003c/li\u003e\n\u003cli\u003eA send action/statement and a receive action correspond if they have the\nsame index in a queue.\u003c/li\u003e\n\u003cli\u003eIt is a compile time error if two or more receive actions have the same\nindex in a queue.\u003c/li\u003e\n\u003cli\u003eA send action/statement is in the same send set as another send\naction/statement if they have the same index in a queue. It is allowed for a\nsend set to have more than one member.\u003c/li\u003e\n\u003cli\u003eThe maximum index that a receive action has in a queue must be the same as\nthe maximum index that a send action or statement has in that queue.\u003c/li\u003e\n\u003cli\u003eIt is a compile time error if it is possible for a worker to terminate with\nsuccess before it has executed all its receive actions.\u003c/li\u003e\n\u003cli\u003eIt is a compile time error if it is possible for a worker to terminate with\nsuccess before it has executed one member from every send set.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_7.9\"\u003e7.9 Outbound network interaction\u003c/h3\u003e\n\n\u003cp\u003e\nA client object is a stub that allows a worker to send network messages to a\nremote system according to some protocol. A local variable declared with client\nobject type will be depicted as a lifeline in the function's sequence diagram.\nThe remote methods of the client object correspond to distinct network messages\ndefined by the protocol for the role played by the client object. The return\nvalue of a remote method represents the protocol's response. A\nclient-remote-method-call-action is depicted as a horizontal arrow from the\nworker lifeline to the client object lifeline.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"client-remote-method-call-action\"\u003eclient-remote-method-call-action\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e-\u0026gt;\u003c/code\u003e \u003ca href=\"#method-name\"\u003e\u003cspan class=\"ntref\"\u003emethod-name\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e(\u003c/code\u003e \u003ca href=\"#arg-list\"\u003e\u003cspan class=\"ntref\"\u003earg-list\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e)\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nCalls a remote method of a client object. This works the same as a method call\nexpression, except that it is used for a client object method with the\n\u003ccode\u003eremote\u003c/code\u003e qualifier.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_7.10\"\u003e7.10 Query action\u003c/h3\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"query-action\"\u003equery-action\u003c/span\u003e := \u003ca href=\"#query-pipeline\"\u003e\u003cspan class=\"ntref\"\u003equery-pipeline\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#do-clause\"\u003e\u003cspan class=\"ntref\"\u003edo-clause\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"do-clause\"\u003edo-clause\u003c/span\u003e := \u003ccode\u003edo\u003c/code\u003e \u003ca href=\"#statement-block\"\u003e\u003cspan class=\"ntref\"\u003estatement-block\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe clauses in the query-pipeline of query-action are executed in the same way\nas the clauses in the query-pipeline of a query-expr.\n\u003c/p\u003e\n\u003cp\u003e\nThe query-action is executed as follows. For each input frame \u003cvar\u003ef\u003c/var\u003e\nemitted by the query-pipeline, execute the statement-block with \u003cvar\u003ef\u003c/var\u003e in\nscope. If a clause in the query-pipeline completes early with error\n\u003cvar\u003ee\u003c/var\u003e, the result of the query-action is \u003cvar\u003ee\u003c/var\u003e. Otherwise, the\nresult of the query-action is nil.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_7.11\"\u003e7.11 Local variable declaration statements\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"local-var-decl-stmt\"\u003elocal-var-decl-stmt\u003c/span\u003e :=\n   \u003ca href=\"#local-init-var-decl-stmt\"\u003e\u003cspan class=\"ntref\"\u003elocal-init-var-decl-stmt\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#local-no-init-var-decl-stmt\"\u003e\u003cspan class=\"ntref\"\u003elocal-no-init-var-decl-stmt\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"local-init-var-decl-stmt\"\u003elocal-init-var-decl-stmt\u003c/span\u003e :=\n   [\u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e] [\u003ccode\u003efinal\u003c/code\u003e] \u003ca href=\"#typed-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003etyped-binding-pattern\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e=\u003c/code\u003e \u003ca href=\"#action-or-expr\"\u003e\u003cspan class=\"ntref\"\u003eaction-or-expr\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003elocal-var-decl-stmt\u003c/code\u003e is used to declare variables with a scope\nthat is local to the block in which they occur.\n\u003c/p\u003e\n\u003cp\u003e\nThe scope of variables declared in a \u003ccode\u003elocal-var-decl-stmt\u003c/code\u003e starts\nimmediately after the statement and continues to the end of the statement block\nin which it occurs.\n\u003c/p\u003e\n\u003cp\u003e\nA local-init-var-decl-stmt is executed by evaluating the action-or-expr\nresulting in a value, and then matching the typed-binding-pattern to the value,\ncausing assignments to the variables occurring in the typed-binding-pattern. The\ntyped-binding-pattern is used unconditionally, meaning that it is a compile\nerror if the static types do not guarantee the success of the match. If the\ntyped-binding-pattern uses \u003ccode\u003evar\u003c/code\u003e, then the type of the variables is\ninferred from the static type of the action-or-expr; if the\nlocal-init-var-decl-stmt includes final, the precise type is used, and otherwise\nthe broad type is used. If the typed-binding-pattern specifies a\ntype-descriptor, then that type-descriptor provides the contextually expected\ntype for action-or-expr.\n\u003c/p\u003e\n\u003cp\u003e\nIf \u003ccode\u003efinal\u003c/code\u003e is specified, then the variables declared must not be\nassigned to outside the local-init-var-decl-stmt.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"local-no-init-var-decl-stmt\"\u003elocal-no-init-var-decl-stmt\u003c/span\u003e :=\n   [\u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e] [\u003ccode\u003efinal\u003c/code\u003e] \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#variable-name\"\u003e\u003cspan class=\"ntref\"\u003evariable-name\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA local variable declared \u003ccode\u003elocal-no-init-var-decl-stmt\u003c/code\u003e must be\ndefinitely assigned at each point that the variable is referenced. This means\nthat the compiler must be able to verify that the local variable will have been\nassigned before that point. If \u003ccode\u003efinal\u003c/code\u003e is specified, then the\nvariable must not be assigned more than once. The \u003ccode\u003etype-descriptor\u003c/code\u003e\nmust not be \u003ccode\u003enever\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"conditional_variable_type_narrowing\"\u003e7.12 Conditional variable type narrowing\u003c/h3\u003e\n\u003cp\u003e\nUsually the type of a reference to a variable is determined by the variable's\ndeclaration, either explicitly specified by a type descriptor or inferred from\nthe static type of the initializer. However, the language also recognizes two\nkinds of case where the way a local variable or parameter is used means that is\nknown at compile-time that within a particular region of code the value of the\nvariable will belong to a type that is narrower than the declared type. In these\ncases, references to the variable within particular regions of code will have a\nstatic type that is narrower that the variable type. One kind of case, which is\ndescribed in this section, is when a variable is used in a boolean expression in\na conditional context. The other kind of case is when a variable is used in a\nmatch statement; this is described in the \u003ca href=\"#match_statement\"\u003eMatch\nstatement\u003c/a\u003e section.\n\u003c/p\u003e\n\u003cp\u003e\nType narrowing makes use of the \u003cem\u003eread-only difference\u003c/em\u003e between two types,\nwhich is defined as follows. We use the notation T\nâ\u003csub\u003e\u003cem\u003ero\u003c/em\u003e\u003c/sub\u003e S for the read-only difference of T and S. T\nâ\u003csub\u003e\u003cem\u003ero\u003c/em\u003e\u003c/sub\u003e S is computed separately for each uniform type.\nLet T\u003csup\u003eU\u003c/sup\u003e be the subset of T belonging to uniform type U, i.e. the\nintersection of T and U. For a uniform type U that is immutable, T\u003csup\u003eU\u003c/sup\u003e\nâ\u003csub\u003e\u003cem\u003ero\u003c/em\u003e\u003c/sub\u003e S\u003csup\u003eU\u003c/sup\u003e is the same as T\u003csup\u003eU\u003c/sup\u003e -\nS\u003csup\u003eU\u003c/sup\u003e (set difference); for a uniform type U that is mutable,\nT\u003csup\u003eU\u003c/sup\u003e â\u003csub\u003e\u003cem\u003ero\u003c/em\u003e\u003c/sub\u003e S\u003csup\u003eU\u003c/sup\u003e is empty if\nT\u003csup\u003eU\u003c/sup\u003e is a subset of S\u003csup\u003eU\u003c/sup\u003e, and T\u003csup\u003eU\u003c/sup\u003e otherwise. T\nâ\u003csub\u003e\u003cem\u003ero\u003c/em\u003e\u003c/sub\u003e S is the union for every uniform type U of\nT\u003csup\u003eU\u003c/sup\u003e â\u003csub\u003e\u003cem\u003ero\u003c/em\u003e\u003c/sub\u003e S\u003csup\u003eU\u003c/sup\u003e. This definition of\nread-only difference ensures that if a value x belongs to T but not does not\nbelong to S, then x belongs to T â\u003csub\u003e\u003cem\u003ero\u003c/em\u003e\u003c/sub\u003e S.\n\u003c/p\u003e\n\u003cp\u003e\nGiven an expression E with static type boolean, and a variable x with static\ntype Tx, we define how to determine\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ea narrowed type for x implied by truth of E and\u003c/li\u003e\n\u003cli\u003ea narrowed type for x implied by falsity of E\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nbased on the syntactic form of E as follows.\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIf E has the form x is T, then\n\u003cul\u003e\n\u003cli\u003ethe narrowed type for x implied by truth of E is the intersection of Tx and\nT\u003c/li\u003e\n\u003cli\u003ethe narrowed type for x implied by falsity of E is Tx\nâ\u003csub\u003e\u003cem\u003ero\u003c/em\u003e\u003c/sub\u003e T\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eIf E has the form x == E1 or E1 == x where the static type of E1 is an\nexpression whose static type is a singleton simple type T1, then\n\u003cul\u003e\n\u003cli\u003ethe narrowed type for x implied by truth of E is the intersection of Tx and\nT1\u003c/li\u003e\n\u003cli\u003ethe narrowed type for x implied by falsity of E is Tx\nâ\u003csub\u003e\u003cem\u003ero\u003c/em\u003e\u003c/sub\u003e T1\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eIf E has the form x != E1 or E1 != x where the static type of E1 is an\nexpression whose static type is a singleton simple type T1, then\n\u003cul\u003e\n\u003cli\u003ethe narrowed type for x implied by truth of E is Tx\nâ\u003csub\u003e\u003cem\u003ero\u003c/em\u003e\u003c/sub\u003e T1\u003c/li\u003e\n\u003cli\u003ethe narrowed type for x implied by falsity of E is the intersection of Tx\nand T1\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eIf E has the form !E1, then\n\u003cul\u003e\n\u003cli\u003ethe narrowed type for x implied by truth of E is the narrowed type for x\nimplied by falsity of E1\u003c/li\u003e\n\u003cli\u003ethe narrowed type for x implied by falsity of E is the narrowed type for x\nimplied by truth of E1\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eIf E has the form E1 \u0026amp;\u0026amp; E2\n\u003cul\u003e\n\u003cli\u003ethe narrowed type for x implied by truth of E is the intersection of T1 and\nT2, where T1 is the narrowed type for x implied by the truth of T1 and T2 is the\nnarrowed type for x implied by the truth of T2\u003c/li\u003e\n\u003cli\u003ethe narrowed type for x implied by falsity of E is T1|T2, where T1 is the\nnarrowed type for x implied by the falsity of E1, and T2 is the intersection of\nT3 and T4, where T3 is the narrowed type for x implied by the truth of E1 and T4\nis the narrowed type for x implied by the falsity of E2\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eIf E has the form E1 || E2, then\n\u003cul\u003e\n\u003cli\u003e the narrowed type for x implied by truth of E is T1|T2, where T1 is the\nnarrowed type for x implied by the truth of E1, and T2 is the intersection of T3\nand T4, where T3 is the narrowed type for x implied by the falsity of E1 and T4\nis the narrowed type for x implied by the truth of E2\u003c/li\u003e\n\u003cli\u003ethe narrowed type for x implied by falsity of E is the intersection of T1\nand T2, where T1 is narrowed type for x implied by the falsity of E1 and T2 is\nthe narrowed type for x implied by the falsity of E2\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eIf E has any other form, then\n\u003cul\u003e\n\u003cli\u003ethe narrowed type for x implied by the truth of E is Tx\u003c/li\u003e\n\u003cli\u003ethe narrowed type for x implied by the falsity of E is Tx\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nNarrowed types apply to regions of code as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ein an expression E1 || E2, the narrowed types implied by the falsity of E1\napply within E2\u003c/li\u003e\n\u003cli\u003ein an expression E1 \u0026amp;\u0026amp; E2, the narrowed types implied by the truth of E1\napply within E2\u003c/li\u003e\n\u003cli\u003ein an expression E1 ? E2 : E3, the narrowed types implied by the truth of E1\napply within E2 and the narrowed types implied by the falsity of E1 apply within\nE3\u003c/li\u003e\n\u003cli\u003ein a statement if E1 { B1 } else { B2 }, the narrowed types implied by the\ntruth of E1 apply within B1 and the narrowed types implied by the falsity of E1\napply within E2\u003c/li\u003e\n\u003cli\u003ein a match-clause P if E =\u0026gt; { B }, the narrowed types implied by the truth\nof E apply within B\u003c/li\u003e\n\u003cli\u003ethe narrowed type for a variable x no longer applies as soon as there is a\npossibility of x being assigned to\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"XML_namespace_declaration_statement\"\u003e7.13 XML namespace declaration statement\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"xmlns-decl-stmt\"\u003exmlns-decl-stmt\u003c/span\u003e := \u003ca href=\"#xmlns-decl\"\u003e\u003cspan class=\"ntref\"\u003exmlns-decl\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"xmlns-decl\"\u003exmlns-decl\u003c/span\u003e := \u003ccode\u003exmlns\u003c/code\u003e \u003ca href=\"#xml-namespace-uri\"\u003e\u003cspan class=\"ntref\"\u003exml-namespace-uri\u003c/span\u003e\u003c/a\u003e [ \u003ccode\u003eas\u003c/code\u003e \u003ca href=\"#xml-namespace-prefix\"\u003e\u003cspan class=\"ntref\"\u003exml-namespace-prefix\u003c/span\u003e\u003c/a\u003e ] \u003ccode\u003e;\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"xml-namespace-uri\"\u003exml-namespace-uri\u003c/span\u003e := \u003ca href=\"#simple-const-expr\"\u003e\u003cspan class=\"ntref\"\u003esimple-const-expr\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"xml-namespace-prefix\"\u003exml-namespace-prefix\u003c/span\u003e := \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nAn \u003ccode\u003exmlns-decl\u003c/code\u003e is used to declare a XML namespace. If there is\nan \u003ccode\u003exml-namespace-prefix\u003c/code\u003e, then the in-scope namespaces that are used\nto perform namespace processing on an \u003ccode\u003exml-template-expr\u003c/code\u003e will include a\nbinding of that prefix to the specified \u003ccode\u003exml-namespace-uri\u003c/code\u003e;\notherwise the in-scope namespaces will include a default namespace with the\nspecified \u003ccode\u003exml-namespace-uri\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nAn \u003ccode\u003exml-namespace-prefix\u003c/code\u003e declared by an \u003ccode\u003exmlns-decl\u003c/code\u003e\nis in the same symbol space as a \u003ccode\u003emodule-prefix\u003c/code\u003e declared by an\n\u003ccode\u003eimport-decl\u003c/code\u003e. This symbol space is distinct from a module's main\nsymbol space used by other declarations. An \u003ccode\u003exmlns-decl\u003c/code\u003e in a\n\u003ccode\u003exmlns-decl-stmt\u003c/code\u003e declares the prefix within the scope of the current\nblock.\n\u003c/p\u003e\n\u003cp\u003e\nThe prefix \u003ccode\u003exmlns\u003c/code\u003e is predeclared as\n\u003ccode\u003ehttp://www.w3.org/2000/xmlns/\u003c/code\u003e and cannot be redeclared.\n\u003c/p\u003e\n\u003cp\u003e\nThe static type of the \u003ccode\u003esimple-const-expr\u003c/code\u003e must be a subtype of\nstring.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_7.14\"\u003e7.14 Assignment\u003c/h3\u003e\n\n\u003cp\u003e\nThere are three kinds of assignment statement:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ean ordinary assignment statement, which is usually called simply an\nassignment statement,\u003c/li\u003e\n\u003cli\u003ea compound assignment statement, and\u003c/li\u003e\n\u003cli\u003ea destructuring assignment statement.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe first two of these build on the concept of an \u003cem\u003elvalue\u003c/em\u003e, whereas the\nlast one builds on the concept of a binding pattern.\n\u003c/p\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_7.14.1\"\u003e7.14.1 Lvalues\u003c/h4\u003e\n\n\u003cp\u003e\nAn lvalue is what the left hand side of an assignment evaluates to. An lvalue\nrefers to a storage location which is one of the following:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ea variable;\u003c/li\u003e\n\u003cli\u003ea specific named field of an object;\u003c/li\u003e\n\u003cli\u003ethe member of a structured value having a specific out-of-line key, which\nwill be either an integer or a string according as the structured value is a\nlist or a mapping.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nNote that an lvalue cannot refer to a member of a table.\n\u003c/p\u003e\n\n\u003cp\u003e\nAn lvalue that is both defined and initialized refers to a storage location that\nholds a value:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ean lvalue referring to a variable is always defined but may be\nuninitialized;\u003c/li\u003e\n\u003cli\u003ean lvalue referring to a specific named field of an object is always defined\nbut may not be initialized until the \u003ccode\u003einit\u003c/code\u003e method returns\u003c/li\u003e\n\u003cli\u003ean lvalue referring to member of a structured value having a specific key is\nundefined if the structured value does not have a member with that key; if such an\nlvalue is defined, it is also initialized; note that an lvalue always refers to\na structured value that is already constructed.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"lvexpr\"\u003elvexpr\u003c/span\u003e :=\n   \u003ca href=\"#variable-reference-lvexpr\"\u003e\u003cspan class=\"ntref\"\u003evariable-reference-lvexpr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#field-access-lvexpr\"\u003e\u003cspan class=\"ntref\"\u003efield-access-lvexpr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#member-access-lvexpr\"\u003e\u003cspan class=\"ntref\"\u003emember-access-lvexpr\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nThe left hand side of an assignment is syntactically a restricted type of\nexpression, called an lvexpr. When the evaluation of an lvexpr completes\nnormally, its result is an lvalue. The evaluation of an lvexpr can also complete\nabruptly, with a panic or check-fail, just as with the evaluation of an\nexpression.\n\u003c/p\u003e\n\u003cp\u003e\nThe compiler determines a static type for each lvexpr just as it does for\nexpressions, but the meaning is slightly different. For an lvexpr L to have\nstatic type T means that if the runtime evaluation of L completes normally\nresulting in an lvalue x, then if x is defined and initialized, it refers to a\nstorage location that holds a value belonging to type T. In addition to a type,\nthe compiler determines for each lvexpr whether it is potentially undefined and\nwhether it is potentially uninitialized.\n\u003c/p\u003e\n\u003cp\u003e\nAn lvalue supports three operations: store, read and filling-read.\n\u003c/p\u003e\n\u003cp\u003e\nThe fundamental operation on an lvalue is to store a value in the storage\nlocation it refers to. This operation does not required the lvalue to be defined\nor initialized; a successful store operation on an undefined lvalue will result\nin the addition of a member to the structured value; a store on an uninitialized lvalue\nwill initialize it. When an lvalue refers to a variable, it is possible to\ndetermine at compile-time whether the store of a value is permissible based on\nthe declaration of the variable and the static type of the value to be stored.\nHowever, when the lvalue refers to a member of a structured value, this is not in\ngeneral possible for three reasons.\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe guarantee provided by an lvalue having a static type T is not that the\nreferenced storage location can hold every value that belongs to type T; rather\nthe guarantee is that every value that the referenced storage location can hold\nbelongs to type T. This is because structured types are covariant in their\nmember types. The values that the storage location can actually hold are\ndetermined by the inherent type of the structured value.\u003c/li\u003e\n\u003cli\u003eThe member may not be defined and the inherent type of the structured value may not\nallow a member with that specific key. The permissible keys of a structured value can\nbe constrained by closed record types, fixed-length array types, and tuple types\n(with any rest descriptor).\u003c/li\u003e\n\u003cli\u003eThe structured value may be immutable. The static type of an lvalue referring to a\nmember of a structured value makes no guaranteees that the structured value is not immutable.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\nThe first of these reasons also applies to lvalues that refer to fields of\nobjects. Accordingly, stores to lvalues other than lvalues that refer to\nvariables must be verified at runtime to ensure that they are not impermissible\nfor any of the above three reasons. An attempt to perform an impermissible store\nresults in a panic at runtime.\n\u003c/p\u003e\n\u003cp\u003e\nList values maintain the invariant that there is a unique integer n, the length\nof the list, such that a member k of the list is defined if and only if k is a\nnon-negative integer less than n. When a store is performed on an lvalue\nreferring to a member k of a list value and the length of the list is n and k is\n\u0026gt; n, then each member with index i for each â¤ i \u0026lt; k is filled in, by\nusing the FillMember abstract operation. The FillMember abstract operation may\nfail; in particular it will fail if the list is a fixed-length array. If the\nFillMember operation fails, then the attempt to store will panic.\n\u003c/p\u003e\n\u003cp\u003e\nAn lvalue also allows a read operation, which is used by the compound assignment\nstatement. Unlike a store operation, a read operation cannot result in a runtime\npanic. A read operation cannot be performed on an lvalue that is undefined or\nuninitialized.\n\u003c/p\u003e\n\u003cp\u003e\nFinally, a lvalue supports a filling-read operation, which is used to support\nchained assignment. A filling-read is performed only an lvalue with a static\ntype that is a structured type. It differs from a read operation only when it is\nperformed on a potentially undefined lvalue. If the lvalue is undefined at\nruntime, then the filling-read will use the FillMember abstract operation on the\nmember that the lvalue refers to. If the FillMember operation fails, then the\nfilling-read panics. Unlike the read operation, the filling-read operation can\nbe performed on an undefined lvalue; it cannot, however, be performed on an\nuninitialized lvalue.\n\u003c/p\u003e\n\u003cp\u003e\nThe evaluation of an lvexpr is specified in terms of the evaluation of its\nsubexpressions, the evaluation of its sub-lvexprs, and store and\nfilling-read operations on lvalues. If any of these result in a panic, then\nthe evaluation of the lvexpr completes abruptly with a panic.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"variable-reference-lvexpr\"\u003evariable-reference-lvexpr\u003c/span\u003e := \u003ca href=\"#variable-reference\"\u003e\u003cspan class=\"ntref\"\u003evariable-reference\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe result of evaluating variable-reference-lvexpr is an lvalue referring to a\nvariable. Its static type is the declared or inferred type of the variable. The\nlvexpr is potentially uninitialized if it is possible for execution to have\nreached this point without initializing the referenced variable.\n\u003c/p\u003e\n\u003cp\u003e\nA variable-reference-lvexpr that refers to a variable declared by a\nmodule-var-decl that includes \u003ccode\u003eisolated\u003c/code\u003e is only allowed within a\nlock-stmt.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"field-access-lvexpr\"\u003efield-access-lvexpr\u003c/span\u003e := \u003ca href=\"#lvexpr\"\u003e\u003cspan class=\"ntref\"\u003elvexpr\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e.\u003c/code\u003e \u003ca href=\"#field-name\"\u003e\u003cspan class=\"ntref\"\u003efield-name\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nThe static type of lvexpr must be either a subtype of the mapping basic type\nor a subtype of the object basic type.\n\u003c/p\u003e\n\u003cp\u003e\nIn the case where the static type of lvexpr is a subtype of the object basic\ntype, the object type must have a field with the specified name, and the\nresulting lvalue refers to that object field.\n\u003c/p\u003e\n\u003cp\u003e\nIn the case where the static type of lvexpr is a subtype of the mapping basic\ntype, the semantics are as follows.\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe following requirements apply at compile time: the type of lvexpr must\ninclude mapping shapes that have the specified field-name; type descriptor for\nlvexpr must include \u003ccode\u003efield-name\u003c/code\u003e as an individual-field-descriptor (if\nlvexpr is a union, then this requirement applies to every member of the union);\nlvexpr must not be potentially uninitialized, but may be potentially\nundefined.\u003c/li\u003e\n\u003cli\u003e\nIt is evaluated as follows:\n\u003col\u003e\n\u003cli\u003eevaluate lvexpr to get lvalue \u003cvar\u003elv\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eperform a filling-read operation on \u003cvar\u003elv\u003c/var\u003e to get mapping value\n\u003cvar\u003em\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003ethe result is an lvalue referring to the member of \u003cvar\u003em\u003c/var\u003e with the\nspecified field-name.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eThe static type of the field-access-expr is the member type for the key type\nK in T, where T is the static type of the lvexpr and K is the singleton string\ntype containing the field-name; the field-access-expr is potentially undefined\nif K is an optional key type for T.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"member-access-lvexpr\"\u003emember-access-lvexpr\u003c/span\u003e := \u003ca href=\"#lvexpr\"\u003e\u003cspan class=\"ntref\"\u003elvexpr\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e[\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e]\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe static type of lvexpr must be either a subtype of the mapping basic type or\na subtype of the list basic type. In the former case, the contextually expected\ntype of expression must be string and it is an error if the static type of\nexpression is not string; in the latter case, the contextually expected type of\nexpression must be int and it is an error if the static type of expression is\nnot int.\n\u003c/p\u003e\n\u003cp\u003e\nIt is evaluated as follows:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eevaluate expression to get a string or int \u003cvar\u003ek\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eevaluate lvexpr to get lvalue \u003cvar\u003elv\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eperform a filling-read operation on \u003cvar\u003elv\u003c/var\u003e to get a list or mapping value\n\u003cvar\u003ev\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003ethe result is an lvalue referring to the member of \u003cvar\u003ec\u003c/var\u003e with key\n\u003cvar\u003ek\u003c/var\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\nThe static type of the member-access-lvexpr is the member type for the key type K\nin T, where T is the static type of the lvexpr and K is the static type type of\nexpression; the member-access-lvexpr is potentially undefined if K is an optional\nkey type for T.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_7.14.2\"\u003e7.14.2 Assignment statement\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"assignment-stmt\"\u003eassignment-stmt\u003c/span\u003e := \u003ca href=\"#lvexpr\"\u003e\u003cspan class=\"ntref\"\u003elvexpr\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e=\u003c/code\u003e \u003ca href=\"#action-or-expr\"\u003e\u003cspan class=\"ntref\"\u003eaction-or-expr\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe static type of action-or-expr must be a subtype of the static type of\nlvexpr. The static type of lvexpr provides the contextually expected type for\naction-or-expr. It is not an error for lvexpr to be potentially undefined or\npotentially uninitialized.\n\u003c/p\u003e\n\u003cp\u003e\nIt is executed at as follows:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eexecute action-or-expr to get a value \u003cvar\u003ev\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eevaluate lvexpr to get an lvalue \u003cvar\u003elv\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eperform the store operation of \u003cvar\u003elv\u003c/var\u003e with value \u003cvar\u003ev\u003c/var\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_7.14.3\"\u003e7.14.3 Compound assignment statement\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"compound-assignment-stmt\"\u003ecompound-assignment-stmt\u003c/span\u003e := \u003ca href=\"#lvexpr\"\u003e\u003cspan class=\"ntref\"\u003elvexpr\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#CompoundAssignmentOperator\"\u003e\u003cspan class=\"ntref\"\u003eCompoundAssignmentOperator\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#action-or-expr\"\u003e\u003cspan class=\"ntref\"\u003eaction-or-expr\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"CompoundAssignmentOperator\"\u003eCompoundAssignmentOperator\u003c/span\u003e := \u003ca href=\"#BinaryOperator\"\u003e\u003cspan class=\"ntref\"\u003eBinaryOperator\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e=\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"BinaryOperator\"\u003eBinaryOperator\u003c/span\u003e := \u003ccode\u003e+\u003c/code\u003e | \u003ccode\u003e-\u003c/code\u003e | \u003ccode\u003e*\u003c/code\u003e | \u003ccode\u003e/\u003c/code\u003e | \u003ccode\u003e\u0026amp;\u003c/code\u003e | \u003ccode\u003e|\u003c/code\u003e | \u003ccode\u003e^\u003c/code\u003e | \u003ccode\u003e\u0026lt;\u0026lt;\u003c/code\u003e | \u003ccode\u003e\u0026gt;\u0026gt;\u003c/code\u003e | \u003ccode\u003e\u0026gt;\u0026gt;\u0026gt;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nIt is a compile error if lvexpr is potentially undefined unless the static type\nof lvexpr is a subtype of the list basic type. It is a compile error if lvexpr\nis potentially uninitialized.\n\u003c/p\u003e\n\u003cp\u003e\nLet T1 be the static type of lvexpr, and let T2 be the static type of\naction-expr. Then let T3 be the static type of an expression E1 BinaryOp E2\nwhere E1 has type T1 and E2 has type T2. It is a compile error if T3 is not a\nsubtype of T1.\n\u003c/p\u003e\n\u003cp\u003e\nIt is executed as follows:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eexecute action-or-expr to get a value \u003cvar\u003ev2\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eevaluate lvexpr to get an lvalue \u003cvar\u003elv\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eif \u003cvar\u003elv\u003c/var\u003e is undefined, panic (\u003cvar\u003elv\u003c/var\u003e must refer to an\nundefined member of a list)\u003c/li\u003e\n\u003cli\u003eperform the read operation on \u003cvar\u003elv\u003c/var\u003e to get a value\n\u003cvar\u003ev1\u003c/var\u003e\n\u003c/li\u003e\n\u003cli\u003eperform the operation specified by BinaryOperator on operands \u003cvar\u003ev1\u003c/var\u003e\nand \u003cvar\u003ev2\u003c/var\u003e, resulting in a value \u003cvar\u003ev3\u003c/var\u003e\n\u003c/li\u003e\n\u003cli\u003eperform the store operation on \u003cvar\u003elv\u003c/var\u003e with value \u003cvar\u003ev3\u003c/var\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_7.14.4\"\u003e7.14.4 Destructuring assignment statement\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"destructuring-assignment-stmt\"\u003edestructuring-assignment-stmt\u003c/span\u003e :=\n   \u003ca href=\"#binding-pattern-not-variable-reference\"\u003e\u003cspan class=\"ntref\"\u003ebinding-pattern-not-variable-reference\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e=\u003c/code\u003e \u003ca href=\"#action-or-expr\"\u003e\u003cspan class=\"ntref\"\u003eaction-or-expr\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"binding-pattern-not-variable-reference\"\u003ebinding-pattern-not-variable-reference\u003c/span\u003e :=\n   \u003ca href=\"#wildcard-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003ewildcard-binding-pattern\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#list-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003elist-binding-pattern\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#mapping-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003emapping-binding-pattern\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#error-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003eerror-binding-pattern\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA destructuring assignment is executed by evaluating the action-or-expr\nresulting in a value v, and then matching the binding pattern to v, causing\nassignments to the variables occurring in the binding pattern.\n\u003c/p\u003e\n\u003cp\u003e\nThe binding-pattern has a static type implied by the static type of the\nvariables occurring in it. The static type of action-or-expr must be a subtype\nof this type.\n\u003c/p\u003e\n\u003cp\u003e\nA binding pattern within a destructuring assignment must not refer to a variable\ndeclared by a module-var-decl that includes \u003ccode\u003eisolated\u003c/code\u003e.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_7.15\"\u003e7.15 Action statement\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"action-stmt\"\u003eaction-stmt\u003c/span\u003e := \u003ca href=\"#action\"\u003e\u003cspan class=\"ntref\"\u003eaction\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nAn action-stmt is a statement that is executed by evaluating an action and\ndiscarding the resulting value, which must be nil. It is a compile-time error if\nthe static type of an action in an action-stmt is not nil.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_7.16\"\u003e7.16 Call statement\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"call-stmt\"\u003ecall-stmt\u003c/span\u003e := \u003ca href=\"#call-expr\"\u003e\u003cspan class=\"ntref\"\u003ecall-expr\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"call-expr\"\u003ecall-expr\u003c/span\u003e :=\n   \u003ca href=\"#function-call-expr\"\u003e\u003cspan class=\"ntref\"\u003efunction-call-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#method-call-expr\"\u003e\u003cspan class=\"ntref\"\u003emethod-call-expr\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#checking-keyword\"\u003e\u003cspan class=\"ntref\"\u003echecking-keyword\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#call-expr\"\u003e\u003cspan class=\"ntref\"\u003ecall-expr\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA call-stmt is executed by evaluating call-expr as an expression and discarding\nthe resulting value, which must be nil. The static type of the call-expr in an\ncall-stmt must be a subtype of nil; it is permitted to be \u003ccode\u003enever\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_7.17\"\u003e7.17 Conditional statement\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"if-else-stmt\"\u003eif-else-stmt\u003c/span\u003e :=\n   \u003ccode\u003eif\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#statement-block\"\u003e\u003cspan class=\"ntref\"\u003estatement-block\u003c/span\u003e\u003c/a\u003e \n   [ \u003ccode\u003eelse\u003c/code\u003e \u003ccode\u003eif\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#statement-block\"\u003e\u003cspan class=\"ntref\"\u003estatement-block\u003c/span\u003e\u003c/a\u003e ]* \n   [ \u003ccode\u003eelse\u003c/code\u003e \u003ca href=\"#statement-block\"\u003e\u003cspan class=\"ntref\"\u003estatement-block\u003c/span\u003e\u003c/a\u003e ]\n\u003c/pre\u003e\n\u003cp\u003e\nThe if-else statement is used for conditional execution.\n\u003c/p\u003e\n\u003cp\u003e\nThe static type of the expression following \u003ccode\u003eif\u003c/code\u003e must be boolean.\nWhen an expression is true then the corresponding statement block is executed\nand the if statement completes. If no expression is true then, if the else block\nis present, the corresponding statement block is executed.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_7.18\"\u003e7.18 Do statement\u003c/h3\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"do-stmt\"\u003edo-stmt\u003c/span\u003e := \u003ccode\u003edo\u003c/code\u003e \u003ca href=\"#statement-block\"\u003e\u003cspan class=\"ntref\"\u003estatement-block\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003edo-stmt\u003c/code\u003e is executed by executing its\n\u003ccode\u003estatement-block\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"match_statement\"\u003e7.19 Match statement\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"match-stmt\"\u003ematch-stmt\u003c/span\u003e := \u003ccode\u003ematch\u003c/code\u003e \u003ca href=\"#action-or-expr\"\u003e\u003cspan class=\"ntref\"\u003eaction-or-expr\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e{\u003c/code\u003e \u003ca href=\"#match-clause\"\u003e\u003cspan class=\"ntref\"\u003ematch-clause\u003c/span\u003e\u003c/a\u003e+ \u003ccode\u003e}\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"match-clause\"\u003ematch-clause\u003c/span\u003e :=\n  \u003ca href=\"#match-pattern-list\"\u003e\u003cspan class=\"ntref\"\u003ematch-pattern-list\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#match-guard\"\u003e\u003cspan class=\"ntref\"\u003ematch-guard\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003e=\u0026gt;\u003c/code\u003e \u003ca href=\"#statement-block\"\u003e\u003cspan class=\"ntref\"\u003estatement-block\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"match-guard\"\u003ematch-guard\u003c/span\u003e := \u003ccode\u003eif\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA match statement selects a statement block to execute based on which patterns a\nvalue matches.\n\u003c/p\u003e\n\u003cp\u003e\nA match-stmt is executed as follows:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003ethe expression is evaluated resulting in some value v;\u003c/li\u003e\n\u003cli\u003efor each match-clause in order:\n\u003col\u003e\n\u003cli\u003ea match of match-pattern-list against v is attempted\u003c/li\u003e\n\u003cli\u003eif the attempted match fails, the execution of the match-stmt continues to\nthe next match-clause\u003c/li\u003e\n\u003cli\u003eif the attempted match succeeds, then the variables in match-pattern are\ncreated\u003c/li\u003e\n\u003cli\u003eif there is a match-guard, then the expression in match-guard is executed\nresulting in a value b\u003c/li\u003e\n\u003cli\u003eif b is false, then the execution of the match-stmt continues to the next\nmatch-clause\u003c/li\u003e\n\u003cli\u003eotherwise, the statement-block in the match-clause is executed\u003c/li\u003e\n\u003cli\u003eexecution of the match-stmt completes\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\nThe scope of any variables created in a match-pattern-list of a match-clause is\nboth the match-guard, if any, and the statement-block in that match-clause. The\nstatic type of the expression in match-guard must be a subtype of boolean.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"match-pattern-list\"\u003ematch-pattern-list\u003c/span\u003e := \n  \u003ca href=\"#match-pattern\"\u003e\u003cspan class=\"ntref\"\u003ematch-pattern\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e|\u003c/code\u003e \u003ca href=\"#match-pattern\"\u003e\u003cspan class=\"ntref\"\u003ematch-pattern\u003c/span\u003e\u003c/a\u003e)*\n\u003c/pre\u003e\n\u003cp\u003e\nA match-pattern-list can be matched against a value. An attempted match can\nsucceed or fail. A match-pattern-list is matched against a value by attempting\nto match each match-pattern until a match succeeds.\n\u003c/p\u003e\n\u003cp\u003e\nAll the match-patterns in a given match-pattern-list must bind the same set of\nvariables.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"match-pattern\"\u003ematch-pattern\u003c/span\u003e :=\n  \u003ccode\u003evar\u003c/code\u003e \u003ca href=\"#binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003ebinding-pattern\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#wildcard-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003ewildcard-match-pattern\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#const-pattern\"\u003e\u003cspan class=\"ntref\"\u003econst-pattern\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#list-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003elist-match-pattern\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#mapping-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003emapping-match-pattern\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#error-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003eerror-match-pattern\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA match-pattern combines the destructuring done by a binding-pattern with the\nability to match a constant value.\n\u003c/p\u003e\n\u003cp\u003e\nNote that an identifier can be interpreted in two different ways within a\nmatch-pattern:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ein the scope of a \u003ccode\u003evar\u003c/code\u003e, an identifier names a variable which is\nto be bound to a part of the matched value when a pattern match succeeds;\u003c/li\u003e\n\u003cli\u003eoutside the scope of a var, an identifier references a constant that a value\nmust match for the pattern match to succeed.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nA match-pattern must be linear: a variable that is to be bound cannot occur more\nthan once in a match-pattern.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"const-pattern\"\u003econst-pattern\u003c/span\u003e := \u003ca href=\"#simple-const-expr\"\u003e\u003cspan class=\"ntref\"\u003esimple-const-expr\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA const-pattern denotes a single value. Matching a const-pattern denoting a\nvalue p against a value v succeeds if DeepEquals(p,v) is true. The static type\nof the simple-const-expr in a const-pattern must be a subtype of anydata.\nSuccessfully matching a const-pattern does not cause any variables to be\ncreated.\n\u003c/p\u003e\n\u003cp\u003e\nMatching a wildcard-match-pattern against a value succeeds if the value belongs to\ntype any, in other words if the basic type of the value is not error.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"wildcard-match-pattern\"\u003ewildcard-match-pattern\u003c/span\u003e := \u003ccode\u003e_\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"list-match-pattern\"\u003elist-match-pattern\u003c/span\u003e := \u003ccode\u003e[\u003c/code\u003e \u003ca href=\"#list-member-match-patterns\"\u003e\u003cspan class=\"ntref\"\u003elist-member-match-patterns\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e]\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"list-member-match-patterns\"\u003elist-member-match-patterns\u003c/span\u003e :=\n   \u003ca href=\"#match-pattern\"\u003e\u003cspan class=\"ntref\"\u003ematch-pattern\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#match-pattern\"\u003e\u003cspan class=\"ntref\"\u003ematch-pattern\u003c/span\u003e\u003c/a\u003e)* [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#rest-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003erest-match-pattern\u003c/span\u003e\u003c/a\u003e]\n   | [ \u003ca href=\"#rest-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003erest-match-pattern\u003c/span\u003e\u003c/a\u003e ]\n\u003cspan class=\"ntdfn\" id=\"mapping-match-pattern\"\u003emapping-match-pattern\u003c/span\u003e := \u003ccode\u003e{\u003c/code\u003e \u003ca href=\"#field-match-patterns\"\u003e\u003cspan class=\"ntref\"\u003efield-match-patterns\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e}\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"field-match-patterns\"\u003efield-match-patterns\u003c/span\u003e :=\n   \u003ca href=\"#field-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003efield-match-pattern\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#field-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003efield-match-pattern\u003c/span\u003e\u003c/a\u003e)* [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#rest-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003erest-match-pattern\u003c/span\u003e\u003c/a\u003e]\n   | [ \u003ca href=\"#rest-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003erest-match-pattern\u003c/span\u003e\u003c/a\u003e ] \n\u003cspan class=\"ntdfn\" id=\"field-match-pattern\"\u003efield-match-pattern\u003c/span\u003e := \u003ca href=\"#field-name\"\u003e\u003cspan class=\"ntref\"\u003efield-name\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e:\u003c/code\u003e \u003ca href=\"#match-pattern\"\u003e\u003cspan class=\"ntref\"\u003ematch-pattern\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"rest-match-pattern\"\u003erest-match-pattern\u003c/span\u003e := \u003ccode\u003e...\u003c/code\u003e \u003ccode\u003evar\u003c/code\u003e \u003ca href=\"#variable-name\"\u003e\u003cspan class=\"ntref\"\u003evariable-name\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"error-match-pattern\"\u003eerror-match-pattern\u003c/span\u003e := \u003ccode\u003eerror\u003c/code\u003e [\u003ca href=\"#error-type-reference\"\u003e\u003cspan class=\"ntref\"\u003eerror-type-reference\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003e(\u003c/code\u003e \u003ca href=\"#error-arg-list-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003eerror-arg-list-match-pattern\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e)\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"error-arg-list-match-pattern\"\u003eerror-arg-list-match-pattern\u003c/span\u003e :=\n   \u003ca href=\"#error-message-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003eerror-message-match-pattern\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#error-cause-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003eerror-cause-match-pattern\u003c/span\u003e\u003c/a\u003e] [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#error-field-match-patterns\"\u003e\u003cspan class=\"ntref\"\u003eerror-field-match-patterns\u003c/span\u003e\u003c/a\u003e]\n   | [\u003ca href=\"#error-field-match-patterns\"\u003e\u003cspan class=\"ntref\"\u003eerror-field-match-patterns\u003c/span\u003e\u003c/a\u003e]\n\u003cspan class=\"ntdfn\" id=\"error-message-match-pattern\"\u003eerror-message-match-pattern\u003c/span\u003e := \u003ca href=\"#simple-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003esimple-match-pattern\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"error-cause-match-pattern\"\u003eerror-cause-match-pattern\u003c/span\u003e := \u003ca href=\"#simple-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003esimple-match-pattern\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#error-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003eerror-match-pattern\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"simple-match-pattern\"\u003esimple-match-pattern\u003c/span\u003e :=\n   \u003ca href=\"#wildcard-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003ewildcard-match-pattern\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#const-pattern\"\u003e\u003cspan class=\"ntref\"\u003econst-pattern\u003c/span\u003e\u003c/a\u003e\n   | \u003ccode\u003evar\u003c/code\u003e \u003ca href=\"#variable-name\"\u003e\u003cspan class=\"ntref\"\u003evariable-name\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"error-field-match-patterns\"\u003eerror-field-match-patterns\u003c/span\u003e :=\n   \u003ca href=\"#named-arg-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003enamed-arg-match-pattern\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#named-arg-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003enamed-arg-match-pattern\u003c/span\u003e\u003c/a\u003e)* [\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#rest-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003erest-match-pattern\u003c/span\u003e\u003c/a\u003e]\n   | \u003ca href=\"#rest-match-pattern\"\u003e\u003cspan class=\"ntref\"\u003erest-match-pattern\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"named-arg-match-pattern\"\u003enamed-arg-match-pattern\u003c/span\u003e := \u003ca href=\"#arg-name\"\u003e\u003cspan class=\"ntref\"\u003earg-name\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e=\u003c/code\u003e \u003ca href=\"#match-pattern\"\u003e\u003cspan class=\"ntref\"\u003ematch-pattern\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nMatching a \u003ccode\u003emapping-match-pattern\u003c/code\u003e against a mapping value succeeds\nif and only every \u003ccode\u003efield-match-pattern\u003c/code\u003e matches against a field of\nthe value. The variable in the \u003ccode\u003erest-match-pattern\u003c/code\u003e, if specified, is\nbound to a new mapping that contains just the fields for which that did not\nmatch a \u003ccode\u003efield-match-pattern\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nFor every match pattern, there is a set of shapes that the pattern matches. The\ntype corresponding to the match pattern is the type containing these shapes. The\nvalue matches the pattern if and only if it looks like the type. A mutable value\nthus can match the pattern without belonging to the corresponding type. However,\nan immutable value that matches the pattern will always belong to the type.\nIn particular, for the match of an \u003ccode\u003eerror-match-pattern\u003c/code\u003e with an\n\u003ccode\u003eerror-type-reference\u003c/code\u003e against an error value to succeed, the\nerror value must belong to the referenced error type.\n\u003c/p\u003e\n\u003cp\u003e\nA variable is the \u003cem\u003ematched variable\u003c/em\u003e of a \u003ccode\u003ematch-stmt\u003c/code\u003e if\nthe \u003ccode\u003eaction-or-expression\u003c/code\u003e following \u003ccode\u003ematch\u003c/code\u003e is a\n\u003ccode\u003evariable-reference\u003c/code\u003e that references this variable. The type of a\nmatched variable is subject to narrowing within regions of the\n\u003ccode\u003ematch-stmt\u003c/code\u003e as follows. The matched variable has a narrowed\ntype at the start of each match-clause, which is determined by previous\n\u003ccode\u003ematch-clause\u003c/code\u003es; the type for the first \u003ccode\u003ematch-clause\u003c/code\u003e is\nthe normal static type of the variable. Narrowing is applied to each\n\u003ccode\u003ematch-clause\u003c/code\u003e as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003elet \u003cvar\u003eT\u003c/var\u003e be the narrowed type of the matched variable at the start\nof the match-clause;\u003c/li\u003e\n\u003cli\u003elet \u003cvar\u003eP\u003c/var\u003e be the union of the corresponding types of each\n\u003ccode\u003ematch-pattern\u003c/code\u003e in the \u003ccode\u003ematch-pattern-list\u003c/code\u003e of the\n\u003ccode\u003ematch-clause\u003c/code\u003e;\u003c/li\u003e\n\u003cli\u003elet \u003cvar\u003eN\u003c/var\u003e be the intersection of \u003cvar\u003eT\u003c/var\u003e and\n\u003cvar\u003eP\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003elet \u003cvar\u003eR\u003c/var\u003e be the set difference of \u003cvar\u003eT\u003c/var\u003e and\n\u003cvar\u003eP\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eif \u003cvar\u003eN\u003c/var\u003e is a subtype of \u003ccode\u003ereadonly\u003c/code\u003e, then the narrowed\ntype for the \u003ccode\u003ematch-guard\u003c/code\u003e, if any, and \u003ccode\u003estatement-block\u003c/code\u003e\nof the \u003ccode\u003ematch-clause\u003c/code\u003e is \u003cvar\u003eN\u003c/var\u003e; otherwise it is\n\u003cvar\u003eT\u003c/var\u003e;\u003c/li\u003e\n\u003cli\u003eif there is a match-guard, then the type narrowing described in \u003ca href=\"#conditional_variable_type_narrowing\"\u003eConditional variable type\nnarrowing\u003c/a\u003e is done in addition to the type narrowing described here;\u003c/li\u003e\n\u003cli\u003eif \u003cvar\u003eR\u003c/var\u003e is a subtype of \u003ccode\u003ereadonly\u003c/code\u003e and there is no\n\u003ccode\u003ematch-guard\u003c/code\u003e, then the narrowed type for the next\n\u003ccode\u003ematch-clause\u003c/code\u003e is \u003cvar\u003eR\u003c/var\u003e; otherwise, it is \u003cvar\u003eT\u003c/var\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_7.20\"\u003e7.20 Loops\u003c/h3\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_7.20.1\"\u003e7.20.1 Foreach statement\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"foreach-stmt\"\u003eforeach-stmt\u003c/span\u003e :=\n   \u003ccode\u003eforeach\u003c/code\u003e \u003ca href=\"#typed-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003etyped-binding-pattern\u003c/span\u003e\u003c/a\u003e \u003ccode\u003ein\u003c/code\u003e \u003ca href=\"#action-or-expr\"\u003e\u003cspan class=\"ntref\"\u003eaction-or-expr\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#statement-block\"\u003e\u003cspan class=\"ntref\"\u003estatement-block\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA foreach statement iterates over an iterable value, executing a statement block\nonce for each value in the iterable value's iteration sequence. The static type\nof action-or-expr must be an iterable type with an iteration completion type of\nnil.\n\u003c/p\u003e\n\u003cp\u003e\nThe scope of any variables created in typed-binding-pattern is statement-block. These\nvariables are implicitly final.\n\u003c/p\u003e\n\u003cp\u003e\nIn more detail, a foreach statement executes as follows:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eevaluate the action-or-expr resulting in a value c\u003c/li\u003e\n\u003cli\u003ecreate an iterator object i from c as follows\n\u003col\u003e\n\u003cli\u003eif c is a basic type that is iterable, then i is the result of calling\nc.iterator()\u003c/li\u003e\n\u003cli\u003eif c is an object and c belongs to Iterable\u0026lt;T,()\u0026gt; for some T, then i is the\nresult of calling c.iterator()\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003ecall i.next() resulting in a value n\u003c/li\u003e\n\u003cli\u003eif n is nil, then terminate execution of the foreach statement\u003c/li\u003e\n\u003cli\u003ematch typed-binding-pattern to n.value causing assignments to any variables\nthat were created in typed-binding-pattern\u003c/li\u003e\n\u003cli\u003eexecute statement-block with the variable bindings from step 5 in scope; in the\ncourse of so doing\n\u003col\u003e\n\u003cli\u003ethe execution of a break-stmt terminates execution of the foreach statement\u003c/li\u003e\n\u003cli\u003ethe execution of a continue-stmt causes execution to proceed immediately to\nstep 3\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003ego back to step 3\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\nIn step 2, the compiler will give an error if the static type of expression is\nnot suitable for 2a or 2b.\n\u003c/p\u003e\n\u003cp\u003e\nIn step 5, the typed-binding-pattern is used unconditionally, and the compiler\nwill check that the static types guarantee that the match will succeed. If the\ntyped-binding-pattern uses var, then the type will be inferred from the type of\n\u003ccode\u003eaction-or-expr\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_7.20.2\"\u003e7.20.2 While statement\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"while-stmt\"\u003ewhile-stmt\u003c/span\u003e := \u003ccode\u003ewhile\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#statement-block\"\u003e\u003cspan class=\"ntref\"\u003estatement-block\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA while statement repeatedly executes a statement block so long as a\nboolean-valued expression evaluates to true.\n\u003c/p\u003e\n\u003cp\u003e\nIn more detail, a while statement executes as follows:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eevaluate expression;\u003c/li\u003e\n\u003cli\u003eif expression evaluates to false, terminate execution of the while\nstatement;\u003c/li\u003e\n\u003cli\u003eexecute statement-block; in the course of so doing\n\u003col\u003e\n\u003cli\u003ethe execution of a break-stmt results in termination of execution of the\nwhile statement\u003c/li\u003e\n\u003cli\u003ethe execution of a continue-stmt causes execution to proceed immediately to\nstep 1\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003ego back to step 1.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\nThe static type of \u003ccode\u003eexpression\u003c/code\u003e must be a subtype of boolean.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_7.20.3\"\u003e7.20.3 Continue statement\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"continue-stmt\"\u003econtinue-stmt\u003c/span\u003e := \u003ccode\u003econtinue\u003c/code\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA continue statement is only allowed if it is lexically within a\nwhile-stmt or a foreach-stmt. Executing a continue statement causes execution of\nthe nearest enclosing while-stmt or foreach-stmt to jump to the end of the\noutermost statement-block in the while-stmt or foreach-stmt.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_7.20.4\"\u003e7.20.4 Break statement\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"break-stmt\"\u003ebreak-stmt\u003c/span\u003e := \u003ccode\u003ebreak\u003c/code\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA break statement is only allowed if it is lexically within a\nwhile-stmt or a foreach-stmt. Executing a break statement causes the nearest\nenclosing while-stmt or foreach-stmt to terminate.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"lock_statement\"\u003e7.21 Lock statement\u003c/h3\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"lock-stmt\"\u003elock-stmt\u003c/span\u003e := \u003ccode\u003elock\u003c/code\u003e \u003ca href=\"#statement-block\"\u003e\u003cspan class=\"ntref\"\u003estatement-block\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nA lock-stmt executing in the context of some strand must execute its statement-block\nin such a way that the effect on the state of the program is consistent with the\nexecution of the statement-block not being interleaved with the execution of a\nlock-stmt on any other strand.\n\u003c/p\u003e\n\u003cp\u003e\nA naive implementation can simply acquire a single, program-wide, recursive mutex\nbefore executing a lock statement, and release the mutex after completing the\nexecution of the lock statement. A more sophisticated implementation can perform\ncompile-time analysis to infer a more fine-grained locking strategy that will\nhave the same effects as the naive implementation.\n\u003c/p\u003e\n\u003cp\u003e\nIt is not allowed to start a new strand within a lock. More precisely, when a\nstrand has started but not yet completed the execution of a lock-stmt, the\nexecution of a named-worker-decl or a start-action on that strand will result in\na panic. It is a compile-time error for a named-worker-decl or start-action to\noccur lexically within a lock-stmt. The compiler may also give a compile-time\nerror if a function definition contains a named-worker-decl or start-action, and\nthere is a function call lexically within the lock-stmt that might result\ndirectly or indirectly in a call to that defined function.\n\u003c/p\u003e\n\u003cp\u003e\nThere are two cases where a variable is restricted to be used only within a\nlock statement:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ewhen the variable is an isolated module-level variable; since isolated\nmodule-level variables are not allowed to be public, this restriction applies to\nall functions in the module;\u003c/li\u003e\n\u003cli\u003ewhen the variable is \u003ccode\u003eself\u003c/code\u003e within an isolated object and\n\u003ccode\u003eself\u003c/code\u003e occurs in a field-access-expr \u003ccode\u003eself.\u003cvar\u003ex\u003c/var\u003e\u003c/code\u003e,\nunless the field \u003ccode\u003e\u003cvar\u003ex\u003c/var\u003e\u003c/code\u003e is isolated; since non-isolated\nfields are required to be private, this restriction applies only to the object's\nmethods.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nWhen a lock statement contains one of the above two cases of restricted variable\nusage, the lock statement is subject to the following additional requirements,\nwhich maintain the invariant that the restricted variable is an isolated root.\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eOnly one such variable can occur in the lock statement.\u003c/li\u003e\n\u003cli\u003eA function or method can be called in the lock statement only if the type of\nthe function is isolated.\u003c/li\u003e\n\u003cli\u003eTransferring values out of the lock statement is constrained: the expression\nfollowing a return statement must be an isolated expression; an assignment to a\nvariable defined outside the lock statement is allowed only if left-hand side is\njust a variable name and the right hand side is an isolated expression. An\nassignment to the restricted variable is not subject to this constraint.\n\u003c/li\u003e\n\u003cli\u003eTransferring values into the lock statement is constrained: a\nvariable-reference-expr within the lock statement that refers to a variable or\nparameter defined outside the lock statement is allowed only if the\nvariable-reference-expr occurs within an expression that is isolated. A\nvariable-reference-expr that refers to the restricted variable is not subject to\nthis constraint. Within a non-isolated object, \u003ccode\u003eself\u003c/code\u003e behaves like a\nparameter.\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_7.22\"\u003e7.22 Fail and retry\u003c/h3\u003e\n\u003cp\u003e\nThe execution of a statement can fail either as the result of \u003ccode\u003echeck\u003c/code\u003e\nexpression or action, or from an explicit \u003ccode\u003efail\u003c/code\u003e statement. When\nexecution of a statement fails, control flow transfers to the nearest lexically\nenclosing failure-handling statement. The failure handling statements are\nstmt-with-on-fail, retry-stmt, transaction-stmt and retry-transaction-stmt. If\nthere is no such statement, it terminates the current worker normally. Note that\nfailure is completely distinct from panic.\n\u003c/p\u003e\n\u003cp\u003e\nWhen execution fails there is an associated error value, which is passed to the\nfailure-handling statement if there is one. If there is no failure-handling\nstatement, then the error value becomes the return value of the worker. The\npossible failure control flows are known at compile-time, as are the types of\nthe associated error values. For every statement, the type of the error value\nassociated with a failure causing control to transfer out of the block is\ndetermined at compile-time. This is in contrast with panics, for which the type\nof associated error value is not known at compile-time.\n\u003c/p\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_7.22.1\"\u003e7.22.1 Fail statement\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"fail-stmt\"\u003efail-stmt\u003c/span\u003e := \u003ccode\u003efail\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nExecuting a fail-stmt will cause control flow to transfer to the nearest\nlexically enclosing failure handling statement.\n\u003c/p\u003e\n\u003cp\u003e\nThe static type of the expression must be a subtype of error. Execution of the\nfail-stmt evaluates the expression; the resulting error value is passed to the\nfailure handling statement or becomes the termination value of the current\nworker.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch4 id=\"section_7.22.2\"\u003e7.22.2 On fail clause\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"stmt-with-on-fail\"\u003estmt-with-on-fail\u003c/span\u003e := \u003ca href=\"#regular-compound-stmt\"\u003e\u003cspan class=\"ntref\"\u003eregular-compound-stmt\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#on-fail-clause\"\u003e\u003cspan class=\"ntref\"\u003eon-fail-clause\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"on-fail-clause\"\u003eon-fail-clause\u003c/span\u003e := \u003ccode\u003eon\u003c/code\u003e \u003ccode\u003efail\u003c/code\u003e \u003ca href=\"#typed-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003etyped-binding-pattern\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#statement-block\"\u003e\u003cspan class=\"ntref\"\u003estatement-block\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003estmt-with-on-fail\u003c/code\u003e is executed by executing the\n\u003ccode\u003eregular-compound-stmt\u003c/code\u003e. A \u003ccode\u003echeck\u003c/code\u003e expression or action,\nor a \u003ccode\u003efail\u003c/code\u003e statement may cause control to transfer to the\n\u003ccode\u003eon-fail-cause\u003c/code\u003e. In this case, the \u003ccode\u003etyped-binding-pattern\u003c/code\u003e\nis matched to the associated error value, binding the variables occurring within\nthe \u003ccode\u003etyped-binding-pattern\u003c/code\u003e; the \u003ccode\u003estatement-block\u003c/code\u003e is then\nexecuted with these bindings in scope. Otherwise, the\n\u003ccode\u003eon-fail-clause\u003c/code\u003e is not executed.\n\u003c/p\u003e\n\u003cp\u003e\nThe static type of the associated error value is determined from the static type\nof the relevant \u003ccode\u003echeck\u003c/code\u003e expressions and actions, and\n\u003ccode\u003efail\u003c/code\u003e statements. It is a compile error unless the match of the\n\u003ccode\u003etyped-binding-pattern\u003c/code\u003e with the associated error value is guaranteed\nto succeed by the static type of the associated error value.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_7.22.3\"\u003e7.22.3 Retry statement\u003c/h4\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"retry-stmt\"\u003eretry-stmt\u003c/span\u003e := \u003ccode\u003eretry\u003c/code\u003e \u003ca href=\"#retry-spec\"\u003e\u003cspan class=\"ntref\"\u003eretry-spec\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#statement-block\"\u003e\u003cspan class=\"ntref\"\u003estatement-block\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"retry-spec\"\u003eretry-spec\u003c/span\u003e := [\u003ca href=\"#type-parameter\"\u003e\u003cspan class=\"ntref\"\u003etype-parameter\u003c/span\u003e\u003c/a\u003e] [ \u003ccode\u003e(\u003c/code\u003e \u003ca href=\"#arg-list\"\u003e\u003cspan class=\"ntref\"\u003earg-list\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e)\u003c/code\u003e ]\n\u003c/pre\u003e\n\u003cp\u003e\nThe type-parameter in a retry-spec specifies a class, which must be a subtype of\nRetryManager\u0026gt;F\u0026lt;, where F is the failure type of the statement-block; this\nimplies that the parameter type of the class's shouldRetry method must be a\nsupertype of F. The arg-list in a retry-spec specifies parameters to be passed\nto the class's \u003ccode\u003einit\u003c/code\u003e method; as with \u003ccode\u003enew\u003c/code\u003e, the arg-list\ncan be omitted if the class's \u003ccode\u003einit\u003c/code\u003e method has no required\narguments.\n\u003c/p\u003e\n\u003cp\u003e\nA retry-stmt is executed as follows:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eCreate an object r of type RetryManager by calling \u003ccode\u003enew T(A)\u003c/code\u003e,\nwhere T and A are the type-descriptor in the type-parameter and the arg-list\nrespectively.\u003c/li\u003e\n\u003cli\u003eExecute the statement-block.\u003c/li\u003e\n\u003cli\u003eIf the execution failed with associated error e, then call\n\u003ccode\u003er.shouldRetry(e)\u003c/code\u003e. If the result is true, go back to the previous\nstep. If the result is false, then continue with the fail.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\nIf the type-parameter is omitted, it defaults to\n\u003ccode\u003eDefaultRetryManager\u003c/code\u003e defined in langlib error module.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"transactions\"\u003e7.23 Transactions\u003c/h3\u003e\n\n\u003cp\u003e\nBallerina provides language support for distributed transactions. A global\ntransaction consists of one or more transaction branches, where a branch\ncorresponds to work done by a single strand of a Ballerina program that is part\nof the global transaction. Every transaction branch is uniquely identified by an\nXID, which consists of an identifier of the global transaction and an identifier\nof a branch with the global transaction.\n\u003c/p\u003e\n\u003cp\u003e\nAt runtime, there is a mapping from each strand to a transaction stack, which is\na stack of transaction branches. A strand is in \u003cem\u003etransaction mode\u003c/em\u003e, if\nits transaction stack is non-empty; the top of a strand's transaction stack is\nthe current transaction branch for that strand.\n\u003c/p\u003e\n\u003cp\u003e\nStatic checking is based on the idea of a transactional scope: this is a lexical\nregion of the program where it is known that at runtime the strand executing the\nregion will always be in transactional mode. A function with the\n\u003ccode\u003etransactional\u003c/code\u003e qualifier can only be called in a transactional\nscope; this includes function calls using \u003ccode\u003estart\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nA running instance of a Ballerina program includes a transaction manager. This\nmay run in the same process as the Ballerina program or in a separate process.\nIt should not be connected over an unreliable network. The transaction manager\nof a program is responsible for managing the transaction branches of all the\nprogram's strands.\n\u003c/p\u003e\n\u003cp\u003e\nWhen a global transaction involves multiple Ballerina programs, there must be a\nnetwork protocol that allows that transaction managers for each Ballerina\nprogram to communicate. The protocol must also allow a remote method or resource\nmethod on a service object to be informed of the global transaction, if any, to\nwhich it belongs. When a listener object determines that a remote method or\nresource method of a service object is to be a part of a global transaction\nmanager, then it will create a new transaction branch, join it to the global\ntransaction and push that on the transaction stack for the strand on which the\nmethod is called; if the method is declared as \u003ccode\u003etransactional\u003c/code\u003e, the\nlistener will not call the method unless it can do this. Similarly, the protocol\nmust allow a remote method on a client object that is called in transaction mode\nto send information about the global transaction of which it is part; if the\nmethod is declared as \u003ccode\u003etransactional\u003c/code\u003e, then as usual the method can\nonly be called in transaction mode; it also implies that the client object\nimplementation is transaction-aware, and that the recipient of the message sent\nby the remote method must join the global transaction. A global transaction can\ncombine Ballerina programs with programs written in other programming languages\nprovided they agree on this network protocol.\n\u003c/p\u003e\n\u003cp\u003e\nA strand in transaction mode can register commit or rollback handlers with the\ntransaction manager; the handlers are functions which will be called by the\ntransaction manager when the decision has been made whether to commit or\nrollback the global transaction to which the current transaction branch belongs.\n\u003c/p\u003e\n\u003cp\u003e\nNote that internal storage in Ballerina is not transactional. Rolling back a\ntransaction does \u003cem\u003enot\u003c/em\u003e automatically restore the mutable values are\nvariables to their state when the transaction started. It is up to the\nprogrammer to do this using commit or rollback handlers.\n\u003c/p\u003e\n\u003cp\u003e\nWhen a new strand is created by a named-worker-decl that includes a\n\u003ccode\u003etransactional\u003c/code\u003e qualifier or by using \u003ccode\u003estart\u003c/code\u003e to call a\nfunction with a \u003ccode\u003etransactional\u003c/code\u003e qualifier, a new transaction branch\nwill be created and joined to the global transaction; this transaction branch\nwill be pushed onto transaction stack for the newly created strand.\n\u003c/p\u003e\n\u003cp\u003e\nBallerina also has the concept that a transaction may be part of a sequence of\nretries, where the last transaction can complete with either a rollback or\ncommit, and the preceding transactions all completed with a rollback.\n\u003c/p\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_7.23.1\"\u003e7.23.1 Transaction manager\u003c/h4\u003e\n\n\u003cp\u003e\nThe semantics of Ballerina's transactional language features are defined in\nterms of the following abstract operations on the transaction manager. These\noperations cover only the interface between the application and the transaction\nmanager, not the interface between the resource manager and the application.\nThese operations are all performed by a Ballerina program in the context of a\nstrand. The transaction manager supports additional operations, which are\ndefined in the langlib transaction module.\n\u003c/p\u003e\n\n\u003csection\u003e\n\u003ch5 id=\"section_7.23.1.1\"\u003e7.23.1.1 Begin operation\u003c/h5\u003e\n\u003cp\u003e\nThe Begin operation starts a global transaction and pushes a transaction branch\nfor the new global transaction onto the current strand's transaction stack. This\ntransaction branch is the initiating branch of the global transaction. The\ncurrent strand will be in transaction mode.\n\u003c/p\u003e\n\u003cp\u003e\nThe Begin operation has an optional parameter that contains information about\nthe previous transactions in a sequence of retries.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch5 id=\"section_7.23.1.2\"\u003e7.23.1.2 Commit operation\u003c/h5\u003e\n\u003cp\u003e\nThe Commit operation is only called in transaction mode, and when the current\ntransaction branch is the initiating branch of a global transaction. The Commit\noperation always removes the topmost transaction branch from the strand's transaction\nstack. The Commit operation initiates a commit of the global transaction that\nthe current transaction branch belongs to.\n\u003c/p\u003e\n\u003cp\u003e\nWhen the commit is initiated, the transaction manager runs a two-phase commit\nprotocol if necessary. First, it requests each participant to prepare to commit\nand waits for the participants to respond. There are two possibilities. If it\nreceives a response from each participant that it is prepared to commit, then\nthe transaction manager will make a decision to commit. If it receives a\nresponse from any participant that it cannot commit or it gives up waiting for a\nresponse from any participant, then the transaction manager will make a decision\nto rollback; in this case, it will create an error value for the cause of the\nrollback.\n\u003c/p\u003e\n\u003cp\u003e\nOnce the transaction manager has made a decision whether to commit, it calls the\nhandlers that were registered with it for for the branches of the global\ntransaction that it is managing; the commit handlers are called if the decision\nwas to commit and the rollback handlers are called if the decision was to\nrollback. The error value for the cause of the rollback will be passed as an\nargument to the call of each rollback handler. At this point, the Commit\noperation can return. The transaction manager will also communicate its decision\nto the transaction's participants, which will result in them running commit or\nrollback handlers for their branches.\n\u003c/p\u003e\n\u003cp\u003e\nThe Commit operation has an optional parameter which is a RetryManager object or\nnil, which defaults to nil. If this parameter is non-nil and the decision is to\nrollback, then the transaction manager will call the RetryManager object's\nshouldRetry method, record the result and then pass it as the willRetry\nparameter to any rollback handlers.\n\u003c/p\u003e\n\u003cp\u003e\nIf the transaction manager decided to rollback, then the Commit operation\nreturns the error value for the reason for the rollback. Otherwise, it returns\nnil.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch5 id=\"section_7.23.1.3\"\u003e7.23.1.3 Rollback operation\u003c/h5\u003e\n\u003cp\u003e\nThe Rollback operation is only called in transaction mode, and when the current\ntransaction branch is the initiating branch of a global transaction. The\nRollback operation always removes the topmost transaction from the strand's\ntransaction stack. The Rollback operations initiates a commit of the global\ntransaction that the current transaction branch belongs to. The transaction\nmanager calls the rollback handlers that were registered with it for the\nbranches of the global transaction that it is managing. The Rollback operation\nhas a parameter which is either an error value or nil; this is passed as an\nargument to any rollback handlers.\n\u003c/p\u003e\n\u003cp\u003e\nThe Rollback operation also has an optional parameter which is a RetryManager object\nor nil, which defaults to nil. If this parameter is non-nil, then the\ntransaction manager will call the RetryManager object's shouldRetry method,\nrecord the result and then pass it as the willRetry parameter to any rollback\nhandlers.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_7.23.2\"\u003e7.23.2 Transaction statement\u003c/h4\u003e\n\n\u003cp\u003e\nA transaction is performed using a transaction statement. The semantics of the\ntransaction statement guarantees that every transaction manager Begin operation\nwill be paired with a Rollback or Commit operation.\n\u003c/p\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"transaction-stmt\"\u003etransaction-stmt\u003c/span\u003e := \u003ccode\u003etransaction\u003c/code\u003e \u003ca href=\"#statement-block\"\u003e\u003cspan class=\"ntref\"\u003estatement-block\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe statement-block must contain at least one commit-action. In addition, the\ncompiler must be able to verify that any exit out of the statement-block that is\nneither a panic nor a fail will have executed a commit-action or\nrollback-stmt.\n\u003c/p\u003e\n\u003cp\u003e\nA transaction-stmt is executed as follows:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ePerform the transaction Begin() operation.\u003c/li\u003e\n\u003cli\u003eExecute the statement-block. While executing the statement-block, any panic\ndoes not immediately terminate the current worker; rather control is transferred\nback to the transaction-stmt, so that the transaction-stmt can handle it as\ndescribed in the next step.\u003c/li\u003e\n\u003cli\u003eIf the new transaction that was begun is still the current transaction, then\nthe statement-block must have failed or panicked. In this case, perform a\nRollback(e) operation, where e is the error associated with the fail or panic,\nand then continue with the fail or panic.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe statement-block of a transaction-stmt is a transactional scope, except for\nany statements that could potentially be executed after the execution of a\ncommit-action or rollback-stmt.\n\u003c/p\u003e\n\u003cp\u003e\nIt is an error for a transactional-stmt to appear in a transactional scope.\nHowever, it is not an error if the current strand is in transaction mode when a\ntransaction-stmt is executed: in this case, the Begin() operation performed by\nthe transaction-stmt will, as usual, start a new transaction, which will be\ncompletely independent of any existing transactions.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\n\u003csection\u003e\n\u003ch4 id=\"section_7.23.3\"\u003e7.23.3 Retry transaction statement\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"retry-transaction-stmt\"\u003eretry-transaction-stmt\u003c/span\u003e := \u003ccode\u003eretry\u003c/code\u003e \u003ca href=\"#retry-spec\"\u003e\u003cspan class=\"ntref\"\u003eretry-spec\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#transaction-stmt\"\u003e\u003cspan class=\"ntref\"\u003etransaction-stmt\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA retry-transaction-stmt is the same as a retry-stmt containing a\ntransaction-stmt, except as follows.\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eWhen a transaction is retried, information about the previous transaction is\npassed as a parameter to the Begin() operation.\u003c/li\u003e\n\u003cli\u003eIf the transaction committed successfully, but the statement-block of the\ntransaction-stmt failed, then the transaction-stmt will not be retried.\u003c/li\u003e\n\u003cli\u003eThe RetryManager is passed as a parameter to the Commit() and Rollback()\noperations and the shouldRetry method is then called by those operations, so\nthat the result is available to the rollback handlers. The transaction manager\nrecords the result of calling shouldRetry, and this is used to determine whether\nto retry.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_7.23.4\"\u003e7.23.4 Commit action\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"commit-action\"\u003ecommit-action\u003c/span\u003e := \u003ccode\u003ecommit\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003ecommit-action\u003c/code\u003e is only allowed if it is lexically within the\n\u003ccode\u003estatement-block\u003c/code\u003e of a \u003ccode\u003etransaction-stmt.\u003c/code\u003e\n\u003c/p\u003e\n\u003cp\u003e\nEvaluating the \u003ccode\u003ecommit-action\u003c/code\u003e performs the transaction manager\nCommit() operation; the result of this operation is the result of the\n\u003ccode\u003ecommit-action\u003c/code\u003e. The type of the result is\n\u003ccode\u003etransaction:Error?\u003c/code\u003e. Note that the commit action does not alter the\nflow of control.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_7.23.5\"\u003e7.23.5 Rollback statement\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"rollback-stmt\"\u003erollback-stmt\u003c/span\u003e := \u003ccode\u003erollback\u003c/code\u003e [\u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003erollback-stmt\u003c/code\u003e is only allowed if it is lexically within the\n\u003ccode\u003estatement-block\u003c/code\u003e of a \u003ccode\u003etransaction-stmt.\u003c/code\u003e\n\u003c/p\u003e\n\u003cp\u003e\nThe \u003ccode\u003erollback-stmt\u003c/code\u003e performs the transaction manager Rollback(e)\noperation, where e is the result of executing the \u003ccode\u003eexpression\u003c/code\u003e, if\npresent, and nil otherwise. Note that like the commit action, the rollback\nstatement does not alter the flow of control.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_7.24\"\u003e7.24 Panic statement\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"panic-stmt\"\u003epanic-stmt\u003c/span\u003e := \u003ccode\u003epanic\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA panic statement terminates the current worker abnormally. The result of\nevaluating \u003ccode\u003eexpression\u003c/code\u003e provides the termination value of the worker.\n\u003c/p\u003e\n\u003cp\u003e\nThe static type of \u003ccode\u003eexpression\u003c/code\u003e must be a subtype of error.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_7.25\"\u003e7.25 Return statement\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"return-stmt\"\u003ereturn-stmt\u003c/span\u003e := \u003ccode\u003ereturn\u003c/code\u003e [ \u003ca href=\"#action-or-expr\"\u003e\u003cspan class=\"ntref\"\u003eaction-or-expr\u003c/span\u003e\u003c/a\u003e ] \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA return statement terminates the current worker normally.The result of\nevaluating the action-or-expr provides the termination value of the worker. If\naction-or-expr is omitted, then the termination value is nil.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch2 id=\"module_level\"\u003e8. Module-level declarations\u003c/h2\u003e\n\u003cp\u003e\nEach source part in a Ballerina module must match the production\n\u003ccode\u003emodule-part\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThe import declarations must come before other declarations; apart from this,\nthe order of the definitions and declarations at the top-level of a module is\nnot constrained.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"module-part\"\u003emodule-part\u003c/span\u003e := \u003ca href=\"#import-decl\"\u003e\u003cspan class=\"ntref\"\u003eimport-decl\u003c/span\u003e\u003c/a\u003e* \u003ca href=\"#other-decl\"\u003e\u003cspan class=\"ntref\"\u003eother-decl\u003c/span\u003e\u003c/a\u003e*\n\u003cspan class=\"ntdfn\" id=\"other-decl\"\u003eother-decl\u003c/span\u003e :=\n   \u003ca href=\"#listener-decl\"\u003e\u003cspan class=\"ntref\"\u003elistener-decl\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#service-decl\"\u003e\u003cspan class=\"ntref\"\u003eservice-decl\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#function-defn\"\u003e\u003cspan class=\"ntref\"\u003efunction-defn\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#module-type-defn\"\u003e\u003cspan class=\"ntref\"\u003emodule-type-defn\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#module-class-defn\"\u003e\u003cspan class=\"ntref\"\u003emodule-class-defn\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#module-var-decl\"\u003e\u003cspan class=\"ntref\"\u003emodule-var-decl\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#module-const-decl\"\u003e\u003cspan class=\"ntref\"\u003emodule-const-decl\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#module-enum-decl\"\u003e\u003cspan class=\"ntref\"\u003emodule-enum-decl\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#module-xmlns-decl\"\u003e\u003cspan class=\"ntref\"\u003emodule-xmlns-decl\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#annotation-decl\"\u003e\u003cspan class=\"ntref\"\u003eannotation-decl\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_8.1\"\u003e8.1 Import declaration\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"import-decl\"\u003eimport-decl\u003c/span\u003e := \u003ccode\u003eimport\u003c/code\u003e [\u003ca href=\"#org-name\"\u003e\u003cspan class=\"ntref\"\u003eorg-name\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e/\u003c/code\u003e] \u003ca href=\"#module-name\"\u003e\u003cspan class=\"ntref\"\u003emodule-name\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003eas\u003c/code\u003e \u003ca href=\"#import-prefix\"\u003e\u003cspan class=\"ntref\"\u003eimport-prefix\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003e;\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"import-prefix\"\u003eimport-prefix\u003c/span\u003e := \u003ca href=\"#module-prefix\"\u003e\u003cspan class=\"ntref\"\u003emodule-prefix\u003c/span\u003e\u003c/a\u003e | \u003ccode\u003e_\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"module-prefix\"\u003emodule-prefix\u003c/span\u003e := \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#predeclared-prefix\"\u003e\u003cspan class=\"ntref\"\u003epredeclared-prefix\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"org-name\"\u003eorg-name\u003c/span\u003e := \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"module-name\"\u003emodule-name\u003c/span\u003e := \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e.\u003c/code\u003e \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e)*\n\n\u003cspan class=\"ntdfn\" id=\"qualified-identifier\"\u003equalified-identifier\u003c/span\u003e := \u003ca href=\"#module-prefix\"\u003e\u003cspan class=\"ntref\"\u003emodule-prefix\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e:\u003c/code\u003e \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nIf org-name is omitted, it is defaulted from the organization of the importing\nmodule.\n\u003c/p\u003e\n\u003cp\u003e\nA \u003ccode\u003emodule-prefix\u003c/code\u003e is a name that is used locally within the source of\na module to refer to another module. A \u003ccode\u003emodule-prefix\u003c/code\u003e in a\nqualified-identifier must refer to a \u003ccode\u003emodule-prefix\u003c/code\u003e specified in an\nimport-declaration in the same source part.\n\u003c/p\u003e\n\u003cp\u003e\nAn import-prefix of \u003ccode\u003e_\u003c/code\u003e causes the module to be imported without\nmaking its symbols available via a module-prefix. In this case, the effect of\nimporting the module will be just to cause the module to be included in the\nprogram and initialized. It is an error for a source-part to import a module\nusing a module-prefix and then not to use that module-prefix.\n\u003c/p\u003e\n\u003cp\u003e\nA \u003ccode\u003emodule-prefix\u003c/code\u003e declared by an \u003ccode\u003eimport-decl\u003c/code\u003e is in the\nsame symbol space as a \u003ccode\u003exmlns-namespace-prefix\u003c/code\u003e declared by an\n\u003ccode\u003exmlns-decl\u003c/code\u003e. This symbol space is distinct from a module's main\nsymbol space used by other declarations.\n\u003c/p\u003e\n\u003cp\u003e\nIt is an error for a module to directly or indirectly import itself. In other\nwords, the directed graph of module imports must be acyclic.\n\u003c/p\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"predeclared-prefix\"\u003epredeclared-prefix\u003c/span\u003e :=\n   \u003ccode\u003eboolean\u003c/code\u003e\n   | \u003ccode\u003edecimal\u003c/code\u003e\n   | \u003ccode\u003eerror\u003c/code\u003e\n   | \u003ccode\u003efloat\u003c/code\u003e\n   | \u003ccode\u003efuture\u003c/code\u003e\n   | \u003ccode\u003eint\u003c/code\u003e\n   | \u003ccode\u003emap\u003c/code\u003e\n   | \u003ccode\u003eobject\u003c/code\u003e\n   | \u003ccode\u003estream\u003c/code\u003e\n   | \u003ccode\u003estring\u003c/code\u003e\n   | \u003ccode\u003etable\u003c/code\u003e\n   | \u003ccode\u003etransaction\u003c/code\u003e\n   | \u003ccode\u003etypedesc\u003c/code\u003e\n   | \u003ccode\u003exml\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA reserved keyword \u003ccode\u003e\u003cvar\u003et\u003c/var\u003e\u003c/code\u003e that is a predeclared-prefix is\npredeclared as referring to the \u003ccode\u003elang.\u003cvar\u003et\u003c/var\u003e\u003c/code\u003e lang library\nmodule, but this can be overridden by an import-decl that imports a module using\nthat prefix. A predeclared-prefix can be used as a module-prefix without using a\nQuotedIdentifier.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_8.2\"\u003e8.2 Module and program execution\u003c/h3\u003e\n\u003cp\u003e\nA Ballerina program consists of one or more modules; one of these modules is\ndistinguished as the \u003cem\u003eroot\u003c/em\u003e module. The source code for a module uses\nimport declarations to identify the modules on which it depends directly. At\ncompile-time, a root module is specified, and the modules comprising the program\nare inferred to be those that the root module imports directly or indirectly.\nThe directed graph of module imports must be acyclic.\n\u003c/p\u003e\n\u003cp\u003e\nProgram execution may terminate successfully or unsuccessfully. Unsuccessful\nprogram termination returns an error value. Program execution consists of two\nconsecutive phases: an initialization phase and a listening phase.\n\u003c/p\u003e\n\u003cp\u003e\nModule initialization is performed by calling an initialization function, which\nis synthesized by the compiler for each module. Module initialization can fail,\nin which case the initialization function returns an error value. The\ninitialization phase of program execution consists of initializing each of the\nprogram's modules. If the initialization of a module is unsuccessful, then\nprogram execution immediately terminates unsuccessfully, returning the error\nvalue returned by the initialization function.\n\u003c/p\u003e\n\u003cp\u003e\nThe initialization of a program's modules is ordered so that a module will not\nbe initialized until all of the modules on which it depends have been\ninitialized. (Such an ordering will always be possible, since the graph of\nmodule imports is required to be acyclic.) The order in which modules are\ninitialized follows the order in which modules are imported so far as is\nconsistent with the previous constraint.\n\u003c/p\u003e\n\u003cp\u003e\nA module's initialization function performs expression evaluation so as to\ninitialize the identifiers declared in the module's declarations; if evaluation\nof an expression completes abruptly, then the module initialization function\nimmediately returns the error value associated with the abrupt completion. If a\nmodule defines a function named \u003ccode\u003einit\u003c/code\u003e, then a module's\ninitialization function will end by calling this function; if it terminates\nabruptly or returns an error, then the module's initialization function will\nreturn an error value. Note that the \u003ccode\u003einit\u003c/code\u003e function of the root\nmodule will be the last function called during a program's initialization phase.\n\u003c/p\u003e\n\u003cp\u003e\nThis specification does not define any mechanism for processing the program\ncommand-line arguments typically provided by an operating system. The Ballerina\nstandard library provides a function to retrieve these command-line arguments.\nIn addition, the Ballerina platform provides a convenient mechanism for\nprocessing these arguments. This works by generating a new command-line\nprocessing module from the specified root module. The \u003ccode\u003einit\u003c/code\u003e\nfunction of the generated module retrieves the command-line arguments, parses\nthem, and calls a public function of the specified root module (typically the\n\u003ccode\u003emain\u003c/code\u003e function). The parsing of the command-line arguments is\ncontrolled by the declared parameter types, annotations and names of the public\nfunctions. The generated module, which imports the specified root module,\nbecomes the new root module.\n\u003c/p\u003e\n\u003cp\u003e\nA configuration is supplied as input to program execution. A\n\u003cem\u003econfiguration\u003c/em\u003e consists of mapping from names of configurable\nmodule-level variables to values. The values in a configuration always belong to\nthe type \u003ccode\u003eanydata\u0026amp;readonly\u003c/code\u003e. The value for a variable in the\nconfiguration is used during module initialization to initialize the variable\ninstead of the value specified in the module. A configurable module-level\nvariable may require that a configuration include a value for it. Except for\nthis requirement, a configuration may be empty. Before initializing any module,\nthe initialization phase must check that there is a value of the correct type\nsupplied for every configurable module-level variable that requires\nconfiguration. If not, the module initialization phase terminates unsuccessfull.\n\u003c/p\u003e\n\u003cp\u003e\nIf the initialization phase of program execution completes successfully, then\nexecution proceeds to the listening phase, which is described in the next\nsection. The termination of the listening phase, which may be successful or\nunsuccessful, terminates the program execution.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"listeners_and_services\"\u003e8.3 Listeners and services\u003c/h3\u003e\n\n\u003cp\u003e\nService objects support network interaction using remote methods and resource\nmethods. Listeners provide the interface between the network and service\nobjects. A listener object receives network messages from a remote process\naccording to some protocol and translates the received messages into calls on\nthe remote and resource methods of service objects that have been attached to\nthe listener object. It is up to the listener object to determine how this\ntranslation happens; the type of the listener object constrains the type of a\nservice that can be attached to the listener. (This constraint cannot yet be\nfully expressed by Ballerina's type system.)\n\u003c/p\u003e\n\u003cp\u003e\nA service object's remote or resource method uses its return value to indicate\nto the listener what further handling of the network message is needed. An error\nreturn value is used to indicate that the method encountered some sort of error\nin handling the network message. When a service object is returned, it means\nthat the listener should use that service object to further handle the network\nmessage. When no further handling is needed, the return value should be nil.\n\u003c/p\u003e\n\u003cp\u003e\nThe return value can also be used to supply a response to the network message.\nThis has the limitation that the method cannot control what happens if there is\nan error in sending a response. It also has the limitation that it cannot handle\ncomplex message exchange patterns, although returning multiple responses to a\nsingle request can be modelled by returning a stream. A listener object can\navoid these limitations by passing a client object as a parameter to the service\nobject's remote or resource method; the service object then makes calls on the\nremote methods of the client object in order to send a response back to the\nclient.\n\u003c/p\u003e\n\u003cp\u003e\nThe methods defined by the Listener object type allow for the\nmanagement of the lifecycle of a listener object and its attached services. A\nlistener declaration registers a listener object with a module, so that it can\nbe managed by the module. The runtime state of each module includes a list of\nlistener objects that have been registered with the module. A listener object\nthat has been registered with a module is called a \u003cem\u003emodule listener\u003c/em\u003e\n\u003c/p\u003e\n\u003cp\u003e\nIf at the start of the listening phase of program execution there are no module\nlisteners, then the listening phase immediately terminates successfully.\nOtherwise, the \u003ccode\u003estart\u003c/code\u003e method of each module listener is called; if\nany of these calls returns an error value, then the listening phase terminates\nunsuccessfully with this error value as its return value.\n\u003c/p\u003e\n\u003cp\u003e\nThe listening phase of program execution continues until either the program\nexplicitly exits, by calling a standard library function, or the user explicitly\nrequests the termination of the program using an implementation-dependent\noperating system facility (such as a signal on a POSIX system). In the latter\ncase, the \u003ccode\u003egracefulStop\u003c/code\u003e or \u003ccode\u003eimmediateStop\u003c/code\u003e method of\neach registered listener will be called before termination.\n\u003c/p\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_8.3.1\"\u003e8.3.1 Listener declaration\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"listener-decl\"\u003elistener-decl\u003c/span\u003e :=\n   \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e\n   [\u003ccode\u003epublic\u003c/code\u003e] \u003ccode\u003elistener\u003c/code\u003e [\u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#variable-name\"\u003e\u003cspan class=\"ntref\"\u003evariable-name\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e=\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003elistener-decl\u003c/code\u003e declares a module listener. A module listener\ndeclares a variable in a similar way to a final variable declaration, but the\ntype of the variable is always a subtype of the Listener object type,\nand it has the additional semantic of registering the variable's value with the\nmodule as a listener. As with a variable declared in a final variable\ndeclaration, the variable can be referenced by a variable-reference, but cannot\nbe assigned to. A module may have multiple multiple listeners.\n\u003c/p\u003e\n\u003cp\u003e\nWhen a listener-decl is initialized as part of module initialization, its\nexpression is evaluated. If expression evaluation completes abruptly or the\nresult of the expression is an error, then module initialization fails.\nOtherwise the variable is initialized with the result of the evaluation.\n\u003c/p\u003e\n\u003cp\u003e\nIf the type-descriptor is present, it specifies the static type of the variable.\nThe static type of \u003ccode\u003eexpression\u003c/code\u003e must be equivalent to a union L|E,\nwhere L is a listener object type and E is subtype of error, which may be\n\u003ccode\u003enever\u003c/code\u003e; if the type-descriptor is not present, then L is used as the\nstatic type of the variable.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_8.3.2\"\u003e8.3.2 Service declaration\u003c/h4\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"service-decl\"\u003eservice-decl\u003c/span\u003e :=\n   \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e [\u003ca href=\"#isolated-qual\"\u003e\u003cspan class=\"ntref\"\u003eisolated-qual\u003c/span\u003e\u003c/a\u003e]\n   \u003ccode\u003eservice\u003c/code\u003e [\u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e] [\u003ca href=\"#attach-point\"\u003e\u003cspan class=\"ntref\"\u003eattach-point\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003eon\u003c/code\u003e \u003ca href=\"#expression-list\"\u003e\u003cspan class=\"ntref\"\u003eexpression-list\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#object-constructor-block\"\u003e\u003cspan class=\"ntref\"\u003eobject-constructor-block\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"attach-point\"\u003eattach-point\u003c/span\u003e := \u003ca href=\"#absolute-resource-path\"\u003e\u003cspan class=\"ntref\"\u003eabsolute-resource-path\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#string-literal\"\u003e\u003cspan class=\"ntref\"\u003estring-literal\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"absolute-resource-path\"\u003eabsolute-resource-path\u003c/span\u003e :=\n   \u003ca href=\"#root-resource-path\"\u003e\u003cspan class=\"ntref\"\u003eroot-resource-path\u003c/span\u003e\u003c/a\u003e\n   | (\u003ccode\u003e/\u003c/code\u003e \u003ca href=\"#resource-path-segment-name\"\u003e\u003cspan class=\"ntref\"\u003eresource-path-segment-name\u003c/span\u003e\u003c/a\u003e)+\n\u003cspan class=\"ntdfn\" id=\"root-resource-path\"\u003eroot-resource-path\u003c/span\u003e := \u003ccode\u003e/\u003c/code\u003e\n\n\u003cspan class=\"ntdfn\" id=\"expression-list\"\u003eexpression-list\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e)*\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003eservice-decl\u003c/code\u003e creates a service object and attaches it to one or more\nlisteners. \n\u003c/p\u003e\n\u003cp\u003e\nThe static type S for the constructed service object is specified by the\ntype-descriptor if present, and otherwise is the union of a type inferred from\neach expression in the expression list as follows. Each expression in the\nexpression-list must have a type Listener\u0026lt;T,A\u0026gt;|E where T is a subtype of\n\u003ccode\u003eservice object {}\u003c/code\u003e, A is a subtype of\n\u003ccode\u003estring[]|string|()\u003c/code\u003e and E is a subtype of \u003ccode\u003eerror\u003c/code\u003e; the\ninferred type is T. The object-constructor-block has the same semantics as in an\nobject-constructor-expr with a \u003ccode\u003eservice\u003c/code\u003e qualifier and a\ntype-reference that refers to S. If the service-decl includes\n\u003ccode\u003eisolated\u003c/code\u003e, then it is equivalent to an object-constructor-expr with\nan \u003ccode\u003eisolated\u003c/code\u003e qualifier as well as a \u003ccode\u003eservice\u003c/code\u003e qualifier.\n\u003c/p\u003e\n\u003cp\u003e\nThe \u003ccode\u003eattach-point\u003c/code\u003e determines the second argument passed to the\n\u003ccode\u003eattach\u003c/code\u003e method: if the \u003ccode\u003eattach-point\u003c/code\u003e is absent, then the\nargument is nil; if it is a \u003ccode\u003estring-literal\u003c/code\u003e, then the argument is a\nstring; otherwise, it is an \u003ccode\u003eabsolute-resource-path\u003c/code\u003e and the argument\nis an array of strings, with one string for each\n\u003ccode\u003eresource-path-segment-name\u003c/code\u003e. Attaching service objects\n\u003cvar\u003es\u003c/var\u003e\u003csub\u003e1\u003c/sub\u003e,...,\u003cvar\u003es\u003c/var\u003e\u003csub\u003e\u003cvar\u003en\u003c/var\u003e\u003c/sub\u003e with absolute\nresource paths \u003cvar\u003ep\u003c/var\u003e\u003csub\u003e1\u003c/sub\u003e,...,\u003cvar\u003ep\u003c/var\u003e\u003csub\u003e\u003cvar\u003en\u003c/var\u003e\u003c/sub\u003e\nis equivalent to attaching a single service object with \u003cvar\u003en\u003c/var\u003e\n\u003ccode\u003eget\u003c/code\u003e resource methods to \u003ccode\u003e/\u003c/code\u003e, where the \u003cvar\u003ei\u003c/var\u003e-th\nresource method has a path \u003cvar\u003ep\u003c/var\u003e\u003csub\u003ei\u003c/sub\u003e (an\n\u003ccode\u003eabsolute-resource-path\u003c/code\u003e is turned into a\n\u003ccode\u003erelative-resource-path\u003c/code\u003e with the same\n\u003ccode\u003eresource-path-segment-name\u003c/code\u003es) and returns\n\u003cvar\u003es\u003c/var\u003e\u003csub\u003e\u003cvar\u003ei\u003c/var\u003e\u003c/sub\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nA service-decl is initialized as part of module initialization as follows. The\nobject-constructor-block is evaluated as in an object-constructor-expr resulting\nin a service object \u003ccode\u003e\u003cvar\u003es\u003c/var\u003e\u003c/code\u003e. Then for each expression in\nexpression-list:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003ethe expression is evaluated resulting in a value which is either an error or\nan object \u003ccode\u003e\u003cvar\u003eobj\u003c/var\u003e\u003c/code\u003e belonging to a listener object type;\u003c/li\u003e\n\u003cli\u003eif it is an error, module initialization fails;\u003c/li\u003e\n\u003cli\u003eotherwise, \u003ccode\u003e\u003cvar\u003eobj\u003c/var\u003e\u003c/code\u003e is registered as a module listener\n(registering the same object multiple times is the same as registering it\nonce);\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e\u003cvar\u003es\u003c/var\u003e\u003c/code\u003e is then attached to \u003ccode\u003e\u003cvar\u003eobj\u003c/var\u003e\u003c/code\u003e\nusing \u003ccode\u003e\u003cvar\u003eobj\u003c/var\u003e\u003c/code\u003e's \u003ccode\u003eattach\u003c/code\u003e method;\u003c/li\u003e\n\u003cli\u003eif the call to \u003ccode\u003eattach\u003c/code\u003e fails, then module initialization\nfails.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"section_8.3.3\"\u003e8.3.3 Isolated inference\u003c/h4\u003e\n\n\u003cp\u003e\nA listener object can use the isolated bit of a service object and of a service\nobject's remote method to determine whether it is safe to make concurrent calls\nto the remote object or the remote method.\n\u003c/p\u003e\n\u003cp\u003e\nThe compiler may infer that a service object or a service object's remote method\nis isolated even it is not explicitly declared as such. In doing so, it analyzes\na module to determine whether there is a set of declarations and definitions in\nthe module, where each of them is a \u003ccode\u003eservice-decl\u003c/code\u003e,\n\u003ccode\u003emodule-var-decl\u003c/code\u003e, \u003ccode\u003emodule-class-defn\u003c/code\u003e\n\u003ccode\u003efunction-defn\u003c/code\u003e or \u003ccode\u003emethod-defn\u003c/code\u003e, and none of them\nexplicitly specified an \u003ccode\u003eisolated\u003c/code\u003e qualifier, such that if all them\nexplicitly specified an \u003ccode\u003eisolated\u003c/code\u003e qualifier, then they all would\nmeet the requirements for \u003ca href=\"#isolated_functions\"\u003eisolated functions\u003c/a\u003e\nand isolated objects. If so, then the isolated bit of values resulting from them\nis set in the same way as if \u003ccode\u003eisolated\u003c/code\u003e qualifiers had been\nexplicitly specified.\n\u003c/p\u003e\n\u003cp\u003e\nThis inference is purely an optimization to improve service concurrency and is\nsubject to two constraints. First, any inferences do not affect the static types\nvisible to other modules. Second, anything explicitly declared as\n\u003ccode\u003eisolated\u003c/code\u003e must satisfy the requirements of this specification\nwithout without relying on inference.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_8.4\"\u003e8.4 Function definition\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"function-defn\"\u003efunction-defn\u003c/span\u003e := \n   \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e\n   [\u003ccode\u003epublic\u003c/code\u003e] \u003ca href=\"#function-quals\"\u003e\u003cspan class=\"ntref\"\u003efunction-quals\u003c/span\u003e\u003c/a\u003e\n   \u003ccode\u003efunction\u003c/code\u003e \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#function-signature\"\u003e\u003cspan class=\"ntref\"\u003efunction-signature\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#function-defn-body\"\u003e\u003cspan class=\"ntref\"\u003efunction-defn-body\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"function-defn-body\"\u003efunction-defn-body\u003c/span\u003e :=\n   \u003ca href=\"#block-function-body\"\u003e\u003cspan class=\"ntref\"\u003eblock-function-body\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#expr-function-body\"\u003e\u003cspan class=\"ntref\"\u003eexpr-function-body\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n   | \u003ca href=\"#external-function-body\"\u003e\u003cspan class=\"ntref\"\u003eexternal-function-body\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nIf a module has a function-defn with an identifier of \u003ccode\u003einit\u003c/code\u003e, it is\ncalled called automatically by the system at the end of the initialization of\nthat module; if this call returns an error, then initialization of the module\nfails. The following special requirements apply to the \u003ccode\u003einit\u003c/code\u003e\nfunction of a module: it must not be declared \u003ccode\u003epublic\u003c/code\u003e; its return\ntype must both be a subtype of \u003ccode\u003eerror?\u003c/code\u003e and contain \u003ccode\u003e()\u003c/code\u003e;\nit must have no parameters.\n\u003c/p\u003e\n\u003cp\u003e\nIf the function-quals includes \u003ccode\u003etransactional\u003c/code\u003e, then\nexpr-function-body and the block-function-body are transactional scopes.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_8.5\"\u003e8.5 Module type definition\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"module-type-defn\"\u003emodule-type-defn\u003c/span\u003e :=\n   \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e\n   [\u003ccode\u003epublic\u003c/code\u003e] \u003ccode\u003etype\u003c/code\u003e \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nA module-type-defn binds the identifier to the specified type descriptor. The\nbinding is in the main symbol space. The type-descriptor is resolved as part of\nmodule initialization.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_8.6\"\u003e8.6 Module class definition\u003c/h3\u003e\n\u003cp\u003e\nA class is a type descriptor that in addition to describing an object type also\ndefines a way to construct an object belonging to the type; in particular, it\nprovides the method definitions that are associated with the object when it is\nconstructed.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"module-class-defn\"\u003emodule-class-defn\u003c/span\u003e :=\n   \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e\n   [\u003ccode\u003epublic\u003c/code\u003e] \u003ca href=\"#class-type-quals\"\u003e\u003cspan class=\"ntref\"\u003eclass-type-quals\u003c/span\u003e\u003c/a\u003e \u003ccode\u003eclass\u003c/code\u003e \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e{\u003c/code\u003e\n      \u003ca href=\"#class-member\"\u003e\u003cspan class=\"ntref\"\u003eclass-member\u003c/span\u003e\u003c/a\u003e*\n  \u003ccode\u003e}\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"class-type-quals\"\u003eclass-type-quals\u003c/span\u003e := (\u003ccode\u003edistinct\u003c/code\u003e | \u003ccode\u003ereadonly\u003c/code\u003e | \u003ca href=\"#isolated-qual\"\u003e\u003cspan class=\"ntref\"\u003eisolated-qual\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#object-network-qual\"\u003e\u003cspan class=\"ntref\"\u003eobject-network-qual\u003c/span\u003e\u003c/a\u003e)*\n\u003cspan class=\"ntdfn\" id=\"class-member\"\u003eclass-member\u003c/span\u003e :=\n   \u003ca href=\"#object-field\"\u003e\u003cspan class=\"ntref\"\u003eobject-field\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#method-defn\"\u003e\u003cspan class=\"ntref\"\u003emethod-defn\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#remote-method-defn\"\u003e\u003cspan class=\"ntref\"\u003eremote-method-defn\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#resource-method-defn\"\u003e\u003cspan class=\"ntref\"\u003eresource-method-defn\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#object-type-inclusion\"\u003e\u003cspan class=\"ntref\"\u003eobject-type-inclusion\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nIt is an error for a keyword to appear more than once in\n\u003ccode\u003eclass-type-quals\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nAs in an object constructor expression, a visibility qualifier of\n\u003ccode\u003eprivate\u003c/code\u003e can be used within a class definition; this means that the\nvisibility region consists of all method definitions in the class definition. If\nclass has private fields or methods, then it is not possible to define another\nobject type descriptor that is a subtype of the class's type.\n\u003c/p\u003e\n\u003cp\u003e\nIf \u003ccode\u003eclass-type-quals\u003c/code\u003e contains \u003ccode\u003ereadonly\u003c/code\u003e, then an object\nconstructed using the class will have its read-only bit set; the effective type\nof each field is thus the intersection of the specified type and\n\u003ccode\u003ereadonly\u003c/code\u003e; furthermore, an object shape belongs to the class's type\nonly if its read-only bit is set.\n\u003c/p\u003e\n\u003cp\u003e\nIf \u003ccode\u003eclass-type-quals\u003c/code\u003e contains \u003ccode\u003eisolated\u003c/code\u003e, then the\ndefined object type is an isolated type, and an object constructed using the\ntype will have its isolated bit set. An \u003ccode\u003eobject-field\u003c/code\u003e or\n\u003ccode\u003emethod-defn\u003c/code\u003e occurring as a \u003ccode\u003eclass-member\u003c/code\u003e in an isolated\nclass is subject to same requirements as when it occurs as an\n\u003ccode\u003eobject-member\u003c/code\u003e in an \u003ccode\u003eobject-constructor-expr\u003c/code\u003e that is\nexplicitly isolated.\n\u003c/p\u003e\n\u003cp\u003e\nIf an \u003ccode\u003eobject-type-inclusion\u003c/code\u003e references a type-descriptor that is a\nclass, then only the type of the class is included: the definitions of the\nmethods and any initializers for the fields are not included. If a class uses an\nobject-type-inclusion to include an object type T, then each method declared in\nT must be defined in the class using a \u003ccode\u003emethod-defn\u003c/code\u003e with the same\nvisibility. If T has a method or field with module-level visibility, then C must\nbe in the same module. If the class is readonly (i.e.\n\u003ccode\u003eclass-type-quals\u003c/code\u003e includes \u003ccode\u003ereadonly\u003c/code\u003e), then an\n\u003ccode\u003eobject-type-inclusion\u003c/code\u003e in the class is allowed to directly or\nindirectly reference a \u003ccode\u003ereadonly\u003c/code\u003e class or \u003ccode\u003ereadonly\u003c/code\u003e type\ndescriptor.\n\u003c/p\u003e\n\u003cp\u003e\nIf \u003ccode\u003eclass-type-quals\u003c/code\u003e contains \u003ccode\u003edistinct\u003c/code\u003e, then the\nprimary type-id of the class will the type-id of that occurrence of\n\u003ccode\u003edistinct\u003c/code\u003e, and the secondary type-ids will be the union of the\ntype-ids of the included object types. If \u003ccode\u003eclass-type-quals\u003c/code\u003e does not\ncontain \u003ccode\u003edistinct\u003c/code\u003e, then the type-ids of the class come from the\nincluded object types in the same way as with an object type descriptor.\n\u003c/p\u003e\n\u003cp\u003e\nAn object of a class is initialized by:\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eallocating storage for the object\u003c/li\u003e\n\u003cli\u003einitializing each field with its initializer, if it has one\u003c/li\u003e\n\u003cli\u003einitializing the methods of the object using the class's method definitions\u003c/li\u003e\n\u003cli\u003ecalling the class's \u003ccode\u003einit\u003c/code\u003e method, if there is one\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\nThe parameter list of an \u003ccode\u003einit\u003c/code\u003e method within an\n\u003ccode\u003emodule-class-defn\u003c/code\u003e is not required to be empty, unlike within an\n\u003ccode\u003eobject-constructor-expr\u003c/code\u003e.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_8.7\"\u003e8.7 Module variable declaration\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"module-var-decl\"\u003emodule-var-decl\u003c/span\u003e := \u003ca href=\"#module-init-var-decl\"\u003e\u003cspan class=\"ntref\"\u003emodule-init-var-decl\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#module-no-init-var-decl\"\u003e\u003cspan class=\"ntref\"\u003emodule-no-init-var-decl\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA module-var-decl declares a variable. The scope of variables declared in a\nmodule-var-decl is the entire module. The variable may be initialized in the\ndeclaration or within the module's \u003ccode\u003einit\u003c/code\u003e function. If\n\u003ccode\u003efinal\u003c/code\u003e is specified, then it is not allowed to assign to the\nvariable after it is initialized.\n\u003c/p\u003e\n\u003cpre class=\"grammar\"\u003e\n\u003cspan class=\"ntdfn\" id=\"module-init-var-decl\"\u003emodule-init-var-decl\u003c/span\u003e := \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003epublic\u003c/code\u003e] \u003ca href=\"#module-init-var-quals\"\u003e\u003cspan class=\"ntref\"\u003emodule-init-var-quals\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#typed-binding-pattern\"\u003e\u003cspan class=\"ntref\"\u003etyped-binding-pattern\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e=\u003c/code\u003e \u003ca href=\"#module-var-init\"\u003e\u003cspan class=\"ntref\"\u003emodule-var-init\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"module-init-var-quals\"\u003emodule-init-var-quals\u003c/span\u003e := (\u003ccode\u003efinal\u003c/code\u003e | \u003ca href=\"#isolated-qual\"\u003e\u003cspan class=\"ntref\"\u003eisolated-qual\u003c/span\u003e\u003c/a\u003e)* | \u003ccode\u003econfigurable\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"module-var-init\"\u003emodule-var-init\u003c/span\u003e := \u003ca href=\"#expression\"\u003e\u003cspan class=\"ntref\"\u003eexpression\u003c/span\u003e\u003c/a\u003e | \u003ccode\u003e?\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA module-init-var-decl declares and initializes a variable. It is an error for a\nkeyword to appear more than once in \u003ccode\u003emodule-init-var-quals\u003c/code\u003e. If the\ntyped-binding-pattern uses \u003ccode\u003evar\u003c/code\u003e, then the type of the variables is\ninferred from the static type of \u003ccode\u003eexpression\u003c/code\u003e; if the module-var-decl\nincludes \u003ccode\u003efinal\u003c/code\u003e or \u003ccode\u003econfigurable\u003c/code\u003e, the precise type is\nused, and otherwise the broad type is used. If the typed-binding-pattern\nspecifies a type-descriptor, then that type-descriptor provides the contextually\nexpected type for action-or-expr.\n\u003c/p\u003e\n\u003cp\u003e\nIf the module-init-var-decl includes \u003ccode\u003epublic\u003c/code\u003e, then the\ntyped-binding-pattern must not use \u003ccode\u003evar\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nIf a module-init-var-decl includes an isolated-qual, then the variable declared\nis isolated. In this case, \u003ccode\u003epublic\u003c/code\u003e must not be specified, the\nbinding-pattern in the typed-binding-pattern must be just a variable-name, and\nthe expression must be an isolated expression. A variable declared as an\nisolated variable can be accessed only within a lock-stmt. When an isolated-qual\noccurs in a position where the grammar would allow it to be parsed as part of\nmodule-init-var-quals or typed-binding-pattern, the former parse is used.\n\u003c/p\u003e\n\u003cp\u003e\nIf \u003ccode\u003econfigurable\u003c/code\u003e is specified, then the initializer specified in the\nmodule-var-init may be overridden at the time of module initialization by a\nvalue supplied when the program is run. If such a value is supplied, then the\nexpression in the module-var-init is not evaluated and the variable is\ninitialized with the supplied value instead. A module-var-init of \u003ccode\u003e?\u003c/code\u003e\nis allowed only when \u003ccode\u003econfigurable\u003c/code\u003e is specified and means that a\nconfigurable value must be supplied for this variable. If\n\u003ccode\u003econfigurable\u003c/code\u003e is specified, then the typed-binding-pattern must use\nan explicit type-descriptor rather than \u003ccode\u003evar\u003c/code\u003e and the binding-pattern\nmust be just a variable-name. The type specified by the type-descriptor must be\na subtype of \u003ccode\u003eanydata\u003c/code\u003e. A variable declared as\n\u003ccode\u003econfigurable\u003c/code\u003e is implicitly final, and cannot be assigned to outside\nthe declaration. The static type of a variable declared as\n\u003ccode\u003econfigurable\u003c/code\u003e is implicitly \u003ccode\u003ereadonly\u003c/code\u003e: the type\nspecified in the type-descriptor is intersected with \u003ccode\u003ereadonly\u003c/code\u003e. A\nconfigurable variable can thus always be referenced within an isolated function.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"module-no-init-var-decl\"\u003emodule-no-init-var-decl\u003c/span\u003e := \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003epublic\u003c/code\u003e] [\u003ccode\u003efinal\u003c/code\u003e] \u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#variable-name\"\u003e\u003cspan class=\"ntref\"\u003evariable-name\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA module variable declared with \u003ccode\u003emodule-no-init-var-decl\u003c/code\u003e must be\ninitialized in the module's \u003ccode\u003einit\u003c/code\u003e function. It must be definitely\nassigned at each point that the variable is referenced. If \u003ccode\u003efinal\u003c/code\u003e is\nspecified, then the variable must not be assigned more than once. The\n\u003ccode\u003etype-descriptor\u003c/code\u003e must not be \u003ccode\u003enever\u003c/code\u003e.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_8.8\"\u003e8.8 Module constant declaration\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"module-const-decl\"\u003emodule-const-decl\u003c/span\u003e :=\n   \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e\n   [\u003ccode\u003epublic\u003c/code\u003e] \u003ccode\u003econst\u003c/code\u003e [\u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e=\u003c/code\u003e \u003ca href=\"#const-expr\"\u003e\u003cspan class=\"ntref\"\u003econst-expr\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e;\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nA module-const-decl declares a compile-time constant. A compile-time constant is\nan named immutable value, known at compile-time. A compile-time constant can be\nused like a variable, and can also be referenced in contexts that require a\nvalue that is known at compile-time, such as in a type-descriptor or in a\nmatch-pattern.\n\u003c/p\u003e\n\u003cp\u003e\nThe type of the constant is the intersection of \u003ccode\u003ereadonly\u003c/code\u003e and the\nsingleton type containing just the shape of the value named by the constant. The\ntype of the constant determines the static type of a variable-reference-expr\nthat references this constant.\n\u003c/p\u003e\n\u003cp\u003e\nIf type-descriptor is present, then it provides the contextually expected type\nfor the interpretation of const-expr. It is a compile-time error if the static\ntype of const-expr is not a subtype of that type. The type-descriptor must\nspecify a type that is a subtype of anydata and must not be \u003ccode\u003enever\u003c/code\u003e.\nNote that the type-descriptor does not specify the type of the constant,\nalthough the type of the constant will all be a subtype of the type specified by\nthe type-descriptor.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_8.9\"\u003e8.9 Module enumeration declaration\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"module-enum-decl\"\u003emodule-enum-decl\u003c/span\u003e :=\n   \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e\n   [\u003ccode\u003epublic\u003c/code\u003e] \u003ccode\u003eenum\u003c/code\u003e \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e \u003ccode\u003e{\u003c/code\u003e \u003ca href=\"#enum-member\"\u003e\u003cspan class=\"ntref\"\u003eenum-member\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#enum-member\"\u003e\u003cspan class=\"ntref\"\u003eenum-member\u003c/span\u003e\u003c/a\u003e)* \u003ccode\u003e}\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"enum-member\"\u003eenum-member\u003c/span\u003e := \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e [\u003ccode\u003e=\u003c/code\u003e \u003ca href=\"#const-expr\"\u003e\u003cspan class=\"ntref\"\u003econst-expr\u003c/span\u003e\u003c/a\u003e]\n\u003c/pre\u003e\n\u003cp\u003e\nA module-enum-decl provides a convenient syntax for declaring a union of string constants.\n\u003c/p\u003e\n\u003cp\u003e\nEach enum-member is defined as compile-time constant in the same way as if it\nhad been defined using a module-const-decl. The result of evaluating the\nconst-expr must be a string. If the const-expr is omitted, it defaults to be the\nsame as the identifier.\n\u003c/p\u003e\n\u003cp\u003e\nThe identifier is defined as a type in the same was as if it had been defined by\na module-type-defn, with the type-descriptor being the union of the constants\ndefined by the members.\n\u003c/p\u003e\n\u003cp\u003e\nIf the module-enum-decl is public, then both the type and the constants are public.\n\u003c/p\u003e\n\u003cp\u003e\nSo for example:\n\u003c/p\u003e\n\u003cpre\u003e\npublic enum Color {\n  RED,\n  GREEN,\n  BLUE\n}\n\u003c/pre\u003e\n\u003cp\u003e\nis exactly equivalent to:\n\u003c/p\u003e\n\u003cpre\u003e\npublic const RED = \"RED\";\npublic const GREEN = \"GREEN\";\npublic const BLUE = \"BLUE\";\npublic type Color RED|GREEN|BLUE;\n\u003c/pre\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_8.10\"\u003e8.10 Module XML namespace declaration\u003c/h3\u003e\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"module-xmlns-decl\"\u003emodule-xmlns-decl\u003c/span\u003e := \u003ca href=\"#xmlns-decl\"\u003e\u003cspan class=\"ntref\"\u003exmlns-decl\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\n\u003cp\u003e\nA \u003ccode\u003emodule-xmlns-decl\u003c/code\u003e declares an XML namespace prefix with module\nscope. It applies only to the source part in which it occurs, as with an\nimport-decl.\n\u003c/p\u003e\n\u003cp\u003e\nThe semantics of xmlns-decl are described in the \u003ca href=\"#XML_namespace_declaration_statement\"\u003eXML namespace declaration\nstatement\u003c/a\u003e section.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch2 id=\"metadata\"\u003e9. Metadata\u003c/h2\u003e\n\u003cp\u003e\nBallerina allows metadata to be attached to a construct by specifying the\nmetadata before the construct.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"metadata\"\u003emetadata\u003c/span\u003e := [\u003ca href=\"#DocumentationString\"\u003e\u003cspan class=\"ntref\"\u003eDocumentationString\u003c/span\u003e\u003c/a\u003e] [\u003ca href=\"#annots\"\u003e\u003cspan class=\"ntref\"\u003eannots\u003c/span\u003e\u003c/a\u003e]\n\u003c/pre\u003e\n\u003cp\u003e\nThere are two forms of metadata: documentation and annotations.\n\u003c/p\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_9.1\"\u003e9.1 Annotations\u003c/h3\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"annots\"\u003eannots\u003c/span\u003e := \u003ca href=\"#annotation\"\u003e\u003cspan class=\"ntref\"\u003eannotation\u003c/span\u003e\u003c/a\u003e+\n\u003cspan class=\"ntdfn\" id=\"annotation\"\u003eannotation\u003c/span\u003e := \u003ccode\u003e@\u003c/code\u003e \u003ca href=\"#annot-tag-reference\"\u003e\u003cspan class=\"ntref\"\u003eannot-tag-reference\u003c/span\u003e\u003c/a\u003e \u003ca href=\"#annot-value\"\u003e\u003cspan class=\"ntref\"\u003eannot-value\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nAnnotations provide structured metadata about a particular construct. Multiple\nannotations can be applied to a single construct. An annotation consists of a\ntag and a value.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"annotation-decl\"\u003eannotation-decl\u003c/span\u003e :=\n   \u003ca href=\"#metadata\"\u003e\u003cspan class=\"ntref\"\u003emetadata\u003c/span\u003e\u003c/a\u003e\n   [\u003ccode\u003epublic\u003c/code\u003e] [\u003ccode\u003econst\u003c/code\u003e] \u003ccode\u003eannotation\u003c/code\u003e [\u003ca href=\"#type-descriptor\"\u003e\u003cspan class=\"ntref\"\u003etype-descriptor\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#annot-tag\"\u003e\u003cspan class=\"ntref\"\u003eannot-tag\u003c/span\u003e\u003c/a\u003e \n   [\u003ccode\u003eon\u003c/code\u003e \u003ca href=\"#annot-attach-points\"\u003e\u003cspan class=\"ntref\"\u003eannot-attach-points\u003c/span\u003e\u003c/a\u003e] \u003ccode\u003e;\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"annot-tag\"\u003eannot-tag\u003c/span\u003e := \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nAn annotation-decl declares an annotation tag. Annotations tags are in a\nseparate symbol space and cannot conflict with other module level declarations\nand definitions. The annotation tag symbol space is also distinct from the\nsymbol space used by module prefixes and XML namespace prefixes.\n\u003c/p\u003e\n\u003cp\u003e\nThe type-descriptor specifies the type of the annotation tag. The type must be a\nsubtype of one of the following three types: \u003ccode\u003etrue\u003c/code\u003e,\n\u003ccode\u003emap\u0026lt;value:Cloneable\u0026gt;\u003c/code\u003e,\n\u003ccode\u003emap\u0026lt;value:Cloneable\u0026gt;[]\u003c/code\u003e. If the type-descriptor is omitted,\nthen the type is \u003ccode\u003etrue\u003c/code\u003e.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"annot-tag-reference\"\u003eannot-tag-reference\u003c/span\u003e := \u003ca href=\"#qualified-identifier\"\u003e\u003cspan class=\"ntref\"\u003equalified-identifier\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#identifier\"\u003e\u003cspan class=\"ntref\"\u003eidentifier\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"annot-value\"\u003eannot-value\u003c/span\u003e := [\u003ca href=\"#mapping-constructor-expr\"\u003e\u003cspan class=\"ntref\"\u003emapping-constructor-expr\u003c/span\u003e\u003c/a\u003e]\n\u003c/pre\u003e\n\u003cp\u003e\nAn annot-tag-reference in an annotation must refer to an annot-tag declared in\nan annotation declaration. When an annot-tag-reference is a\nqualified-identifier, then the module-prefix of the qualified-identifier is\nresolved using import declarations into a reference to a module, and that module\nmust contain an annotation-decl with the same identifier. An annot-tag-reference\nthat is an identifier rather than a qualified-identifier does \u003cem\u003enot\u003c/em\u003e refer\nto an annotation defined within the same module. Rather the compilation\nenvironment determines which identifiers can occur as an\nannotation-tag-reference, and for each such identifier which module defines that\nannotation tag.\n\u003c/p\u003e\n\u003cp\u003e\nEach annotation has a value. For every construct that has an annotation with a\nparticular tag, there is also an \u003cem\u003eeffective value\u003c/em\u003e for that annotation\ntag, which is constructed from the values of all annotations with that tag that\nwere attached to that construct. The effective value belongs to the type\ndeclared for the annotation tag. The type of the annotation tag determines the\ntype of the annotation value and whether multiple annotations with the same tag\non a single construct are allowed. For an annotation tag declared with type T,\nif T is M[] for some type mapping type M, then the type of the annotation value\nis M, multiple annotations are allowed, and the effective value is an array of\nthe values for each annotation; otherwise the type of the annotation value is T,\nmultiple annotations are not allowed, the effective value is the value of the\nsingle annotation.\n\u003c/p\u003e\n\u003cp\u003e\nIf the type of the annotation value is \u003ccode\u003etrue\u003c/code\u003e, then a\nmapping-constructor-expr is not allowed, and the annotation value is\n\u003ccode\u003etrue\u003c/code\u003e. Otherwise the type of the annotation value must be a mapping\ntype M; if a mapping-constructor-expr is not specified, then it defaults to\n\u003ccode\u003e{ }\u003c/code\u003e; the mapping-constructor-expr must have static type M and the\nannotation value is the result of evaluating the mapping-constructor-expr with M\nas the contextually expected type.\n\u003c/p\u003e\n\u003cp\u003e\nIf the annotation-decl for a tag specifies \u003ccode\u003econst\u003c/code\u003e, then a\nmapping-constructor-expr in annotations with that tag must be a const-expr and\nis evaluated at compile-time with the semantics of a const-expr. Otherwise, the\nmapping-constructor-expr is evaluated when the annotation is evaluated and the\nImmutableClone abstract operation is applied to the result.\n\u003c/p\u003e\n\u003cp\u003e\nAn annotation applied to a module-level declaration is evaluated when the module\nis initialized. An annotation applied to a service constructor is evaluated when\nthe service constructor is evaluated. An annotation occurring within a type\ndescriptor is evaluated when the type descriptor is resolved.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"annot-attach-points\"\u003eannot-attach-points\u003c/span\u003e := \u003ca href=\"#annot-attach-point\"\u003e\u003cspan class=\"ntref\"\u003eannot-attach-point\u003c/span\u003e\u003c/a\u003e (\u003ccode\u003e,\u003c/code\u003e \u003ca href=\"#annot-attach-point\"\u003e\u003cspan class=\"ntref\"\u003eannot-attach-point\u003c/span\u003e\u003c/a\u003e)*\n\u003cspan class=\"ntdfn\" id=\"annot-attach-point\"\u003eannot-attach-point\u003c/span\u003e :=\n   \u003ca href=\"#dual-attach-point\"\u003e\u003cspan class=\"ntref\"\u003edual-attach-point\u003c/span\u003e\u003c/a\u003e\n   | \u003ca href=\"#source-only-attach-point\"\u003e\u003cspan class=\"ntref\"\u003esource-only-attach-point\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"dual-attach-point\"\u003edual-attach-point\u003c/span\u003e := [\u003ccode\u003esource\u003c/code\u003e] \u003ca href=\"#dual-attach-point-ident\"\u003e\u003cspan class=\"ntref\"\u003edual-attach-point-ident\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"dual-attach-point-ident\"\u003edual-attach-point-ident\u003c/span\u003e :=\n   \u003ccode\u003etype\u003c/code\u003e\n   | \u003ccode\u003eclass\u003c/code\u003e\n   | [\u003ccode\u003eobject\u003c/code\u003e|\u003ccode\u003eservice\u003c/code\u003e \u003ccode\u003eremote\u003c/code\u003e] \u003ccode\u003efunction\u003c/code\u003e\n   | \u003ccode\u003eparameter\u003c/code\u003e\n   | \u003ccode\u003ereturn\u003c/code\u003e\n   | \u003ccode\u003eservice\u003c/code\u003e\n   | [\u003ccode\u003eobject\u003c/code\u003e|\u003ccode\u003erecord\u003c/code\u003e] \u003ccode\u003efield\u003c/code\u003e\n\u003cspan class=\"ntdfn\" id=\"source-only-attach-point\"\u003esource-only-attach-point\u003c/span\u003e := \u003ccode\u003esource\u003c/code\u003e \u003ca href=\"#source-only-attach-point-ident\"\u003e\u003cspan class=\"ntref\"\u003esource-only-attach-point-ident\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"source-only-attach-point-ident\"\u003esource-only-attach-point-ident\u003c/span\u003e :=\n   \u003ccode\u003eannotation\u003c/code\u003e\n   | \u003ccode\u003eexternal\u003c/code\u003e\n   | \u003ccode\u003evar\u003c/code\u003e\n   | \u003ccode\u003econst\u003c/code\u003e\n   | \u003ccode\u003elistener\u003c/code\u003e\n   | \u003ccode\u003eworker\u003c/code\u003e\n\u003c/pre\u003e\n\u003cp\u003e\nThe \u003ccode\u003eannot-attach-points\u003c/code\u003e specify the constructs to which an\nannotation can be attached.\n\u003c/p\u003e\n\u003cp\u003e\nWhen an attachment point is prefixed with \u003ccode\u003esource\u003c/code\u003e, then the\nannotation is attached to a fragment of the source rather than to any runtime\nvalue, and thus is not available at runtime. If any of the attachment points\nspecify \u003ccode\u003esource\u003c/code\u003e, the annotation-decl must specify\n\u003ccode\u003econst\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nWhen an attachment point is not prefixed with source, then the annotation is\naccessible at runtime by applying the annotation access operator to a typedesc\nvalue.\n\u003c/p\u003e\n\u003cp\u003e\nThe available attachment points are described in the following table.\n\u003c/p\u003e\n\u003ctable\u003e\n  \u003ctr\u003e\n   \u003ctd\u003e\u003cstrong\u003eAttachment point name\u003c/strong\u003e\u003c/td\u003e\n   \u003ctd\u003e\u003cstrong\u003eSyntactic attachment point(s)\u003c/strong\u003e\u003c/td\u003e\n   \u003ctd\u003e\u003cstrong\u003eAttached to which type descriptor at runtime\u003c/strong\u003e\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003etype\u003c/td\u003e\n   \u003ctd\u003emodule-type-defn, module-enum-decl, type-cast-expr\u003c/td\u003e\n   \u003ctd\u003edefined type\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eclass\u003c/td\u003e\n   \u003ctd\u003emodule-class-defn\u003c/td\u003e\n   \u003ctd\u003edefined type (which will be type of objects constructed using this class)\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003efunction\u003c/td\u003e\n   \u003ctd\u003efunction-defn, method-decl, method-defn, anonymous-function-expr\u003c/td\u003e\n   \u003ctd\u003etype of function\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eobject function\u003c/td\u003e\n   \u003ctd\u003emethod-decl, method-defn\u003c/td\u003e\n   \u003ctd\u003etype of function\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eservice remote function\u003c/td\u003e\n   \u003ctd\u003emethod-defn with remote qualifier on service object\u003c/td\u003e\n   \u003ctd\u003etype of function, on service value\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003ereturn\u003c/td\u003e\n   \u003ctd\u003ereturn-type-descriptor\u003c/td\u003e\n   \u003ctd\u003eindirectly to type of function\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eparameter\u003c/td\u003e\n   \u003ctd\u003erequired-param, defaultable-param, included-record-param, rest-param\u003c/td\u003e\n   \u003ctd\u003eindirectly to type of function\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eservice\u003c/td\u003e\n   \u003ctd\u003eservice-decl, object-constructor-expr with service qualifier\u003c/td\u003e\n   \u003ctd\u003etype of service\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003efield\u003c/td\u003e\n   \u003ctd\u003eindividual-field-descriptor, object-field-descriptor\u003c/td\u003e\n   \u003ctd\u003etype of mapping or object\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eobject field\u003c/td\u003e\n   \u003ctd\u003eobject-field-descriptor, object-field\u003c/td\u003e\n   \u003ctd\u003etype of object\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003erecord field\u003c/td\u003e\n   \u003ctd\u003eindividual-field-descriptor\u003c/td\u003e\n   \u003ctd\u003etype of mapping\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003elistener\u003c/td\u003e\n   \u003ctd\u003elistener-decl\u003c/td\u003e\n   \u003ctd\u003enone\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003evar\u003c/td\u003e\n   \u003ctd\u003emodule-var-decl, local-var-decl-stmt, let-var-decl\u003c/td\u003e\n   \u003ctd\u003enone\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003econst\u003c/td\u003e\n   \u003ctd\u003emodule-const-decl, enum-member\u003c/td\u003e\n   \u003ctd\u003enone\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eannotation\u003c/td\u003e\n   \u003ctd\u003eannotation-decl\u003c/td\u003e\n   \u003ctd\u003enone\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eexternal\u003c/td\u003e\n   \u003ctd\u003eexternal-function-body\u003c/td\u003e\n   \u003ctd\u003enone\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n   \u003ctd\u003eworker\u003c/td\u003e\n   \u003ctd\u003enamed-worker-decl, start-action\u003c/td\u003e\n   \u003ctd\u003enone\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_9.2\"\u003e9.2 Documentation\u003c/h3\u003e\n\u003cp\u003e\nA documentation string is an item of metadata that can be associated with\nmodule-level Ballerina constructs and with method declarations. The purpose of\nthe documentation strings for a module is to enable a programmer to use the\nmodule. Information not useful for this purpose should be provided in in\ncomments.\n\u003c/p\u003e\n\u003cp\u003e\nA documentation string has the format of one or more lines each of which has a\n\u003ccode\u003e#\u003c/code\u003e optionally preceded by blank space.\n\u003c/p\u003e\n\u003cp\u003e\nThe documentation statement is used to document various Ballerina constructs.\n\u003c/p\u003e\n\n\u003cpre class=\"grammar\"\u003e\u003cspan class=\"ntdfn\" id=\"DocumentationString\"\u003eDocumentationString\u003c/span\u003e := \u003ca href=\"#DocumentationLine\"\u003e\u003cspan class=\"ntref\"\u003eDocumentationLine\u003c/span\u003e\u003c/a\u003e +\n\u003cspan class=\"ntdfn\" id=\"DocumentationLine\"\u003eDocumentationLine\u003c/span\u003e := \u003ca href=\"#BlankSpace\"\u003e\u003cspan class=\"ntref\"\u003eBlankSpace\u003c/span\u003e\u003c/a\u003e* \u003ccode\u003e#\u003c/code\u003e [\u003ca href=\"#Space\"\u003e\u003cspan class=\"ntref\"\u003eSpace\u003c/span\u003e\u003c/a\u003e] \u003ca href=\"#DocumentationContent\"\u003e\u003cspan class=\"ntref\"\u003eDocumentationContent\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"DocumentationContent\"\u003eDocumentationContent\u003c/span\u003e := (^ 0xA)* 0xA\n\u003cspan class=\"ntdfn\" id=\"BlankSpace\"\u003eBlankSpace\u003c/span\u003e := \u003ca href=\"#Tab\"\u003e\u003cspan class=\"ntref\"\u003eTab\u003c/span\u003e\u003c/a\u003e | \u003ca href=\"#Space\"\u003e\u003cspan class=\"ntref\"\u003eSpace\u003c/span\u003e\u003c/a\u003e\n\u003cspan class=\"ntdfn\" id=\"Space\"\u003eSpace\u003c/span\u003e := 0x20\n\u003cspan class=\"ntdfn\" id=\"Tab\"\u003eTab\u003c/span\u003e := 0x9\n\u003c/pre\u003e\n\u003cp\u003e\nA \u003ccode\u003eDocumentationString\u003c/code\u003e is recognized only at the beginning of a\nline. The content of a documentation string is the concatenation of the\n\u003ccode\u003eDocumentationContent\u003c/code\u003e of each \u003ccode\u003eDocumentationLine\u003c/code\u003e in the\n\u003ccode\u003eDocumentationString\u003c/code\u003e. Note that a single space following the # is\nnot treated as part of the DocumentationContent.\n\u003c/p\u003e\n\u003cp\u003e\nThe content of a \u003ccode\u003eDocumentationString\u003c/code\u003e is parsed as Ballerina\nFlavored Markdown (BFM). BFM is also used for a separate per-module\ndocumentation file, conventionally called \u003ccode\u003eModule.md\u003c/code\u003e.\n\u003c/p\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_9.3\"\u003e9.3 Ballerina Flavored Markdown\u003c/h3\u003e\n\u003cp\u003e\nBallerina Flavored Markdown is GitHub Flavored Markdown, with some additional\nconventions.\n\u003c/p\u003e\n\u003cp\u003e\nIn the documentation string attached to a function or method, there must be\ndocumentation for each parameter, and for the return value if the return value\nis not nil. The documentation for the parameters and a return value must consist\nof a Markdown list, where each list item must have the form \u003ccode\u003eident -\ndoc\u003c/code\u003e, where ident is either the parameter name or return, and doc is the\ndocumentation of that parameter or of the return value.\n\u003c/p\u003e\n\u003cp\u003e\nThe documentation for an object must contain a list of fields rather than\nparameters. Private fields should not be included in the list.\n\u003c/p\u003e\n\u003cp\u003e\nBFM also provides conventions for referring to Ballerina-defined names from\nwithin documentation strings in a source file. An identifier in backticks\n\u003ccode\u003e`X`\u003c/code\u003e, when preceded by one of the following words:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003etype\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eservice\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003evariable\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003evar\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eannotation\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emodule\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003efunction\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eparameter\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nis assumed to be a reference to a Ballerina-defined name of the type indicated\nby the word. In the case of \u003ccode\u003eparameter\u003c/code\u003e, the name must be unqualified\nand be the name of a parameter of the function to which the documentation string\nis attached. For other cases, if the name is unqualified it must refer to a\npublic name of the appropriate type in the source file's module; if it is a\nqualified name M:X, then the source file must have imported M, and X must refer\nto a public name of an appropriate type in M. BFM also recognizes\n\u003ccode\u003e`f()`\u003c/code\u003e as an alternative to \u003ccode\u003efunction `f`\u003c/code\u003e. In both\ncases, f can have any of the following forms (where `m` is a module import, `x` is a\nfunction name, `T` is an object type name, and `y` is a method name):\n\u003c/p\u003e\n\n\u003cpre\u003e    x()\n    m:x()\n    T.y()\n    m:T.y()\n\u003c/pre\u003e\n\u003cp\u003e\nExample\n\u003c/p\u003e\n\n\u003cpre\u003e    # Adds parameter `x` and parameter `y`\n    # + x - one thing to be added\n    # + y - another thing to be added\n    # + return - the sum of them\n    function add (int x, int y) returns int { return x + y; }\n\u003c/pre\u003e\n\n\u003cp\u003e\nThe Ballerina platform may define additional conventions, in particular relating\nto headings with particular content. For example, a heading with a content of\n\u003ccode\u003eDeprecated\u003c/code\u003e can be used to provide information about the deprecation\nof the name to which the documentation string is attached.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch2 id=\"lang_library\"\u003e10. Lang library\u003c/h2\u003e\n\n\u003cp\u003e\nModules in the \u003ccode\u003eballerina\u003c/code\u003e organization with a module name starting\nwith \u003ccode\u003elang.\u003c/code\u003e are reserved for use by this specification. These\nmodules are called the \u003cem\u003elang library\u003c/em\u003e.\n\u003c/p\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_10.1\"\u003e10.1 Generic types\u003c/h3\u003e\n\u003cp\u003e\nModules in the lang library can make use generic typing. Since generic typing\nhas not yet been added to Ballerina, the source code for the modules use an\nannotation to describe generic typing as follows. When a module type definition\nhas a \u003ccode\u003e@typeParam\u003c/code\u003e annotation, it means that this type serves as a\ntype parameter when it is used in a function definition: all uses of the type\nparameter in a function definition refer to the same type; the definition of the\ntype is an upper bound on the type parameter. A parameter of a function\ndefinition can be annotated with an \u003ccode\u003e@isolatedParam\u003c/code\u003e annotation; this\nis allowed when the function is declared as isolated and the type of the\nparameter is a function type; the meaning is that when the function is called in\na context that requires it to be isolated, then the argument supplied for the\nparameter must also be isolated. In effect, the function is parameterized with\nthe isolated qualifier.\n\u003c/p\u003e\n\u003cp\u003e\n\u003cstrong\u003eNote\u003c/strong\u003e We plan to provide full support for generic types in\na future version of this specification.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"built-in_subtypes\"\u003e10.2 Built-in subtypes\u003c/h3\u003e\n\u003cp\u003e\nA module in the lang library can provide types that are \u003cem\u003ebuilt-in\u003c/em\u003e in the\nsense that their meaning is defined by this specification. Each such built-in\ntype is a subtype of a single basic type; a built-in type that is a subtype of a\nbasic type \u003ccode\u003e\u003cvar\u003eB\u003c/var\u003e\u003c/code\u003e is provided by the module\n\u003ccode\u003elang.\u003cvar\u003eB\u003c/var\u003e\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nThe built-types provided by lang library modules are described in the following\ntable.\n\u003c/p\u003e\n\n\u003ctable\u003e\n\u003ctr\u003e\n\u003cth\u003eBasic type\u003c/th\u003e\n\u003cth\u003eType name\u003c/th\u003e\n\u003cth\u003eCriteria for \u003cem\u003ev\u003c/em\u003e to belong to type\u003c/th\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd rowspan=\"6\"\u003eint\u003c/td\u003e\n\u003ctd\u003eUnsigned8\u003c/td\u003e\n\u003ctd\u003e0 â¤ \u003cem\u003ev\u003c/em\u003e â¤ 255\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSigned8\u003c/td\u003e\n\u003ctd\u003e-128 â¤ \u003cem\u003ev\u003c/em\u003e â¤ 127\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUnsigned16\u003c/td\u003e\n\u003ctd\u003e0 â¤ \u003cem\u003ev\u003c/em\u003e â¤ 65,535\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSigned16\u003c/td\u003e\n\u003ctd\u003e-32,768 â¤ \u003cem\u003ev\u003c/em\u003e â¤ 32,767\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUnsigned32\u003c/td\u003e\n\u003ctd\u003e0 â¤ \u003cem\u003ev\u003c/em\u003e â¤ 4,294,967,295\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSigned32\u003c/td\u003e\n\u003ctd\u003e-2,147,483,648â¬ â¤ \u003cem\u003ev\u003c/em\u003e â¤ 2,147,483,6487\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eChar\u003c/td\u003e\n\u003ctd\u003e\n\u003cem\u003ev\u003c/em\u003e has length 1\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd rowspan=\"4\"\u003exml\u003c/td\u003e\n\u003ctd\u003eElement\u003c/td\u003e\n\u003ctd\u003e\n\u003cem\u003ev\u003c/em\u003e is an element singleton\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eProcessingInstruction\u003c/td\u003e\n\u003ctd\u003e\n\u003cem\u003ev\u003c/em\u003e is a processing instruction singleton\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eComment\u003c/td\u003e\n\u003ctd\u003e\n\u003cem\u003ev\u003c/em\u003e is a comment singleton\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eText\u003c/td\u003e\n\u003ctd\u003e\n\u003cem\u003ev\u003c/em\u003e is either the empty xml value or a text singleton\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003cp\u003e\nEach built-in type has a type definition in the module that provides it. The\ntype descriptor of the type definition is the corresponding basic type. The type\ndefinition has a \u003ccode\u003e@builtinSubtype\u003c/code\u003e annotation, which indicates that\nthe meaning of the type name is built-in, as specified in the above table,\nrather than coming from its type descriptor. It is an error to use the\n\u003ccode\u003e@builtinSubtype\u003c/code\u003e annotation except in a lang library module.\n\u003c/p\u003e\n\u003cp\u003e\nSo, for example, the \u003ccode\u003elang.int\u003c/code\u003e module would include the definition:\n\u003c/p\u003e\n\u003cpre\u003e\n@builtinSubtype\ntype Signed32 int;\n\u003c/pre\u003e\n\u003cp\u003e\nSemantically, these types behave like a predefined type that can be referenced\nby an unqualified name, such as \u003ccode\u003ebyte\u003c/code\u003e. Syntactically, these types\nare referenced by a \u003ccode\u003etype-reference\u003c/code\u003e in the same way as if their\ndefinitions were not built-in. A built-in type \u003ccode\u003eT\u003c/code\u003e which is a subtype\nof basic type \u003ccode\u003eB\u003c/code\u003e can be referenced by a type-reference\n\u003ccode\u003eM:T\u003c/code\u003e, where \u003ccode\u003eM\u003c/code\u003e is a module-prefix referring to module\n\u003ccode\u003eballerina/lang.B\u003c/code\u003e.\n\u003c/p\u003e\n\u003cp\u003e\nFor convenience, this specification refers to the built-in subtype T provided by\nthe module for basic type B as B:T. For example, in this specification\n\u003ccode\u003eint:Signed32\u003c/code\u003e refers to the \u003ccode\u003eSigned32\u003c/code\u003e built-in subtype\nof \u003ccode\u003eint\u003c/code\u003e, which is provided by the \u003ccode\u003elang.int\u003c/code\u003e module.\n\u003c/p\u003e\n\u003cp\u003e\nThe \u003ccode\u003eint:Unsigned8\u003c/code\u003e type is equivalent to the predefined\n\u003ccode\u003ebyte\u003c/code\u003e type.\n\u003c/p\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_10.3\"\u003e10.3 Lang library modules\u003c/h3\u003e\n\u003cp\u003e\nThe lang library consists of the following modules. With the exception of the\n\u003ccode\u003elang.value\u003c/code\u003e, \u003ccode\u003elang.transaction\u003c/code\u003e and\n\u003ccode\u003elang.runtime\u003c/code\u003e modules, each corresponds to a basic type.\n\u003c/p\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lang.array\"\u003e10.3.1 \u003ccode\u003elang.array\u003c/code\u003e module\u003c/h4\u003e\n\n\u003cp\u003eThe \u003ccode\u003elang.array\u003c/code\u003e module corresponds to basic type list.\u003c/p\u003e\n\n\u003cpre class=\"langlib\"\u003e\n\n# A type parameter that is a subtype of `any|error`.\n# Has the special semantic that when used in a declaration\n# all uses in the declaration must refer to same type.\n@typeParam\ntype Type any|error;\n\n# A type parameter that is a subtype of `any|error`.\n# Has the special semantic that when used in a declaration\n# all uses in the declaration must refer to same type.\n@typeParam\ntype Type1 any|error;\n\n# A type parameter that is a subtype of `anydata|error`.\n# Has the special semantic that when used in a declaration\n# all uses in the declaration must refer to same type.\n@typeParam\ntype AnydataType anydata;\n\n# Returns the number of members of an array.\n#\n# + arr - the array\n# + return - number of members in `arr`\npublic isolated function length((any|error)[] arr) returns int = external;\n\n# Returns an iterator over an array.\n#\n# + arr - the array\n# + return - a new iterator object that will iterate over the members of `arr`.\npublic isolated function iterator(Type[] arr) returns object {\n    public isolated function next() returns record {|\n        Type value;\n    |}?;\n} = external;\n\n# Returns a new array consisting of index and member pairs.\n#\n# + arr - the array\n# + return - array of index, member pairs\npublic isolated function enumerate(Type[] arr) returns [int, Type][] = external;\n\n\n# Applies a function to each member of an array and returns an array of the results.\n#\n# + arr - the array\n# + func - a function to apply to each member\n# + return - new array containing result of applying `func` to each member of `arr` in order\npublic isolated function 'map(Type[] arr, @isolatedParam function(Type val) returns Type1 func) returns Type1[] = external;\n\n# Applies a function to each member of an array.\n# The function `func` is applied to each member of array `arr` in order.\n#\n# + arr - the array\n# + func - a function to apply to each member\npublic isolated function forEach(Type[] arr, @isolatedParam function(Type val) returns () func) returns () = external;\n\n# Selects the members from an array for which a function returns true.\n#\n# + arr - the array\n# + func - a predicate to apply to each member to test whether it should be selected\n# + return - new array only containing members of `arr` for which `func` evaluates to true\npublic isolated function filter(Type[] arr, @isolatedParam function(Type val) returns boolean func) returns Type[] = external;\n\n# Combines the members of an array using a combining function.\n# The combining function takes the combined value so far and a member of the array,\n# and returns a new combined value.\n#\n# + arr - the array\n# + func - combining function\n# + initial - initial value for the first argument of combining function `func`\n# + return - result of combining the members of `arr` using `func`\n#\n# For example\n# ```\n# reduce([1, 2, 3], function (int total, int n) returns int { return total + n; }, 0)\n# ```\n# is the same as `sum(1, 2, 3)`.\npublic isolated function reduce(Type[] arr, @isolatedParam function(Type1 accum, Type val) returns Type1 func, Type1 initial) returns Type1 = external;\n\n# Returns a slice of an array.\n#\n# + arr - the array\n# + startIndex - index of first member to include in the slice\n# + endIndex - index of first member not to include in the slice\n# + return - new array containing members of `arr` with index \u0026gt;= `startIndex` and \u0026lt; `endIndex` \npublic isolated function slice(Type[] arr, int startIndex, int endIndex = arr.length()) returns Type[] = external;\n\n# Removes a member of an array.\n#\n# + arr - the array\n# + index - index of member to be removed from `arr`\n# + return - the member of `arr` that was at `index`\n# This removes the member of `arr` with index `index` and returns it.\n# It panics if there is no such member.\npublic isolated function remove(Type[] arr, int index) returns Type = external;\n\n# Removes all members of an array.\n# + arr - the array\n# Panics if any member cannot be removed.\npublic isolated function removeAll((any|error)[] arr) returns () = external;\n\n# Changes the length of an array.\n# \n# + arr - the array of which to change the length\n# + length - new length\n# `setLength(arr, 0)` is equivalent to `removeAll(arr)`.\npublic isolated function setLength((any|error)[] arr, int length) returns () = external;\n\n# Returns the index of first member of `arr` that is equal to `val` if there is one.\n# Returns `()` if not found.\n# Equality is tested using `==`.\n#\n# + arr - the array\n# + val - member to search for\n# + startIndex - index to start the search from\n# + return - index of the member if found, else `()`\npublic isolated function indexOf(AnydataType[] arr, AnydataType val, int startIndex = 0) returns int? = external;\n\n# Returns the index of last member of `arr` that is equal to `val` if there is one.\n# Returns `()` if not found.\n# Equality is tested using `==`.\n#\n# + arr - the array\n# + val - member to search for\n# + startIndex - index to start searching backwards from\n# + return - index of the member if found, else `()`\npublic isolated function lastIndexOf(AnydataType[] arr, AnydataType val, int startIndex = arr.length() - 1) returns int? = external;\n\n# Reverses the order of the members of an array.\n#\n# + arr - the array to be reversed\n# + return - new array with the members of `arr` in reverse order\npublic isolated function reverse(Type[] arr) returns Type[] = external;\n\n# Direction for `sort` function.\npublic enum SortDirection {\n   ASCENDING = \"ascending\",\n   DESCENDING = \"descending\"\n}\n\n# A type of which any ordered type must be a subtype.\n# Whether a type is an ordered type cannot be defined in\n# terms of being a subtype of a type, so being a subtype\n# of `OrderedType` is a necessary but not sufficient condition\n# for a type to be an ordered type.\npublic type OrderedType ()|boolean|int|float|decimal|string|OrderedType[];\n\n# Sorts an array.\n# If the member type of the array is not sorted, then the `key` function\n# must be specified.\n# Sorting works the same as with the `sort` clause of query expressions.\n#\n# + arr - the array to be sorted; \n# + direction - direction in which to sort\n# + key - function that returns a key to use to sort the members\n# + return - new array consisting of the members of `arr` in sorted order\npublic isolated function sort(Type[] arr, SortDirection direction = ASCENDING,\n        (isolated function(Type val) returns OrderedType)? key = ()) returns Type[] = external;\n\n\n# Removes and returns the last member of an array.\n# The array must not be empty.\n#\n# + arr - the array\n# + return - removed member\npublic isolated function pop(Type[] arr) returns Type = external;\n\n# Adds values to the end of an array.\n#\n# + arr - the array\n# + vals - values to add to the end of the array\npublic isolated function push(Type[] arr, Type... vals) returns () = external;\n\n\n# Removes and returns first member of an array.\n# The array must not be empty.\n#\n# + arr - the array\n# + return - the value that was the first member of the array\npublic isolated function shift(Type[] arr) returns Type = external;\n\n# Adds values to the start of an array.\n# The values newly added to the array will be in the same order\n# as they are in `vals`.\n# \n# + arr - the array\n# + vals - values to add to the start of the array\npublic isolated function unshift(Type[] arr, Type... vals) returns () = external;\n\n\n# Returns the string that is the Base64 representation of an array of bytes.\n# The representation is the same as used by a Ballerina Base64Literal.\n# The result will contain only characters  `A..Z`, `a..z`, `0..9`, `+`, `/` and `=`.\n# There will be no whitespace in the returned string.\n#\n# + arr - the array\n# + return - Base64 string representation\npublic isolated function toBase64(byte[] arr) returns string = external;\n\n# Returns the byte array that a string represents in Base64.\n# `str` must consist of the characters `A..Z`, `a..z`, `0..9`, `+`, `/`, `=`\n# and whitespace as allowed by a Ballerina Base64Literal.\n#\n# + str - Base64 string representation\n# + return - the byte array or error\npublic isolated function fromBase64(string str) returns byte[]|error = external;\n\n# Returns the string that is the Base16 representation of an array of bytes.\n# The representation is the same as used by a Ballerina Base16Literal.\n# The result will contain only characters  `0..9`, `a..f`.\n# There will be no whitespace in the returned string.\n#\n# + arr - the array\n# + return - Base16 string representation\npublic isolated function toBase16(byte[] arr) returns string = external;\n\n# Returns the byte array that a string represents in Base16.\n# `str` must consist of the characters `0..9`, `A..F`, `a..f`\n# and whitespace as allowed by a Ballerina Base16Literal.\n#\n# + str - Base16 string representation\n# + return - the byte array or error\npublic isolated function fromBase16(string str) returns byte[]|error = external;\n\n# Returns a stream of the members of an array.\n#\n# + arr - the array\n# + returns - stream of members of the array\n# The returned stream will use an iterator over `arr` and\n# will therefore handle mutation of `arr` in the same way\n# as an iterator does.\n# Theutation of the `arr`\npublic isolated function toStream(T[] arr) returns stream\u0026lt;T,()\u0026gt; = external;\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lang.boolean\"\u003e10.3.2 \u003ccode\u003elang.boolean\u003c/code\u003e module\u003c/h4\u003e\n\n\u003cp\u003eThe \u003ccode\u003elang.boolean\u003c/code\u003e module corresponds to basic type boolean.\u003c/p\u003e\n\n\u003cpre class=\"langlib\"\u003e\n\n# Converts a string to a boolean.\n# Returns the boolean of which `s` is a string representation.\n# The accepted representations are `true`, `false`\n# (in any combination of lower- and upper-case),\n# and also `1` for true and `0` for `false`.\n# This is the inverse of `value:toString` applied to a `boolean`.\n#\n# + s - string representing a boolean valie\n# + return - boolean that `s` represents, or an error if there is no such boolean\npublic isolated function fromString(string s) returns boolean|error = external;\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lang.decimal\"\u003e10.3.3 \u003ccode\u003elang.decimal\u003c/code\u003e module\u003c/h4\u003e\n\n\u003cp\u003eThe \u003ccode\u003elang.decimal\u003c/code\u003e module corresponds to basic type decimal.\u003c/p\u003e\n\n\u003cpre class=\"langlib\"\u003e\n\n# Sum of zero or more decimal values.\n#\n# + xs - decimal values to sum\n# + return - sum of all the `xs`; 0 if `xs` is empty\npublic isolated function sum(decimal... xs) returns decimal = external;\n\n# Maximum of one or more decimal values.\n#\n# + x - first decimal value\n# + xs - other decimal values\n# + return - maximum value of `x` and all the `xs`\npublic isolated function max(decimal x, decimal... xs) returns decimal = external;\n\n# Minimum of one or more decimal values\n#\n# + x - first decimal value\n# + xs - other decimal values\n# + return - minimum value of `x` and all the `xs`.\npublic isolated function min(decimal x, decimal... xs) returns decimal = external;\n\n# IEEE abs operation.\n#\n# + x - decimal value to operate on\n# + return - absolute value of `x`\npublic isolated function abs(decimal x) returns decimal = external;\n\n# Round a decimal to the closest integral value.\n# Returns the decimal value that is a mathematical integer and closest to `x`.\n# If there are two such values, choose the one that is even\n# (this is the round-to-nearest rounding mode, which is the default for IEEE\n# and for Ballerina).\n# Same as Java Math.rint method\n# Same as .NET Math.Round method\n# IEEE 754 roundToIntegralTiesToEven operation\n# Note that `\u0026lt;int\u0026gt;x` is the same as `\u0026lt;int\u0026gt;x.round()`\n#\n# + x - decimal value to operate on\n# + return - closest decimal value to `x` that is a mathematical integer\npublic isolated function round(decimal x) returns decimal = external;\n\n# Rounds a decimal down to the closest integral value.\n#\n# + x - decimal value to operate on\n# + return - largest (closest to +â) decimal value not greater than `x` that is a mathematical integer.\npublic isolated function floor(decimal x) returns decimal = external;\n\n# Rounds a decimal up to the closest integral value.\n#\n# + x - decimal value to operate on\n# + return - smallest (closest to -â) decimal value not less than `x` that is a mathematical integer\npublic isolated function ceiling(decimal x) returns decimal = external;\n\n# Return the decimal value represented by `s`.\n# `s` must follow the syntax of DecimalFloatingPointNumber as defined by the Ballerina specification\n# with the following modifications\n# - the DecimalFloatingPointLiteral may have a leading `+` or `-` sign\n# - a FloatingPointTypeSuffix is not allowed\n# This is the inverse of `value:toString` applied to an `decimal`.\n#\n# + s - string representation of a decimal\n# + return - decimal representation of the argument or error\npublic isolated function fromString(string s) returns decimal|error = external;\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lang.error\"\u003e10.3.4 \u003ccode\u003elang.error\u003c/code\u003e module\u003c/h4\u003e\n\n\u003cp\u003eThe \u003ccode\u003elang.error\u003c/code\u003e module corresponds to basic type error.\u003c/p\u003e\n\n\u003cpre class=\"langlib\"\u003e\n\n\n# Type for value that can be cloned.\n# This is the same as in lang.value, but is copied here to avoid a dependency.\n\ntype Cloneable readonly|xml|Cloneable[]|map\u0026lt;Cloneable\u0026gt;|table\u0026lt;map\u0026lt;Cloneable\u0026gt;\u0026gt;;\n\n# The type to which error detail records must belong.\npublic type Detail record {|\n   Cloneable...;\n|};\n\n# A type parameter that is a subtype of error `Detail` record type.\n# Has the special semantic that when used in a declaration\n# all uses in the declaration must refer to same type.\n@typeParam\ntype DetailType Detail;\n\n# Returns the error's message.\n#\n# + e - the error value\n# + return - error message\npublic isolated function message(error e) returns string = external;\n\n# Returns the error's cause.\n#\n# + e - the error value\n# + return - error cause\npublic isolated function cause(error e) returns error? = external;\n\n# Returns the error's detail record.\n# The returned value will be immutable.\n# + e - the error value\n# + return - error detail value\npublic isolated function detail(error\u0026lt;DetailType\u0026gt; e) returns readonly \u0026amp; DetailType = external;\n\n# Type representing a stack frame.\n# A call stack is represented as an array of stack frames.\n# This type is also present in lang.runtime to avoid a dependency.\npublic type StackFrame readonly \u0026amp; object {\n   # Returns a string representing this StackFrame.\n   # This must not contain any newline characters.\n   # + return - a string\n   public function toString() returns string;\n};\n\n# Returns an array representing an error's stack trace.\n#\n# + e - the error value\n# + return - an array representing the stack trace of the error value\n# The first member of the array represents the top of the call stack.\npublic isolated function stackTrace(error e) returns StackFrame[] = external;\n\n# Converts an error to a string.\n#\n# + e - the error to be converted to a string\n# + return - a string resulting from the conversion\n#\n# The details of the conversion are specified by the ToString abstract operation\n# defined in the Ballerina Language Specification, using the direct style.\npublic isolated function toString(error e) returns string = external;\n\n# Converts an error to a string that describes the value in Ballerina syntax.\n# + e - the error to be converted to a string\n# + return - a string resulting from the conversion\n#\n# The details of the conversion are specified by the ToString abstract operation\n# defined in the Ballerina Language Specification, using the expression style.\npublic isolated function toBalString(error e) returns string = external;\n\n# A type of error which can be retried.\npublic type Retriable distinct error;\n\n# The RetryManager used by default.\npublic class DefaultRetryManager {\n   private int count;\n   public function init(int count = 3) {\n     this.count = count;\n   }\n   public function shouldRetry(error e) returns boolean {\n      if e is Retriable \u0026amp;\u0026amp; count \u0026gt;  0 {\n         count -= 1;\n         return true;\n      }\n      else {\n         return false;\n      }\n   }\n}\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lang.float\"\u003e10.3.5 \u003ccode\u003elang.float\u003c/code\u003e module\u003c/h4\u003e\n\n\u003cp\u003eThe \u003ccode\u003elang.float\u003c/code\u003e module corresponds to basic type float.\u003c/p\u003e\n\n\u003cpre class=\"langlib\"\u003e\n\n\n# The number Ï\npublic const float PI = 3.141592653589793;\n# Euler's number\npublic const float E =  2.718281828459045;\n# IEEE not-a-number value\npublic const float NaN = 0.0/0.0;\n\n# IEEE positive infinity\npublic const float Infinity = 1.0/0.0;\n\n# Tests whether a float is finite.\n# Exactly one of isFinite, isInfinite and IsNaN will be true for any float value\n#\n# + x - the float to be tested\n# + return - true if `x` is finite, i.e. neither NaN nor +â nor -â\npublic isolated function isFinite(float x) returns boolean = external;\n\n# Tests whether a float is infinite.\n# Exactly one of isFinite, isInfinite and IsNaN will be true for any float value\n#\n# + x - the float to be tested\n# + return - true if `x` is either +â or -â\npublic isolated function isInfinite(float x) returns boolean = external;\n\n# Tests whether a float is NaN.\n# Exactly one of isFinite, isInfinite and IsNaN will be true for any float value.\n#\n# + x - the float to be tested\n# + return - true if `x` is NaN\npublic isolated function isNaN(float x) returns boolean = external;\n\n# Sum of zero or more float values.\n# Result is NaN if any arg is NaN\n#\n# + xs - float values to sum\n# + return - sum of all the `xs`, +0.0 if `xs` is empty\npublic isolated function sum(float... xs) returns float = external;\n\n# Maximum of zero or more float values.\n# Result is -â if no args\n# NaN if any arg is NaN\n#\n# + xs - float values to operate on\n# + return - maximum value of all the `xs`\npublic isolated function max(float... xs) returns float = external;\n\n# Minimum of zero or more float values.\n# Result is +â if no args\n# Result is NaN if any arg is NaN\n#\n# + xs - float values to operate on\n# + return - minimum value of all the `xs`\npublic isolated function min(float... xs) returns float = external;\n\n# IEEE abs operation.\n#\n# + x - float value to operate on\n# + return - absolute value of `x`\npublic isolated function abs(float x) returns float = external;\n\n# Round a float value to the closest integral value.\n# Returns the float value that is a mathematical integer and closest to `x`.\n# If there are two such values, choose the one that is even\n# (this is the round-to-nearest rounding mode, which is the default for IEEE and for Ballerina).\n# Same as Java Math.rint method\n# Same as .NET Math.Round method\n# IEEE roundToIntegralTiesToEven operation\n# Note that `\u0026lt;int\u0026gt;x` is the same as `\u0026lt;int\u0026gt;x.round()`\n#\n# + x - float value to operate on\n# + return - closest float value to `x` that is a mathematical integer\npublic isolated function round(float x) returns float = external;\n\n# Rounds a float down to the closest integral value.\n#\n# + x - float value to operate on\n# + return - largest (closest to +â) float value not greater than `x` that is a mathematical integer.\npublic isolated function floor(float x) returns float = external;\n\n# Rounds a float up to the closest integral value.\n#\n# + x - float value to operate on\n# + return - smallest (closest to -â) decimal value not less than `x` that is a mathematical integer\npublic isolated function ceiling(float x) returns float = external;\n\n# Returns the square root of a float value.\n# Corresponds to IEEE squareRoot operation.\n#\n# + x - float value to operate on\n# + return - square root of `x`\npublic isolated function sqrt(float x) returns float = external;\n\n# Returns the cube root of a float value.\n# Corresponds to IEEE rootn(x, 3) operation.\n#\n# + x - float value to operate on\n# + return - cube root of `x`\npublic isolated function cbrt(float x) returns float = external;\n\n# Raises one float value to the power of another float values.\n# Corresponds to IEEE pow(x, y) operation.\n#\n# + x - base value\n# + y - the exponent\n# + return - `x` raised to the power of `y`\npublic isolated function pow(float x, float y) returns float = external;\n\n# Returns the natural logarithm of a float value\n# Corresponds to IEEE log operation.\n#\n# + x - float value to operate on\n# + return - natural logarithm of `x`\npublic isolated function log(float x) returns float = external;\n\n# Returns the base 10 logarithm of a float value.\n# Corresponds to IEEE log10 operation.\n#\n# + x - float value to operate on\n# + return - base 10 logarithm of `x`\npublic isolated function log10(float x) returns float = external;\n\n# Raises Euler's number to a power.\n# Corresponds to IEEE exp operation.\n#\n# + x - float value to operate on\n# + return - Euler's number raised to the power `x`\npublic isolated function exp(float x) returns float = external;\n\n# Returns the sine of a float value.\n# Corresponds to IEEE sin operation.\n#\n# + x - float value, specifying an angle in radians\n# + return - the sine of `x`\npublic isolated function sin(float x) returns float = external;\n\n# Returns the cosine of a float value.\n# Corresponds to IEEE cos operation.\n#\n# + x - float value, specifying an angle in radians\n# + return - the cosine of `x`\npublic isolated function cos(float x) returns float = external;\n\n# Returns the tangent of a float value.\n# Corresponds to IEEE tan operation\n#\n# + x - float value, specifying an angle in radians\n# + return - the tangent of `x`\npublic isolated function tan(float x) returns float = external;\n\n# Returns the arccosine of a float value.\n# Corresponds to IEEE acos operation\n#\n# + x - float value to operate on\n# + return - the arccosine of `x` in radians\npublic isolated function acos(float x) returns float = external;\n\n# Returns the arctangent of a float value.\n# Corresponds to IEEE atan operation.\n#\n# + x - float value to operate on\n# + return - the arctangent of `x` in radians\npublic isolated function atan(float x) returns float = external;\n\n# Returns the arcsine of a float value.\n# Corresponds to IEEE asin operation.\n#\n# + x - float value to operate on\n# + return - the arcsine of `x` in radians\npublic isolated function asin(float x) returns float = external;\n\n# Performs the 2-argument arctangent operation.\n# Corresponds IEEE atan2(y, x) operation.\n#\n# + y - the y-coordinate\n# + x - the x-coordinate\n# + return - the angle in radians from the positive x-axis to the point\n#   whose Cartesian coordinates are `(x, y)`\npublic isolated function atan2(float y, float x) returns float = external;\n\n# Returns the hyperbolic sine of a float value.\n# Corresponds to IEEE sinh operation.\n#\n# + x - float value to operate on\n# + return - hyperbolic sine of `x`\npublic isolated function sinh(float x) returns float = external;\n\n# Returns the hyperbolic cosine of a float value.\n# Corresponds to IEEE cosh operation.\n#\n# + x - float value to operate on\n# + return - hyperbolic cosine of `x`\npublic isolated function cosh(float x) returns float = external;\n\n# Returns the hyperbolic tangent of a float value.\n# Corresponds to IEEE tanh operation.\n#\n# + x - float value to operate on\n# + return - hyperbolic tangent of `x`\npublic isolated function tanh(float x) returns float = external;\n\n# Return the float value represented by `s`.\n# `s` must follow the syntax of DecimalFloatingPointNumber as defined by the Ballerina specification\n# with the following modifications\n# - the DecimalFloatingPointNumber may have a leading `+` or `-` sign\n# - `NaN` is allowed\n# - `Infinity` is allowed with an optional leading `+` or `-` sign\n# - a FloatingPointTypeSuffix is not allowed\n# This is the inverse of `value:toString` applied to an `float`.\n#\n# + s - string representation of a float\n# + return - float value or error\npublic isolated function fromString(string s) returns float|error = external;\n\n# Returns a string that represents `x` as a hexadecimal floating point number.\n# The returned string will comply to the grammar of HexFloatingPointLiteral\n# in the Ballerina spec with the following modifications:\n# - it will have a leading `-` sign if negative\n# - positive infinity will be represented by `Infinity`\n# - negative infinity will be represented by `-Infinity`\n# - NaN will be represented by `NaN`\n# The representation includes `0x` for finite numbers.\n#\n# + x - float value\n# + return - hexadecimal floating point hex string representation\npublic isolated function toHexString(float x) returns string = external;\n\n# Return the float value represented by `s`.\n# `s` must follow the syntax of HexFloatingPointLiteral as defined by the Ballerina specification\n# with the following modifications\n# - the HexFloatingPointLiteral may have a leading `+` or `-` sign\n# - `NaN` is allowed\n# - `Infinity` is allowed with an optional leading `+` or `-` sign\n#\n# + s - hexadecimal floating point hex string representation\n# + return - float value or error\npublic isolated function fromHexString(string s) returns float|error = external;\n\n# Returns IEEE 64-bit binary floating point format representation of `x` as an int.\n#\n# + x - float value\n# + return - `x` bit pattern as an int\npublic isolated function toBitsInt(float x) returns int = external;\n\n# Returns the float that is represented in IEEE 64-bit floating point by `x`.\n# All bit patterns that IEEE defines to be NaNs will all be mapped to the single float NaN value.\n#\n# + x - int value\n# + return - `x` bit pattern as a float\npublic isolated function fromBitsInt(int x) returns float = external;\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lang.future\"\u003e10.3.6 \u003ccode\u003elang.future\u003c/code\u003e module\u003c/h4\u003e\n\n\u003cp\u003eThe \u003ccode\u003elang.future\u003c/code\u003e module corresponds to basic type future.\u003c/p\u003e\n\n\u003cpre class=\"langlib\"\u003e\n\n# Requests cancellation of a future.\n# + f - the future to be cancelled\n# This sets the cancellation flag in the strand corresponding to `f`.\n# Each time that a strand yields, it will check the cancellation flag\n# and terminate abnormally if the flag is set.\npublic isolated function cancel(future f) returns () = external;\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lang.int\"\u003e10.3.7 \u003ccode\u003elang.int\u003c/code\u003e module\u003c/h4\u003e\n\n\u003cp\u003eThe \u003ccode\u003elang.int\u003c/code\u003e module corresponds to basic type int.\u003c/p\u003e\n\n\u003cpre class=\"langlib\"\u003e\n\n# Built-in subtype that allows signed integers that can be represented in 32 bits using two's complement.\n# This allows an int between -2^31 and 2^31 - 1 inclusive.\n# i.e. between -2,147,483,648 and 2,147,483,647 inclusive.\n@builtinSubtype\npublic type Signed32 int;\n\n# Built-in subtype that allows non-negative integers that can be represented in 16 bits using two's complement.\n# This allows an int between -2^15 and 2^15 - 1 inclusive.\n# i.e. between -32,768 and 32,767 inclusive.\n@builtinSubtype\npublic type Signed16 int;\n\n# Built-in subtype that allows non-negative integers that can be represented in 8 bits using two's complement.\n# This allows an int between -2^7 and 2^7 - 1 inclusive.\n# i.e. between -128 and 127 inclusive.\n@builtinSubtype\npublic type Signed8 int;\n\n# Built-in subtype that allows non-negative integers that can be represented in 32 bits.\n# This allows an int between 0 and 2^32 - 1 inclusive,\n# i.e. between 0 and 4,294,967,295 inclusive.\n@builtinSubtype\npublic type Unsigned32 int;\n\n# Built-in subtype that allows non-negative integers that can be represented in 16 bits.\n# This allows an int between 0 and 2^16 - 1 inclusive,\n# i.e. between 0 and 65,535 inclusive.\n@builtinSubtype\npublic type Unsigned16 int;\n\n# Built-in subtype that allows non-negative integers that can be represented in 8 bits.\n# This allows an int between 0 and 2^8 - 1 inclusive,\n# i.e. between 0 and 255 inclusive.\n# This is the same as `byte`.\n@builtinSubtype\npublic type Unsigned8 int;\n\n# Maximum value of type `int`.\npublic const MAX_VALUE = 9223372036854775807;\n# Minimum value of type `int`.\npublic const MIN_VALUE = -9223372036854775807 - 1; // -9223372036854775808 would overflow\n# Maximum value of type `Signed32`.\npublic const SIGNED32_MAX_VALUE = 2147483647;\n# Minimum value of type `Signed32`.\npublic const SIGNED32_MIN_VALUE = -2147483648;\n# Maximum value of type `Signed16`.\npublic const SIGNED16_MAX_VALUE = 32767;\n# Minimum value of type `Signed16`.\npublic const SIGNED16_MIN_VALUE = -32768;\n# Maximum value of type `Signed8`.\npublic const SIGNED8_MAX_VALUE = 127;\n# Minimum value of type `Signed8`.\npublic const SIGNED8_MIN_VALUE = -128;\n# Maximum value of type `Unsigned32`.\npublic const UNSIGNED32_MAX_VALUE = 4294967295;\n# Maximum value of type `Unsigned16`.\npublic const UNSIGNED16_MAX_VALUE = 65535;\n# Maximum value of type `Unsigned8`.\npublic const UNSIGNED8_MAX_VALUE = 255;\n\n\n# Returns absolute value of an int.\n#\n# + n - int value to be operated on\n# + return - absolute value of `n`\npublic isolated function abs(int n) returns int = external;\n\n# Returns sum of zero or more int values.\n#\n# + ns - int values to sum\n# + return - sum of all the `ns`; 0 is `ns` is empty\npublic isolated function sum(int... ns) returns int = external;\n\n# Maximum of one or more int values.\n#\n# + n - first int value\n# + ns - other int values\n# + return - maximum value of value of `x` and all the `xs`\npublic isolated function max(int n, int... ns) returns int = external;\n\n# Minimum of one or more int values\n#\n# + n - first int value\n# + ns - other int values\n# + return - minimum value of `n` and all the `ns`\npublic isolated function min(int n, int... ns) returns int = external;\n\n# Returns the integer that `s` represents in decimal.\n# Returns error if `s` is not the decimal representation of an integer.\n# The first character may be `+` or `-`.\n# This is the inverse of `value:toString` applied to an `int`.\n#\n# + s - string representation of a integer value\n# + return - int representation of the argument or error\npublic isolated function fromString(string s) returns int|error = external;\n\n# Returns representation of `n` as hexdecimal string.\n# There is no `0x` prefix. Lowercase letters a-f are used.\n# Negative numbers will have a `-` prefix. No sign for\n# non-negative numbers.\n#\n# + n - int value\n# + return - hexadecimal string representation of int value\npublic isolated function toHexString(int n) returns string = external;\n\n# Returns the integer that `s` represents in hexadecimal.\n# Both uppercase A-F and lowercase a-f are allowed.\n# It may start with an optional `+` or `-` sign.\n# No `0x` or `0X` prefix is allowed.\n# Returns an error if the `s` is not in an allowed format.\n#\n# + s - hexadecimal string representation of int value\n# + return - int value or error\npublic isolated function fromHexString(string s) returns int|error = external;\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lang.map\"\u003e10.3.8 \u003ccode\u003elang.map\u003c/code\u003e module\u003c/h4\u003e\n\n\u003cp\u003eThe \u003ccode\u003elang.map\u003c/code\u003e module corresponds to basic type mapping.\u003c/p\u003e\n\n\u003cpre class=\"langlib\"\u003e\n\n# A type parameter that is a subtype of `any|error`.\n# Has the special semantic that when used in a declaration\n# all uses in the declaration must refer to same type.\n@typeParam\ntype Type any|error;\n\n# A type parameter that is a subtype of `any|error`.\n# Has the special semantic that when used in a declaration\n# all uses in the declaration must refer to same type.\n@typeParam\ntype Type1 any|error;\n\n# Returns number of members of a map.\n#\n# + m - the map\n# + return - number of members in `m`\npublic isolated function length(map\u0026lt;any|error\u0026gt; m) returns int = external;\n\n# Returns an iterator over a map.\n# The iterator will iterate over the members of the map not the keys.\n# The `entries` function can be used to iterate over the keys and members together.\n# The `keys` function can be used to iterator over just the keys.\n# \n# + m - the map\n# + return - a new iterator object that will iterate over the members of `m`\npublic isolated function iterator(map\u0026lt;Type\u0026gt; m) returns object {\n    public isolated function next() returns record {|\n        Type value;\n    |}?;\n} = external;\n\n# Returns the member of map `m` with key `k`.\n# This for use in a case where it is known that the map has a specific key,\n# and accordingly panics if `m` does not have a member with key `k`.\n#\n# + m - the map\n# + k - the key\n# + return - member with key `k`\npublic isolated function get(map\u0026lt;Type\u0026gt; m, string k) returns Type = external;\n\n# Returns a map containing [key, member] pair as the value for each key.\n#\n# + m - the map\n# + return - a new map of [key, member] pairs\npublic isolated function entries(map\u0026lt;Type\u0026gt; m) returns map\u0026lt;[string, Type]\u0026gt; = external;\n\n\n# Applies a function each member of a map and returns a map of the result.\n# The resulting map will have the same keys as the argument map.\n#\n# + m - the map\n# + func - a function to apply to each member\n# + return - new map containing result of applying function `func` to each member\npublic isolated function 'map(map\u0026lt;Type\u0026gt; m, @isolatedParam function(Type val) returns Type1 func) returns map\u0026lt;Type1\u0026gt; = external;\n\n# Applies a function to each member of a map.\n# The function `func` is applied to each member of `m`.\n#\n# + m - the map\n# + func - a function to apply to each member\npublic isolated function forEach(map\u0026lt;Type\u0026gt; m, @isolatedParam function(Type val) returns () func) returns () = external;\n\n# Selects the members from a map for which a function returns true.\n#\n# + m - the map\n# + func - a predicate to apply to each element to test whether it should be included\n# + return - new map containing members for which `func` evaluates to true\npublic isolated function filter(map\u0026lt;Type\u0026gt; m, @isolatedParam function(Type val) returns boolean func) returns map\u0026lt;Type\u0026gt; = external;\n\n# Combines the members of a map using a combining function.\n# The combining function takes the combined value so far and a member of the map,\n# and returns a new combined value.\n#\n# + m - the map\n# + func - combining function\n# + initial - initial value for the first argument of combining function `func`\n# + return - result of combining the members of `m` using `func`\npublic isolated function reduce(map\u0026lt;Type\u0026gt; m, @isolatedParam function(Type1 accum, Type val) returns Type1 func, Type1 initial) returns Type1 = external;\n\n# Removes a member of a map.\n#\n# + m - the map\n# + k - the key\n# + return - the member of `m` that had key `k`\n# This removes the member of `m` with key `k` and returns it.\n# It panics if there is no such member.\npublic isolated function remove(map\u0026lt;Type\u0026gt; m, string k) returns Type = external;\n\n# Removes a member of a map with a given key, if the map has member with the key.\n#\n# + m - the map\n# + k - the key\n# + return - the member of `m` that had key `k`, or `()` if `m` does not have a key `k`\n# If `m` has a member with key `k`, it removes and returns it;\n# otherwise it returns `()`.\npublic isolated function removeIfHasKey(map\u0026lt;Type\u0026gt; m, string k) returns Type? = external;\n\n# Removes all members of a map.\n# This panics if any member cannot be removed.\n#\n# + m - the map\npublic isolated function removeAll(map\u0026lt;any|error\u0026gt; m) returns () = external;\n\n# Tests whether m has a member with key `k`.\n#\n# + m - the map\n# + k - the key\n# + return - true if m has a member with key `k`\npublic isolated function hasKey(map\u0026lt;Type\u0026gt; m, string k) returns boolean = external;\n\n# Returns a list of all the keys of map `m`.\n#\n# + m - the map\n# + return - a new list of all keys\npublic isolated function keys(map\u0026lt;any|error\u0026gt; m) returns string[] = external;\n\n# Returns a list of all the members of a map.\n#\n# + m - the map\n# + return - an array whose members are the members of `m`\npublic isolated function toArray(map\u0026lt;Type\u0026gt; m) returns Type[] = external;\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lang.object\"\u003e10.3.9 \u003ccode\u003elang.object\u003c/code\u003e module\u003c/h4\u003e\n\n\u003cp\u003eThe \u003ccode\u003elang.object\u003c/code\u003e module corresponds to basic type object.\u003c/p\u003e\n\n\u003cpre class=\"langlib\"\u003e\n\n# Distinct Iterable type.\n# An object can make itself iterable by using `*object:Iterable;`,\n# and then defining an `iterator` method.\npublic type Iterable distinct object {\n    # Create a new iterator.\n    #\n    # + return - a new iterator object\n    public function iterator() returns object {\n        public function next() returns record {| any|error value; |}|error?;\n    }\n}\n\n# Distinct RawTemplate type.\n# A raw template expression constructs an object belonging to this type.\npublic type RawTemplate distinct object {\n    # An array of the strings containing the characters in BacktickString\n    # outside of interpolations, split at the interpolation points.\n    # The length of this array is one greater than\n    # the length of the `insertions` array.\n    public (readonly \u0026amp; string[]) strings;\n    # An array containing the results of evaluating the\n    # interpolations in the BacktickString.\n    public (any|error)[] insertions;\n};\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lang.stream\"\u003e10.3.10 \u003ccode\u003elang.stream\u003c/code\u003e module\u003c/h4\u003e\n\n\u003cp\u003eThe \u003ccode\u003elang.stream\u003c/code\u003e module corresponds to basic type stream.\u003c/p\u003e\n\n\u003cpre class=\"langlib\"\u003e\n\n\n# A type parameter that is a subtype of `any|error`.\n# Has the special semantic that when used in a declaration\n# all uses in the declaration must refer to same type.\n@typeParam\ntype Type any|error;\n\n# A type parameter that is a subtype of `error`.\n# Has the special semantic that when used in a declaration\n# all uses in the declaration must refer to same type.\n@typeParam\ntype ErrorType error;\n\n# A type parameter that is a subtype of `error?`.\n# Has the special semantic that when used in a declaration\n# all uses in the declaration must refer to same type.\n# This represents the result type of an iterator.\n@typeParam\ntype CompletionType error?;\n\n# A type parameter that is a subtype of `any|error`.\n# Has the special semantic that when used in a declaration\n# all uses in the declaration must refer to same type.\n@typeParam\ntype Type1 any|error;\n\n# Returns an iterator over a stream.\n#\n# + stm - the stream\n# + return - a new iterator object that will iterate over the members of `stm`.\npublic isolated function iterator(stream\u0026lt;Type,CompletionType\u0026gt; stm) returns object {\n    public isolated function next() returns record {|\n        Type value;\n    |}|CompletionType;\n} = external;\n\n# Returns the next member of the stream.\n#\n# + stm - the stream\n# + return - a record containing the next member of the stream, if there is one, or,\n#   otherwise, the completion value\npublic isolated function next(stream\u0026lt;Type,CompletionType\u0026gt; stm) returns record {|\n        Type value;\n    |}|CompletionType = external;\n\n# Closes a stream.\n# This releases any system resources being used by the stream.\n# Closing a stream that has already been closed has no efffect and returns `()`.\n#\n# + stm - the stream to close\n# + return - () if the close completed successfully, otherwise an error\npublic isolated function close(stream\u0026lt;Type,CompletionType\u0026gt; stm) returns CompletionType? = external;\n\n\n# Applies a function to each member of a stream and returns a stream of the results.\n#\n# + stm - the stream\n# + func - a function to apply to each member\n# + return - new stream containing result of applying `func` to each member of `stm` in order\npublic isolated function 'map(stream\u0026lt;Type,CompletionType\u0026gt; stm, @isolatedParam function(Type val) returns Type1 func)\n   returns stream\u0026lt;Type1,CompletionType\u0026gt; = external;\n\n# Applies a function to each member of a stream.\n# The function `func` is applied to each member of stream `stm` in order.\n#\n# + stm - the stream\n# + func - a function to apply to each member\npublic isolated function forEach(stream\u0026lt;Type,CompletionType\u0026gt; stm, @isolatedParam function(Type val) returns () func) returns CompletionType = external;\n\n# Selects the members from a stream for which a function returns true.\n#\n# + stm - the stream\n# + func - a predicate to apply to each member to test whether it should be selected\n# + return - new stream only containing members of `stm` for which `func` evaluates to true\npublic isolated function filter(stream\u0026lt;Type,CompletionType\u0026gt; stm, @isolatedParam function(Type val) returns boolean func)\n   returns stream\u0026lt;Type,CompletionType\u0026gt; = external;\n\n# Combines the members of a stream using a combining function.\n# The combining function takes the combined value so far and a member of the stream,\n# and returns a new combined value.\n#\n# + stm - the stream\n# + func - combining function\n# + initial - initial value for the first argument of combining function `func`\n# + return - result of combining the members of `stm` using `func`\npublic isolated function reduce(stream\u0026lt;Type,ErrorType?\u0026gt; stm, @isolatedParam function(Type1 accum, Type val) returns Type1 func, Type1 initial)\n   returns Type1|ErrorType = external;\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lang.string\"\u003e10.3.11 \u003ccode\u003elang.string\u003c/code\u003e module\u003c/h4\u003e\n\n\u003cp\u003eThe \u003ccode\u003elang.string\u003c/code\u003e module corresponds to basic type string.\u003c/p\u003e\n\n\u003cpre class=\"langlib\"\u003e\n\n# Built-in subtype of string containing strings of length 1.\n@builtinSubtype\ntype Char string;\n\n# Returns the length of the string.\n#\n# + str - the string\n# + return - the number of characters (code points) in `str`\npublic isolated function length(string str) returns int = external;\n\n# Returns an iterator over the string.\n# The iterator will yield the substrings of length 1 in order.\n#\n# + str - the string to be iterated over\n# + return - a new iterator object\npublic isolated function iterator(string str) returns object {\n    public isolated function next() returns record {| Char value; |}?;\n} = external;\n\n# Concatenates zero or more strings.\n#\n# + strs - strings to be concatenated\n# + return - concatenation of all of the `strs`; empty string if `strs` is empty\npublic isolated function concat(string... strs) returns string = external;\n\n# Returns the code point of a character in a string.\n#\n# + str - the string\n# + index - an index in `str`\n# + return - the Unicode code point of the character at `index` in `str`\npublic isolated function getCodePoint(string str, int index) returns int = external;\n\n# Returns a substring of a string.\n#\n# + str - source string.\n# + startIndex - the starting index, inclusive\n# + endIndex - the ending index, exclusive\n# + return - substring consisting of characters with index \u0026gt;= startIndex and \u0026lt; endIndex\npublic isolated function substring(string str, int startIndex, int endIndex = str.length()) returns string = external;\n\n# Lexicographically compares strings using their Unicode code points.\n# This orders strings in a consistent and well-defined way,\n# but the ordering will often not be consistent with cultural expectations\n# for sorted order.\n#\n# + str1 - the first string to be compared\n# + str2 - the second string to be compared\n# + return - an int that is less than, equal to or greater than zero,\n#    according as `str1` is less than, equal to or greater than `str2`\npublic isolated function codePointCompare(string str1, string str2) returns int = external;\n\n# Joins zero or more strings together with a separator.\n#\n# + separator - separator string\n# + strs - strings to be joined\n# + return - a string consisting of all of `strs` concatenated in order\n#     with `separator` in between them\npublic isolated function 'join(string separator, string... strs) returns string = external;\n\n# Finds the first occurrence of one string in another string.\n#\n# + str - the string in which to search\n# + substr - the string to search for\n# + startIndex - index to start searching from\n# + return - index of the first occurrence of `substr` in `str` that is \u0026gt;= `startIndex`,\n#    or `()` if there is no such occurrence\npublic isolated function indexOf(string str, string substr, int startIndex = 0) returns int? = external;\n\n# Finds the last occurrence of one string in another string.\n#\n# + str - the string in which to search\n# + substr - the string to search for\n# + startIndex - index to start searching backwards from\n# + return - index of the last occurrence of `substr` in `str` that is \u0026lt;= `startIndex`,\n#    or `()` if there is no such occurrence\npublic isolated function lastIndexOf(string str, string substr, int startIndex = str.length() - substr.length()) returns int? = external;\n\n# Tests whether a string includes another string.\n#\n# + str - the string in which to search\n# + substr - the string to search for\n# + startIndex - index to start searching from\n# + return - `true` if there is an occurrence of `substr` in `str` at an index \u0026gt;= `startIndex`,\n#    or `false` otherwise\npublic isolated function includes(string str, string substr, int startIndex = 0) returns boolean = external;\n\n# Tests whether a string starts with another string.\n#\n# + str - the string to be tested\n# + substr - the starting string\n# + return - true if `str` starts with `substr`; false otherwise\npublic isolated function startsWith(string str, string substr) returns boolean = external;\n\n# Tests whether a string ends with another string.\n#\n# + str - the string to be tested\n# + substr - the ending string\n# + return - true if `str` ends with `substr`; false otherwise\npublic isolated function endsWith(string str, string substr) returns boolean = external;\n\n\n# Converts occurrences of A-Z to a-z.\n# Other characters are left unchanged.\n#\n# + str - the string to be converted\n# + return - `str` with any occurrences of A-Z converted to a-z\npublic isolated function toLowerAscii(string str) returns string = external;\n\n# Converts occurrences of a-z to A-Z.\n# Other characters are left unchanged.\n#\n# + str - the string to be converted\n# + return - `str` with any occurrences of a-z converted to A-Z\npublic isolated function toUpperAscii(string str) returns string = external;\n\n\n# Tests whether two strings are the same, ignoring the case of ASCII characters.\n# A character in the range a-z is treated the same as the corresponding character in the range A-Z.\n#\n# + str1 - the first string to be compared\n# + str2 - the second string to be compared\n# + return - true if `str1` is the same as `str2`, treating upper-case and lower-case\n# ASCII letters as the same; false, otherwise\npublic isolated function equalsIgnoreCaseAscii(string str1, string str2) returns boolean = external;\n\n# Removes ASCII white space characters from the start and end of a string.\n# The ASCII white space characters are 0x9...0xD, 0x20.\n#\n# + str - the string\n# + return - `str` with leading or trailing ASCII white space characters removed\npublic isolated function trim(string str) returns string = external;\n\n# Represents `str` as an array of bytes using UTF-8.\n#\n# + str - the string\n# + return - UTF-8 byte array\npublic isolated function toBytes(string str) returns byte[] = external;\n\n# Constructs a string from its UTF-8 representation in `bytes`.\n#\n# + bytes - UTF-8 byte array\n# + return - `bytes` converted to string or error\npublic isolated function fromBytes(byte[] bytes) returns string|error = external;\n\n# Converts a string to an array of code points.\n#\n# + str - the string\n# + return - an array with a code point for each character of `str`\npublic isolated function toCodePointInts(string str) returns int[] = external;\n\n# Converts a single character string to a code point.\n#\n# + ch - a single character string\n# + return - the code point of `ch`\npublic isolated function toCodePointInt(Char ch) returns int = external;\n\n# Constructs a string from an array of code points.\n# An int is a valid code point if it is in the range 0 to 0x10FFFF inclusive,\n# but not in the range 0xD800 or 0xDFFF inclusive.\n#\n# + codePoints - an array of ints, each specifying a code point\n# + return - a string with a character for each code point in `codePoints`; or an error\n# if any member of `codePoints` is not a valid code point\npublic isolated function fromCodePointInts(int[] codePoints) returns string|error = external;\n\n# Constructs a single character string from a code point.\n# An int is a valid code point if it is in the range 0 to 0x10FFFF inclusive,\n# but not in the range 0xD800 or 0xDFFF inclusive.\n#\n# + codePoint - an int specifying a code point\n# + return - a single character string whose code point is `codePoint`; or an error\n# if `codePoint` is not a valid code point\npublic isolated function fromCodePointInt(int codePoint) returns Char|error = external;\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lang.table\"\u003e10.3.12 \u003ccode\u003elang.table\u003c/code\u003e module\u003c/h4\u003e\n\n\u003cp\u003eThe \u003ccode\u003elang.table\u003c/code\u003e module corresponds to basic type table.\u003c/p\u003e\n\n\u003cpre class=\"langlib\"\u003e\n\n# A type parameter that is a subtype of `map\u0026lt;any|error\u0026gt;`.\n# Has the special semantic that when used in a declaration\n# all uses in the declaration must refer to same type.\n@typeParam\ntype MapType map\u0026lt;any|error\u0026gt;;\n\n# A type parameter that is a subtype of `map\u0026lt;any|error\u0026gt;`.\n# Has the special semantic that when used in a declaration\n# all uses in the declaration must refer to same type.\n@typeParam\ntype MapType1 map\u0026lt;any|error\u0026gt;;\n\n# A type parameter that is a subtype of `anydata`.\n# Has the special semantic that when used in a declaration\n# all uses in the declaration must refer to same type.\n@typeParam\ntype KeyType anydata;\n\n# Returns number of members of a table.\n#\n# + t - the table\n# + return - number of members in `t`\npublic isolated function length(table\u0026lt;map\u0026lt;any|error\u0026gt;\u0026gt; t) returns int = external;\n\n# Returns an iterator over a table.\n# The iterator will iterate over the members of the table not the keys.\n# The `entries` function can be used to iterate over the keys and members together.\n# The `keys` function can be used to iterator over just the keys.\n# \n# + t - the table\n# + return - a new iterator object that will iterate over the members of `t`\npublic isolated function iterator(table\u0026lt;MapType\u0026gt; t) returns object {\n    public isolated function next() returns record {|\n        MapType value;\n    |}?;\n} = external;\n\n# Returns the member of table `t` with key `k`.\n# This for use in a case where it is known that the table has a specific key,\n# and accordingly panics if `t` does not have a member with key `k`.\n#\n# + t - the table\n# + k - the key\n# + return - member with key `k`\npublic isolated function get(table\u0026lt;MapType\u0026gt; key\u0026lt;KeyType\u0026gt; t, KeyType k) returns MapType = external;\n\n# Adds a member `val` to table `t`, replacing any member with the same key value.\n# If `val` replaces an existing member, it will have the same position\n# in the order of the members as the existing member;\n# otherwise, it will be added as the last member.\n# It panics if `val` is inconsistent with the inherent type of `t`.\npublic isolated function put(table\u0026lt;MapType\u0026gt; t, MapType val) = external;\n\n# Adds a member `val` to table `t`.\n# It will be added as the last member.\n# It panics if `val` has the same key as an existing member of `t`,\n# or if `val` is inconsistent with the inherent type of `t`.\npublic isolated function add(table\u0026lt;MapType\u0026gt; t, MapType val) = external;\n\n\n# Applies a function each member of a table and returns a table of the result.\n#\n# + t - the table\n# + func - a function to apply to each member\n# + return - new table containing result of applying function `func` to each member\npublic isolated function map(table\u0026lt;MapType\u0026gt; t, @isolatedParam function(MapType val) returns MapType1 func)\n   returns table\u0026lt;MapType1\u0026gt; key\u0026lt;never\u0026gt; = external;\n\n# Applies a function to each member of a table.\n# The function `func` is applied to each member of `t`.\n#\n# + t - the table\n# + func - a function to apply to each member\npublic isolated function forEach(table\u0026lt;MapType\u0026gt; t, @isolatedParam function(MapType val) returns () func) returns () = external;\n\n# Selects the members from a table for which a function returns true.\n# The resulting table will have the same keys as the argument table.\n#\n# + t - the table\n# + func - a predicate to apply to each member to test whether it should be included\n# + return - new table containing members for which `func` evaluates to true\npublic isolated function filter(table\u0026lt;MapType\u0026gt; key\u0026lt;KeyType\u0026gt; t, @isolatedParam function(MapType val) returns boolean func)\n   returns table\u0026lt;MapType\u0026gt; key\u0026lt;KeyType\u0026gt; = external;\n\n# Combines the members of a table using a combining function.\n# The combining function takes the combined value so far and a member of the table,\n# and returns a new combined value.\n#\n# + t - the table\n# + func - combining function\n# + initial - initial value for the first argument of combining function `func`\n# + return - result of combining the members of `t` using `func`\npublic isolated function reduce(table\u0026lt;MapType\u0026gt; t, @isolatedParam function(MapType1 accum, MapType val) returns MapType1 func, MapType1 initial) returns MapType1 = external;\n\n# Removes a member of a table.\n#\n# + t - the table\n# + k - the key\n# + return - the member of `t` that had key `k`\n# This removed the member of `t` with key `k` and returns it.\n# It panics if there is no such member.\npublic isolated function remove(table\u0026lt;MapType\u0026gt; key\u0026lt;KeyType\u0026gt; t, KeyType k) returns MapType = external;\n\n# Removes a member of a table with a given key, if the table has member with the key.\n#\n# + t - the table\n# + k - the key\n# + return - the member of `t` that had key `k`, or `()` if `t` does not have a key `k`\n# If `t` has a member with key `k`, it removes and returns it;\n# otherwise it returns `()`.\npublic isolated function removeIfHasKey(table\u0026lt;MapType\u0026gt; key\u0026lt;KeyType\u0026gt; t, KeyType k) returns MapType? = external;\n\n# Removes all members of a table.\n# This panics if any member cannot be removed.\n#\n# + t - the table\npublic isolated function removeAll(table\u0026lt;map\u0026lt;any|error\u0026gt;\u0026gt; t) returns () = external;\n\n# Tests whether `t` has a member with key `k`.\n#\n# + t - the table\n# + k - the key\n# + return - true if `t` has a member with key `k`\npublic isolated function hasKey(table\u0026lt;MapType\u0026gt; key\u0026lt;KeyType\u0026gt; t, KeyType k) returns boolean = external;\n\n# Returns a list of all the keys of table `t`.\n#\n# + t - the table\n# + return - a new list of all keys\npublic isolated function keys(table\u0026lt;map\u0026lt;any|error\u0026gt;\u0026gt; key\u0026lt;KeyType\u0026gt; t) returns KeyType[] = external;\n\n# Returns a list of all the members of a table.\n#\n# + t - the table\n# + return - an array whose members are the members of `t`\npublic isolated function toArray(table\u0026lt;MapType\u0026gt; t) returns MapType[] = external;\n\n# Returns the next available integer key.\n# + t - the table with a key of type int\n# + return - an integer not yet used as a key\n# This is maximum used key value + 1, or 0 if no key used\n# XXX should it be 0, if the maximum used key value is \u0026lt; 0?\n# Provides similar functionality to auto-increment\npublic isolated function nextKey(table\u0026lt;map\u0026lt;any|error\u0026gt;\u0026gt; key\u0026lt;int\u0026gt; t) returns int = external;\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lang.typedesc\"\u003e10.3.13 \u003ccode\u003elang.typedesc\u003c/code\u003e module\u003c/h4\u003e\n\n\u003cp\u003eThe \u003ccode\u003elang.typedesc\u003c/code\u003e module corresponds to basic type typedesc.\u003c/p\u003e\n\n\u003cpre class=\"langlib\"\u003e\n\n# A record representing an identifier for a module.\n# This uniquely identifies a module within a program.\npublic type ModuleId readonly \u0026amp; record {|\n    # the organization\n    string organization;\n    # the module name\n    string name;\n    # platform-specified parts of the identifier\n    string[] platformParts;\n|};\n\n# A record representing a type-id.\n# A type-id uniquely identifies an occurrence of a distinct type descriptor\n# within a program.\npublic type TypeId readonly \u0026amp; record {|\n    # An identifier for the module.\n    ModuleId moduleId;\n    # An identifier within the module identified by `moduleId`.\n    # If it is a string, then it is the name of a type defined in the module.\n    # If it is an integer, then it is compiler-generated.\n    (string|int) localId;\n|};\n\n# Returns the type-ids induced by a typedesc value.\n# + t - the typedesc\n# + primaryOnly - if true, only the primary type-ids will be returned; otherwise,\n    all type-ids will be returned\n# + return - an array containing the type-ids induced by `t` or nil if `t` is not definite\npublic isolated function typeIds(typedesc t, boolean primaryOnly = false) returns readonly \u0026amp; TypeId[]?\n    = external;\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lang.xml\"\u003e10.3.14 \u003ccode\u003elang.xml\u003c/code\u003e module\u003c/h4\u003e\n\n\u003cp\u003eThe \u003ccode\u003elang.xml\u003c/code\u003e module corresponds to basic type xml.\u003c/p\u003e\n\n\u003cpre class=\"langlib\"\u003e\n\n# The namespace URI bound to the `xml` prefix.\npublic const string XML_NAMESPACE_URI = \"http://www.w3.org/XML/1998/namespace\";\n# The namespace URI bound to the `xmlns` prefix.\npublic const string XMLNS_NAMESPACE_URI = \"http://www.w3.org/2000/xmlns/\";\n\n# The expanded name of the `xml:space` attribute.\npublic const string space = \"{http://www.w3.org/XML/1998/namespace}space\";\n# The expanded name of the `xml:lang` attribute.\npublic const string lang = \"{http://www.w3.org/XML/1998/namespace}lang\";\n# The expanded name of the `xml:base` attribute.\npublic const string base = \"{http://www.w3.org/XML/1998/namespace}base\";\n\n# Type for singleton elements.\n# Built-in subtype of xml.\n@builtinSubtype\npublic type Element xml;\n\n# Type for singleton processing instructions.\n# Built-in subtype of xml.\n@builtinSubtype\npublic type ProcessingInstruction xml;\n\n# Type for singleton comments.\n# Built-in subtype of xml.\n@builtinSubtype\npublic type Comment xml;\n\n# Type for zero or more text characters.\n# Built-in subtype of xml.\n# Adjacent xml text items are automatically concatenated,\n# so an xml sequence belongs to this type if it is a singleton test sequence\n# or the empty sequence.\n@builtinSubtype\npublic type Text xml;\n\n# Returns number of xml items in `x`.\n#\n# + x - xml item\n# + return - number of XML items in `x`\npublic isolated function length(xml x) returns int = external;\n\n# A type parameter that is a subtype of any singleton or empty xml sequence.\n# Has the special semantic that when used in a declaration\n# all uses in the declaration must refer to same type.\n@typeParam\ntype ItemType Element|Comment|ProcessingInstruction|Text;\n# A type parameter that is a subtype of `xml`.\n# Has the special semantic that when used in a declaration\n# all uses in the declaration must refer to same type.\n@typeParam\ntype XmlType xml;\n\n# Returns an iterator over the xml items of `x`\n#\n# + x - xml sequence to iterate over\n# + return - iterator object\n# Each item is represented by an xml singleton.\npublic isolated function iterator(xml\u0026lt;ItemType\u0026gt; x) returns object {\n    public isolated function next() returns record {| ItemType value; |}?;\n} = external;\n\n# Returns the item of `x` with index `i`.\n# This differs from `x[i]` in that it panics if\n# `x` does not have an item with index `i`.\n#\n# + x - the xml sequence \n# + k - the index\n# + return - the item with index `i` in `x`\npublic isolated function get(xml\u0026lt;ItemType\u0026gt; x, int i) returns ItemType = external;\n\n# Concatenates xml and string values.\n#\n# + xs - xml or string items to concatenate\n# + return - an xml sequence that is the concatenation of all the `xs`;\n#    an empty xml sequence if the `xs` are empty\npublic isolated function concat((xml|string)... xs) returns xml = external;\n\n# Returns a string giving the expanded name of `elem`.\n#\n# + elem - xml element\n# + return - element name\npublic isolated function getName(Element elem) returns string = external;\n\n# Change the name of element `elem` to `xName`.\n#\n# + elem - xml element\n# + xName - new expanded name\npublic isolated function setName(Element elem, string xName) = external;\n\n# Returns the map representing the attributes of `elem`.\n# This includes namespace attributes.\n# The keys in the map are the expanded names of the attributes.\n#\n# + x - xml element\n# + return - attributes of `x`\npublic isolated function getAttributes(Element x) returns map\u0026lt;string\u0026gt; = external;\n\n# Returns the children of `elem`.\n#\n# + elem - xml element\n# + return - children of `elem`\npublic isolated function getChildren(Element elem) returns xml = external;\n\n# Sets the children of `elem` to `children`.\n# This panics if it would result in the element structure\n# becoming cyclic.\n#\n# + elem - xml element\n# + children - xml or string to set as children\npublic isolated function setChildren(Element elem, xml|string children) = external;\n\n# Returns the descendants of `elem`.\n#\n# + elem - xml element\n# + return - descendants of `elem`\n# The descendants of an element are the children of the element\n# together with, for each of those children that is an element,\n# the descendants of that element, ordered so that\n# each element immediately precedes all its descendants.\n# The order of the items in the returned sequence will thus correspond\n# to the order in which the first character of the representation\n# of the item would occur in the representation of the element in XML syntax.\npublic isolated function getDescendants(Element elem) returns xml = external;\n\n# Returns a string with the character data of an xml value.\n# + x - the xml value\n# + return - a string consisting of all the character data of `x`\n# The character data of an xml value is as follows:\n# * the character data of a text item is a string with one character for each\n#     character information item represented by the text item;\n# * the character data of an element item is the character data of its children;\n# * the character data of a comment item is the empty string;\n# * the character data of a processing instruction item is the empty string;\n# * the character data of an empty xml sequence is the empty string;\n# * the character data of the concatenation of two xml sequences x1 and x2 is the\n#    concatenation of the character data of x1 and the character data of x2.\npublic isolated function data(xml x) returns string = external;\n\n# Returns the target part of the processing instruction.\n#\n# + x - xml processing instruction item\n# + return - target part of `x`\npublic isolated function getTarget(ProcessingInstruction x) returns string = external;\n\n# Returns the content of a processing instruction or comment item.\n#\n# + x - xml item\n# + return - the content of `x`\npublic isolated function getContent(ProcessingInstruction|Comment x) returns string = external;\n\n# Creates a new xml element item.\n#\n# + name - the name of the new element\n# + attributes - the attributes of the new element\n# + children - the children of the new element\n# + return - an xml sequence consisting of only a new xml element with name `name`,\n#   attributes `attributes`, and children `children`\n# The element's attribute map is a newly created map, into which any attributes specified\n# by the `attributes` map are copied.\npublic isolated function createElement(string name, map\u0026lt;string\u0026gt; attributes = {}, xml children = xml``)\n    returns Element = external;\n\n# Creates a new xml processing instruction item.\n#\n# + target - the target part of the processing instruction to be constructed\n# + content - the content part of the processing instruction to be constructed\n# + return - an xml sequence consisting of a processing instruction with target `target`\n#     and content `content`\npublic isolated function createProcessingInstruction(string target, string content)\n    returns ProcessingInstruction = external;\n\n# Creates a new xml comment item.\n#\n# + content - the content of the comment to be constructed.\n# + return - an xml sequence consisting of a comment with content `content`\npublic isolated function createComment(string content) returns Comment = external;\n\n# Constructs an xml value of type Text.\n# + data - the character data of the Text item\n# + return - an xml sequence that is either empty or consists of one text item\n# The returned xml value will be empty when the length of `data` is zero.\npublic isolated function createText(string data) returns Text = external;\n\n# Returns a subsequence of an xml value.\n#\n# + x - the xml value\n# + startIndex - start index, inclusive\n# + endIndex - end index, exclusive\n# + return - a subsequence of `x` consisting of items with index \u0026gt;= startIndex and \u0026lt; endIndex\npublic isolated function slice(xml\u0026lt;ItemType\u0026gt; x, int startIndex, int endIndex = x.length())\n    returns xml\u0026lt;ItemType\u0026gt; = external;\n\n# Strips the insignificant parts of the an xml value.\n# This first transforms the xml value by leaving out any constituent\n# item that is a comment or processing instruction. It then\n# transforms this value by leaving out any constituent item that\n# is a text item that consists entirely of whitespace, where whitespace\n# is as defined by the S production of XML 1.0.\n#\n# + x - the xml value\n# + return - `x` transformed by leaving out insignificant items\npublic isolated function strip(xml x) returns xml = external;\n\n# Selects elements from an xml value.\n# If `nm` is `()`, selects all elements;\n# otherwise, selects only elements whose expanded name is `nm`.\n# \n# + x - the xml value\n# + nm - the expanded name of the elements to be selected, or `()` for all elements\n# + return - an xml sequence consisting of all the element items in `x` whose expanded name is `nm`,\n#  or, if `nm` is `()`, all element items in `x`\npublic isolated function elements(xml x, string? nm = ()) returns xml\u0026lt;Element\u0026gt; = external;\n\n# Returns the children of elements in an xml value.\n# When `x` is of type Element, it is equivalent to `getChildren`.\n# + x - xml value\n# + return - xml sequence containing the children of each element x concatenated in order\n# This is equivalent to `elements(x).map(getChildren)`.\npublic isolated function children(xml x) returns xml = external;\n\n# Selects element children of an xml value\n# + x - the xml value\n# + nm - the expanded name of the elements to be selected, or `()` for all elements\n# + return - an xml sequence consisting of child elements of elements in `x`; if `nm`\n#  is `()`, returns a sequence of all such elements;\n#  otherwise, include only elements whose expanded name is `nm`\n# This is equivalent to `children(x).elements(nm)`.\npublic isolated function elementChildren(xml x, string? nm = ()) returns xml\u0026lt;Element\u0026gt; = external;\n\n# Selects text items from an xml value.\n# + x - the xml value\n# return - an xml sequence consisting of the concatentation of the text items in `x`\npublic isolated function text(xml x) returns Text = external;\n\n\n# Applies a function to each item in an xml sequence, and returns an xml sequence of the results.\n# Each item is represented as a singleton value.\n#\n# + x - the xml value\n# + func - a function to apply to each child or `item`\n# + return - new xml value containing result of applying function `func` to each child or `item`\npublic isolated function map(xml\u0026lt;ItemType\u0026gt; x, @isolatedParam function(ItemType item) returns XmlType func)\n    returns xml\u0026lt;XmlType\u0026gt; = external;\n\n# Applies a function to each item in an xml sequence.\n# Each item is represented as a singleton value.\n#\n# + x - the xml value\n# + func - a function to apply to each item in `x`\npublic isolated function forEach(xml\u0026lt;ItemType\u0026gt; x, @isolatedParam function(ItemType item) returns () func)\n    = external;\n\n# Selects the items from an xml sequence for which a function returns true.\n# Each item is represented as a singleton value.\n#\n# + x - xml value\n# + func - a predicate to apply to each item to test whether it should be selected\n# + return - new xml sequence containing items in `x` for which `func` evaluates to true\npublic isolated function filter(xml\u0026lt;ItemType\u0026gt; x, @isolatedParam function(ItemType item) returns boolean func)\n    returns xml = external;\n\n# Constructs an xml value from a string.\n# This parses the string using the `content` production of the\n# XML 1.0 Recommendation.\n#\n# + s - a string in XML format\n# + return - xml value resulting from parsing `s`, or an error\npublic isolated function fromString(string s) returns xml|error = external;\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lang.transaction\"\u003e10.3.15 \u003ccode\u003elang.transaction\u003c/code\u003e module\u003c/h4\u003e\n\n\u003cp\u003eThe \u003ccode\u003elang.transaction\u003c/code\u003e module supports transactions.\u003c/p\u003e\n\n\u003cpre class=\"langlib\"\u003e\n\n\n# Type of error returned by commit action.\ntype Error distinct error;\n\n# Information about a transaction that does not change\n# after the transaction is started.\ntype Info readonly \u0026amp; record {|\n   # Unique identifier for the transaction branch\n   byte[] xid;\n   # The number of previous attempts in a sequence of retries\n   int retryNumber;\n   # Information about the previous attempt in a sequence of retries.\n   # This will be `()` if the `retryNumber` is 0.\n   Info? prevAttempt;\n   # The time at which the transaction was started.\n   Timestamp startTime;\n|};\n\n# An instant in time.\npublic type Timestamp readonly \u0026amp; object {\n    # Returns milliseconds since 1970-01-01T00:00:00Z, not including leap seconds\n    public function toMillisecondsInt() returns int;\n    # Returns a string representation of the timestamp in ISO 8601 format\n    public function toString() returns string;\n};\n\n# Returns information about the current transaction\npublic transactional isolated function info() returns Info = external;\n\n# Returns information about the transaction with\n# the specified xid.\npublic isolated function getInfo(byte[] xid) returns Info? = external;\n\n# Prevents the global transaction from committing successfully.\n# This ask the transaction manager that when it makes the decision\n# whether to commit or rollback, it should decide to rollback.\n#\n# + error - the error that caused the rollback or `()`, if there is none\npublic transactional isolated function setRollbackOnly(error? e) = external;\n\n# Tells whether it is known that the transaction will be rolled back.\n# + return - true if it is known that the transaction manager will,\n# when it makes the decision whether to commit or rollback, decide\n# to rollback\npublic transactional isolated function getRollbackOnly() returns boolean = external;\n\n# Associates some data with the current transaction branch.\npublic transactional isolated function setData(readonly data) = external;\n\n# Retrieves data associated with the current transaction branch.\n# The data is set using `setData`.\n# + return - the data, or `()` if no data has been set.\npublic transactional isolated function getData() returns readonly = external;\n\n# Type of a commit handler function.\n# + info - information about the transaction being committed\npublic type CommitHandler isolated function(Info info);\n\n# Type of a rollback handler function.\n# + info - information about the transaction being committed\n# + cause - an error describing the cause of the rollback, if there is\n# + willRetry - true if the transaction will be retried, false otherwise\npublic type RollbackHandler isolated function(Info info, error? cause, boolean willRetry);\n\n# Adds a handler to be called if and when the global transaction commits.\n#\n# + handler - the function to be called on commit\npublic transactional isolated function onCommit(CommitHandler handler) = external;\n\n# Adds a handler to be called if and when the global transaction rolls back.\n#\n# + handler - the function to be called on rollback\npublic transactional isolated function onRollback(RollbackHandler handler) = external;\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lang.runtime\"\u003e10.3.16 \u003ccode\u003elang.runtime\u003c/code\u003e module\u003c/h4\u003e\n\n\u003cp\u003eThe \u003ccode\u003elang.runtime\u003c/code\u003e module provides functions related to the\nlanguage runtime that are not specific to a particular basic type.\u003c/p\u003e\n\n\u003cpre class=\"langlib\"\u003e\n\n# Sleep for `seconds`.\n# + seconds - a decimal giving the length of time to sleep in seconds\n# The function will do nothing for the specified period of time before returning.\n# This will cause the current strand to yield.\npublic isolated function sleep(decimal seconds) = external; \n\n# A listener that is dynamically registered with a module.\npublic type DynamicListener object {\n   public function 'start() returns error?;\n   public function gracefulStop() returns error?;\n   public function immediateStop() returns error?;\n};\n\n# Register a listener object with a module.\n# + listener - the listener object to be registered\n# The listener becomes a module listener of the module from which this\n# function is called.\npublic isolated function registerListener(DynamicListener listener) = external;\n\n# Deregister a listener from a module.\n# + listener - the listener object to be unregistered\n# The `listener` ceases to be a module listener of the module from\n# which this function is called.\npublic isolated function deregisterListener(DynamicListener listener) = external;\n\n\n# Type representing a stack frame.\n# A call stack is represented as an array of stack frames.\n# This type is also present in lang.error to avoid a dependency.\npublic type StackFrame readonly \u0026amp; object {\n   # Returns a string representing this StackFrame.\n   # This must not contain any newline characters.\n   # + return - a string\n   public function toString() returns string;\n};\n\n# Return a stack trace for the current call stack.\n# + return - an array representing the current call stack\n# The first member of the array represents the top of the call stack.\npublic isolated function getStackTrace() returns StackFrame[] = external;\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch4 id=\"lang.value\"\u003e10.3.17 \u003ccode\u003elang.value\u003c/code\u003e module\u003c/h4\u003e\n\n\u003cp\u003eThe \u003ccode\u003elang.value\u003c/code\u003e module provides functions that work on values of\nmore than one basic type..\u003c/p\u003e\n\n\u003cpre class=\"langlib\"\u003e\n\n# The type of value to which `clone` and `cloneReadOnly` can be applied.\npublic type Cloneable readonly|xml|Cloneable[]|map\u0026lt;Cloneable\u0026gt;|table\u0026lt;map\u0026lt;Cloneable\u0026gt;\u0026gt;;\n\n# A type parameter that is a subtype of `Cloneable`.\n# Has the special semantic that when used in a declaration\n# all uses in the declaration must refer to same type.\n@typeParam\ntype CloneableType Cloneable;\n\n# Returns a clone of `v`.\n# A clone is a deep copy that does not copy immutable subtrees.\n# A clone can therefore safely be used concurrently with the original.\n# It corresponds to the Clone(v) abstract operation,\n# defined in the Ballerina Language Specification.\n#\n# + v - source value\n# + return - clone of `v`\npublic isolated function clone(CloneableType v) returns CloneableType = external;\n\n# Returns a clone of `v` that is read-only, i.e. immutable.\n# It corresponds to the ImmutableClone(v) abstract operation,\n# defined in the Ballerina Language Specification.\n#\n# + v - source value\n# + return - immutable clone of `v`\npublic isolated function cloneReadOnly(CloneableType v) returns CloneableType \u0026amp; readonly = external;\n\n# Constructs a value with a specified type by cloning another value.\n# + v - the value to be cloned\n# + t - the type for the cloned to be constructed\n# + return - a new value that belongs to type `t`, or an error if this cannot be done\n# \n# When `v` is a structural value, the inherent type of the value to be constructed\n# comes from `t`. When `t` is a union, it must be possible to determine which\n# member of the union to use for the inherent type by following the same rules\n# that are used by list constructor expressions and mapping constructor expressions\n# with the contextually expected type. If not, then an error is returned.\n# The `cloneWithType` operation is recursively applied to each member of `v` using\n# the type descriptor that the inherent type requires for that member.\n# \n# Like the Clone abstract operation, this does a deep copy, but differs in\n# the following respects:\n# - the inherent type of any structural values constructed comes from the specified\n#   type descriptor rather than the value being constructed\n# - the read-only bit of values and fields comes from the specified type descriptor\n# - the graph structure of `v` is not preserved; the result will always be a tree;\n#   an error will be returned if `v` has cycles\n# - immutable structural values are copied rather than being returned as is\n# - numeric values can be converted using the NumericConvert abstract operation\n# - if a record type descriptor specifies default values, these will be used\n#   to supply any missing members\npublic isolated function cloneWithType(anydata v, typedesc\u0026lt;anydata\u0026gt; t = \u0026lt;\u0026gt;) returns t|error = external;\n\n# Safely casts a value to a type.\n# This casts a value to a type in the same way as a type cast expression,\n# but returns an error if the cast cannot be done, rather than panicking.\n# + v - the value to be cast\n# + t - a typedesc for the type to which to cast it\n# return - `v` cast to the type described by `t`, or an error, if the cast cannot be done\npublic isolated function ensureType(any|error v, typedesc\u0026lt;any\u0026gt; t = \u0026lt;\u0026gt;) returns t|error = external;\n\n# Performs a direct conversion of a value to a string.\n# The conversion is direct in the sense that when applied to a value that is already\n# a string it leaves the value unchanged.\n#\n# + v - the value to be converted to a string\n# + return - a string resulting from the conversion\n#\n# The details of the conversion are specified by the ToString abstract operation\n# defined in the Ballerina Language Specification, using the direct style.\npublic isolated function toString(any v) returns string = external;\n\n# Converts a value to a string that describes the value in Ballerina syntax.\n# + v - the value to be converted to a string\n# + return - a string resulting from the conversion\n#\n# If `v` is anydata and does not have cycles, then the result will\n# conform to the grammar for a Ballerina expression and when evaluated\n# will result in a value that is == to v.\n#\n# The details of the conversion are specified by the ToString abstract operation\n# defined in the Ballerina Language Specification, using the expression style.\npublic isolated function toBalString(any v) returns string = external;\n\n# Parses and evaluates a subset of Ballerina expression syntax.\n# + s - the string to be parsed and evaluated\n# return - the result of evaluating the parsed expression, or\n# an error if the string cannot be parsed\n# The subset of Ballerina expression syntax supported is that produced\n# by toBalString when applied to an anydata value.\nfunction fromBalString(string s) returns anydata|error = external;\n\n\n# Converts a value of type `anydata` to `json`.\n# This does a deep copy of `v` converting values that do\n# not belong to json into values that do.\n# A value of type `xml` is converted into a string as if\n# by the `toString` function.\n# A value of type `table` is converted into a list of\n# mappings one for each row.\n# The inherent type of arrays in the return value will be\n# `json[]` and of mappings will be `map\u0026lt;json\u0026gt;`.\n# A new copy is made of all structural values, including\n# immutable values.\n#\n# + v - anydata value\n# + return - representation of `v` as value of type json\n# This panics if `v` has cycles.\npublic isolated function toJson(anydata v) returns json = external;\n\n# Returns the string that represents `v` in JSON format.\n# `v` is first converted to `json` as if by the `toJson` function.\n#\n# + v - anydata value\n# + return - string representation of `v` converted to `json`\npublic isolated function toJsonString(anydata v) returns string = external;\n\n# Parses a string in JSON format and returns the the value that it represents.\n# Numbers in the JSON string are converted into Ballerina values of type\n# decimal except in the following two cases:\n# if the JSON number starts with `-` and is numerically equal to zero, then it is\n# converted into float value of `-0.0`;\n# otherwise, if the JSON number is syntactically an integer and is in the range representable\n# by a Ballerina int, then it is converted into a Ballerina int.\n# A JSON number is considered syntactically an integer if it contains neither\n# a decimal point nor an exponent.\n# \n# Returns an error if the string cannot be parsed.\n#\n# + str - string in JSON format\n# + return - `str` parsed to json or error\npublic isolated function fromJsonString(string str) returns json|error = external;\n\n# Subtype of `json` that allows only float numbers.\npublic type JsonFloat ()|boolean|string|float|JsonFloat[]|map\u0026lt;JsonFloat\u0026gt;;\n\n# Parses a string in JSON format, using float to represent numbers.\n# Returns an error if the string cannot be parsed.\n#\n# + str - string in JSON format\n# + return - `str` parsed to json or error\npublic isolated function fromJsonFloatString(string str) returns JsonFloat|error = external;\n\n# Subtype of `json` that allows only decimal numbers.\npublic type JsonDecimal ()|boolean|string|decimal|JsonDecimal[]|map\u0026lt;JsonDecimal\u0026gt;;\n\n# Parses a string in JSON format, using decimal to represent numbers.\n# Returns an error if the string cannot be parsed.\n#\n# + str - string in JSON format\n# + return - `str` parsed to json or error\npublic isolated function fromJsonDecimalString(string str) returns JsonDecimal|error = external;\n\n# Converts a value of type json to a user-specified type.\n# This works the same as `cloneWithType`,\n# except that it also does the inverse of the conversions done by `toJson`.\n#\n# + v - json value\n# + t - type to convert to\n# + return - value belonging to type `t` or error if this cannot be done\npublic isolated function fromJsonWithType(json v, typedesc\u0026lt;anydata\u0026gt; t = \u0026lt;\u0026gt;)\n    returns t|error = external;\n\n# Converts a string in JSON format to a user-specified type.\n# This is a combination of `fromJsonString` followed by\n# `fromJsonWithType`.\n# + str - string in JSON format\n# + t - type to convert to\n# + return - value belonging to type `t` or error if this cannot be done\npublic isolated function fromJsonStringWithType(string str, typedesc\u0026lt;anydata\u0026gt; t = \u0026lt;\u0026gt;)\n    returns t|error = external;\n    \n# Merges two json values.\n#\n# + j1 - json value\n# + j2 - json value\n# + return - the merge of `j1` with `j2` or an error if the merge fails\n#\n# The merge of `j1` with `j2` is defined as follows:\n# - if `j1` is `()`, then the result is `j2`\n# - if `j2` is `()`, then the result is `j1`\n# - if `j1` is a mapping and `j2` is a mapping, then for each entry [k, j] in j2,\n#   set `j1[k]` to the merge of `j1[k]` with `j`\n#     - if `j1[k]` is undefined, then set `j1[k]` to `j`\n#     - if any merge fails, then the merge of `j1` with `j2` fails\n#     - otherwise, the result is `j1`.\n# - otherwise, the merge fails\n# If the merge fails, then `j1` is unchanged.\npublic isolated function mergeJson(json j1, json j2) returns json|error = external;\n\u003c/pre\u003e\n\n\u003c/section\u003e\n\n\u003c/section\u003e\n\n\u003c/section\u003e\n\u003csection class=\"appendix\"\u003e\n\u003ch2 id=\"references\"\u003eA. References\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eUnicode\u003c/li\u003e\n\u003cli\u003eXML\u003c/li\u003e\n\u003cli\u003eJSON\u003c/li\u003e\n\u003cli\u003eRFC 3629 UTF-8\u003c/li\u003e\n\u003cli\u003eIEEE 754-2008\u003c/li\u003e\n\u003cli\u003eGitHub Markdown\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/section\u003e\n\u003csection class=\"appendix\"\u003e\n\u003ch2 id=\"changes\"\u003eB. Changes since previous releases\u003c/h2\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_B.1\"\u003eB.1 Summary of changes from 2020R1 to 2021R1\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eThere has been a major change to how objects works. All object type\ndescriptors are what was previously called \u003cem\u003eabstract\u003c/em\u003e: they declare\nmethods but do not define them. Objects are now created either by using an\nobject constructor expression, which includes method definitions, or by applying\n\u003ccode\u003enew\u003c/code\u003e to the name of a class defined by a class definition. The\nmethods and fields of an object are in a single symbol space. Classes and\nobject constructors can declare fields as final.\u003c/li\u003e\n\u003cli\u003eServices have become service objects that work in a similar way to client\nobjects; resource methods on service objects have become remote methods. Remote\nmethods are in a separate symbol space from regular methods. There is a new\nconcept for resource methods.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003ereadonly\u003c/code\u003e type has been added. Fields of records can also be\ndeclared as \u003ccode\u003ereadonly\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eFunctions, objects and module-level variables can be declared as\n\u003ccode\u003eisolated\u003c/code\u003e; this works in conjunction with \u003ccode\u003ereadonly\u003c/code\u003e to\nsupport concurrency safety.\u003c/li\u003e\n\u003cli\u003eModule-level variables can be public, provided they are not isolated.\u003c/li\u003e\n\u003cli\u003eIntersection types have been added.\u003c/li\u003e\n\u003cli\u003eDistinct types have been added; these provide the functionality of nominal\ntypes with the framework of a structural type system.\u003c/li\u003e\n\u003cli\u003eThe error type has been revised to take advantage of distinct types. Instead\nan error value having a reason string for categorizing the error and separate\nmessage string in the detail record, an error value has a message string in the\nerror and distinct types are used for categorizing. The cause has also moved\nfrom the detail record into the error value.\u003c/li\u003e\n\u003cli\u003eThe syntax for an error constructor that uses a user-defined type name now\nincludes the \u003ccode\u003eerror\u003c/code\u003e keyword before the type name.\u003c/li\u003e\n\u003cli\u003eLanguage-defined abstract object types now make use of distinct types,\ninstead of using names prefixed with double underscore.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003e__init\u003c/code\u003e method of object and the \u003ccode\u003e__init\u003c/code\u003e function\nof modules have been renamed to \u003ccode\u003einit\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eModule variables can be initialized in the module's \u003ccode\u003einit\u003c/code\u003e\nfunction.\u003c/li\u003e\n\u003cli\u003eThe table type has been redesigned to be more consistent with other\nstructural types and no longer has preview status.\u003c/li\u003e\n\u003cli\u003eEnum declarations have been added.\u003c/li\u003e\n\u003cli\u003eThe return type of a function with an external body can depend on the value\nof a parameter of typedesc type, which can be defaulted from the contextually\nexpected type.\u003c/li\u003e\n\u003cli\u003eQuery expressions support some new clauses: \u003ccode\u003ejoin\u003c/code\u003e clause,\n\u003ccode\u003eorder by\u003c/code\u003e clause, \u003ccode\u003elimit\u003c/code\u003e clause and \u003ccode\u003eon\nconflict\u003c/code\u003e clause.\u003c/li\u003e\n\u003cli\u003eThe relational operators (\u003ccode\u003e\u0026lt; \u0026lt;= \u0026gt; \u0026gt;=\u003c/code\u003e) have been\nextended to apply to more than just numeric types.\u003c/li\u003e\n\u003cli\u003eRaw template expressions have been added.\u003c/li\u003e\n\u003cli\u003eThe ability to specify the visibility of parameter names has been removed: a\nparameter can always be specified by name as well as position; a parameter\ncannot be declared as \u003ccode\u003epublic\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eLocal type definitions have been removed.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003efail\u003c/code\u003e statement has been added, along with a \u003ccode\u003eon\nfail\u003c/code\u003e clause for compound statements. If a \u003ccode\u003echeck\u003c/code\u003e expression\nor action fails, it behaves like a \u003ccode\u003efail\u003c/code\u003e statement rather than a\n\u003ccode\u003ereturn\u003c/code\u003e statement.\u003c/li\u003e\n\u003cli\u003eThe language has a concept of configurability: module level variables can be\nspecified to be \u003ccode\u003econfigurable\u003c/code\u003e, which allows their initial values to\nbe specified at runtime.\u003c/li\u003e\n\u003cli\u003eAn import declaration can no longer specify a version.\u003c/li\u003e\n\u003cli\u003eThe stream type no longer has Preview status.\u003c/li\u003e\n\u003cli\u003eModule prefixes for the langlib modules that correspond to keywords are\npredeclared.\u003c/li\u003e\n\u003cli\u003eBackslash escapes can be used in identifiers without needing an initial\nsingle quote.\u003c/li\u003e\n\u003cli\u003eLanguage support for transactions has been added.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003eerror\u0026lt;*\u0026gt;\u003c/code\u003e feature has been removed, because it does\nnot work well with distinct error types.\u003c/li\u003e\n\u003cli\u003eIn message passing between workers, the function's default worker is now\nreferenced using the \u003ccode\u003efunction\u003c/code\u003e keyword rather than the\n\u003ccode\u003edefault\u003c/code\u003e keyword.\u003c/li\u003e\n\u003cli\u003eMake \u003ccode\u003etrap\u003c/code\u003e expression have lower precedence.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_B.2\"\u003eB.2 Summary of changes from 2019R3 to 2020R1\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eQuery expressions and query actions have been added. This is the first stage\nof language-integrated query.\u003c/li\u003e\n\u003cli\u003eThe stream basic type has been added.\u003c/li\u003e\n\u003cli\u003eLet expressions have been added.\u003c/li\u003e\n\u003cli\u003eThe XML design has been refined and no longer has Preview status.\n\u003cul\u003e\n\u003cli\u003eThe various kinds of xml item (e.g. element and text) are subtypes of the\n\u003ccode\u003exml\u003c/code\u003e type.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003exml\u003c/code\u003e type can have a type parameter specifying the item\ntypes.\u003c/li\u003e\n\u003cli\u003eIteration over xml values exposes characters as text items rather than strings\u003c/li\u003e\n\u003cli\u003eAdjacent characters in XML content are chunked into a single text item.\u003c/li\u003e\n\u003cli\u003eThe meaning of \u003ccode\u003e===\u003c/code\u003e for xml has changed.\u003c/li\u003e\n\u003cli\u003eThe item of an xml sequence value x with index i can be accessed using an\nexpression x[i].\u003c/li\u003e\n\u003cli\u003eThe syntax \u003ccode\u003ex@\u003c/code\u003e for accessing the attributes of an XML element has\nbeen removed.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003elock\u003c/code\u003e statement has been added.\u003c/li\u003e\n\u003cli\u003eWhen a list constructor or mapping constructor is used without a\ncontextually expected type, we now infer a tuple or record type rather than an\narray or map type.\u003c/li\u003e\n\u003cli\u003eThe syntax for Unicode escapes in strings has changed from\n\u003ccode\u003e\\u[\u003cem\u003eCodePoint\u003c/em\u003e]\u003c/code\u003e to \u003ccode\u003e\\u{\u003cem\u003eCodePoint\u003c/em\u003e}\u003c/code\u003e so as\nto align with ECMAScript. Although this is an incompatible change, the previous\nsyntax was not implemented.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003enever\u003c/code\u003e type has been added.\u003c/li\u003e\n\u003cli\u003eLang library modules can now provide built-in subtypes of existing basic\ntypes.\u003c/li\u003e\n\u003cli\u003eThere is a lang.boolean lang lib module.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_B.3\"\u003eB.3 Summary of changes from 2019R2 to 2019R3\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eAn import declaration can use \u003ccode\u003eas _\u003c/code\u003e to include a module in the\nprogram without using its symbols.\u003c/li\u003e\n\u003cli\u003eThe specification of experimental features has been moved to a separate\ndocument.\u003c/li\u003e\n\u003cli\u003eA wait-action can result in an error value when applied to a future that is\nnot a named worker.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/section\u003e\n\n\u003csection\u003e\n\u003ch3 id=\"section_B.4\"\u003eB.4 Summary of changes from 2019R1 to 2019R2\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eThe concept of a built-in method has been replaced by the concept of a lang\nlibrary. A method call on a value of non-object type is now treated as a\nconvenient syntax for a call to a function in a module of the lang library. The\ndesign of the many of the existing built-in methods has been changed to fit in\nwith this. There are many functions in the lang library that were not previously\navailable as built-in methods.\u003c/li\u003e\n\u003cli\u003eA mapping value is now iterable as a sequence of its members (like list),\nrather than as a sequence of key-value pairs. The \u003ccode\u003eentries\u003c/code\u003e lang library\nfunction allows it to be iterated as a sequence of key-value pairs.\u003c/li\u003e\n\u003cli\u003eThe basic type \u003ccode\u003ehandle\u003c/code\u003e has been added.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003etable\u0026lt;T\u0026gt;\u003c/code\u003e type descriptor shorthand has been brought\nback.\u003c/li\u003e\n\u003cli\u003eThere is now a variation on \u003ccode\u003echeck\u003c/code\u003e called\n\u003ccode\u003echeckpanic\u003c/code\u003e, which panics rather than returns on error.\u003c/li\u003e\n\u003cli\u003eA range-expr now returns an object belonging to the Iterable abstract object\ntype, rather than a list.\u003c/li\u003e\n\u003cli\u003eThe decimal type now uses a simplified subset of IEEE 754-2008 decimal\nfloating point.\u003c/li\u003e\n\u003cli\u003eThe status of XML-related features has been changed to preview.\u003c/li\u003e\n\u003cli\u003eThe ability to define a method outside the object type has been\nremoved.\u003c/li\u003e\n\u003cli\u003eThe UnfrozenClone operation has been removed.\u003c/li\u003e\n\u003cli\u003eThe Freeze operation has been replaced by the ImmutableClone operation.\u003c/li\u003e\n\u003cli\u003eThe semantics of field access, member access and assignment are now\nfully specified.\u003c/li\u003e\n\u003cli\u003eA \u003ccode\u003e?.\u003c/code\u003e operator has been added for access to optional fields.\u003c/li\u003e\n\u003cli\u003eA type-cast-expr can include annotations.\u003c/li\u003e\n\u003cli\u003eThe error detail record must belong to type Detail defined in the lang\nlibrary.\u003c/li\u003e\n\u003cli\u003eThe compile-time requirement that the inherent type of a variable-length\nlist must allow members to be filled-in has been removed; this is instead caught\nat run-time.\u003c/li\u003e\n\u003cli\u003eParameter names now have public or module-level visibility, which determines\nwhen a function call can use the parameter name to specify an argument.\u003c/li\u003e\n\u003cli\u003eA type descriptor \u003ccode\u003erecord { }\u003c/code\u003e is open to \u003ccode\u003eanydata\u003c/code\u003e\nrather than \u003ccode\u003eanydata|error\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eCalls using \u003ccode\u003estart\u003c/code\u003e are treated as actions, and so are not\nallowed within expressions.\u003c/li\u003e\n\u003cli\u003eThere is a new syntax for allowing arbitrary strings as identifiers to\nreplace the old delimited identifier syntax \u003ccode\u003e^\"\u003cvar\u003es\u003c/var\u003e\"\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_B.5\"\u003eB.5 Summary of changes from 0.990 to 2019R1\u003c/h3\u003e\n\u003cp\u003e\nThe specification has switched to a new versioning scheme. The \u003cvar\u003en\u003c/var\u003e-th\nversion of the specification released in year 20\u003cvar\u003exy\u003c/var\u003e will be labelled\n20\u003cvar\u003exy\u003c/var\u003eR\u003cvar\u003en\u003c/var\u003e.\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eTuples types now use square brackets, rather than parentheses, as do tuple\nbinding patterns and tuple match patterns. Array constructors and tuple\nconstructors are now unified into list constructors, which use square brackets.\nTuple types can have zero members or one member, and can use \u003ccode\u003eT...\u003c/code\u003e\nsyntax allow trailing members of a specified type.\u003c/li\u003e\n\u003cli\u003eThe way that record type descriptors express openness has changed. Instead\nof the \u003ccode\u003e!...\u003c/code\u003e syntax, there are two flavours of record type\ndescriptor, which use different delimiters: \u003ccode\u003erecord {| |}\u003c/code\u003e allows any\nmapping that has exclusively the specified fields, whereas \u003ccode\u003erecord {\n}\u003c/code\u003e allows any mapping that includes the specified fields; the former can\nuse the \u003ccode\u003eT...\u003c/code\u003e syntax, whereas the latter cannot. The\n\u003ccode\u003e!...\u003c/code\u003e is no longer allowed for record binding patterns and record\nmatch patterns.\u003c/li\u003e\n\u003cli\u003eThe syntax for an array with an array length that is inferred has changed\nfrom \u003ccode\u003eT[!...]\u003c/code\u003e to \u003ccode\u003eT[*]\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eA type descriptor of \u003ccode\u003eerror\u0026lt;*\u0026gt;\u003c/code\u003e can be used to specify an\nerror type whose subtype is inferred.\u003c/li\u003e\n\u003cli\u003eA new expression can no longer be used to create values of structural types;\nit is only allowed for objects.\u003c/li\u003e\n\u003cli\u003eSymbolic string literals \u003ccode\u003e'ident\u003c/code\u003e have been removed (compile time\nconstants provide a more convenient approach).\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003euntaint\u003c/code\u003e expression has been removed (this will be handled by\nannotations instead).\u003c/li\u003e\n\u003cli\u003eThe syntax for named arguments in a function call has reverted to\n\u003ccode\u003earg=\u003c/code\u003e from \u003ccode\u003earg:\u003c/code\u003e, since the latter caused syntactic\nambiguities.\u003c/li\u003e\n\u003cli\u003eThe syntax for error constructors specifies fields of the error detail\nseparately as named arguments, rather than specifying the error detail as a\nsingle argument; the syntax for binding patterns and match patterns for error\nvalues has also changed accordingly.\u003c/li\u003e\n\u003cli\u003eThe error reason argument can be omitted from an error constructor if it\ncan be determined from the contextually expected type.\u003c/li\u003e\n\u003cli\u003eThe syntax for annotation declarations has been revised; the places where\nannotations are allowed has been revised to match the possible attachment\npoints.\u003c/li\u003e\n\u003cli\u003eAn \u003ccode\u003e.@\u003c/code\u003e binary operator has been added for accessing annotations\nat runtime.\u003c/li\u003e\n\u003cli\u003eA unary \u003ccode\u003etypeof\u003c/code\u003e operator has been added.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003etypedesc\u003c/code\u003e type now takes an optional type parameter.\u003c/li\u003e\n\u003cli\u003eThe type parameters for \u003ccode\u003efuture\u003c/code\u003e and \u003ccode\u003estream\u003c/code\u003e are now\noptional.\u003c/li\u003e\n\u003cli\u003eThe syntax for a function with an external implementation has changed to use\n\u003ccode\u003e=external\u003c/code\u003e in place of the curly braces.\u003c/li\u003e\n\u003cli\u003eA numeric literal can use a suffix of \u003ccode\u003ed\u003c/code\u003e or \u003ccode\u003ef\u003c/code\u003e to\nindicate that it represents a value belonging to the decimal or float type\nrespectively.\u003c/li\u003e\n\u003cli\u003eRecord type descriptors may now specify a default value for fields.\u003c/li\u003e\n\u003cli\u003eProviding a default value for a parameter no longer affects whether a function\ncall must supply the argument for that parameter positionally or by name. Instead\nthe argument for any parameter can be supplied either positionally or by name.\nTo avoid ambiguity, all arguments specified positionally must be specified before\narguments specified by name.\u003c/li\u003e\n\u003cli\u003eExpressions specifying the default value for function parameters are not\ncompile time constants, and are evaluated each time they are used to supply a\nmissing argument.\u003c/li\u003e\n\u003cli\u003eIn the argument list of a function or method call, positional arguments are\nnow required to be specified before named arguments.\u003c/li\u003e\n\u003cli\u003eTypes may now be defined within a block.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_B.6\"\u003eB.6 Summary of changes from 0.980 to 0.990\u003c/h3\u003e\n\u003cp\u003e\n\u003cstrong\u003eStructural types and values\u003c/strong\u003e\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eConcepts relating to typing of mutable structural values have been changed\nin order to make type system sound.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003ematch\u003c/code\u003e statement has been redesigned.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003ebut\u003c/code\u003e expression has been removed.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003eis\u003c/code\u003e expression for dynamic type testing has been added.\u003c/li\u003e\n\u003cli\u003eThe type-cast-expr \u0026lt;T\u0026gt;E now performs unsafe type casts.The only\nconversions it performs are numeric conversions.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003eanydata\u003c/code\u003e type has been added, which is a union of simple and\nstructural types.\u003c/li\u003e\n\u003cli\u003eRecords are now by default open to \u003ccode\u003eanydata|error\u003c/code\u003e, rather than\n\u003ccode\u003eany\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eType parameters for built-in types (map, stream, future), which previously\ndefaulted to any, are now required.\u003c/li\u003e\n\u003cli\u003eThe type parameter for json (e.g. json\u0026lt;T\u0026gt;) is not allowed any more.\u003c/li\u003e\n\u003cli\u003eType for table columns are restricted to subtype of anydata|error.\u003c/li\u003e\n\u003cli\u003eThere are now two flavors of equality operator: == and != for deep equality\n(which is allowed only for \u003ccode\u003eanydata\u003c/code\u003e), and ===  and !== for exact\nequality.\u003c/li\u003e\n\u003cli\u003eThere is a built-in clone operation for performing a deep copy on values of\ntype anydata.\u003c/li\u003e\n\u003cli\u003eThere is a built-in freeze operation for making structural values deeply\nimmutable.\u003c/li\u003e\n\u003cli\u003eCompile-time constants (which are always a subtype of anydata and frozen)\nhave been added.\u003c/li\u003e\n\u003cli\u003eSingleton types have been generalized: any compile-time constant can be made\ninto a singleton value.\u003c/li\u003e\n\u003cli\u003eVariables can be declared final, with a similar semantic to Java.\u003c/li\u003e\n\u003cli\u003eErrors are now immutable.\u003c/li\u003e\n\u003cli\u003eModule variables are not allowed to be public: only compile-time constants\ncan be public.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\n\u003cstrong\u003eError handling\u003c/strong\u003e\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe \u003ccode\u003eany\u003c/code\u003e type no longer includes \u003ccode\u003eerror\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003echeck\u003c/code\u003e is now an expression.\u003c/li\u003e\n\u003cli\u003eExceptions have been replaced by panics\n\u003col\u003e\n\u003cli\u003ethe \u003ccode\u003ethrow\u003c/code\u003e statement has been replaced by the \u003ccode\u003epanic\u003c/code\u003e\nstatement\u003c/li\u003e\n\u003cli\u003ethe\u003ccode\u003e try\u003c/code\u003e statement has been replaced by the \u003ccode\u003etrap\u003c/code\u003e\nexpression\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eObject constructors (which could not return errors) have been replaced by\n\u003ccode\u003e__init\u003c/code\u003e methods (which can return errors).\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\n\u003cstrong\u003eConcurrency\u003c/strong\u003e\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eWorkers in functions have been redesigned. In particular, workers now have a\nreturn value.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003edone\u003c/code\u003e statement has been removed.\u003c/li\u003e\n\u003cli\u003eThe fork/join statement has been redesigned.\u003c/li\u003e\n\u003cli\u003eA syntactic category between expression and statement, called action, has\nbeen added.\u003c/li\u003e\n\u003cli\u003eA synchronous message send action has been added.\u003c/li\u003e\n\u003cli\u003eA flush action has been added to flush asynchronously sent messages.\u003c/li\u003e\n\u003cli\u003eA wait action has been added to wait for a worker and get its return value.\u003c/li\u003e\n\u003cli\u003eFutures have been unified with workers. A future\u0026lt;T\u0026gt; represents a value to\nbe returned by a named worker.\u003c/li\u003e\n\u003cli\u003eError handling of message send/receive has been redesigned.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\n\u003cstrong\u003eEndpoints and services\u003c/strong\u003e\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eClient endpoints have been replaced by client objects, and actions on client\nendpoints have been replaced by remote methods on client objects. Remote methods\nare called using a remote method call action, which replaces the action\ninvocation statement.\u003c/li\u003e\n\u003cli\u003eModule endpoint declaration has been replaced by module listener\ndeclaration, which uses the Listener built-in object type.\u003c/li\u003e\n\u003cli\u003eThe service type has been added as a new basic type of behavioral value,\ntogether with service constructor expressions for creating service values.\u003c/li\u003e\n\u003cli\u003eModule service definitions have been redesigned.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\n\u003cstrong\u003eMiscellaneous changes\u003c/strong\u003e\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003ePublic/private visibility qualifiers must be repeated on an outside method\ndefinition.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/section\u003e\n\u003csection\u003e\n\u003ch3 id=\"section_B.7\"\u003eB.7 Summary of changes from 0.970 to 0.980\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eThe decimal type has been added.\u003c/li\u003e\n\u003cli\u003eThere are no longer any implicit numeric conversions.\u003c/li\u003e\n\u003cli\u003eThe type of a numeric literal can be inferred from the context.\u003c/li\u003e\n\u003cli\u003eThe error type is now a distinct basic type.\u003c/li\u003e\n\u003cli\u003eThe byte type has been added as a predefined subtype of int; blobs have been\nreplaced by arrays of bytes.\u003c/li\u003e\n\u003cli\u003eThe syntax of string templates and xml literals has been revised and\nharmonized.\u003c/li\u003e\n\u003cli\u003eThe syntax of anonymous functions has been revised to provide two\nalternative syntaxes: a full syntax similar to normal function definitions and a\nmore convenient arrow syntax for when the function body is an expression.\u003c/li\u003e\n\u003cli\u003eThe cases of a match statement are required to be exhaustive.\u003c/li\u003e\n\u003cli\u003eThe + operator is specified to do string and xml concatenation as well as\naddition.\u003c/li\u003e\n\u003cli\u003eBitwise operators have been added (\u003ccode\u003e\u0026lt;\u0026lt;\u003c/code\u003e, \u003ccode\u003e\u0026gt;\u0026gt;\u003c/code\u003e,\n\u003ccode\u003e\u0026gt;\u0026gt;\u0026gt;\u003c/code\u003e, \u003ccode\u003e\u0026amp;\u003c/code\u003e, \u003ccode\u003e|\u003c/code\u003e, \u003ccode\u003e^\u003c/code\u003e,\n\u003ccode\u003e~\u003c/code\u003e) rather than = after the argument name.\u003c/li\u003e\n\u003cli\u003eIn a function call or method call, named arguments have changed to use\n\u003ccode\u003e:\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eA statement with \u003ccode\u003echeck\u003c/code\u003e always handles an error by returning it,\nnot by throwing it.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003echeck\u003c/code\u003e is allowed in compound assignment statements.\u003c/li\u003e\n\u003cli\u003eMethod names are now looked up differently from field names; values of types\nother than objects can now have built-in methods.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003elengthof\u003c/code\u003e unary expression has been removed; the length\nbuilt-in method can be used instead.\u003c/li\u003e\n\u003cli\u003eThe semantics of \u0026lt;T\u0026gt;expr have been specified.\u003c/li\u003e\n\u003cli\u003eThe value space for tuples and arrays is now unified, in the same way as the\nvalue space for records and maps was unified. This means that tuples are now\nmutable. Array types can now have a length.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003enext\u003c/code\u003e keyword has been changed to \u003ccode\u003econtinue\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eThe syntax and semantics of destructuring is now done in a consistent way\nfor the but expression, the match statement, the foreach statement,\ndestructuring assignment statements and variable declarations.\u003c/li\u003e\n\u003cli\u003eThe implied initial value is not used as a default initializer in variable\ndeclarations. A local variable whose declaration omits the initializer must be\ninitialized by an assignment before it is used. A global variable declaration\nmust always have an initializer. A new expression can be used with any reference\ntype that has an implicit initial value.\u003c/li\u003e\n\u003cli\u003ePostfix increment and decrement statements have been removed.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003e...\u003c/code\u003e and \u003ccode\u003e..\u0026lt;\u003c/code\u003e operators have been added for\ncreating integer ranges; this replaces the foreach statement's special treatment\nof integer ranges.\u003c/li\u003e\n\u003cli\u003eAn object type can be declared to be abstract, meaning it cannot be used\nwith \u003ccode\u003enew\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eBy default,  a record type now allows extra fields other than those\nexplicitly mentioned; \u003ccode\u003eT...\u003c/code\u003e requires extra fields to be of type T\nand \u003ccode\u003e!...\u003c/code\u003e disallows extra fields.\u003c/li\u003e\n\u003cli\u003eIn a mapping constructor, an expression can be used for the field name by\nenclosing the expression in square brackets (as in ECMAScript).\u003c/li\u003e\n\u003cli\u003eInteger arithmetic operations are specified to throw an exception on\noverflow.\u003c/li\u003e\n\u003cli\u003eThe syntax for documentation strings has changed.\u003c/li\u003e\n\u003cli\u003eThe deprecated construct has been removed (data related to deprecation will\nbe provided by an annotation; documentation related to deprecation will be part\nof the documentation string).\u003c/li\u003e\n\u003cli\u003eThe order of fields, methods and constructors in object types is no longer\nconstrained.\u003c/li\u003e\n\u003cli\u003eA function or method can be defined as \u003ccode\u003eextern\u003c/code\u003e. The\n\u003ccode\u003enative\u003c/code\u003e keyword has been removed.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection class=\"appendix\"\u003e\n\u003ch2 id=\"planned_future_functionality\"\u003eC. Planned future functionality\u003c/h2\u003e\n\n\u003cp\u003e\nThe vision for the Ballerina language includes a range of functionality\nthat is not yet included in this specification.\n\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003cem\u003eSecurity\u003c/em\u003e will combine language and platform features to make\nprograms secure by default.\u003c/li\u003e\n\u003cli\u003e\n\u003cem\u003eDate/time basic types\u003c/em\u003e will provide one or more basic types related\nto date and time.\u003c/li\u003e\n\u003cli\u003e\n\u003cem\u003eEvent stream processing\u003c/em\u003e will build on the \u003ccode\u003estream\u003c/code\u003e type\nto allow queries over timestamped sequences of events\u003c/li\u003e\n\u003cli\u003e\n\u003cem\u003eGeneric types\u003c/em\u003e will provide types that can be instantiated with one\nor more type parameters.\u003c/li\u003e\n\u003cli\u003e\n\u003cem\u003eFlexible message passing\u003c/em\u003e will support patterns of communication\nbetween workers/strands, where the number of messages is not fixed and/or\nworkers are not peers.\u003c/li\u003e\n\u003cli\u003e\n\u003cem\u003eLong-running processes\u003c/em\u003e will allow the execution of a program to be\nautomatically suspended and then later resumed upon the occurrence of particular\nexternal events.\u003c/li\u003e\n\u003cli\u003e\n\u003cem\u003eReliable messaging\u003c/em\u003e will allow for sending messages across the\nnetwork with some guarantees about reliability.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\n\u003ca href=\"https://github.com/ballerina-platform/ballerina-spec/blob/master/lang/proposals/README.md\"\u003eProposals\u003c/a\u003e\nfor new language features relating to this and other functionality are\nmaintained in the specification's GitHub repository.\n\u003c/p\u003e\n\n\u003c/section\u003e\n\n\u003csection class=\"appendix\"\u003e\n\u003ch2 id=\"contributors\"\u003eD. Other contributors\u003c/h2\u003e\n\u003cp\u003e\nThe following contributed to establishing the design principles of the language:\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eFrank Leymann, \u003ca href=\"mailto:frank.leymann@iaas.uni-stuttgart.de\"\u003efrank.leymann@iaas.uni-stuttgart.de\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eSrinath Perera, \u003ca href=\"mailto:srinath@wso2.com\"\u003esrinath@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eKasun Indrasiri, \u003ca href=\"mailto:kasun@wso2.com\"\u003ekasun@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\nThe following also contributed to the language in a variety of ways (in\nalphabetical order):\n\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eShafreen Anfar, \u003ca href=\"mailto:shafreen@wso2.com\"\u003eshafreen@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eAfkham Azeez, \u003ca href=\"mailto:azeez@wso2.com\"\u003eazeez@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eAnjana Fernando, \u003ca href=\"mailto:anjana@wso2.com\"\u003eanjana@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eChanaka Fernando, \u003ca href=\"mailto:chanakaf@wso2.com\"\u003echanakaf@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eJoseph Fonseka, \u003ca href=\"mailto:joseph@wso2.com\"\u003ejoseph@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003ePaul Fremantle, \u003ca href=\"mailto:paul@wso2.com\"\u003epaul@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eAntony Hosking, \u003ca href=\"mailto:antony.hosking@anu.edu.au\"\u003eantony.hosking@anu.edu.au\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eTyler Jewell, \u003ca href=\"mailto:tylerjewell@gmail.com\"\u003etylerjewell@gmail.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eAnupama Pathirage, \u003ca href=\"mailto:anupama@wso2.com\"\u003eanupama@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eManuranga Perera, \u003ca href=\"mailto:manu@wso2.com\"\u003emanu@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eSupun Thilina Sethunga, \u003ca href=\"mailto:supuns@wso2.com\"\u003esupuns@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eSriskandarajah Suhothayan, \u003ca href=\"mailto:suho@wso2.com\"\u003esuho@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eIsuru Udana, \u003ca href=\"mailto:isuruu@wso2.com\"\u003eisuruu@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eRajith Lanka Vitharana, \u003ca href=\"mailto:rajithv@wso2.com\"\u003erajithv@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eMohanadarshan Vivekanandalingam, \u003ca href=\"mailto:mohan@wso2.com\"\u003emohan@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eLakmal Warusawithana, \u003ca href=\"mailto:lakmal@wso2.com\"\u003elakmal@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eAyoma Wijethunga, \u003ca href=\"mailto:ayoma@wso2.com\"\u003eayoma@wso2.com\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/section\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/spec/lang/[...slug]","query":{"slug":["2021R1","index"]},"buildId":"lz8gcLmWqhPPISHqmYQtS","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>